
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 8. Graphic Content - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-8-graphic-content" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 8. Graphic Content
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 8. Graphic Content
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="08-Graphic_Content.html" class="md-nav__link md-nav__link--active">
        Chapter 8. Graphic Content
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-linking-a-graphic-object-to-a-document" class="md-nav__link">
    1.  Linking a Graphic Object to a Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-adding-a-graphic-to-a-document-as-a-shape" class="md-nav__link">
    2.  Adding a Graphic to a Document as a Shape
  </a>
  
    <nav class="md-nav" aria-label="2.  Adding a Graphic to a Document as a Shape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-creating-an-image-shape" class="md-nav__link">
    2.1.  Creating an Image Shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-adding-other-graphics-to-the-document" class="md-nav__link">
    2.2.  Adding Other Graphics to the Document
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-accessing-linked-images-and-shapes" class="md-nav__link">
    3.  Accessing Linked Images and Shapes
  </a>
  
    <nav class="md-nav" aria-label="3.  Accessing Linked Images and Shapes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-finding-and-saving-text-graphics-in-a-document" class="md-nav__link">
    3.1.  Finding and Saving Text Graphics in a Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-finding-the-shapes-in-a-document" class="md-nav__link">
    3.2.  Finding the Shapes in a Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-another-way-of-accessing-drawing-shapes" class="md-nav__link">
    3.3.  Another Way of Accessing Drawing Shapes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-linking-a-graphic-object-to-a-document" class="md-nav__link">
    1.  Linking a Graphic Object to a Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-adding-a-graphic-to-a-document-as-a-shape" class="md-nav__link">
    2.  Adding a Graphic to a Document as a Shape
  </a>
  
    <nav class="md-nav" aria-label="2.  Adding a Graphic to a Document as a Shape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-creating-an-image-shape" class="md-nav__link">
    2.1.  Creating an Image Shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-adding-other-graphics-to-the-document" class="md-nav__link">
    2.2.  Adding Other Graphics to the Document
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-accessing-linked-images-and-shapes" class="md-nav__link">
    3.  Accessing Linked Images and Shapes
  </a>
  
    <nav class="md-nav" aria-label="3.  Accessing Linked Images and Shapes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-finding-and-saving-text-graphics-in-a-document" class="md-nav__link">
    3.1.  Finding and Saving Text Graphics in a Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-finding-the-shapes-in-a-document" class="md-nav__link">
    3.2.  Finding the Shapes in a Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-another-way-of-accessing-drawing-shapes" class="md-nav__link">
    3.3.  Another Way of Accessing Drawing Shapes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/08-Graphic_Content.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-8-graphic-content">Chapter 8. Graphic Content</h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Graphics; 
Linked Images/Shapes </p>
<p>Example folders: "Text 
Tests" and "Utils" </p>
</div>
<p>Chapter 7 looked at several forms of text document 
content (e.g. text frames, math formulae, text fields and 
tables, and bookmarks), as indicated by Figure 1. However 
the different ways of adding graphical content (corresponding to the services 
highlighted in orange) are the focus of this chapter </p>
<p><img alt="" src="images/08-Graphic_Content-1.png" /></p>
<p>Figure 1. The TextContent Service and Some Subclasses. </p>
<h2 id="1-linking-a-graphic-object-to-a-document">1.  Linking a Graphic Object to a Document</h2>
<p>Adding an image to a text document follows the same steps as other text content, as 
shown in Write.addImageLink(): </p>
<p>public static void addImageLink(XTextDocument doc,<br />
                             XTextCursor cursor, String fnm)<br />
{  addImageLink(doc, cursor, fnm, 0, 0);  } 
                     // 0, 0 means use image's size as width &amp; height </p>
<p>public static void addImageLink(XTextDocument doc,<br />
                           XTextCursor cursor, String fnm,<br />
                           int width, int height) 
{ try { </p>
<pre><code>// create TextContent for graphic 
XTextContent tgo = Lo.createInstanceMSF(XTextContent.class,  
                         "com.sun.star.text.TextGraphicObject"); 
if (tgo == null) { 
  System.out.println("Could not create a text graphic object"); 
  return; 
}

// set anchor and URL properties 
XPropertySet props = Lo.qi( XPropertySet.class, tgo); 
props.setPropertyValue("AnchorType",  
                       TextContentAnchorType.AS_CHARACTER); 
props.setPropertyValue("GraphicURL", FileIO.fnmToURL(fnm));

// optionally set the width and height 
if ((width &gt; 0) &amp;&amp; (height &gt; 0)) { 
  props.setPropertyValue("Width", width); 
  props.setPropertyValue("Height", height); 
}

// append image to document, followed by a newline 
append(cursor, tgo); 
endLine(cursor);
</code></pre>
<p>} 
  catch (Exception e) { 
    System.out.println("Insert of \"" + fnm + "\" failed: " + e); 
  } 
}  // end of addImageLink() </p>
<p>The TextGraphicObject service doesn't offer a XTextGraphicObject interface, so 
Lo.createInstanceMSF() returns an XTextContext. </p>
<p>The interface is also converted to XPropertySet because several properties need to be 
set. The frame is anchored, and the image's filename is assigned to "GraphicURL" 
(after being changed into a URL). </p>
<p>The image's size on the page depends on the dimensions of its enclosing frame, which 
are set in the "Width" and "Height" properties: </p>
<p>props.setPropertyValue("Width", 4500);   // 45 mm width 
props.setPropertyValue("Height", 4000);  // 40 mm height </p>
<p>The values are in 1/100 mm units, so 4500 is 45 mm or 4.5 cm. </p>
<p>If these properties aren't explicitly set then the frame size defaults to being the width 
and height of the image. </p>
<p>In more realistic code, the width and height properties would be calculated as some 
scale factor of the image's size, as measured in 1/100 mm units not pixels. These 
dimensions are available if the image file is loaded as an XGraphic object, as shown 
in Images.getSize100mm(): </p>
<p>// in the Images class 
public static Size getSize100mm(String imFnm) 
{ 
  XGraphic graphic = loadGraphicFile(imFnm); 
  if (graphic == null) 
    return null; 
  return (Size) Props.getProperty(graphic, "Size100thMM"); 
}  // end of getSize100mm() </p>
<p>public static XGraphic loadGraphicFile(String imFnm) 
{ 
  // create graphics provider 
  XGraphicProvider gProvider = Lo.createInstanceMCF( 
                    XGraphicProvider.class,<br />
                    "com.sun.star.graphic.GraphicProvider"); 
  if (gProvider == null) { 
    System.out.println("Graphic Provider could not be found"); 
    return null; 
  } </p>
<p>// set URL property and query it for XGraphic 
  PropertyValue[] fileProps = <br />
            Props.makeProps("URL", FileIO.fnmToURL(imFnm)); 
  try { 
    return gProvider.queryGraphic(fileProps); 
  } 
  catch(Exception e) 
  { System.out.println("Could not load XGraphic from " + imFnm); 
    return null; <br />
  } 
}  // end of loadGraphicFile() </p>
<p>Displaying the image at a scaled size is possible by combining 
Images.getSize100mm() and Write.addImageLink(): </p>
<p>Size imSize = Images.getSize100mm(imFnm); 
int w = (int)Math.round(imSize.Width<em>1.5);   // enlarge by 1.5x 
int h = (int)Math.round(imSize.Height</em>1.5); 
Write.addImageLink(doc, cursor, imFnm, w, h);    </p>
<p>A possible drawback of Write.addImageLink() is that the document only contains a 
link to the image. This becomes an issue if you save the document in a format other 
than ".odt". In particular, when saved as a Word ".doc" file, the link is lost. </p>
<h2 id="2-adding-a-graphic-to-a-document-as-a-shape">2.  Adding a Graphic to a Document as a Shape</h2>
<p>An alternative to inserting a graphic as a link is to treat it as a shape. Shapes will be 
discussed at length in Part 3, so I won't go into much detail about them here. One 
difference between a graphic link and shape is that shapes can be rotated. </p>
<p>Shapes can be created using the com.sun.star.text.Shape service, 
com.sun.star.drawing.Shape, or one of its subclasses, while 
XDrawPageSupplier.getDrawPage() accesses the shapes in a document.  </p>
<p>The shape hierarchy is quite extensive (i.e. there are many kinds of shape), so only the 
parts used here are shown in Figure 2: </p>
<p><img alt="" src="images/08-Graphic_Content-2.png" /></p>
<p>Figure 2. Part of the Shape Hierarchy. </p>
<p>In Figure 2, "(text) Shape" refers to the com.sun.star.text.Shape service, while 
"(drawing) Shape" is com.sun.star.drawing.Shape. </p>
<p>My examples use GraphicObjectShape to create a shape containing an image, and 
LineShape to add a line to the document.  </p>
<p>The XShapeDescriptor interface in com.sun.star.drawing.Shape is a useful way to 
obtain the name of a shape service. </p>
<h3 id="21-creating-an-image-shape">2.1.  Creating an Image Shape</h3>
<p>The BuildDoc.java example adds an image shape to the document by calling 
Write.addImageShape(): </p>
<p>// code fragment in BuildDoc.java 
Write.append(cursor, "Image as a shape: "); 
Write.addImageShape(doc, cursor, imFnm); // image filename 
Write.endParagraph(cursor); </p>
<p>Write.addImageShape() comes in two versions: with and without width and height 
arguments. A shape with no explicitly set width and height properties is rendered as a 
miniscule image (about 1 mm wide). Call me old-fashioned, but I want to see the 
graphic, so Write.addImageShape() calculates the picture's dimensions if none are 
supplied by the user. </p>
<p>Another difference between image shape and image link is how the content's 
"GraphicURL" property is employed. The image link version contains its URL, while 
the image shape's "GraphicURL" stores its bitmap as a string.  </p>
<p>The code for Write.addImageShape(): </p>
<p>public static void addImageShape(XTextDocument doc,<br />
                            XTextCursor cursor, String fnm) 
{  addImageShape(doc, cursor, fnm, 0, 0);  } 
              /<em> 0, 0 means that the method must calculate 
                 the image's size </em>/ </p>
<p>public static void addImageShape(XTextDocument doc,<br />
           XTextCursor cursor, String fnm, int width, int height) 
{ 
  Size imSize; 
  if ((width &gt; 0) &amp;&amp; (height &gt; 0)) 
    imSize = new Size(width, height); 
  else { 
    imSize = Images.getSize100mm(fnm); 
    if (imSize == null) 
      return; 
  } </p>
<p>try { 
    // create TextContent for the graphic shape 
    XTextContent gos = Lo.createInstanceMSF( 
              XTextContent.class,<br />
              "com.sun.star.drawing.GraphicObjectShape"); 
    if (gos == null) { 
      System.out.println("Could not create a graphic shape"); 
      return; 
    } </p>
<pre><code>// store the image's bitmap in the "GraphicURL" property 
String bitmap = Images.getBitmap(fnm); 
Props.setProperty(gos, "GraphicURL", bitmap);

// set the shape's size 
XShape xDrawShape = Lo.qi(XShape.class, gos); 
xDrawShape.setSize(imSize);  // must be set, or image is tiny

// insert image shape into the document, followed by newline 
append(cursor, gos); 
endLine(cursor);
</code></pre>
<p>} 
  catch(Exception e) { 
    System.out.println("Insert of \"" + fnm + "\" failed: " + e); 
  } 
}  // end of addImageShape() </p>
<p>The image's size is calculated using Images.getSize100mm() if the user doesn't supply 
a width and height, and is used towards the end of the method. </p>
<p>An image shape is created using the GraphicObjectShape service, and its 
XTextContent interface is converted to XPropertySet for assigning its properties, and 
to XShape for setting its size (see Figure 2). XShape includes a setSize() method. </p>
<p>Images.getBitmap() converts the graphic into a bitmap string. </p>
<p>// in the Images utility class 
public static String getBitmap(String fnm) 
{ 
  try { 
    // create a BitmapTable service and named container 
    XNameContainer bitmapContainer = <br />
         Lo.createInstanceMSF(XNameContainer.class,<br />
                       "com.sun.star.drawing.BitmapTable"); </p>
<pre><code>// insert image into container 
if (!FileIO.isOpenable(fnm)) 
  return null;

String picURL = FileIO.fnmToURL(fnm); 
if (picURL == null) 
  return null;

bitmapContainer.insertByName(fnm, picURL); 
        // use the filename as the name of the bitmap

// return the bitmap as a string 
return (String) bitmapContainer.getByName(fnm);
</code></pre>
<p>} 
  catch(Exception e) 
  { System.out.println("Could not create bitmap for " + fnm); 
    return null; 
  } 
}  // end of getBitmap() </p>
<p>getBitmap() uses a BitmapTable service to store the image's file in an 
XNameContainer. When the bitmap value is retrieved from the container, it can be 
cast to a string. </p>
<p>A named container requires a name be assigned to the bitmap value; I use the image's 
filename, but any unique string would do. </p>
<h3 id="22-adding-other-graphics-to-the-document">2.2.  Adding Other Graphics to the Document</h3>
<p>The graphic text content can be any subclass of Shape. In the last section I created a 
GraphicObjectShape service, and accessed its XTextContent interface: </p>
<p>XTextContent gos = Lo.createInstanceMSF(XTextContent.class,<br />
                        "com.sun.star.drawing.GraphicObjectShape"); </p>
<p>In this section I'll use LineShape: </p>
<p>XTextContent ls = Lo.createInstanceMSF(XTextContent.class,<br />
                       "com.sun.star.drawing.LineShape"); </p>
<p>The aim is to draw an horizontal line in the document, to act as a divider between 
paragraphs. The line will be half-a-page wide and centered, like the one in Figure 3 </p>
<p><img alt="" src="images/08-Graphic_Content-3.png" /></p>
<p>Figure 3. A Graphical Line Divider. </p>
<p>The difficult part is calculating the width of the line, which should only extend across 
half the writing width. This isn't the same as the page width because it doesn't include 
the left and right margins.  </p>
<p>The page and margin dimensions are accessible through the "Standard" page style, as 
implemented in Write.getPageTextWidth(): </p>
<p>public static int getPageTextWidth(XTextDocument textDoc) 
// get the page's writing width 
{ 
  // access the "standard" style in the pages style family 
  XPropertySet props =<br />
         Info.getStyleProps(textDoc, "PageStyles", "Standard"); 
  if (props == null) { 
    System.out.println("Could not access the standard page style"); 
    return 0; 
  } </p>
<p>// lookup the page and margin widths 
  try { 
    int width = ((Integer)props.getPropertyValue( 
                                      "Width")).intValue(); 
    int leftMargin = ((Integer)props.getPropertyValue( 
                                      "LeftMargin")).intValue(); 
    int rightMargin = ((Integer)props.getPropertyValue( 
                                     "RightMargin")).intValue(); </p>
<pre><code>return (width - (leftMargin + rightMargin));  // writing width
</code></pre>
<p>} 
  catch (Exception e)<br />
  {  System.out.println("Could not access page dimensions: " + e);<br />
     return 0; 
  } 
}  // end of getPageTextWidth() </p>
<p>getPageTextWidth() returns the writing width in 1/100 mm units, which is scaled, 
then passed to Write.addLineDivider(): </p>
<p>// code fragment in BuildDoc,java 
int textWidth = Write.getPageTextWidth(doc); 
Write.addLineDivider(cursor, (int)Math.round(textWidth*0.5) ); 
                                     // scale width by 0.5 </p>
<p>addLineDivider() creates a LineShape service with an XTextContent interface (see 
Figure 2). This is converted to XShape so its setSize() method can be passed the line 
width: </p>
<p>public static void addLineDivider(XTextCursor cursor,<br />
                                             int lineWidth) 
// in the Writer class 
{ try { 
    // create TextContent for a line 
    XTextContent ls = Lo.createInstanceMSF( 
                       XTextContent.class,<br />
                       "com.sun.star.drawing.LineShape"); 
    if (ls == null) { 
      System.out.println("Could not create a line shape"); 
      return; 
    } </p>
<pre><code>// set line size 
XShape lineShape = Lo.qi(XShape.class, ls); 
lineShape.setSize( new Size(lineWidth, 0));

endParagraph(cursor); 
append(cursor, ls);   // put line in its own paragraph 
endParagraph(cursor);

// center the line paragraph 
stylePrevParagraph(cursor, "ParaAdjust",  
         com.sun.star.style.ParagraphAdjust.CENTER);

endParagraph(cursor);
</code></pre>
<p>} 
  catch(Exception e) 
  {  System.out.println("Insertion of graphic line failed");  } 
}  // end of addLineDivider() </p>
<p>The centering of the line is achieved by placing the shape in its own paragraph, then 
using Write.stylePrevParagraph() to center it. </p>
<h2 id="3-accessing-linked-images-and-shapes">3.  Accessing Linked Images and Shapes</h2>
<p>The outcome of running BuildDoc.java is a "build.odt" file containing four graphics – 
two are linked images, one is an image shape, and the other a line shape.  </p>
<p>The ExtractGraphics.java example extracts linked graphics from a document, saving 
them as PNG files. It also prints information about the shapes in the document. </p>
<p>When ExtractGraphics is passed "build.odt", the following is output: </p>
<p>Num. of text graphics: 2 
Saving graphic in graphics1.png 
Image size in pixels: 319 x 274 
Saving graphic in graphics2.png 
Image size in pixels: 319 x 274 </p>
<p>Num. of draw shapes: 3 
  Shape service: FrameShape; z-order: 0 
  Shape service: com.sun.star.drawing.GraphicObjectShape; z-order: 1 
  Shape service: com.sun.star.drawing.LineShape; z-order: 2 </p>
<p>A user who looked at "build.odt" for themselves might say that it contains three 
images not the two reported by ExtractGraphics. Why the discrepancy? 
ExtractGraphics.java only saves linked graphics, and only two were added by 
Write.addImageLink(). The other image was inserted using Write.addImageShape() 
which creates an image shape.  </p>
<p>The number of shapes reported by ExtractGraphics.java may also confuse the user – 
why are there three rather than two? The only shapes added to the document were an 
image and a line. </p>
<p>The names of the services gives a clue: the second and third shapes are the expected 
GraphicObjectShape and LineShape, but the first is a text frame (FrameShape) added 
by Write.addTextFrame(). Although this frame is an instance of the TextFrame 
service, it's reported as a FrameShape. That's a bit mysterious because there's no 
FrameShape service in the Office documentation. </p>
<p>The main() function of ExtractGraphics.java: </p>
<p>public static void main(String[] args)<br />
{ 
  XComponentLoader loader = Lo.loadOffice(); </p>
<p>XTextDocument textDoc = Write.openDoc(args[0], loader); 
  if (textDoc == null) { 
    System.out.println("Could not open " + args[0]); 
    Lo.closeOffice(); 
    return; 
  } </p>
<p>// save text graphics to files 
  ArrayList<XGraphic> pics = Write.getTextGraphics(textDoc); 
  if (pics == null) 
    return; 
  System.out.println("\nNum. of text graphics: " + pics.size()); 
  int i = 1; 
  for(XGraphic pic : pics) { 
    Images.saveGraphic(pic, "graphics" + i + ".png", "png"); 
    Size sz = (Size) Props.getProperty(pic, "SizePixel"); 
    System.out.println("Image size in pixels: " +<br />
                                sz.Width + " x " + sz.Height); 
    i++; 
  } 
  System.out.println(); </p>
<p>// report on shapes in the document 
  XDrawPage drawPage = Write.getShapes(textDoc); 
  ArrayList<XShape> shapes = Draw.getShapes(drawPage); 
  if (shapes != null) 
    System.out.println("\nNum. of draw shapes: " + shapes.size()); 
  for(XShape shape : shapes) 
    Draw.printShapeInfo(shape); 
  System.out.println(); </p>
<p>Lo.closeDoc(textDoc); 
  Lo.closeOffice(); 
}  // end of main() </p>
<p>The first block of code saves text graphic objects as PNGs, and the second reports on 
shapes. </p>
<h3 id="31-finding-and-saving-text-graphics-in-a-document">3.1.  Finding and Saving Text Graphics in a Document</h3>
<p>Write.getTextGraphics() returns a list of XGraphic objects: first it retrieves a 
collection of the graphic links in the document, then iterates through them creating an 
XGraphic object for each one: </p>
<p>// in the Write class 
public static ArrayList<XGraphic> getTextGraphics( 
                                    XTextDocument textDoc) 
{ // get all the graphic links 
  XNameAccess xNameAccess = getGraphicLinks(textDoc); 
  if (xNameAccess == null) 
    return null; 
  String[] names = xNameAccess.getElementNames(); 
  System.out.println("Number of graphics found: " + names.length); </p>
<p>// build a list of XGraphic objects, one for each link 
  ArrayList<XGraphic> pics = new ArrayList<XGraphic>(); 
  for (int i = 0; i &lt; names.length; i++) { 
    Object graphicLink = null; 
    try { 
      graphicLink = xNameAccess.getByName(names[i]); 
    } 
    catch(com.sun.star.uno.Exception e) {} </p>
<pre><code>if (graphicLink == null) 
  System.out.println("No graphic found for " + names[i]); 
else { 
  XGraphic xGraphic = Images.loadGraphicLink(graphicLink); 
  if (xGraphic != null) 
    pics.add(xGraphic); 
  else 
    System.out.println(names[i] + " could not be accessed"); 
}
</code></pre>
<p>} 
  return pics; 
}  // end of getTextGraphics() </p>
<p>Graphic objects are accessed with XTextGraphicObjectsSupplier, as implemented by 
Write.getGraphicLinks(): </p>
<p>// in the Write class 
public static XNameAccess getGraphicLinks(XComponent doc) 
{ 
  XTextGraphicObjectsSupplier imsSupplier =<br />
                  Lo.qi(XTextGraphicObjectsSupplier.class, doc); 
  if (imsSupplier == null) { 
    System.out.println("Supplier could not be created"); 
    return null; 
  } </p>
<p>XNameAccess xNameAccess = imsSupplier.getGraphicObjects(); 
  if (xNameAccess == null)  { 
    System.out.println("Name access to graphics not possible"); 
    return null; 
  } </p>
<p>if (!xNameAccess.hasElements())  { 
    System.out.println("No graphics elements found"); 
    return null; 
  } 
  return xNameAccess; 
}  // end of getGraphicLinks() </p>
<p>Back in Write.getTextGraphics, each graphic is loaded by calling 
Images.loadGraphicLink(). It loads an image from the URL associated with a link: </p>
<p>// in the Images class 
public static XGraphic loadGraphicLink(Object graphicLink) 
{ 
  // create graphic provider 
  XGraphicProvider gProvider =  Lo.createInstanceMCF( 
                        XGraphicProvider.class,<br />
                       "com.sun.star.graphic.GraphicProvider"); 
  if (gProvider == null) { 
    System.out.println("Graphic Provider could not be found"); 
    return null; 
  } </p>
<p>// set up URL property then load as an XGraphic 
  try { 
    XPropertySet xprops = Lo.qi(XPropertySet.class, graphicLink); 
    PropertyValue[] gProps = Props.makeProps("URL",<br />
                (String) xprops.getPropertyValue("GraphicURL") ); 
    return gProvider.queryGraphic(gProps); 
  } 
  catch(Exception e) 
  {  System.out.println("Unable to retrieve graphic"); <br />
     return null; 
  } 
}  // end of loadGraphicLink() </p>
<p>Note that the XGraphic is not extracted from the document but loaded from a URL. </p>
<p>Back in ExtractGraphics.java, the XGraphic objects are saved as PNG files, and their 
pixel sizes reported: </p>
<p>private static void savePics(XTextDocument textDoc) 
// method in ExtractGraphics.java 
{ 
  ArrayList<XGraphic> pics = Write.getTextGraphics(textDoc); 
  if (pics == null) 
    return; 
  System.out.println("No. of graphic retrieved: " +  pics.size()); 
  int i = 1; 
  for(XGraphic pic : pics) { 
    Images.saveGraphic(pic, "graphics" + i + ".png", "png"); 
    Size sz = (Size) Props.getProperty(pic, "SizePixel"); 
    System.out.println("Image Pixel size: " +<br />
                             sz.Width + " x " + sz.Height); 
    i++; 
  } 
}  // end of savePics() </p>
<p>Images.saveGraphic() utilizes the graphic provider's XGraphicProvider.storeGraphic() 
method: </p>
<p>// in XGraphicProvider 
void storeGraphic(XGraphic g, PropertyValue[] props) 
{ ... } </p>
<p>Its second argument is an array of PropertyValue objects, not a PropertySet. My 
Props.java utility class provides several functions for creating PropertyValue 
instances, which are a variant of the {name=value} pair idea, but with extra data 
fields. One such function is: </p>
<p>// in Props.java 
PropertyValue[] makeProps(String[] nms, Object[] vals)<br />
{ ... } </p>
<p>It's passed an array of names and values, which are paired up as PropertyValue 
objects, and returned in an array. </p>
<p>In saveGraphic(), these methods are used like so: </p>
<p>XGraphicProvider gProvider = Lo.createInstanceMCF( 
                      XGraphicProvider.class, 
                     "com.sun.star.graphic.GraphicProvider"); </p>
<p>// set up properties for storing the graphic 
PropertyValue[] props = Props.makeProps( 
                           "URL", FileIO.fnmToURL(fnm),<br />
                           "MimeType", "image/" + imFormat); </p>
<p>gProvider.storeGraphic(pic, props); </p>
<p>The idea is to call XGraphicProvider.saveGraphics() with the "URL" and 
"MimeType" properties set – the URL is for the image file, and the mimetype is an 
image type (e.g. "image/png"). </p>
<p>saveGraphic() is coded as:  </p>
<p>public static void saveGraphic(XGraphic pic,<br />
                                String fnm, String imFormat) 
{ // create graphic provider 
  XGraphicProvider gProvider = Lo.createInstanceMCF( 
                       XGraphicProvider.class, 
                       "com.sun.star.graphic.GraphicProvider"); 
  if (gProvider == null) { 
    System.out.println("Graphic Provider could not be found"); 
    return; 
  } </p>
<p>if (pic == null) { 
    System.out.println("Supplied image is null"); 
    return; 
  } </p>
<p>// set up properties for storing the graphic 
  PropertyValue[] pngProps = Props.makeProps( 
                           "URL", FileIO.fnmToURL(fnm),<br />
                           "MimeType", "image/" + imFormat); 
  try { 
    gProvider.storeGraphic(pic, pngProps); 
  } 
  catch(com.sun.star.uno.Exception e) 
  {  System.out.println("Unable to save graphic"); } 
}  // end of saveGraphic() </p>
<p>Other possible image MIME types include "gif", "jpeg", "wmf", and "bmp". For 
instance, this call will save the image as a GIF: 
Images.saveGraphic(pic, "graphics" + i + ".gif", "gif");<br />
The printed output from saveGraphic() contains another surprise: </p>
<p>Num. of text graphics: 2 
Saving graphic in graphics1.png 
Image size in pixels: 319 x 274 
Saving graphic in graphics2.png 
Image size in pixels: 319 x 274 </p>
<p>The two saved graphics are the same size, but the second image is bigger inside the 
document. The discrepancy is because the rendering of the image in the document is 
bigger, scaled up to fit the enclosing frame; the original image is unchanged. </p>
<h3 id="32-finding-the-shapes-in-a-document">3.2.  Finding the Shapes in a Document</h3>
<p>The second block of code in ExtractGraphics reports on the shapes found in the 
document. The relevant code fragment is: </p>
<p>// code fragment from ExtractGraphics.java 
XDrawPage drawPage = Write.getShapes(textDoc); 
ArrayList<XShape> shapes = Draw.getShapes(drawPage); 
if (shapes != null) 
  System.out.println("\nNum. of draw shapes: " + shapes.size()); 
for(XShape shape : shapes) 
  Draw.printShapeInfo(shape); </p>
<p>Shapes are accessed with the XDrawPageSupplier.getDrawPage() method, which 
returns a single XDrawPage: </p>
<p>public static XDrawPage getShapes(XTextDocument textDoc) 
{ 
  XDrawPageSupplier drawPageSupplier = Lo.qi( 
                           XDrawPageSupplier.class, textDoc); 
  if (drawPageSupplier == null) { 
    System.out.println("Draw page supplier could not be created"); 
    return null; 
  } 
  return drawPageSupplier.getDrawPage(); 
}  // end of getShapes() </p>
<p>XDrawPage's usual role is to represent the canvas in Office's Draw, or a slide in 
Impress, and so plays an important role in Part 3. Several support functions inside that 
part's Draw utility class will be used here. </p>
<p>XDrawPageSupplier.getDrawPage() returns a single XDrawPage for the entire text 
document. That doesn't mean that the shapes all have to occur on a single text page, 
but rather that all the shapes spread across multiple text pages are collected into a 
single draw page.  </p>
<p>XDrawPage inherits from XShapes and XindexAccess, as shown in Figure 4, which 
means that a page can be viewed as a indexed collection of shapes. </p>
<p><img alt="" src="images/08-Graphic_Content-4.png" /></p>
<p>Figure 4. Partial Inheritance Hierarchy for XDrawPage. </p>
<p>Draw.getShapes() uses this idea to iterate through the draw page and store the shapes 
in a list: </p>
<p>// in the Draw class 
public static ArrayList<XShape> getShapes(XDrawPage dp) 
{ 
  if (dp == null) { 
    System.out.println("Draw page is null"); 
    return null; 
  } </p>
<p>if (dp.getCount() == 0) { 
    System.out.println("Draw page does not contain any shapes"); 
    return null; 
  } </p>
<p>// create a shapes list 
  ArrayList<XShape> xShapesList = new ArrayList<XShape>(); 
  try { 
    for(int j=0; j &lt; dp.getCount(); j++) 
      xShapesList.add( Lo.qi(XShape.class, dp.getByIndex(j))); 
  } 
  catch(Exception e) 
  {   System.out.println("Extraction error in draw page");  } </p>
<p>return xShapesList; 
}  // end of getShapes() </p>
<p>XShape is part of the Shape service, which contains many shape-related properties. </p>
<p>XShape inherits XShapeDescriptor, which includes a getShapeType() method for 
returning the shape type as a string. Figure 5 summarizes these details. </p>
<p><img alt="" src="images/08-Graphic_Content-5.png" /></p>
<p>Figure 5. The Shape Service and XShape Interface </p>
<p>Draw.printShapeInfo() accesses the Shape service associated with an XShape 
reference, and prints its "XOrder" property. This number indicates the order that the 
shapes were added to the document.  </p>
<p>public static void printShapeInfo(XShape xShape) 
{ 
  Integer nZOrder = (Integer) Props.getProperty(xShape, "ZOrder"); 
  System.out.println("  Shape service: " + xShape.getShapeType() +<br />
                     "; z-order: " + nZOrder); 
} </p>
<p>printShapeInfo() also calls the inherited XShapeDescriptor.getShapeType() method to 
report the shape's service name. </p>
<h3 id="33-another-way-of-accessing-drawing-shapes">3.3.  Another Way of Accessing Drawing Shapes</h3>
<p>The XDrawPageSupplier documentation states that this interface is deprecated, 
although what's meant to replace it isn't clear. My guess is 
com.sun.star.text.XTextShapesSupplier, although I wasn't able to get it to supply 
anything. For example, the following always reports that the supplier is null: </p>
<p>XTextShapesSupplier shpsSupplier = Lo.qi( 
                              XTextShapesSupplier.class, textDoc); 
if (shpsSupplier == null) 
  System.out.println("Could not obtain text shapes supplier"); 
else 
  System.out.println("Num. of text shapes: " +<br />
                        shpsSupplier.getShapes().getCount()); </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="07-Non-text_Content.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 7. Text Content Other than Strings
            </div>
          </div>
        </a>
      
      
        <a href="09-Text_Search.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 9. Text Search and Replace
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>