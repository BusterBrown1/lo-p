
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/10-Linguistics.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>Chapter 10. The Linguistics API - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-10-the-linguistics-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 10. The Linguistics API
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 10. The Linguistics API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="10-Linguistics.html" class="md-nav__link md-nav__link--active">
        Chapter 10. The Linguistics API
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-linguistic-tools" class="md-nav__link">
    1.  The Linguistic Tools
  </a>
  
    <nav class="md-nav" aria-label="1.  The Linguistic Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-dictionary-information" class="md-nav__link">
    1.1.  Dictionary Information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-linguistic-properties" class="md-nav__link">
    1.2.  Linguistic Properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-installed-extensions" class="md-nav__link">
    1.3.  Installed Extensions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-examining-the-lingu-services" class="md-nav__link">
    1.4.  Examining the Lingu Services
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-using-the-spell-checker" class="md-nav__link">
    2.  Using the Spell Checker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-using-the-thesaurus" class="md-nav__link">
    3.  Using the Thesaurus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-grammar-checking" class="md-nav__link">
    4.  Grammar Checking
  </a>
  
    <nav class="md-nav" aria-label="4.  Grammar Checking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-error-reporting-options" class="md-nav__link">
    4.1.  Error Reporting Options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-using-the-proof-reader" class="md-nav__link">
    4.2.  Using the Proof Reader
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-guessing-the-language-used-in-a-string" class="md-nav__link">
    5.  Guessing the Language used in a String
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-spell-checking-and-grammar-checking-a-document" class="md-nav__link">
    6.  Spell Checking and Grammar Checking a Document
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-linguistic-tools" class="md-nav__link">
    1.  The Linguistic Tools
  </a>
  
    <nav class="md-nav" aria-label="1.  The Linguistic Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-dictionary-information" class="md-nav__link">
    1.1.  Dictionary Information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-linguistic-properties" class="md-nav__link">
    1.2.  Linguistic Properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-installed-extensions" class="md-nav__link">
    1.3.  Installed Extensions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-examining-the-lingu-services" class="md-nav__link">
    1.4.  Examining the Lingu Services
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-using-the-spell-checker" class="md-nav__link">
    2.  Using the Spell Checker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-using-the-thesaurus" class="md-nav__link">
    3.  Using the Thesaurus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-grammar-checking" class="md-nav__link">
    4.  Grammar Checking
  </a>
  
    <nav class="md-nav" aria-label="4.  Grammar Checking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-error-reporting-options" class="md-nav__link">
    4.1.  Error Reporting Options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-using-the-proof-reader" class="md-nav__link">
    4.2.  Using the Proof Reader
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-guessing-the-language-used-in-a-string" class="md-nav__link">
    5.  Guessing the Language used in a String
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-spell-checking-and-grammar-checking-a-document" class="md-nav__link">
    6.  Spell Checking and Grammar Checking a Document
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/flywire/lo-p/edit/main/docs/10-Linguistics.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="chapter-10-the-linguistics-api">Chapter 10. The Linguistics API<a class="headerlink" href="#chapter-10-the-linguistics-api" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Linguistic
Tools; Using the Spell
Checker; Using the
Thesaurus; Grammar
Checking; Guessing the
Language used in a
String; Spell Checking
and Grammar Checking
a Document</p>
<p>Example folders: "Lingu
Tests" and "Utils"</p>
</div>
<p>The linguistics API has four main components – a spell
checker, a hyphenator, a thesaurus, and a grammar
checker (which Office calls a proof reader). I'll look at
how to program using the spell checker, thesaurus, and
two grammar checkers, but I'll skip the hyphenator which
is easier to use interactively through Office's  GUI.</p>
<p>However, if you have an urge to hyphenate, then
LingusticExamples.java in the Developer's Guide
examples contains some code; it can be downloaded from
<a href="https://api.libreoffice.org/examples/DevelopersGuide/OfficeDev/Linguistic/LinguisticExamples.java">https://api.libreoffice.org/examples/DevelopersGuide/OfficeDev/Linguistic/LinguisticExamples.java</a>.</p>
<p>I'll describe two examples, Lingo.java and LingoFile.java. The first lists information
about the linguistic services, then uses the spell checker, thesaurus, and grammar
checker 'standalone' without having to load an Office document first. LingoFile.java
automatically spell checks and grammar checks a complete file, reporting errors
without altering the document.</p>
<p>One topic I'll be ignoring is how to create and edit the data files used by the linguistic
services. For that task, you should have a look at PTG (Proofing Tool GUI) developed
by Marco Pinto at <a href="https://marcoagpinto.cidadevirtual.pt/proofingtoolgui.html">https://marcoagpinto.cidadevirtual.pt/proofingtoolgui.html</a>. It's an
open source tool for editing Office's  dictionary, thesaurus, hyphenation, and
autocorrect files.</p>
<p>Another area I'll be skipping is the use of events and listeners. Please refer to the
"Linguistics" sub-section of chapter 6 of the Developer's Guide for details
(<code>loGuide Linguistics</code>). Listener code can be found in LinguisticExamples.java mentioned
above.</p>
<p>The linguistic features accessible through Office's GUI are explained in chapter 3 of
the "Writer Guide", available at <a href="https://libreoffice.org/get-help/documentation">https://libreoffice.org/get-help/documentation</a>,
starting from the section called "Checking spelling and grammar".</p>
<p>An older information source is the "Lingucomponent Project" page at the OpenOffice
website, <a href="https://openoffice.org/lingucomponent">https://openoffice.org/lingucomponent</a>, which links to some useful
tools, such as alternative grammar checkers. An interesting set of slides by Daniel
Naber explaining the state of the project in 2005 can be found at
<a href="https://danielnaber.de/publications/">https://danielnaber.de/publications/</a>, along with more recent material.</p>
<h2 id="1-the-linguistic-tools">1.  The Linguistic Tools<a class="headerlink" href="#1-the-linguistic-tools" title="Permanent link">&para;</a></h2>
<p>Lingo.java prints a variety of information about the linguistics services:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>

  <span class="c1">// print linguistics info</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">dictsInfo</span><span class="p">();</span>

  <span class="n">XLinguProperties</span> <span class="n">linguProps</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getLinguProperties</span><span class="p">();</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;Linguistic Manager&quot;</span><span class="p">,</span> <span class="n">linguProps</span><span class="p">);</span>

  <span class="n">Info</span><span class="p">.</span><span class="na">listExtensions</span><span class="p">();</span>

  <span class="c1">// get lingo manager</span>
  <span class="n">XLinguServiceManager2</span> <span class="n">lingoMgr</span> <span class="o">=</span>
           <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XLinguServiceManager2</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                   <span class="s">&quot;com.sun.star.linguistic2.LinguServiceManager&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">lingoMgr</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No linguistics manager found&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Write</span><span class="p">.</span><span class="na">printServicesInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">);</span>

    <span class="p">:</span> <span class="c1">// code for using the services; see later</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="11-dictionary-information">1.1.  Dictionary Information<a class="headerlink" href="#11-dictionary-information" title="Permanent link">&para;</a></h3>
<p>Write.dictsInfo() prints brief details about Office's dictionaries:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">No</span><span class="p">.</span> <span class="n">of</span> <span class="n">dictionaries</span><span class="p">:</span> <span class="mi">5</span>
  <span class="n">standard</span><span class="p">.</span><span class="na">dic</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">active</span><span class="p">;</span> <span class="s">&quot;&quot;</span><span class="p">;</span> <span class="n">positive</span>
  <span class="n">en</span><span class="o">-</span><span class="n">GB</span><span class="p">.</span><span class="na">dic</span> <span class="p">(</span><span class="mi">42</span><span class="p">);</span> <span class="n">active</span><span class="p">;</span> <span class="s">&quot;GB&quot;</span><span class="p">;</span> <span class="n">positive</span>
  <span class="n">en</span><span class="o">-</span><span class="n">US</span><span class="p">.</span><span class="na">dic</span> <span class="p">(</span><span class="mi">42</span><span class="p">);</span> <span class="n">active</span><span class="p">;</span> <span class="s">&quot;US&quot;</span><span class="p">;</span> <span class="n">positive</span>
  <span class="n">technical</span><span class="p">.</span><span class="na">dic</span> <span class="p">(</span><span class="mi">258</span><span class="p">);</span> <span class="n">active</span><span class="p">;</span> <span class="s">&quot;&quot;</span><span class="p">;</span> <span class="n">positive</span>
  <span class="nf">IgnoreAllList</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">active</span><span class="p">;</span> <span class="s">&quot;&quot;</span><span class="p">;</span> <span class="n">positive</span>

<span class="n">No</span><span class="p">.</span> <span class="n">of</span> <span class="n">conversion</span> <span class="n">dictionaries</span><span class="p">:</span> <span class="mi">0</span>
</code></pre></div>
</div>
</div>
</div>
<p>Each line includes the name of a dictionary, its number of entries, whether it's active
(i.e. being used), its locale, and whether it's a positive, negative, or mixed dictionary.</p>
<p>A positive dictionary holds correctly spelled words only, while a negative one lists
incorrectly spelt words. A mixed dictionary contains both correctly and incorrectly
spelt entries.</p>
<p>If a dictionary has a locale, such as "GB" for en-GB.dic, then it's only utilized during
spell checking if its locale matches Office's. The Office locale can be set via the Tools,
Options, Language Settings, "Languages" dialog shown in Figure 1.</p>
<p><img alt="" src="images/10-Linguistics-1.png" /></p>
<p>Figure 1. The Languages Dialog.</p>
<p>Figure 1 shows that my version of Office is using the American English locale, and so
en-GB.dic won't be consulted when text is spell checked.</p>
<p>Write.dictsInfo() is defined as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Write class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">dictsInfo</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">XSearchableDictionaryList</span> <span class="n">dictList</span> <span class="o">=</span>
           <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XSearchableDictionaryList</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                   <span class="s">&quot;com.sun.star.linguistic2.DictionaryList&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">dictList</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No list of dictionaries found&quot;</span><span class="p">);</span>
  <span class="k">else</span>
    <span class="n">printDictsInfo</span><span class="p">(</span><span class="n">dictList</span><span class="p">);</span>

  <span class="n">XConversionDictionaryList</span> <span class="n">cdList</span> <span class="o">=</span>
           <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XConversionDictionaryList</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
               <span class="s">&quot;com.sun.star.linguistic2.ConversionDictionaryList&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">cdList</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No list of conversion dictionaries found&quot;</span><span class="p">);</span>
  <span class="k">else</span>
    <span class="n">printConDictsInfo</span><span class="p">(</span><span class="n">cdList</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of dictsInfo()</span>
</code></pre></div>
</div>
</div>
</div>
<p>It retrieves a conventional dictionary list first (called dictList), and iterates through its
dictionaries using printDictsInfo(). Then it obtains the conversion dictionary list
(called csList), and iterates over that with printConDictsInfo().</p>
<p>Figure 2 shows the main services and interfaces used by ordinary dictionaries.</p>
<p><img alt="" src="images/10-Linguistics-2.png" /></p>
<p>Figure 2. The DictionaryList and Dictionary Services.</p>
<p>Each dictionary in the list has an XDictionary interface which contains methods for
accessing and changing its entries. printDictsInfo() retrieves an XDictionary array
from the list, and prints out a summary of each dictionary:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Write class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printDictsInfo</span><span class="p">(</span>
                      <span class="n">XSearchableDictionaryList</span> <span class="n">dictList</span><span class="p">)</span>
<span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">dictList</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Dictionary list is null&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No. of dictionaries: &quot;</span> <span class="o">+</span>
                                     <span class="n">dictList</span><span class="p">.</span><span class="na">getCount</span><span class="p">());</span>
  <span class="n">XDictionary</span><span class="o">[]</span> <span class="n">dicts</span> <span class="o">=</span> <span class="n">dictList</span><span class="p">.</span><span class="na">getDictionaries</span><span class="p">();</span>
  <span class="k">for</span><span class="p">(</span><span class="n">XDictionary</span> <span class="n">dict</span> <span class="p">:</span> <span class="n">dicts</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">dict</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span>
                    <span class="s">&quot; (&quot;</span> <span class="o">+</span> <span class="n">dict</span><span class="p">.</span><span class="na">getCount</span><span class="p">()</span> <span class="o">+</span>
                    <span class="s">&quot;); &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">dict</span><span class="p">.</span><span class="na">isActive</span><span class="p">()</span> <span class="o">?</span> <span class="s">&quot;active&quot;</span> <span class="p">:</span> <span class="s">&quot;na&quot;</span><span class="p">)</span> <span class="o">+</span>
                    <span class="s">&quot;; \&quot;&quot;</span> <span class="o">+</span> <span class="n">dict</span><span class="p">.</span><span class="na">getLocale</span><span class="p">().</span><span class="na">Country</span> <span class="o">+</span>
                    <span class="s">&quot;\&quot;; &quot;</span> <span class="o">+</span>
                    <span class="n">getDictType</span><span class="p">(</span><span class="n">dict</span><span class="p">.</span><span class="na">getDictionaryType</span><span class="p">()));</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of printDictsInfo()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getDictType</span><span class="p">(</span><span class="n">DictionaryType</span> <span class="n">dt</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">dt</span> <span class="o">==</span> <span class="n">DictionaryType</span><span class="p">.</span><span class="na">POSITIVE</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">&quot;positive&quot;</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">dt</span> <span class="o">==</span> <span class="n">DictionaryType</span><span class="p">.</span><span class="na">NEGATIVE</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">&quot;negative&quot;</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">dt</span> <span class="o">==</span> <span class="n">DictionaryType</span><span class="p">.</span><span class="na">MIXED</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">&quot;mixed&quot;</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="s">&quot;??&quot;</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getDictType()</span>
</code></pre></div>
</div>
</div>
</div>
<p>Conversion dictionaries map words in one language/dialect to corresponding words in
another language/dialect. 3 shows that conversion dictionaries are organized in
a similar way to ordinary ones. The interfaces for manipulating a conversion
dictionary are XConversionDictionary and XConversionPropertyType.</p>
<p><img alt="" src="images/10-Linguistics-3.png" /></p>
<p>Figure 3. The ConversionDictionaryList and ConversionDictionary Services.</p>
<p>Write.dictsInfo() calls printConDictsInfo() to print the names of the conversion
dictionaries – by extracting an XNameContainer from the dictionary list, and then
pulling a list of the names from the container:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Write clas</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printConDictsInfo</span><span class="p">(</span>
                     <span class="n">XConversionDictionaryList</span> <span class="n">cdList</span><span class="p">)</span>
<span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">cdList</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Conversion Dictionary list is null&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">XNameContainer</span> <span class="n">dcCon</span> <span class="o">=</span> <span class="n">cdList</span><span class="p">.</span><span class="na">getDictionaryContainer</span><span class="p">();</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">dcNames</span> <span class="o">=</span> <span class="n">dcCon</span><span class="p">.</span><span class="na">getElementNames</span><span class="p">();</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No. of conversion dictionaries: &quot;</span> <span class="o">+</span>
                                            <span class="n">dcNames</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">String</span> <span class="n">dcName</span> <span class="p">:</span> <span class="n">dcNames</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">dcName</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of printConDictsInfo()</span>
</code></pre></div>
</div>
</div>
</div>
<p>Output similar to Write.dictsInfo() can be viewed via Office's Tools, Options,
Language Settings, "Writing Aids" dialog, shown in Figure 4.</p>
<p><img alt="" src="images/10-Linguistics-4.png" /></p>
<p>Figure 4. The Writing Aids Dialog.</p>
<p>The dictionaries are listed in the second pane of the dialog. Also, at the bottom of the
window is a "Get more dictionaries online" hyperlink which takes the user to Office's
extension website, and displays the "Dictionary" category (see Figure 5).</p>
<p><img alt="" src="images/10-Linguistics-5.png" /></p>
<p>Figure 5. The Dictionary Extensions at the LibreOffice Website.</p>
<p>The URL of the page in Figure 5 is:
<a href="https://extensions.libreoffice.org/extension-center?getCategories=Dictionary">https://extensions.libreoffice.org/extension-center?getCategories=Dictionary</a>
The dictionary category currently has 94 entries, but if you can't find what you're
looking for, don't forget the extensions for OpenOffice, at:
<a href="https://extensions.openoffice.org">https://extensions.openoffice.org</a>
If you're unclear about how to install extensions, the process is explained online at
<a href="https://wiki.documentfoundation.org/Documentation/HowTo/install_extension">https://wiki.documentfoundation.org/Documentation/HowTo/install_extension</a>, or in
the "Installing Extensions" guide available at
<a href="https://libreoffice.org/get-help/documentation">https://libreoffice.org/get-help/documentation</a>.</p>
<h3 id="12-linguistic-properties">1.2.  Linguistic Properties<a class="headerlink" href="#12-linguistic-properties" title="Permanent link">&para;</a></h3>
<p>Back in the Lingo.java example, Write.getLinguProperties() returns an instance of
XLinguProperties, and its properties are printed by calling Props.showProps():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Lingo.java</span>
<span class="n">XLinguProperties</span> <span class="n">linguProps</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getLinguProperties</span><span class="p">();</span>
<span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;Linguistic Manager&quot;</span><span class="p">,</span> <span class="n">linguProps</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The output:</p>
<div class="highlight"><pre><span></span><code>Linguistic Manager Properties
  DefaultLanguage == 0
  DefaultLocale == com.sun.star.lang.Locale@1f95c5d
  DefaultLocale_CJK == com.sun.star.lang.Locale@cd43c2
  DefaultLocale_CTL == com.sun.star.lang.Locale@a8f0b4
  HyphMinLeading == 2
  HyphMinTrailing == 2
  HyphMinWordLength == 5
  IsGermanPreReform == Any[Type[void], null]
  IsHyphAuto == false
  IsHyphSpecial == true
  IsIgnoreControlCharacters == true
  IsSpellAuto == false
  IsSpellCapitalization == true
  IsSpellHide == Any[Type[void], null]
  IsSpellInAllLanguages == Any[Type[void], null]
  IsSpellSpecial == true
  IsSpellUpperCase == true
  IsSpellWithDigits == false
  IsUseDictionaryList == true
  IsWrapReverse == false
</code></pre></div>
<p>These properties are explained in the online documentation for the XLinguProperties
interface (<code>lodoc XLinguProperties</code>), and also in the Developer's Guide.</p>
<p>The properties are spread across several dialogs in Office's GUI, starting from the
Tools, Options, "Language Settings" menu item. However,  most of them are in the
"Options" pane of the "Writing Aids" Dialog in Figure 4.</p>
<h3 id="13-installed-extensions">1.3.  Installed Extensions<a class="headerlink" href="#13-installed-extensions" title="Permanent link">&para;</a></h3>
<p>Additional dictionaries, and other language tools such as grammar checkers, are
loaded into Office as extensions, so calling Info.listExtensions() can be informative.</p>
<p>The output on one of my test machine is:</p>
<div class="highlight"><pre><span></span><code>Extensions:
1.  ID: org.openoffice.en.hunspell.dictionaries
   Version: 2011.12.05.1
   Loc: file:///C:/Program%20Files/LibreOffice%205/program/
            ../share/extensions/dict-en

2.  ID: French.linguistic.resources.from.Dicollecte.by.OlivierR
   Version: 5.4.1
   Loc: file:///C:/Program%20Files/LibreOffice%205/program/
            ../share/extensions/dict-fr

3.  ID: org.openoffice.languagetool.oxt
   Version: 3.4
   Loc: file:///C:/Program%20Files/LibreOffice%205/program/
            ../share/uno_packages/cache/uno_packages/
            lu4156ef34f.tmp_/LanguageTool-3.4.oxt

4.  ID: com.sun.star.comp.Calc.NLPSolver
   Version: 0.9
   Loc: file:///C:/Program%20Files/LibreOffice%205/program/
            ../share/extensions/nlpsolver

5.  ID: spanish.es_ANY.dicts.from.rla-es
   Version: 0.8
   Loc: file:///C:/Program%20Files/LibreOffice%205/program/
            ../share/extensions/dict-es

6.  ID: com.sun.wiki-publisher
   Version: 1.2.0
   Loc: file:///C:/Program%20Files/LibreOffice%205/program/
            ../share/extensions/wiki-publisher
</code></pre></div>
<p>The "Loc" entries are the directories or OXT files containing the extensions. Most
extensions are placed in the <OFFICE>\share\extensions folder on Windows.</p>
<p>Office can display similar information via its Tools, "Extension Manager" dialog, as
in Figure 6.</p>
<p><img alt="" src="images/10-Linguistics-6.png" /></p>
<p>Figure 6. The Extension Manager Dialog.</p>
<p>The code for Info.listExtensions():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Info class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">listExtensions</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">XPackageInformationProvider</span> <span class="n">pip</span> <span class="o">=</span> <span class="n">getPip</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">pip</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No package info provider found&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">String</span><span class="o">[][]</span> <span class="n">extsTable</span> <span class="o">=</span> <span class="n">pip</span><span class="p">.</span><span class="na">getExtensionList</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\nExtensions:&quot;</span><span class="p">);</span>
    <span class="n">String</span> <span class="n">serviceName</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">extsTable</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;. ID: &quot;</span> <span class="o">+</span> <span class="n">extsTable</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;   Version: &quot;</span> <span class="o">+</span> <span class="n">extsTable</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;   Loc: &quot;</span> <span class="o">+</span>
                <span class="n">pip</span><span class="p">.</span><span class="na">getPackageLocation</span><span class="p">(</span><span class="n">extsTable</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span><span class="p">));</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of listExtensions()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XPackageInformationProvider</span> <span class="nf">getPip</span><span class="p">()</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">PackageInformationProvider</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Lo</span><span class="p">.</span><span class="na">getContext</span><span class="p">());</span>  <span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Extensions are accessed via the XPackageInformationProvider interface.</p>
<h3 id="14-examining-the-lingu-services">1.4.  Examining the Lingu Services<a class="headerlink" href="#14-examining-the-lingu-services" title="Permanent link">&para;</a></h3>
<p>The LinguServiceManager provides access to three of the four main linguistic
services: the spell checker, the hyphenator, and thesaurus.The proof reader (i.e. the
grammar checker) is managed by a separate Proofreader service, which I'll explain
later.</p>
<p>Figure 7 shows the interfaces accessible from the LinguServiceManager service.</p>
<p><img alt="" src="images/10-Linguistics-7.png" /></p>
<p>Figure 7. The LinguServiceManager Service and Interfaces.</p>
<p>In Lingo.java, the LinguServiceManager is instantiated and then
Write.printServicesInfo() reports details about its services:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Lingo.java</span>
   <span class="p">:</span>
<span class="c1">// get lingo manager</span>
<span class="n">XLinguServiceManager2</span> <span class="n">lingoMgr</span> <span class="o">=</span>
         <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XLinguServiceManager2</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                 <span class="s">&quot;com.sun.star.linguistic2.LinguServiceManager&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">lingoMgr</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No linguistics manager found&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Write</span><span class="p">.</span><span class="na">printServicesInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Typical output from Write.printServicesInfo():</p>
<div class="highlight"><pre><span></span><code>Available Services:
SpellChecker (1):
  org.openoffice.lingu.MySpellSpellChecker
Thesaurus (1):
  org.openoffice.lingu.new.Thesaurus
Hyphenator (1):
  org.openoffice.lingu.LibHnjHyphenator
Proofreader (2):
  org.languagetool.openoffice.Main
  org.libreoffice.comp.pyuno.Lightproof.en

Configured Services:
SpellChecker (1):
  org.openoffice.lingu.MySpellSpellChecker
Thesaurus (1):
  org.openoffice.lingu.new.Thesaurus
Hyphenator (1):
  org.openoffice.lingu.LibHnjHyphenator
Proofreader (1):
  org.languagetool.openoffice.Main

Locales for SpellChecker (43):
  AR  AU  BE  BO  BS  BZ  CA  CA  CH  CL
  CO  CR  CU  DO  EC  ES  FR  GB  GH  GT
  HN  IE  IN  JM  LU  MC  MW  MX  NA  NI
  NZ  PA  PE  PH  PR  PY  SV  TT  US  UY
  VE  ZA  ZW

Locales for Thesaurus (43):
  AR  AU  BE  BO  BS  BZ  CA  CA  CH  CL
  CO  CR  CU  DO  EC  ES  FR  GB  GH  GT
  HN  IE  IN  JM  LU  MC  MW  MX  NA  NI
  NZ  PA  PE  PH  PR  PY  SV  TT  US  UY
  VE  ZA  ZW

Locales for Hyphenator (43):
  AR  AU  BE  BO  BS  BZ  CA  CA  CH  CL
  CO  CR  CU  DO  EC  ES  FR  GB  GH  GT
  HN  IE  IN  JM  LU  MC  MW  MX  NA  NI
  NZ  PA  PE  PH  PR  PY  SV  TT  US  UY
  VE  ZA  ZW

Locales for Proofreader (94):
        AF  AO  AR  AT  AU  BE  BE
  BE  BO  BR  BS  BY  BZ  CA  CA  CD  CH
  CH  CH  CI  CL  CM  CN  CR  CU  DE  DE
  DK  DO  EC  ES  ES  ES  ES  ES  FI  FR
  FR  GB  GH  GR  GT  HN  HT  IE  IN  IN
  IN  IR  IS  IT  JM  JP  KH  LI  LT  LU
  LU  MA  MC  ML  MX  MZ  NA  NI  NL  NZ
  PA  PE  PH  PH  PL  PR  PT  PY  RE  RO
  RU  SE  SI  SK  SN  SV  TT  UA  US  US
  UY  VE  ZA  ZW
</code></pre></div>
<p>The print-out contains three lists: a list of available services, a list of configured
services (i.e. ones that are activated inside Office), and a list of the locales available to
each service.</p>
<p>Figure 7 shows that LinguServiceManager only manages the spell checker,
hyphenator, and thesaurus, and yet Write.printServicesInfo() includes information
about the proof reader. Somewhat confusingly, although LinguServiceManager
cannot instantiate a proof reader it can print information about it.</p>
<p>The output shows that two proofreader services are available
(org.languagetool.openoffice.Main and org.libreoffice.comp.pyuno.Lightproof.en),
but only one is configured (i.e. active). I'll explain this setup when I talk about the
proof reader later.</p>
<p>The three lists are generated by Write.printServicesInfo() calling
Write.printAvailServiceInfo(), Write.printConfigServiceInfo(), and
Write.printLocales():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Writer class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printServicesInfo</span><span class="p">(</span>
                          <span class="n">XLinguServiceManager2</span> <span class="n">lingoMgr</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span> <span class="n">loc</span> <span class="o">=</span>
                  <span class="k">new</span> <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span><span class="p">(</span><span class="s">&quot;en&quot;</span><span class="p">,</span><span class="s">&quot;US&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">);</span>
                        <span class="c1">// American English locale</span>

  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Available Services:&quot;</span><span class="p">);</span>
  <span class="n">printAvailServiceInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;SpellChecker&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="p">);</span>
  <span class="n">printAvailServiceInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;Thesaurus&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="p">);</span>
  <span class="n">printAvailServiceInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;Hyphenator&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="p">);</span>
  <span class="n">printAvailServiceInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;Proofreader&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>

  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Configured Services:&quot;</span><span class="p">);</span>
  <span class="n">printConfigServiceInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;SpellChecker&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="p">);</span>
  <span class="n">printConfigServiceInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;Thesaurus&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="p">);</span>
  <span class="n">printConfigServiceInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;Hyphenator&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="p">);</span>
  <span class="n">printConfigServiceInfo</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;Proofreader&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>

  <span class="n">printLocales</span><span class="p">(</span><span class="s">&quot;SpellChecker&quot;</span><span class="p">,</span> <span class="n">lingoMgr</span><span class="p">.</span><span class="na">getAvailableLocales</span><span class="p">(</span>
                       <span class="s">&quot;com.sun.star.linguistic2.SpellChecker&quot;</span><span class="p">));</span>
  <span class="n">printLocales</span><span class="p">(</span><span class="s">&quot;Thesaurus&quot;</span><span class="p">,</span> <span class="n">lingoMgr</span><span class="p">.</span><span class="na">getAvailableLocales</span><span class="p">(</span>
                       <span class="s">&quot;com.sun.star.linguistic2.Thesaurus&quot;</span><span class="p">));</span>
  <span class="n">printLocales</span><span class="p">(</span><span class="s">&quot;Hyphenator&quot;</span><span class="p">,</span> <span class="n">lingoMgr</span><span class="p">.</span><span class="na">getAvailableLocales</span><span class="p">(</span>
                      <span class="s">&quot;com.sun.star.linguistic2.Hyphenator&quot;</span><span class="p">));</span>
  <span class="n">printLocales</span><span class="p">(</span><span class="s">&quot;Proofreader&quot;</span><span class="p">,</span> <span class="n">lingoMgr</span><span class="p">.</span><span class="na">getAvailableLocales</span><span class="p">(</span>
                      <span class="s">&quot;com.sun.star.linguistic2.Proofreader&quot;</span><span class="p">));</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>

<span class="p">}</span>  <span class="c1">// end of printServicesInfo()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The choice of services depends on the current locale, so printServicesInfo() begins by
creating an American English locale, which matches my version of Office.</p>
<p>Write.printAvailServiceInfo() utilizes XLinguServiceManager.getAvailableServices()
to retrieve a list of the available services. In a similar way,
Write.printConfigServiceInfo() calls
XLinguServiceManager.getConfiguredServices(), and printLocales gets an array of
Locale objects from XLinguServiceManager.getAvailableLocales().</p>
<h2 id="2-using-the-spell-checker">2.  Using the Spell Checker<a class="headerlink" href="#2-using-the-spell-checker" title="Permanent link">&para;</a></h2>
<p>There's a few examples in Lingo.java of applying the spell checker to individual
words:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Lingo.java</span>
<span class="n">XSpellChecker</span> <span class="n">speller</span> <span class="o">=</span> <span class="n">lingoMgr</span><span class="p">.</span><span class="na">getSpellChecker</span><span class="p">();</span>

<span class="n">Write</span><span class="p">.</span><span class="na">spellWord</span><span class="p">(</span><span class="s">&quot;horseback&quot;</span><span class="p">,</span> <span class="n">speller</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">spellWord</span><span class="p">(</span><span class="s">&quot;ceurse&quot;</span><span class="p">,</span> <span class="n">speller</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">spellWord</span><span class="p">(</span><span class="s">&quot;magisian&quot;</span><span class="p">,</span> <span class="n">speller</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">spellWord</span><span class="p">(</span><span class="s">&quot;ellucidate&quot;</span><span class="p">,</span> <span class="n">speller</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>XLinguServiceManager.getSpellChecker() returns a reference to the spell checker,
and Write.spellWord() checks the supplied word. For the code above, the following is
printed:</p>
<div class="highlight"><pre><span></span><code>* &quot;ceurse&quot; is unknown. Try:
No. of names: 8
  &quot;curse&quot;  &quot;course&quot;  &quot;secateurs&quot;  &quot;cerise&quot;
  &quot;surcease&quot;  &quot;secure&quot;  &quot;cease&quot;  &quot;Ceausescu&quot;

* &quot;magisian&quot; is unknown. Try:
No. of names: 7
  &quot;magician&quot;  &quot;magnesia&quot;  &quot;Malaysian&quot;  &quot;mismanage&quot;
  &quot;imagining&quot;  &quot;mastication&quot;  &quot;fumigation&quot;

* &quot;ellucidate&quot; is unknown. Try:
No. of names: 7
  &quot;elucidate&quot;  &quot;elucidation&quot;  &quot;hallucinate&quot;  &quot;pellucid&quot;
  &quot;fluoridate&quot;  &quot;elasticated&quot;  &quot;illustrated&quot;
</code></pre></div>
<p>Nothing is reported for "horseback" because that's correctly spelt, and spellWord()
returns the boolean true.</p>
<p>The SpellChecker service and its important interfaces are shown in Figure 8.</p>
<p><img alt="" src="images/10-Linguistics-8.png" /></p>
<p>Figure 8. The SpellChecker Service and Interfaces.</p>
<p>Write.spellWord() utilizes XSpellChecker.spell() to find a spelling mistake, then
prints the alternative spellings:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:1"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Write class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">spellWord</span><span class="p">(</span><span class="n">String</span> <span class="n">word</span><span class="p">,</span> <span class="n">XSpellChecker</span> <span class="n">speller</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span> <span class="n">loc</span> <span class="o">=</span>
           <span class="k">new</span> <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span><span class="p">(</span><span class="s">&quot;en&quot;</span><span class="p">,</span> <span class="s">&quot;US&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">);</span>
                                   <span class="c1">// American English</span>
  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PropertyValue</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>

  <span class="n">XSpellAlternatives</span> <span class="n">alts</span> <span class="o">=</span> <span class="n">speller</span><span class="p">.</span><span class="na">spell</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">alts</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;* \&quot;&quot;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s">&quot;\&quot; is unknown. Try:&quot;</span><span class="p">);</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">altWords</span> <span class="o">=</span> <span class="n">alts</span><span class="p">.</span><span class="na">getAlternatives</span><span class="p">();</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">printNames</span><span class="p">(</span><span class="n">altWords</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>   <span class="c1">// end of spellWord()</span>
</code></pre></div>
</div>
</div>
</div>
<p>XSpellChecker.spell() requires a locale and an array of properties, which I've left
empty. The properties are those associated with XLinguProperties, which were listed
above using Write.getLinguProperties(). Its output shows that "IsSpellCapitalization"
is presently true, which means that words in all-caps will be checked. The property
can be changed to false inside the PropertyValue array passed to
XSpellChecker.spell(). For example:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:1"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">props</span> <span class="o">=</span>
       <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;IsSpellCapitalization&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="n">XSpellAlternatives</span> <span class="n">alts</span> <span class="o">=</span> <span class="n">speller</span><span class="p">.</span><span class="na">spell</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Now an incorrectly spelt word in all-caps, such as "CEURSE", will be skipped over.</p>
<p>This means that Write.spellWord("CEURSE", speller) should return true.</p>
<p>Unfortunately, XSpellChecker.spell() seems to ignore the property array, and still
reports "CEURSE" as incorrectly spelt.</p>
<p>Even a property change performed through the XLinguProperties interface, such as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XLinguProperties</span> <span class="n">linguProps</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getLinguProperties</span><span class="p">();</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">linguProps</span><span class="p">,</span> <span class="s">&quot;IsSpellCapitalization&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>fails to change XSpellChecker.spell()'s behavior. The only way to make a change to
the linguistic properties that is acted upon is through the "Options" pane in the
"Writing Aids" dialog, as in Figure 9.</p>
<p><img alt="" src="images/10-Linguistics-9.png" /></p>
<p>Figure 9. Changing the Capitalization Property.</p>
<p>Office's default spell checker is Hunspell (from <a href="https://hunspell.github.io/">https://hunspell.github.io/</a>), and has
been part of OpenOffice since v.2, when it replaced MySpell, adding several features
such as support for Unicode. The "MySpell" name lives on in a few places, such as in
the spelling service (org.openoffice.lingu.MySpellSpellChecker).</p>
<p>Hunspell offers extra properties in addition to those in the "Options" pane of the
"Writing Aids" dialog. They can be accessed through the Tools, Options, Language
Settings, "English sentence checking" dialog shown in Figure 10.</p>
<p><img alt="" src="images/10-Linguistics-10.png" /></p>
<p>Figure 10. The English Sentence Checking Dialog.</p>
<p>The same dialog can also be reached through the Extension Manager window shown
back in Figure 6. Click on the "English Spelling dictionaries" extension, and then
press the "Options" button which appears as in Figure 11.</p>
<p><img alt="" src="images/10-Linguistics-11.png" /></p>
<p>Figure 11. The English Spelling Options Button.</p>
<p>Unfortunately, there appears to be no API for accessing these Hunspell options. The
best that can be done is to use a dispatch message to open the "English Sentence
Checking" dialog in Figure 10. This done by calling Write.openSentCheckOptions():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>   <span class="c1">// Office must be visible...</span>
<span class="n">Lo</span><span class="p">.</span><span class="na">wait</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">openSentCheckOptions</span><span class="p">();</span>  <span class="c1">// for the dialog to appear</span>
</code></pre></div>
</div>
</div>
</div>
<p>Write.openSentCheckOptions() uses an ".uno:OptionsTreeDialog" dispatch along
with an URL argument for the dialog's XML definition file:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:1"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Writer class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">openSentCheckOptions</span><span class="p">()</span>
<span class="c1">// open &quot;Options - Language Settings - English sentence checking</span>
<span class="p">{</span>
  <span class="n">XPackageInformationProvider</span> <span class="n">pip</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">getPip</span><span class="p">();</span>
  <span class="n">String</span> <span class="n">langExt</span> <span class="o">=</span> <span class="n">pip</span><span class="p">.</span><span class="na">getPackageLocation</span><span class="p">(</span>
                    <span class="s">&quot;org.openoffice.en.hunspell.dictionaries&quot;</span><span class="p">);</span>
  <span class="c1">// System.out.println(&quot;Lang Ext: &quot; + langExt);</span>
  <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="n">langExt</span> <span class="o">+</span> <span class="s">&quot;/dialog/en.xdl&quot;</span><span class="p">;</span>

  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;OptionsPageURL&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">dispatchCmd</span><span class="p">(</span><span class="s">&quot;OptionsTreeDialog&quot;</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">wait</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of openSentCheckOptions()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The XML file's location is obtained in two steps. First the ID of the Hunspell service
("org.openoffice.en.hunspell.dictionaries") is passed to
XPackageInformationProvider.getPackageLocation() to obtain the spell checker's
installation folder. Figure 12 shows the directory on my machine.</p>
<p><img alt="" src="images/10-Linguistics-12.png" /></p>
<p>Figure 12. The Hunspell Installation Folder.</p>
<p>The directory contains a dialog subdirectory, which holds an XXX.xdl file that
defines the dialog's XML structure and data. The "XXX" name will be Office's locale
language, which in my case is "en".</p>
<p>The URL required by the "OptionsTreeDialog" dispatch is constructed by appending
"/dialog/en.xdl" to the installation folder string.</p>
<h2 id="3-using-the-thesaurus">3.  Using the Thesaurus<a class="headerlink" href="#3-using-the-thesaurus" title="Permanent link">&para;</a></h2>
<p>Lingo.java contains two examples of how to use the thesaurus:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:1"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Lingo.java</span>
   <span class="p">:</span>
<span class="n">XLinguServiceManager2</span> <span class="n">lingoMgr</span> <span class="o">=</span>
         <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XLinguServiceManager2</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                 <span class="s">&quot;com.sun.star.linguistic2.LinguServiceManager&quot;</span><span class="p">);</span>
   <span class="p">:</span>
<span class="n">XThesaurus</span> <span class="n">thesaurus</span> <span class="o">=</span> <span class="n">lingoMgr</span><span class="p">.</span><span class="na">getThesaurus</span><span class="p">();</span>
<span class="n">Write</span><span class="p">.</span><span class="na">printMeaning</span><span class="p">(</span><span class="s">&quot;magician&quot;</span><span class="p">,</span> <span class="n">thesaurus</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">printMeaning</span><span class="p">(</span><span class="s">&quot;elucidate&quot;</span><span class="p">,</span> <span class="n">thesaurus</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The output from the first call to Write.printMeaning() is:</p>
<div class="highlight"><pre><span></span><code>&quot;magician&quot; found in thesaurus; number of meanings: 2
1.  Meaning: (noun) prestidigitator

  No. of synonyms: 6
    prestidigitator
    conjurer
    conjuror
    illusionist
    performer (generic term)
    performing artist (generic term)

2.  Meaning: (noun) sorcerer

  No. of synonyms: 6
    sorcerer
    wizard
    necromancer
    thaumaturge
    thaumaturgist
    occultist (generic term)
</code></pre></div>
<p>XLinguServiceManager2.getThesaurus() returns an instance of XThesaurus whose
service and main interfaces are shown in Figure 13.</p>
<p><img alt="" src="images/10-Linguistics-13.png" /></p>
<p>Figure 13. The Thesaurus Service and Interfaces.</p>
<p>Write.printMeaning() calls XThesaurus.queryMeanings(), and prints the array of
results:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:1"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">printMeaning</span><span class="p">(</span><span class="n">String</span> <span class="n">word</span><span class="p">,</span> <span class="n">XThesaurus</span> <span class="n">thesaurus</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span> <span class="n">loc</span> <span class="o">=</span>
               <span class="k">new</span> <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span><span class="p">(</span><span class="s">&quot;en&quot;</span><span class="p">,</span> <span class="s">&quot;US&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">);</span>
                                      <span class="c1">// American English</span>
  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PropertyValue</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>

  <span class="n">XMeaning</span><span class="o">[]</span> <span class="n">meanings</span> <span class="o">=</span> <span class="n">thesaurus</span><span class="p">.</span><span class="na">queryMeanings</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">meanings</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span>
                              <span class="s">&quot;\&quot; NOT found in thesaurus\n&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s">&quot;\&quot; found in thesaurus;</span>
<span class="s">                   number of meanings: &quot;</span> <span class="o">+</span> <span class="n">meanings</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">meanings</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;. Meaning: &quot;</span> <span class="o">+</span>
                                       <span class="n">meanings</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">getMeaning</span><span class="p">());</span>
      <span class="n">String</span><span class="o">[]</span> <span class="n">synonyms</span> <span class="o">=</span> <span class="n">meanings</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">querySynonyms</span><span class="p">();</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  No. of synonyms: &quot;</span> <span class="o">+</span> <span class="n">synonyms</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">synonyms</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;    &quot;</span> <span class="o">+</span> <span class="n">synonyms</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="p">);</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">meanings</span><span class="p">.</span><span class="na">length</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of printMeaning()</span>
</code></pre></div>
</div>
</div>
</div>
<p>In a similar way to XSpellChecker.spell(), XThesaurus.queryMeanings() requires a
locale and an optional array of properties. printMeaning() utilizes American English,
and no properties.</p>
<p>If you need a non-English thesaurus which isn't part of Office, then look through the
dictionary extensions at
<a href="https://extensions.libreoffice.org/extension-center?getCategories=Dictionary">https://extensions.libreoffice.org/extension-center?getCategories=Dictionary</a>;
many include a thesaurus with the dictionary.</p>
<p>Thesaurus data is stored as ".idx" and ".dat" files in the same directory as the spell
checker (i.e. in <OFFICE>\share\extensions\dict-en), as can be seen in Figure 13.</p>
<p>The files are built from WordNet data (<a href="https://wordnet.princeton.edu/">https://wordnet.princeton.edu/</a>), but use a text-
based format explained very briefly in Daniel Naber's slides about the
Lingucomponent Project (at <a href="https://danielnaber.de/publications/ooocon2005-lingucomponent.pdf">https://danielnaber.de/publications/ooocon2005-lingucomponent.pdf</a>).
Also, the Lingucomponent website has some C++ code for
reading ".idx" and '.dat" files (in <a href="https://openoffice.org/lingucomponent/MyThes-1.zip">https://openoffice.org/lingucomponent/MyThes-1.zip</a>).</p>
<p>However, if you want to write code using a thesaurus independently of Office, then
I'd suggest programming with one of the many APIs for WordNet; there are currently
nine for Java, listed at <a href="https://wordnet.princeton.edu/wordnet/related-projects/#Java">https://wordnet.princeton.edu/wordnet/related-projects/#Java</a>.</p>
<h2 id="4-grammar-checking">4.  Grammar Checking<a class="headerlink" href="#4-grammar-checking" title="Permanent link">&para;</a></h2>
<p>Office's default grammar checker (or proof reader) is Lightproof, a Python application
developed by László Németh. Lightproof.py, and its support files, are installed in the
same folder as the spell checker and thesaurus; on my machine that's
<OFFICE>\share\extensions\dict-en.</p>
<p>Older versions of Lightproof are available from OpenOffice's extensions website at
<a href="https://extensions.services.openoffice.org/project/lightproof">https://extensions.services.openoffice.org/project/lightproof</a>. One reason for
downloading the old version is that it contains documentation on adding new
grammar rules missing from the version installed in Office.</p>
<p>Another way to modify Lightproof's grammar rules is with its editor, which can be
obtained from <a href="https://extensions.libreoffice.org/extension-center/lightproof-editor">https://extensions.libreoffice.org/extension-center/lightproof-editor</a>.</p>
<p>There are a number of alternative grammar checkers for Office, including "After the
Deadline" (<a href="https://afterthedeadline.com/">https://afterthedeadline.com/</a>) and "LanguageTool"
(<a href="https://languagetool.org/">https://languagetool.org/</a>), which are easily added to Office as extensions via
the "Language Tools" subsection of the website, at
<a href="https://extensions.libreoffice.org/extension-center?getCategories=Language%20Tools">https://extensions.libreoffice.org/extension-center?getCategories=Language%20Tools</a>.</p>
<p>When I first coded my examples, I used the default Lightproof for grammar checking,
but it doesn't have a very extensive set of built-in grammar rules (it seems best at
catching punctuation mistakes). I switched to LanguageTool because of its larger set
of rules, and its support for many languages. I also like that it can be used as a
standalone Java library, separate from Office, and that its site includes lots of
documentation. Perhaps its biggest drawback is that it requires Java 8 or later.</p>
<p>Another issue is that LanguageTool and Lightproof cannot happily coexist inside
Office. Lightproof must be disabled and LanguageTool enabled via the Options,
Language Settings, Writing aids, "Available language modules" pane at the top of
Figure 14.</p>
<p><img alt="" src="images/10-Linguistics-14.png" /></p>
<p>Figure 14. Goodbye Lightproof, hello LanguageTool.</p>
<p>I used Write.printServicesInfo() earlier to list the available and configured services.</p>
<p>The output included:</p>
<div class="highlight"><pre><span></span><code>Available Services:
    :
Proofreader (2):
  org.languagetool.openoffice.Main
  org.libreoffice.comp.pyuno.Lightproof.en

Configured Services:
    :
Proofreader (1):
  org.languagetool.openoffice.Main
</code></pre></div>
<p>"org.languagetool.openoffice.Main" refers to the LanguageTool extension, while
"org.libreoffice.comp.pyuno.Lightproof.en" is the English version of Lightproof.</p>
<p>This information can be used to set the proof reader. LanguageTool is made the
default by calling Write.setConfiguredServices() like so:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:1"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Write</span><span class="p">.</span><span class="na">setConfiguredServices</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;Proofreader&quot;</span><span class="p">,</span>
                          <span class="s">&quot;org.languagetool.openoffice.Main&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Alternatively, Lightproof can be enabled with:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:1"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Write</span><span class="p">.</span><span class="na">setConfiguredServices</span><span class="p">(</span><span class="n">lingoMgr</span><span class="p">,</span> <span class="s">&quot;Proofreader&quot;</span><span class="p">,</span>
                    <span class="s">&quot;org.libreoffice.comp.pyuno.Lightproof.en&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The code for Write.setConfiguredServices() is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:1"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Write class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setConfiguredServices</span><span class="p">(</span>
                      <span class="n">XLinguServiceManager2</span> <span class="n">lingoMgr</span><span class="p">,</span>
                      <span class="n">String</span> <span class="n">service</span><span class="p">,</span> <span class="n">String</span> <span class="n">implName</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span> <span class="n">loc</span> <span class="o">=</span>
                  <span class="k">new</span> <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span><span class="p">(</span><span class="s">&quot;en&quot;</span><span class="p">,</span><span class="s">&quot;US&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">);</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">implNames</span> <span class="o">=</span> <span class="p">{</span> <span class="n">implName</span> <span class="p">};</span>
  <span class="n">lingoMgr</span><span class="p">.</span><span class="na">setConfiguredServices</span><span class="p">(</span>
      <span class="s">&quot;com.sun.star.linguistic2.&quot;</span> <span class="o">+</span> <span class="n">service</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">implNames</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of setConfiguredServices()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The function utilizes XLinguServiceManager.setConfiguredServices() to attach a
particular implementation service (e.g. LanguageTool) to a specified linguistic service
(e.g. the Proofreader).</p>
<h3 id="41-error-reporting-options">4.1.  Error Reporting Options<a class="headerlink" href="#41-error-reporting-options" title="Permanent link">&para;</a></h3>
<p>The kinds of errors reported by the proof reader can be adjusted through Office's GUI.</p>
<p>One configuration pane, used by both Lightproof and LanguageTool, is in the
"English Sentence Checking" dialog shown back in Figure 10. If you look closely, the
first group of check boxes are titled "Grammar checking".</p>
<p>If you install LanguageTool, Office's Tools menu will be modified to contain a new
"LanguageTool" submenu shown in Figure 15.</p>
<p><img alt="" src="images/10-Linguistics-15.png" /></p>
<p>Figure 15. The LanguageTool Submenu.</p>
<p>The "Options" menu item in the "LanguageTool" submenu brings up an extensive set
of options, reflecting the greater number of grammar rules in the checker (see Figure
16).</p>
<p><img alt="" src="images/10-Linguistics-16.png" /></p>
<p>Figure 16. The LanguageTool Options Dialog.</p>
<p>Unfortunately, there seems to be no way to modify these options through Office's
Proofreader API.</p>
<h3 id="42-using-the-proof-reader">4.2.  Using the Proof Reader<a class="headerlink" href="#42-using-the-proof-reader" title="Permanent link">&para;</a></h3>
<p>In Lingo.java the proof reader is loaded and called like so:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:1"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Lingo.java</span>
    <span class="p">:</span>
<span class="n">XProofreader</span> <span class="n">proofreader</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">loadProofreader</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Proofing...&quot;</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">numErrs</span> <span class="o">=</span>
     <span class="n">Write</span><span class="p">.</span><span class="na">proofSentence</span><span class="p">(</span><span class="s">&quot;i dont have one one dogs.&quot;</span><span class="p">,</span> <span class="n">proofreader</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No. of proofing errors: &quot;</span> <span class="o">+</span> <span class="n">numErrs</span> <span class="o">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The output is:</p>
<p>Proofing...</p>
<div class="highlight"><pre><span></span><code>G* This sentence does not start with an uppercase letter in: &quot;i&quot;
   Suggested change: &quot;I&quot;

G* Spelling mistake in: &quot;dont&quot;
   Suggested change: &quot;don&#39;t&quot;

G* Word repetition in: &quot;one one&quot;
   Suggested change: &quot;one&quot;

No. of proofing errors: 3
</code></pre></div>
<p>The proof reader isn't accessed through the linguistics manager; instead a Proofreader
service is created, and its interfaces employed. A simplified view of the services and
interfaces are shown in Figure 17.</p>
<p><img alt="" src="images/10-Linguistics-17.png" /></p>
<p>Figure 17. The Proofreader Service and Interfaces.</p>
<p>Write.loadProofreader() creates the service:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="22:1"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="__tabbed_22_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">XProofreader</span> <span class="nf">loadProofreader</span><span class="p">()</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XProofreader</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                    <span class="s">&quot;com.sun.star.linguistic2.Proofreader&quot;</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Write.proofSentence() passes a sentence to XProofreader.doProofreading(), and prints
the errors inside the returned ProofreadingResult instance:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="23:1"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="__tabbed_23_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">proofSentence</span><span class="p">(</span><span class="n">String</span> <span class="n">sent</span><span class="p">,</span>
                                 <span class="n">XProofreader</span> <span class="n">proofreader</span><span class="p">)</span>
<span class="p">{</span> <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span> <span class="n">loc</span> <span class="o">=</span>
             <span class="k">new</span> <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span><span class="p">(</span><span class="s">&quot;en&quot;</span><span class="p">,</span> <span class="s">&quot;US&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">);</span>
                     <span class="c1">// American English</span>
  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PropertyValue</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">numErrs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">ProofreadingResult</span> <span class="n">prRes</span> <span class="o">=</span>
           <span class="n">proofreader</span><span class="p">.</span><span class="na">doProofreading</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="n">sent</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span>
                                      <span class="mi">0</span><span class="p">,</span> <span class="n">sent</span><span class="p">.</span><span class="na">length</span><span class="p">(),</span> <span class="n">props</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">prRes</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">SingleProofreadingError</span><span class="o">[]</span> <span class="n">errs</span> <span class="o">=</span> <span class="n">prRes</span><span class="p">.</span><span class="na">aErrors</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">errs</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
      <span class="k">for</span><span class="p">(</span><span class="n">SingleProofreadingError</span> <span class="n">err</span> <span class="p">:</span> <span class="n">errs</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printProofError</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="n">err</span><span class="p">);</span>
        <span class="n">numErrs</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">numErrs</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of proofSentence()</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printProofError</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">,</span>
                              <span class="n">SingleProofreadingError</span> <span class="n">err</span><span class="p">)</span>
<span class="p">{</span> <span class="n">String</span> <span class="n">errText</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="n">err</span><span class="p">.</span><span class="na">nErrorStart</span><span class="p">,</span>
                               <span class="n">err</span><span class="p">.</span><span class="na">nErrorStart</span> <span class="o">+</span> <span class="n">err</span><span class="p">.</span><span class="na">nErrorLength</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;G* &quot;</span> <span class="o">+</span> <span class="n">err</span><span class="p">.</span><span class="na">aShortComment</span> <span class="o">+</span>
                                    <span class="s">&quot; in: \&quot;&quot;</span> <span class="o">+</span> <span class="n">errText</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">.</span><span class="na">aSuggestions</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;   Suggested change: \&quot;&quot;</span> <span class="o">+</span>
                                     <span class="n">err</span><span class="p">.</span><span class="na">aSuggestions</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of printProofError()</span>
</code></pre></div>
</div>
</div>
</div>
<p>XProofreader.doProofreading() requires a locale and properties array in the same way
as the earlier spell checking and thesaurus methods. It also needs two indices for the
start and end of the sentence being checked, and a document ID which is used in the
error results.</p>
<p>The results are returned as an array of SingleProofreadingError objects, one for each
detected error. It's worth having a look at the documentation for the
SingleProofreadingError class (use <code>lodoc SingleProofreadingError</code>), since the
object contains more information than I've used in Write.printProofError(); for
example, the ID of the grammar rule that was 'broken', a full comment string, and
multiple suggestions in a String array.</p>
<p>Grammar rule IDs are one area where the proof reader API could be improved. The
XProofreader interface includes methods for switching on and off rules based on their
IDs, but there's no way to find out what these IDs are except by looking at
SingleProofreadingError objects.</p>
<h2 id="5-guessing-the-language-used-in-a-string">5.  Guessing the Language used in a String<a class="headerlink" href="#5-guessing-the-language-used-in-a-string" title="Permanent link">&para;</a></h2>
<p>An oft overlooked linguistics API feature is the ability to guess the language used in a
string, which is implemented by one service, LanguageGuessing, and a single
interface, XLanguageGuessing. The documentation for XLanguageGuessing includes
a long list of supported languages, including Irish Gaelic, Scots Gaelic, and Manx
Gaelic.</p>
<p>There are two examples of language guessing in Lingo.java:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="24:1"><input checked="checked" id="__tabbed_24_1" name="__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="__tabbed_24_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Lingo.java</span>
   <span class="p">:</span>
<span class="n">Locale</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">guessLocale</span><span class="p">(</span>
              <span class="s">&quot;The rain in Spain stays mainly on the plain.&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">printLocale</span><span class="p">(</span><span class="n">loc</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">loc</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Guessed language: &quot;</span> <span class="o">+</span> <span class="n">loc</span><span class="p">.</span><span class="na">Language</span><span class="p">);</span>

<span class="n">loc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">guessLocale</span><span class="p">(</span>
            <span class="s">&quot;A vaincre sans péril, on triomphe sans gloire.&quot;</span><span class="p">);</span>
          <span class="c1">// To win without risk is a triumph without glory.</span>

<span class="k">if</span> <span class="p">(</span><span class="n">loc</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Guessed language: &quot;</span> <span class="o">+</span> <span class="n">loc</span><span class="p">.</span><span class="na">Language</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The output is:</p>
<div class="highlight"><pre><span></span><code>Locale lang: &quot;English&quot;; country: &quot;&quot;; variant: &quot;&quot;
Guessed language: en
Guessed language: fr
</code></pre></div>
<p>Write.guessLocale() creates the service, its interface, and calls
XLanguageGuessing.guessPrimaryLanguage():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="25:1"><input checked="checked" id="__tabbed_25_1" name="__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="__tabbed_25_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Writer class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span> <span class="nf">guessLocale</span><span class="p">(</span><span class="n">String</span> <span class="n">testStr</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XLanguageGuessing</span> <span class="n">guesser</span> <span class="o">=</span>
       <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XLanguageGuessing</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
               <span class="s">&quot;com.sun.star.linguistic2.LanguageGuessing&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">guesser</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No language guesser found&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="n">guesser</span><span class="p">.</span><span class="na">guessPrimaryLanguage</span><span class="p">(</span><span class="n">testStr</span><span class="p">,</span>
                                         <span class="mi">0</span><span class="p">,</span> <span class="n">testStr</span><span class="p">.</span><span class="na">length</span><span class="p">());</span>
<span class="p">}</span>  <span class="c1">// end of guessLocale()</span>
</code></pre></div>
</div>
</div>
</div>
<p>XLanguageGuessing actually guesses a locale rather than a language, and the locale
includes information about the language, country and a variant BCP 47 language
label. com.sun.star.lang.Locale stores that information as three strings, but XLocale
has additional methods for displaying the string codes in longer formats (e.g. "th" as
"Thailand"). Unfortunately, I was unable to get code using XLocale to compile, so fell
back to Java's Locale class which includes similar methods.</p>
<p>Write.printLocale() converts an Office locale into a Java version, then prints its data
in long form:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="26:1"><input checked="checked" id="__tabbed_26_1" name="__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="__tabbed_26_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printLocale</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span> <span class="n">loc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">loc</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>  <span class="p">{</span>
    <span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">Locale</span> <span class="n">jloc</span> <span class="o">=</span>
        <span class="k">new</span> <span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">Locale</span><span class="p">(</span><span class="n">loc</span><span class="p">.</span><span class="na">Language</span><span class="p">,</span> <span class="n">loc</span><span class="p">.</span><span class="na">Country</span><span class="p">,</span> <span class="n">loc</span><span class="p">.</span><span class="na">Variant</span><span class="p">);</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Locale lang: \&quot;&quot;</span> <span class="o">+</span>
                                   <span class="n">jloc</span><span class="p">.</span><span class="na">getDisplayLanguage</span><span class="p">()</span> <span class="o">+</span>
               <span class="s">&quot;\&quot;; country: \&quot;&quot;</span> <span class="o">+</span> <span class="n">jloc</span><span class="p">.</span><span class="na">getDisplayCountry</span><span class="p">()</span> <span class="o">+</span>
               <span class="s">&quot;\&quot;; variant: \&quot;&quot;</span> <span class="o">+</span> <span class="n">jloc</span><span class="p">.</span><span class="na">getDisplayVariant</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of printLocale()</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="6-spell-checking-and-grammar-checking-a-document">6.  Spell Checking and Grammar Checking a Document<a class="headerlink" href="#6-spell-checking-and-grammar-checking-a-document" title="Permanent link">&para;</a></h2>
<p>Lingo.java only spell checks individual words, and grammar checks a single sentence.</p>
<p>The LingoFile.java example shows how these features can be applied to an entire
document.</p>
<p>One way to scan every sentence in a document is to combine XParagraphCursor and
XSentenceCursor, as in the TalkingBook.java example from Chapter 5, section 6. An
outer loop iterates over every paragraph using XParagraphCursor, and an inner loop
splits each paragraph into sentences with the help of XSentenceCursor. Initially, I
coded LingoFile.java in this way, but found that XSentenceCursor  occasionally didn't
divide a paragraph into the correct number of sentences; sometimes two sentences
were treated as one.</p>
<p>So I switched to a combined Office/Java approach – the outer loop in LingoFile.java
still utilizes XParagraphCursor to scan the paragraphs, but the sentences in a
paragraph are extracted using a sentence-based BreakIterator.</p>
<p>The main() function of LingoFile.java:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="27:1"><input checked="checked" id="__tabbed_27_1" name="__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="__tabbed_27_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Usage: run LingoFile &lt;fnm&gt;&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XTextDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">openDoc</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not open &quot;</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// load spell checker, proof reader</span>
  <span class="n">XSpellChecker</span> <span class="n">speller</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">loadSpellChecker</span><span class="p">();</span>
  <span class="n">XProofreader</span> <span class="n">proofreader</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">loadProofreader</span><span class="p">();</span>

  <span class="n">BreakIterator</span> <span class="n">bi</span> <span class="o">=</span> <span class="n">BreakIterator</span><span class="p">.</span><span class="na">getSentenceInstance</span><span class="p">(</span>
                                          <span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">Locale</span><span class="p">.</span><span class="na">US</span><span class="p">);</span>

  <span class="c1">// iterate through the doc by paragraphs</span>
  <span class="n">XParagraphCursor</span> <span class="n">paraCursor</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getParagraphCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">paraCursor</span><span class="p">.</span><span class="na">gotoStart</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>     <span class="c1">// go to start of text</span>
  <span class="n">String</span> <span class="n">currPara</span><span class="p">;</span>
  <span class="k">do</span> <span class="p">{</span>
    <span class="n">paraCursor</span><span class="p">.</span><span class="na">gotoEndOfParagraph</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
                          <span class="c1">// select all of paragraph</span>
    <span class="n">currPara</span> <span class="o">=</span> <span class="n">paraCursor</span><span class="p">.</span><span class="na">getString</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">currPara</span><span class="p">.</span><span class="na">length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">checkSentences</span><span class="p">(</span><span class="n">currPara</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="n">speller</span><span class="p">,</span> <span class="n">proofreader</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">paraCursor</span><span class="p">.</span><span class="na">gotoNextParagraph</span><span class="p">(</span><span class="kc">false</span><span class="p">));</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
</div>
</div>
</div>
<p>Write.loadSpellChecker() hides the creation of the linguistics manager, and its
retrieval of the spell checker:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="28:1"><input checked="checked" id="__tabbed_28_1" name="__tabbed_28" type="radio" /><div class="tabbed-labels"><label for="__tabbed_28_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Write class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XSpellChecker</span> <span class="nf">loadSpellChecker</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">XLinguServiceManager</span> <span class="n">lingoMgr</span> <span class="o">=</span>
           <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XLinguServiceManager</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                   <span class="s">&quot;com.sun.star.linguistic2.LinguServiceManager&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">lingoMgr</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No linguistics manager found&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="n">lingoMgr</span><span class="p">.</span><span class="na">getSpellChecker</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of loadSpellChecker()</span>

<span class="n">The</span> <span class="n">BreakIterator</span> <span class="n">is</span> <span class="n">instantiated</span> <span class="n">in</span> <span class="nf">main</span><span class="p">()</span> <span class="n">using</span><span class="p">:</span>
<span class="n">BreakIterator</span> <span class="n">bi</span> <span class="o">=</span>
        <span class="n">BreakIterator</span><span class="p">.</span><span class="na">getSentenceInstance</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">Locale</span><span class="p">.</span><span class="na">US</span><span class="p">);</span>
<span class="n">but</span> <span class="n">employed</span> <span class="n">inside</span> <span class="nf">checkSentences</span><span class="p">(),</span> <span class="n">which</span> <span class="n">splits</span> <span class="n">a</span> <span class="n">paragraph</span> <span class="n">into</span> <span class="n">sentences</span><span class="p">:</span>

<span class="c1">// in LingoFile.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">checkSentences</span><span class="p">(</span><span class="n">String</span> <span class="n">currPara</span><span class="p">,</span>
               <span class="n">BreakIterator</span> <span class="n">bi</span><span class="p">,</span>
               <span class="n">XSpellChecker</span> <span class="n">speller</span><span class="p">,</span> <span class="n">XProofreader</span> <span class="n">proofreader</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\n&gt;&gt; &quot;</span> <span class="o">+</span> <span class="n">currPara</span><span class="p">);</span>
  <span class="n">bi</span><span class="p">.</span><span class="na">setText</span><span class="p">(</span><span class="n">currPara</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">lastIdx</span> <span class="o">=</span> <span class="n">bi</span><span class="p">.</span><span class="na">first</span><span class="p">();</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">lastIdx</span> <span class="o">!=</span> <span class="n">BreakIterator</span><span class="p">.</span><span class="na">DONE</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">firstIdx</span> <span class="o">=</span> <span class="n">lastIdx</span><span class="p">;</span>
    <span class="n">lastIdx</span> <span class="o">=</span> <span class="n">bi</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lastIdx</span> <span class="o">!=</span> <span class="n">BreakIterator</span><span class="p">.</span><span class="na">DONE</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">String</span> <span class="n">sentence</span> <span class="o">=</span> <span class="n">currPara</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="n">firstIdx</span><span class="p">,</span> <span class="n">lastIdx</span><span class="p">);</span>
      <span class="n">Write</span><span class="p">.</span><span class="na">proofSentence</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">proofreader</span><span class="p">);</span>
      <span class="n">Write</span><span class="p">.</span><span class="na">spellSentence</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">speller</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of checkSentences()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The index positions of the start of the current sentence and the start of the next
sentence are stored in firstIdx and lastIdx, and used to extract a substring spanning the
current sentence. This is passed to Write.spellSentence() and Write.proofSentence()
for spell and proof checking. Write.spellSentence() splits the sentence into an array of
words, and calls Write.spellWord() on each one:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="29:1"><input checked="checked" id="__tabbed_29_1" name="__tabbed_29" type="radio" /><div class="tabbed-labels"><label for="__tabbed_29_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Write class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">spellSentence</span><span class="p">(</span><span class="n">String</span> <span class="n">sent</span><span class="p">,</span> <span class="n">XSpellChecker</span> <span class="n">speller</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">words</span> <span class="o">=</span> <span class="n">sent</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;\\W+&quot;</span><span class="p">);</span>   <span class="c1">// split into words</span>
  <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">boolean</span> <span class="n">isCorrect</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">String</span> <span class="n">word</span> <span class="p">:</span> <span class="n">words</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">isCorrect</span> <span class="o">=</span> <span class="n">spellWord</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">speller</span><span class="p">);</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="p">(</span><span class="n">isCorrect</span><span class="o">?</span> <span class="mi">0</span> <span class="p">:</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">count</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of spellSentence()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The poorly written "badGrammar.odt" is shown in Figure 18.</p>
<p><img alt="" src="images/10-Linguistics-18.png" /></p>
<p>Figure 18. Not a Good Example of my Writing Skills.</p>
<p>The output from LingoFile.java when given "badGrammar.odt":</p>
<div class="highlight"><pre><span></span><code>&gt;&gt; I have a dogs. I have one dogs.

G* Possible agreement error in: &quot;a dogs&quot;
   Suggested change: &quot;a dog&quot;


&gt;&gt; I allow of of go home.  i dogs. John don’t like dogs. So recieve
no cats also.

G* Word repetition in: &quot;of of&quot;
   Suggested change: &quot;of&quot;

G* This sentence does not start with an uppercase letter in: &quot;i&quot;
   Suggested change: &quot;I&quot;

G* Grammatical problem in: &quot;dogs&quot;
   Suggested change: &quot;dog&quot;

G* &#39;Also&#39; at the end of sentence in: &quot;also&quot;
   Suggested change: &quot;as well&quot;

* &quot;recieve&quot; is unknown. Try:
No. of names: 8
  &quot;receive&quot;  &quot;relieve&quot;  &quot;retrieve&quot;  &quot;reprieve&quot;
  &quot;reverie&quot;  &quot;recitative&quot;  &quot;Recife&quot;  &quot;reserve&quot;

The grammar errors (those starting with &quot;G*&quot;) are produced  by the LanguageTool
proof checker. If the default Lightproof checker is utilized instead, then less errors are
found:

&gt;&gt; I have a dogs. I have one dogs.


&gt;&gt; I allow of of go home.  i dogs. John don’t like dogs. So recieve
no cats also.

G* Word duplication? in: &quot;of of&quot;
   Suggested change: &quot;of&quot;

G* Missing capitalization? in: &quot;i&quot;
   Suggested change: &quot;I&quot;

* &quot;recieve&quot; is unknown. Try:
No. of names: 8
  &quot;receive&quot;  &quot;relieve&quot;  &quot;retrieve&quot;  &quot;reprieve&quot;
  &quot;reverie&quot;  &quot;recitative&quot;  &quot;Recife&quot;  &quot;reserve&quot;
</code></pre></div>
<p>On larger documents, such as the Sherlock Holmes short story in "bigStory.doc", it's a
good idea to redirect the voluminous output to a temporary file so it can be examined
easily.</p>
<p>More than half the errors for "bigStory.doc" are spurious reports of unpaired quotes.</p>
<p>The output can be considerably reduced if LanguageTool's unpaired rule is disabled,
via the Options dialog in Figure 16. Figure 19 shows the dialog with the "Unpaired"
checkbox deselected in the Punctuation section.</p>
<p><img alt="" src="images/10-Linguistics-19.png" /></p>
<p>Figure 19. The LanguageTool Options Dialog
with the Unpaired Rule Deselected.</p>
<p>The majority of the remaining errors are words unknown to the spell checker, such as
names and places, and British English spellings.</p>
<p>Most of the grammar errors relate to how direct speech is written. The grammar
checker mistakenly reports an error if the direct speech ends with a question mark or
exclamation mark without a comma after the quoted text.</p>
<p>On balance, I'd say that Sir Arthur Conan Doyle was an excellent speller and
grammarian, or his copy editor was.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="09-Text_Search.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 9. Text Search and Replace" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 9. Text Search and Replace
            </div>
          </div>
        </a>
      
      
        
        <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-footer__link md-footer__link--next" aria-label="Next: Part 3 Draw &amp; Impress" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Part 3 Draw & Impress
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>