
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/23-Garlic_Secrets.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>Chapter 23. Garlic Secrets - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-23-garlic-secrets" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 23. Garlic Secrets
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 23. Garlic Secrets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="23-Garlic_Secrets.html" class="md-nav__link md-nav__link--active">
        Chapter 23. Garlic Secrets
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-freezing-rows" class="md-nav__link">
    1.  Freezing Rows
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-general-functions" class="md-nav__link">
    2.  General Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-searching-for-the-cost-of-garlic-and-increasing-it" class="md-nav__link">
    3.  Searching for the Cost of Garlic, and Increasing it
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-adding-a-secret-hidden-message" class="md-nav__link">
    4.  Adding a Secret, Hidden Message
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adding-the-label" class="md-nav__link">
    5.  Adding the Label
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-splitting-a-window-into-two-view-panes" class="md-nav__link">
    6.  Splitting a Window into Two View Panes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-view-states-and-making-the-top-pane-active" class="md-nav__link">
    7.  View States, and Making the Top Pane Active
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-adding-a-new-first-row-and-shifting-cells" class="md-nav__link">
    8.  Adding a New First Row and Shifting Cells
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-freezing-rows" class="md-nav__link">
    1.  Freezing Rows
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-general-functions" class="md-nav__link">
    2.  General Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-searching-for-the-cost-of-garlic-and-increasing-it" class="md-nav__link">
    3.  Searching for the Cost of Garlic, and Increasing it
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-adding-a-secret-hidden-message" class="md-nav__link">
    4.  Adding a Secret, Hidden Message
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adding-the-label" class="md-nav__link">
    5.  Adding the Label
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-splitting-a-window-into-two-view-panes" class="md-nav__link">
    6.  Splitting a Window into Two View Panes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-view-states-and-making-the-top-pane-active" class="md-nav__link">
    7.  View States, and Making the Top Pane Active
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-adding-a-new-first-row-and-shifting-cells" class="md-nav__link">
    8.  Adding a New First Row and Shifting Cells
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/flywire/lo-p/edit/main/docs/23-Garlic_Secrets.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="chapter-23-garlic-secrets">Chapter 23. Garlic Secrets<a class="headerlink" href="#chapter-23-garlic-secrets" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Freezing Rows;
GeneralFunctions; Sheet
Searching; Sheet Range
Queries; Hidden  Cells;
Cell Merging; Splitting
Windows; View Panes;
View State Data; Active
Panes;  Inserting Rows
and Columns; Shifting
Cells</p>
<p>Example folders: "Calc
Tests" and "Utils"</p>
</div>
<p>This chapter's GarlicSecrets.java example illustrates how
data can be extracted from an existing spreadsheet
("produceSales.xlsx") using 'general' functions, sheet
searching, and sheet range queries. It also has more
examples of cell styling, and demonstrates sheet freezing,
view pane splitting, pane activation, and the insertion of
new rows into a sheet.</p>
<p>The idea for this chapter, and the data, comes from the
Excel example in chapter 12 of "Automate the Boring Stuff with Python" by Al
Sweigart. However, he utilized the Python library OpenPyXL to manipulate his file.</p>
<p>The beginning of the spreadsheet is shown in Figure 1.</p>
<p><img alt="" src="images/23-Garlic_Secrets-1.png" /></p>
<p>Figure 1. Part of the "produceSales.xlsx" Spreadsheet.</p>
<p>Each row holds information about the sale of fruit or vegetables. The columns are the
type of produce sold (column A), the cost per pound of that produce (B), the number
of pounds sold (C), and the total revenue from the sale (D). The TOTAL column is
calculated using a formula which multiplies the cost per pound by the number of
pounds sold, and rounds the result to the nearest cent. For example, cell "D2" contains
"=ROUND(B2*C2, 2)".</p>
<p>Most of the main() function for GarlicSecrets.java is shown below. I'll explain the
commented out parts in later sections:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in GarlicSecrets.java</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">FNM</span> <span class="o">=</span> <span class="s">&quot;produceSales.xlsx&quot;</span><span class="p">;</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">OUT_FNM</span> <span class="o">=</span> <span class="s">&quot;garlicSecrets.ods&quot;</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XSpreadsheetDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">openDoc</span><span class="p">(</span><span class="n">FNM</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not open &quot;</span> <span class="o">+</span> <span class="n">FNM</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">XSpreadsheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheet</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;A1&quot;</span><span class="p">);</span>  <span class="c1">// make sure top of sheet is visible</span>

  <span class="c1">// freeze first 3 rows of view</span>
  <span class="c1">// Calc.freezeRows(doc, 3);</span>

  <span class="c1">// report total for the &quot;Total&quot; column</span>
  <span class="n">XCellRange</span> <span class="n">totalRange</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getColRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
  <span class="kt">double</span> <span class="n">total</span> <span class="o">=</span>
      <span class="n">Calc</span><span class="p">.</span><span class="na">computeFunction</span><span class="p">(</span><span class="n">GeneralFunction</span><span class="p">.</span><span class="na">SUM</span><span class="p">,</span> <span class="n">totalRange</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Total before change: %.2f\n&quot;</span><span class="p">,</span> <span class="n">total</span><span class="p">);</span>

  <span class="n">increaseGarlicCost</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>

  <span class="c1">// recalculate total and print again</span>
  <span class="n">total</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">computeFunction</span><span class="p">(</span><span class="n">GeneralFunction</span><span class="p">.</span><span class="na">SUM</span><span class="p">,</span> <span class="n">totalRange</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Total after change:  %.2f\n&quot;</span><span class="p">,</span> <span class="n">total</span><span class="p">);</span>


  <span class="c1">// add a label at the bottom of the data, and hide it...</span>

  <span class="c1">// split sheet into panes...</span>

  <span class="c1">// make top pane the active one in the first sheet...</span>

  <span class="c1">// add a new first row, and label that as at the bottom...</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">saveDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">OUT_FNM</span><span class="p">);</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">waitEnter</span><span class="p">();</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="1-freezing-rows">1.  Freezing Rows<a class="headerlink" href="#1-freezing-rows" title="Permanent link">&para;</a></h2>
<p>Calc.freezeRows() specifies the number of rows that should be 'frozen' on-screen as
Office's view of the spreadsheet changes (e.g. when the user scrolls downwards). The
function's argument is the number of rows to freeze, not a row index, and the choice
of which rows are frozen depends on which row is currently selected (active) in the
application window when the function is called.</p>
<p>The earlier call to Calc.gotoCell() in main() means that "A1" is the active cell in the
spreadsheet, and so row "1" is the active row (and "A" the active column). For that
reason, Calc.freezeRows(doc, 3) will freeze rows "1", "2", and "3" so they remain in
view when the spreadsheet is scrolled up or down.</p>
<p>Calc.freezeRows() and Calc.freezeCols() are implemented using Calc.freeze():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">freezeRows</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">numRows</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">freeze</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">numRows</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">freezeCols</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">numCols</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">freeze</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">numCols</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">freeze</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                               <span class="kt">int</span> <span class="n">numCols</span><span class="p">,</span> <span class="kt">int</span> <span class="n">numRows</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XViewFreezable</span> <span class="n">xFreeze</span> <span class="o">=</span>
           <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XViewFreezable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">getController</span><span class="p">(</span><span class="n">doc</span><span class="p">));</span>
  <span class="n">xFreeze</span><span class="p">.</span><span class="na">freezeAtPosition</span><span class="p">(</span><span class="n">numCols</span><span class="p">,</span> <span class="n">numRows</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Calc.freeze() accesses the SpreadsheetView service (see Figure 2) via the document's
controller, and utilizes its XViewFreezable interface to call freezeAtPosition().</p>
<p><img alt="" src="images/23-Garlic_Secrets-2.png" /></p>
<p>Figure 2. The SpreadsheetView Services and Interfaces.</p>
<h2 id="2-general-functions">2.  General Functions<a class="headerlink" href="#2-general-functions" title="Permanent link">&para;</a></h2>
<p>Office has a small set of functions (called GeneralFunctions) which can be applied to
cell ranges without the need for formula strings (i.e. a string starting with "=").</p>
<p>They're listed in the enum section at the end of the sheet module at
<a href="https://api.libreoffice.org/docs/idl/ref/namespacecom_1_1sun_1_1star_1_1sheet.html">https://api.libreoffice.org/docs/idl/ref/namespacecom_1_1sun_1_1star_1_1sheet.html</a>,
or use <code>lodoc GeneralFunctions</code>. The more important functions  are shown in Table
1.</p>
<table>
<thead>
<tr>
<th>GeneralFunction Name</th>
<th>Calculation Applied to the Cell Values</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUM</td>
<td>Sum the numerical values.</td>
</tr>
<tr>
<td>COUNT</td>
<td>Count all the values, including the non-numerical ones.</td>
</tr>
<tr>
<td>COUNTNUMS</td>
<td>Count only the numerical values.</td>
</tr>
<tr>
<td>AVERAGE</td>
<td>Average all the numerical values.</td>
</tr>
<tr>
<td>MAX</td>
<td>Find the maximum of all the numerical values.</td>
</tr>
<tr>
<td>MIN</td>
<td>Find the minimum of all the numerical values.</td>
</tr>
<tr>
<td>PRODUCT</td>
<td>Return the product of all the numerical values.</td>
</tr>
<tr>
<td>STDEV</td>
<td>The standard deviation is calculated for the values based</td>
</tr>
<tr>
<td></td>
<td>on using a sample size.</td>
</tr>
<tr>
<td>STDEVP</td>
<td>The standard deviation is calculated for the values based</td>
</tr>
<tr>
<td></td>
<td>on using the entire population.</td>
</tr>
<tr>
<td>VAR</td>
<td>The variance is calculated for the values based on using</td>
</tr>
<tr>
<td></td>
<td>a sample size.</td>
</tr>
<tr>
<td>VARP</td>
<td>The variance is calculated for the values based on using</td>
</tr>
<tr>
<td></td>
<td>the entire population.</td>
</tr>
</tbody>
</table>
<p>Table 1. Some GeneralFunctions.</p>
<p>GeneralFunction.SUM is used in main(), to sum the "TOTALS" column of the
spreadsheet:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in GarlicSecrets.java</span>
<span class="n">XCellRange</span> <span class="n">totalRange</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getColRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="kt">double</span> <span class="n">total</span> <span class="o">=</span>
      <span class="n">Calc</span><span class="p">.</span><span class="na">computeFunction</span><span class="p">(</span><span class="n">GeneralFunction</span><span class="p">.</span><span class="na">SUM</span><span class="p">,</span> <span class="n">totalRange</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Cal.getColRange() utilizes the XColumnRowRange interface to access the sheet as a
series of columns. The required column is extracted from the series via its index
position:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XCellRange</span> <span class="nf">getColRange</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XColumnRowRange</span> <span class="n">crRange</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XColumnRowRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
  <span class="n">XTableColumns</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">crRange</span><span class="p">.</span><span class="na">getColumns</span><span class="p">();</span>  <span class="c1">// get all columns</span>

  <span class="n">XIndexAccess</span> <span class="n">con</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XIndexAccess</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cols</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>   <span class="c1">// get column at idx position</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XCellRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">con</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access range for col pos &quot;</span> <span class="o">+</span><span class="n">idx</span><span class="p">);</span>
     <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getColRange()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The sheet can also be treated as a series of rows by calling
XColumnRowRange.getRows(), as in Calc.getRowRange():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XCellRange</span> <span class="nf">getRowRange</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XColumnRowRange</span> <span class="n">crRange</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XColumnRowRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
  <span class="n">XTableRows</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">crRange</span><span class="p">.</span><span class="na">getRows</span><span class="p">();</span>  <span class="c1">// get all rows</span>
  <span class="n">XIndexAccess</span> <span class="n">con</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XIndexAccess</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">rows</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>  <span class="c1">// get row at idx position</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XCellRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">con</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access range for row pos &quot;</span> <span class="o">+</span><span class="n">idx</span><span class="p">);</span>
     <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getRowRange()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The column returned by <code>Calc.getColRange(sheet,3)</code> includes the cell containing
the word "TOTALS", but GeneralFunction.SUM only sums cells holding numerical
data.</p>
<p>Calc.computeFunction() obtains the XSheetOperation interface for the cell range, and
calls XSheetOperation.computeFunction() to apply a GeneralFunction:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">computeFunction</span><span class="p">(</span><span class="n">GeneralFunction</span> <span class="n">fn</span><span class="p">,</span>
                                       <span class="n">XCellRange</span> <span class="n">cellRange</span><span class="p">)</span>
<span class="p">{</span> <span class="k">try</span> <span class="p">{</span>
    <span class="n">XSheetOperation</span> <span class="n">sheetOp</span> <span class="o">=</span>
                     <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XSheetOperation</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cellRange</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">sheetOp</span><span class="p">.</span><span class="na">computeFunction</span><span class="p">(</span><span class="n">fn</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Compute function failed: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span>
     <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of computeFunction()</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="3-searching-for-the-cost-of-garlic-and-increasing-it">3.  Searching for the Cost of Garlic, and Increasing it<a class="headerlink" href="#3-searching-for-the-cost-of-garlic-and-increasing-it" title="Permanent link">&para;</a></h2>
<p>GarlicSecrets.java increases the "Code per Pound" value for every garlic entry. The
source document uses $1.19 (e.g. see row 6 of Figure 1). Due to a worldwide garlic
shortage, this must be increased by 5% to $1.2495.</p>
<p>increaseGarlicCost() in GarlicSecrets.java scans every used row in the sheet,
examining the "Produce" cell to see if it contains the string "Garlic". When the string
is found, the corresponding "Cost per Pound" entry on that row is changed. When the
scanning reaches an empty cell, the end of the data has been reached, and the function
returns.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in GarlicSecrets.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">increaseGarlicCost</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                      <span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">)</span>
<span class="p">{</span> <span class="kt">int</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">XCell</span> <span class="n">prodCell</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCell</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="p">);</span>
              <span class="c1">// get produce cell in first row</span>
  <span class="n">XCell</span> <span class="n">costCell</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">prodCell</span><span class="p">.</span><span class="na">getType</span><span class="p">()</span> <span class="o">!=</span>  <span class="n">CellContentType</span><span class="p">.</span><span class="na">EMPTY</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// iterate down produce column until an empty cell is reached</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">prodCell</span><span class="p">.</span><span class="na">getFormula</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;Garlic&quot;</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellStr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="p">));</span>
                              <span class="c1">// show the cell on-screen</span>
      <span class="n">costCell</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCell</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="p">);</span>
                              <span class="c1">// change cost/pound entry in the row</span>
      <span class="n">costCell</span><span class="p">.</span><span class="na">setValue</span><span class="p">(</span> <span class="mf">1.05</span><span class="o">*</span> <span class="n">costCell</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span>
      <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">costCell</span><span class="p">,</span> <span class="s">&quot;CharWeight&quot;</span><span class="p">,</span>
                           <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">FontWeight</span><span class="p">.</span><span class="na">BOLD</span><span class="p">);</span>
      <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">costCell</span><span class="p">,</span> <span class="s">&quot;CharColor&quot;</span><span class="p">,</span> <span class="mh">0xFF0000</span><span class="p">);</span>  <span class="c1">// red</span>
    <span class="p">}</span>
    <span class="n">row</span><span class="o">++</span><span class="p">;</span>
    <span class="n">prodCell</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCell</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="p">);</span>
                   <span class="c1">// get produce cell in next row</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">row</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of increaseGarlicCost()</span>
</code></pre></div>
</div>
</div>
</div>
<p>To help the user see that changes have been made to the sheet, the text of each
updated "Cost per Pound" cell is made bold and red. The cell properties being altered
come from the CharacterProperties class.</p>
<p>The progression of the function is also highlighted by calling Calc.gotoCell() inside
the loop. This causes the spreadsheet to scroll down, to follow the changes.</p>
<p>Back in main() after the updates, the "Totals" column is summed once again, and the
new value reported:</p>
<div class="highlight"><pre><span></span><code>Total before change: 231353.57
Total after change:  231488.58
</code></pre></div>
<h2 id="4-adding-a-secret-hidden-message">4.  Adding a Secret, Hidden Message<a class="headerlink" href="#4-adding-a-secret-hidden-message" title="Permanent link">&para;</a></h2>
<p>The change made by increaseGarlicCost() are of a top-secret nature, and so the code
adds an invisible message to the end of the sheet:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in main() of GarlicSecrets.java</span>
    <span class="p">:</span>
<span class="kt">int</span> <span class="n">emptyRowNum</span> <span class="o">=</span> <span class="n">findEmptyRow</span><span class="p">(</span><span class="n">sheet</span><span class="p">);</span>
<span class="n">addGarlicLabel</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="p">);</span>  <span class="c1">// add msg to row</span>

<span class="n">Lo</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>       <span class="c1">// wait a bit before hiding row</span>

<span class="n">XCellRange</span> <span class="n">rowRange</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getRowRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">rowRange</span><span class="p">,</span> <span class="s">&quot;IsVisible&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="p">:</span>
</code></pre></div>
</div>
</div>
</div>
<p>findEmptyRow() returns the index of the first empty row in the sheet, which happens
to be the first row after the end of the data. It passes the index to addGarlicLabel()
which inserts the large red text "Top Secret Garlic Changes" into the first cell on the
row. The message is so big that several cells are merged together to make enough
space; the row's height is also increased. The result is shown in Figure 3.</p>
<p><img alt="" src="images/23-Garlic_Secrets-3.png" /></p>
<p>Figure 3. The Message at the end of the Sheet.</p>
<p>This message is visible for about 2 seconds before it's hidden by setting the height of
the row to 0. This results in Figure 4.</p>
<p><img alt="" src="images/23-Garlic_Secrets-4.png" /></p>
<p>Figure 4. The Hidden Message at the end of the Sheet.</p>
<p>findEmptyRow() utilizes a sheet ranges query to find all the empty cell ranges in the
first column (XCellRangesQuery.queryEmptyCells()). Then it extracts the smallest
row index from those ranges:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in GarlicSecrets.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">findEmptyRow</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// create a cell range spanning the first column of the sheet</span>
  <span class="n">XCellRange</span> <span class="n">colRange</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getColRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">printAddress</span><span class="p">(</span><span class="n">colRange</span><span class="p">);</span>

  <span class="c1">// build query using the column cell range</span>
  <span class="n">XCellRangesQuery</span> <span class="n">crQuery</span> <span class="o">=</span>
                   <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XCellRangesQuery</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">colRange</span><span class="p">);</span>

  <span class="c1">// find all empty cell ranges in the column</span>
  <span class="n">XSheetCellRanges</span> <span class="n">scRanges</span> <span class="o">=</span> <span class="n">crQuery</span><span class="p">.</span><span class="na">queryEmptyCells</span><span class="p">();</span>

  <span class="n">CellRangeAddress</span><span class="o">[]</span> <span class="n">addrs</span> <span class="o">=</span> <span class="n">scRanges</span><span class="p">.</span><span class="na">getRangeAddresses</span><span class="p">();</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">printAddresses</span><span class="p">(</span><span class="n">addrs</span><span class="p">);</span>

  <span class="c1">// find smallest row index in those ranges</span>
  <span class="kt">int</span> <span class="n">row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">addrs</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">row</span>  <span class="o">=</span> <span class="n">addrs</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">.</span><span class="na">StartRow</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">addrs</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="n">addrs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">StartRow</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">addrs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">StartRow</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;First empty row is at position: &quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not find an empty row&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">row</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of findEmptyRow()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The XCellRangesQuery interface needs a cell range to search, which is obtained by
calling Calc.getColRange() to get the first column. The cell range is printed by
Calc.printAddress():</p>
<div class="highlight"><pre><span></span><code>Range: Sheet1.A1:A1048576
</code></pre></div>
<p>The first column extends down to row 1048576.</p>
<p>XCellRangesQuery.queryEmptyCells() returns an XSheetCellRanges object, and an
array of cell range addresses are extracted from it. Calc.printAddresses() prints:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nl">Range</span><span class="p">:</span> <span class="n">Sheet1</span><span class="p">.</span><span class="na">A5001</span><span class="p">:</span><span class="n">A1048576</span>
</code></pre></div>
</div>
</div>
</div>
<p>There's only one empty cell range in the column, starting at row position 5001 and
extending to the bottom of the sheet. This is correct because the produce data is made
up of 5000 records.</p>
<p>findEmptyRow() returns the smallest start row (i.e. 5001).</p>
<h2 id="5-adding-the-label">5.  Adding the Label<a class="headerlink" href="#5-adding-the-label" title="Permanent link">&para;</a></h2>
<p>addGarlicLabel() adds the large text string "Top Secret Garlic Changes" to the first
cell in the supplied row. The cell is made wider by merging a few cells together, made
taller by adjusting the row height, and turned bright red.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:1"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in GarlicSecrets.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addGarlicLabel</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                          <span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span> <span class="kt">int</span> <span class="n">emptyRowNum</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellStr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="p">));</span>
     <span class="c1">// goto first cell of the empty row</span>

  <span class="c1">// merge first few cells of the row</span>
  <span class="n">XCellRange</span> <span class="n">cellRange</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="p">,</span>
                                                  <span class="mi">3</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="p">);</span>
  <span class="n">XMergeable</span> <span class="n">xMerge</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XMergeable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cellRange</span><span class="p">);</span>
  <span class="n">xMerge</span><span class="p">.</span><span class="na">merge</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

  <span class="n">Calc</span><span class="p">.</span><span class="na">setRowHeight</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>  <span class="c1">// make row taller</span>

  <span class="c1">// set text and properties in the cell</span>
  <span class="n">XCell</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCell</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="p">);</span>
  <span class="n">cell</span><span class="p">.</span><span class="na">setFormula</span><span class="p">(</span><span class="s">&quot;Top Secret Garlic Changes&quot;</span><span class="p">);</span>  <span class="c1">// add text</span>

  <span class="c1">// adjust cell text properties</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s">&quot;CharWeight&quot;</span><span class="p">,</span>
                              <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">FontWeight</span><span class="p">.</span><span class="na">BOLD</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s">&quot;CharHeight&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s">&quot;CellBackColor&quot;</span><span class="p">,</span> <span class="mh">0xFF0000</span><span class="p">);</span>  <span class="c1">// red</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s">&quot;HoriJustify&quot;</span><span class="p">,</span> <span class="n">CellHoriJustify</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s">&quot;VertJustify&quot;</span><span class="p">,</span> <span class="n">CellVertJustify</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of addGarlicLabel()</span>
</code></pre></div>
</div>
</div>
</div>
<p>Cell merging requires a cell range, which is obtained by calling the version of
Calc.getCellRange that employs start and end cell positions in (column, row) order.</p>
<p>The range spans the first four cells of the empty row, making it wide enough for the
large text.</p>
<p>The XMergeable  interface is supported by the SheetCellRange service and uses
merge() with a boolean argument to merge or unmerge a cell range.</p>
<p>Changing the cell height affects the entire row, not just the merged cells, and so
Calc.setRowHeight() manipulates a cell range representing the row:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:1"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setRowHeight</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                                        <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XCellRange</span> <span class="n">rowRange</span> <span class="o">=</span> <span class="n">getRowRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">rowRange</span><span class="p">,</span> <span class="s">&quot;Height&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">*</span><span class="mi">100</span><span class="p">);</span>
                                        <span class="c1">// in 1/100 mm units</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>setRowHeight() illustrates the difficulties of finding property documentation. The first
line obtains an XCellRange interface for the row, and the second line changes a
property in the cell range's service. Pretend for a moment, that we don't know the
name of this height property ("Height"). How could we find it?</p>
<p>That depends on finding the cell range's service. First turn to the online
documentation for the XCellRange class, which includes the class diagram shown in
Figure 5 (which can be reached with lodoc XCellRange).</p>
<p><img alt="" src="images/23-Garlic_Secrets-5.png" /></p>
<p>Figure 5. Classes that Inherit XCellRange.</p>
<p>This diagram combines the service and interface inheritance hierarchies. Ignoring the
interfaces that inherit XCellRange  is easy because their names always begin with
"X". The remaining names mean that XCellRange is implemented by almost every
service in the Calc API: CellRange (twice), TableColumn, TableRow, and TextTable.
CellRange appears twice because the blue triangle in the bottom-right corner of the
first CellRange box means that there's more subclass hierarchy that's not shown; in
this case, SheetCellRange, SheetCellCursor, and Spreadsheet. The height property
must be in one of these services, or one of their superclasses.</p>
<p>The correct choice is TableRow because the cell range is representing a spreadsheet
row. TableRow contains four properties, one of which is "Height".</p>
<p>Another approach for finding the service is to call Info.showServices(). For example,
by adding the following line to Calc.setRowHeight():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Info</span><span class="p">.</span><span class="na">showServices</span><span class="p">(</span><span class="s">&quot;Cell range for a row&quot;</span><span class="p">,</span> <span class="n">cellRange</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The following is printed:</p>
<div class="highlight"><pre><span></span><code>Cell range for a row Supported Services (1)
  &quot;com.sun.star.table.TableRow&quot;
</code></pre></div>
<p>Back in addGarlicLabel(), text is stored in the cell, and its properties set. Although
XMergeable changes a cell range into a cell, it doesn't return a reference to that cell. It
can be accessed by calling Calc.getCell():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XCell</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCell</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The various cell properties changed in addGarlicLabel() are inherited from different
classes shown in Figure 6.</p>
<p><img alt="" src="images/23-Garlic_Secrets-6.png" /></p>
<p>Figure 6. The SheetCell Services and Interfaces.</p>
<p>"CharWeight" and "CharHeight" come from CharacterProperties, and
"CellBackColor", "HoriJustify", and "VertJustify" from CellProperties.</p>
<p>Back in main(), the newly created label is hidden after an interval of  2 seconds:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:1"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in main() of GarlicSecrets.java</span>
<span class="n">Lo</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>       <span class="c1">// wait a bit before hiding last row</span>

<span class="n">XCellRange</span> <span class="n">rowRange</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getRowRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">rowRange</span><span class="p">,</span> <span class="s">&quot;IsVisible&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
   <span class="p">:</span>
</code></pre></div>
</div>
</div>
</div>
<p>Row invisibility requires a property change to the row. The row's cell range is
obtained by calling Calc.getRowRange(), and then the "IsVisible" property is
switched off. Finding the name of this property involves the same investigative skills
as the search for "Height" in Calc.setRowHeight(). As with "Height", "IsVisible" is
defined in the TableRow service.</p>
<h2 id="6-splitting-a-window-into-two-view-panes">6.  Splitting a Window into Two View Panes<a class="headerlink" href="#6-splitting-a-window-into-two-view-panes" title="Permanent link">&para;</a></h2>
<p>The produce sales data is quite lengthy, so it's useful to split the window into two
view panes: one showing the modified rows at the end, and the other the first few
rows at the top of the sheet. My first attempt at splitting the sheet is shown in Figure
7.  The division occurs just above row 4999, drawn as a thick dark gray line.</p>
<p><img alt="" src="images/23-Garlic_Secrets-7.png" /></p>
<p>Figure 7. Two Views of the Sheet.</p>
<p>The code in main() of GarlicSecrets.java for this:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:1"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in GarlicSecrets.java</span>
    <span class="p">:</span>
<span class="c1">// split window into 2 view panes</span>
<span class="n">String</span> <span class="n">cellName</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellStr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">emptyRowNum</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Splitting at: &quot;</span> <span class="o">+</span> <span class="n">cellName</span><span class="p">);</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">splitWindow</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">cellName</span><span class="p">);</span>   <span class="c1">// doesn&#39;t work with Calc.freeze()</span>
    <span class="p">:</span>
</code></pre></div>
</div>
</div>
</div>
<p>Calc.splitWindow() can utilize the SpreadsheetView service (see Figure 2), and its
XViewSplitable interface:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:1"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XController</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getController</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">XViewSplitable</span> <span class="n">viewSplit</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XViewSplitable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xController</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Unfortunately, XViewSplitable only offers a splitAtPosition() method which specifies
the split location in terms of pixels. In addition, the interface is deprecated.</p>
<p>A better alternative is to employ the "splitWindow" dispatch command, which has a
"ToPoint" property argument for a cell name (e.g. "A4999") where the split will
occur. Therefore, Calc.splitWindow() is coded as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:1"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">splitWindow</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                      <span class="n">String</span> <span class="n">cellName</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XFrame</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">getController</span><span class="p">(</span><span class="n">doc</span><span class="p">).</span><span class="na">getFrame</span><span class="p">();</span>
  <span class="n">gotoCell</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cellName</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">dispatchCmd</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s">&quot;SplitWindow&quot;</span><span class="p">,</span>
                   <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;ToPoint&quot;</span><span class="p">,</span> <span class="n">cellName</span><span class="p">));</span>
  <span class="p">}</span>  <span class="c1">// end of splitWindow()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">gotoCell</span><span class="p">(</span><span class="n">XFrame</span> <span class="n">frame</span><span class="p">,</span> <span class="n">String</span> <span class="n">cellName</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">Lo</span><span class="p">.</span><span class="na">dispatchCmd</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s">&quot;GoToCell&quot;</span><span class="p">,</span>
                  <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;ToPoint&quot;</span><span class="p">,</span> <span class="n">cellName</span><span class="p">));</span>  <span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>The call to Calc.gotoCell() changes the on-screen active cell. If it's left out then the
"SplitWindow" dispatch creates a split at the currently selected cell rather than the
one stored in the "ToPoint" property. In other words, it appears that the
"SplitWindow" dispatch ignores the property.</p>
<p>Figure 7 shows another problem with the split – the top pane still shows the rows of
data immediately above the split line. I want the top view to show the first rows at the
start of the sheet.</p>
<p>One way of changing the displayed rows is via the view's XViewPane interface (see
Figure 2). Each view (or pane) created by a split is represented by an XViewPane
object, and a collection of all the current panes can be accessed through the
SpreadsheetView service. This approach is implemented in Calc.getViewPanes(),
which returns the collection as an array:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:1"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XViewPane</span><span class="o">[]</span> <span class="nf">getViewPanes</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XIndexAccess</span> <span class="n">con</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XIndexAccess</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">getController</span><span class="p">(</span><span class="n">doc</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">con</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access the view pane container&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">con</span><span class="p">.</span><span class="na">getCount</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No view panes found&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// put each XViewPane obj in container into an array</span>
  <span class="n">XViewPane</span><span class="o">[]</span> <span class="n">panes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XViewPane</span><span class="o">[</span><span class="n">con</span><span class="p">.</span><span class="na">getCount</span><span class="p">()</span><span class="o">]</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">con</span><span class="p">.</span><span class="na">getCount</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">panes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XViewPane</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">con</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
    <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not get view pane &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>  <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">panes</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getViewPanes()</span>

<span class="n">Calc</span><span class="p">.</span><span class="na">getViewPanes</span><span class="p">()</span> <span class="n">is</span> <span class="n">called</span> <span class="n">like</span> <span class="n">so</span><span class="p">:</span>

<span class="n">XViewPane</span><span class="o">[]</span> <span class="n">panes</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getViewPanes</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No of panes: &quot;</span> <span class="o">+</span> <span class="n">panes</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The XViewPane interface has methods for setting and getting the visible row and
column in the view. For example, the first pane can be made to show the first row, by
calling:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:1"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">panes</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">.</span><span class="na">setFirstVisibleRow</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="7-view-states-and-making-the-top-pane-active">7.  View States, and Making the Top Pane Active<a class="headerlink" href="#7-view-states-and-making-the-top-pane-active" title="Permanent link">&para;</a></h2>
<p>The previous section split the window into two panes, and changed the view in the top
pane to show the first rows of the sheet. But there's still a problem which can be seen
in Figure 7 – the active cell is still in the bottom pane, and I want it to be in the first
row of the top pane. More coding is required.</p>
<p>Hidden away in the XController interface are the methods getViewData() and
restoreViewData() . They allow a programmer to access and change the view details
of all the sheets in the document. For example, the following retrieval of the view data
for a document:</p>
<div class="highlight"><pre><span></span><code>XController ctrl = getController(doc);
System.out.println( ctrl.getViewData() );
prints:
100/60/0;0;tw:270;3/13/0/0/0/0/2/0/0/0/1;5/15/0/0/0/0/2/0/0/0/0;0/0/0
/0/0/0/2/0/0/0/0
</code></pre></div>
<p>This can be better understood by separating the data according to the ";'s, producing:</p>
<div class="highlight"><pre><span></span><code>100/60/0
0
tw:270
3/13/0/0/0/0/2/0/0/0/1
5/15/0/0/0/0/2/0/0/0/0
0/0/0/0/0/0/2/0/0/0/0
</code></pre></div>
<p>The first three lines refer to the document's zoom settings, the active sheet index, and
the position of the scrollbar. The fourth line and below give the view state information
for each sheet. In the example document, there are three sheets, so three view state
lines.</p>
<p>Each view state consists of 11 values, separated by "/"s. Their meaning, based on their
index positions:</p>
<ul>
<li>indices 0 and 1 contain the current cursor position in terms of column and row positions;</li>
<li>index 2: this records if column split mode is being used (0 or 1);</li>
<li>3: is row split mode being used? (0 or 1);</li>
<li>4: the vertical split position (in pixels);</li>
<li>5: the horizontal split position (in pixels);</li>
<li>6: the active/focused pane number for this sheet;</li>
<li>7: the left column index of the left-hand panes;</li>
<li>8: the left column index of the right-hand panes;</li>
<li>9: the top row index of the upper panes;</li>
<li>10: the top  row index of the lower panes.</li>
</ul>
<p>A sheet can be split horizontal and/or vertically, which can generate a maximum of
four panes, which are numbered as in Figure 8.</p>
<p><img alt="" src="images/23-Garlic_Secrets-8.png" /></p>
<p>Figure 8. The Four Panes in a Split Window.</p>
<p>If a window is split only horizontally, then numbers 0 and 1 are used. If the split is
only vertical, then the numbers used are 0 and 2.</p>
<p>Only one pane can be active (i.e. have keyboard focus) at a time. For example, in
Figure 8, pane 1 is active. The active pane number is stored in view state index 6.</p>
<p>The view state information at index positions 7 to 10 define the top-left corners of
each pane. For example, since pane 1 is in the top-right of the sheet, its top-left corner
is obtained by combining the values in view state index positions 8 and 9. Position 8
supplies the column index of the two right-hand panes, and position 9 the row index
of the top two panes.</p>
<p>If a sheet is not split at all, then its top-left corner is reconstructed by accessing index
positions 7 and 10.</p>
<p>Although it's possible for a programmer to extract all this information from the view
data string by himself, I've implemented a support class called ViewState which stores
the data in a more easily accessible form. Calc.getViewStates() parses the view data
string, creating an array of ViewState objects, one object for each sheet in the
document. For example, the following code is in GarlicSecrets.java:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:1"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in GarlicSecrets.java</span>
   <span class="p">:</span>
<span class="n">ViewState</span><span class="o">[]</span> <span class="n">states</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getViewStates</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="k">for</span><span class="p">(</span><span class="n">ViewState</span> <span class="n">s</span> <span class="p">:</span> <span class="n">states</span><span class="p">)</span>
  <span class="n">s</span><span class="p">.</span><span class="na">report</span><span class="p">();</span>
</code></pre></div>
</div>
</div>
</div>
<p>When it's executed after the sheet has been split as shown in Figure 7, the following is
printed:</p>
<div class="highlight"><pre><span></span><code>Sheet View State
  Cursor pos (column, row): (0, 4998) or &quot;A4999&quot;
  Sheet is split horizontally at 138
  Number of focused pane: 2
  Left column indices of left/right panes: 0 / 0
  Top row indices of upper/lower panes: 4992 / 4998
</code></pre></div>
<p>One view state is reported since the document only contains one sheet. The output
says that the sheet is split vertically, and the lower pane is active (in focus).</p>
<p>Calc.getViewStates() is implemented as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="22:1"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="__tabbed_22_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">ViewState</span><span class="o">[]</span> <span class="nf">getViewStates</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// get view data from controller</span>
  <span class="n">XController</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="n">getController</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">String</span> <span class="n">viewData</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span> <span class="n">ctrl</span><span class="p">.</span><span class="na">getViewData</span><span class="p">();</span>

  <span class="c1">// split into parts based on &quot;;&quot; delimiter</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">viewParts</span> <span class="o">=</span> <span class="n">viewData</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;;&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">viewParts</span><span class="p">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No sheet view states found in view data&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// build view states array from view data after first 3 entries</span>
  <span class="n">ViewState</span><span class="o">[]</span> <span class="n">states</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ViewState</span><span class="o">[</span><span class="n">viewParts</span><span class="p">.</span><span class="na">length</span><span class="o">-</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">viewParts</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="n">states</span><span class="o">[</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ViewState</span><span class="p">(</span><span class="n">viewParts</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
                       <span class="c1">// construct view state object</span>
  <span class="k">return</span> <span class="n">states</span><span class="p">;</span>
<span class="p">}</span> <span class="c1">// end of getViewStates()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The first three entries in the view data (i.e. the document's zoom, active sheet, and
scrollbar position) are discarded, so only the document's view states are stored.</p>
<p>Paired with Calc.getViewStates() is Calc.setViewStates() which uses an array of
ViewState objects to update the view states of a document. It is coded as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="23:1"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="__tabbed_23_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setViewStates</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                  <span class="n">ViewState</span><span class="o">[]</span> <span class="n">states</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// get view data from controller</span>
  <span class="n">XController</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="n">getController</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">String</span> <span class="n">viewData</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span> <span class="n">ctrl</span><span class="p">.</span><span class="na">getViewData</span><span class="p">();</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">viewParts</span> <span class="o">=</span> <span class="n">viewData</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;;&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">viewParts</span><span class="p">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No sheet states found in view data&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// start building a string holding the modified view data</span>
  <span class="n">StringBuilder</span> <span class="n">vdNew</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="p">();</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>  <span class="c1">// copy first 3 parts unchanged</span>
    <span class="n">vdNew</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">viewParts</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;;&quot;</span><span class="p">);</span>

  <span class="c1">// build rest of string using supplied view states array</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">states</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vdNew</span><span class="p">.</span><span class="na">append</span><span class="p">(</span> <span class="n">states</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>  <span class="c1">//add new state as string</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">states</span><span class="p">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">vdNew</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;;&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// use string to update controller&#39;s view data</span>
  <span class="n">ctrl</span><span class="p">.</span><span class="na">restoreViewData</span><span class="p">(</span><span class="n">vdNew</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
 <span class="p">}</span> <span class="c1">// end of setViewStates()</span>
</code></pre></div>
</div>
</div>
</div>
<p>A new view data string is constructed, and loaded into the document by calling
XController.restoreViewData(). The string is composed from view state strings
obtained by calling ViewState.toString() for each ViewState object. Also, the existing
values for the document's zoom, active sheet, and scrollbar position are copied over
unchanged by extracting their current values from a call to
XController.getViewData().</p>
<p>I'm finally able to change the active pane to be the top view. While I'm at it, I'll also
move the view in that newly activated pane to the top of the sheet:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="24:1"><input checked="checked" id="__tabbed_24_1" name="__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="__tabbed_24_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="c1">// in main() in GarlicSecrets.java</span>
       <span class="p">:</span>
<span class="n">ViewState</span><span class="o">[]</span> <span class="n">states</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getViewStates</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>

<span class="c1">// move focus to top pane in the first sheet</span>
<span class="n">states</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">.</span><span class="na">movePaneFocus</span><span class="p">(</span><span class="n">ViewState</span><span class="p">.</span><span class="na">MOVE_UP</span><span class="p">);</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setViewStates</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">states</span><span class="p">);</span>

<span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;A1&quot;</span><span class="p">);</span>    <span class="c1">// move selection to top cell</span>

<span class="c1">// print revised view states</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getViewStates</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="k">for</span><span class="p">(</span><span class="n">ViewState</span> <span class="n">s</span> <span class="p">:</span> <span class="n">states</span><span class="p">)</span>
  <span class="n">s</span><span class="p">.</span><span class="na">report</span><span class="p">();</span>
</code></pre></div>
 :</p>
</div>
</div>
</div>
<p>The view states are obtained by calling Calc.getViewStates(). The states[] array will
hold one ViewState object for each sheet in the document, so by using states[0] the
panes in the first sheet will be affected. ViewState.movePaneFocus(), which I'll
describe shortly, changes the focus to the top pane. Finally, the modified view states
are written back to the document by Calc.setViewStates().</p>
<p>Figure 9 shows the outcome of this code: the active cell is now in the top pane, at cell
"A1".</p>
<p><img alt="" src="images/23-Garlic_Secrets-9.png" /></p>
<p>Figure 9. A Changed Active Cell and Pane.</p>
<p>The code fragment above also prints out the revised view state, which is:</p>
<div class="highlight"><pre><span></span><code>Sheet View State
  Cursor pos (column, row): (0, 0) or &quot;A1&quot;
  Sheet is split horizontally at 138
  Number of focused pane: 0
  Left column indices of left/right panes: 0 / 0
  Top row indices of upper/lower panes: 0 / 4998
</code></pre></div>
<p>ViewState.movePaneFocus() changes one value in the view state – the focused pane
number (index no. 6 in the list given earlier). I decided not to implement this by
having the programmer supply a pane number  (i.e., 0, 1, 2, or 3 as shown in Figure 8)
since these numbers may not all be used in a given split. Instead the focus change is
specified in terms of a direction, as shown in the code:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="25:1"><input checked="checked" id="__tabbed_25_1" name="__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="__tabbed_25_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the ViewState class</span>

<span class="c1">// globals for moving the pane focus</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MOVE_UP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MOVE_DOWN</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MOVE_LEFT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MOVE_RIGHT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

<span class="kd">private</span> <span class="kt">int</span> <span class="n">focusNum</span><span class="p">;</span>


<span class="kd">public</span> <span class="kt">void</span> <span class="nf">movePaneFocus</span><span class="p">(</span><span class="kt">int</span> <span class="n">dir</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">dir</span> <span class="o">==</span> <span class="n">MOVE_UP</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">focusNum</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
      <span class="n">focusNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">focusNum</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
      <span class="n">focusNum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;cannot move up&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">dir</span> <span class="o">==</span> <span class="n">MOVE_DOWN</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">focusNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">focusNum</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">focusNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">focusNum</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;cannot move down&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">dir</span> <span class="o">==</span> <span class="n">MOVE_LEFT</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">focusNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">focusNum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">focusNum</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
      <span class="n">focusNum</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;cannot move left&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">dir</span> <span class="o">==</span> <span class="n">MOVE_RIGHT</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">focusNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">focusNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">focusNum</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
      <span class="n">focusNum</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;cannot move right&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unknown move direction&quot;</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of movePaneFocus()</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="8-adding-a-new-first-row-and-shifting-cells">8.  Adding a New First Row and Shifting Cells<a class="headerlink" href="#8-adding-a-new-first-row-and-shifting-cells" title="Permanent link">&para;</a></h2>
<p>The final task in GarlicSecrets.java is to add the "Top Secret Garlic Changes" text to
the sheet again, this time as a visible title for the spreadsheet. The only new API
feature used is the insertion of a row. This is done with:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="26:1"><input checked="checked" id="__tabbed_26_1" name="__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="__tabbed_26_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in GarlicSecrets.java</span>
<span class="c1">// add a new first row, and label it</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">insertRow</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">addGarlicLabel</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The addGarlicLabel() method is unchanged from earlier, but is now passed row index
0 rather than the last row. The result is shown in Figure 10.</p>
<p><img alt="" src="images/23-Garlic_Secrets-10.png" /></p>
<p>Figure 10. The Sheet with a New Title Row.</p>
<p>Calc.insertRow()  manipulates a row as a cell range, so it's once again necessary to
access the sheet's XColumnRowRange interface, to retrieve a TableRows object. The
XTableRows interface supports the adding and removal of rows at specified index
positions. This allows Calc.insertRow() to be coded as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="27:1"><input checked="checked" id="__tabbed_27_1" name="__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="__tabbed_27_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">insertRow</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XColumnRowRange</span> <span class="n">crRange</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XColumnRowRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
  <span class="n">XTableRows</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">crRange</span><span class="p">.</span><span class="na">getRows</span><span class="p">();</span>
  <span class="n">rows</span><span class="p">.</span><span class="na">insertByIndex</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>   <span class="c1">// add 1 row at idx position</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>There's a similar Calc.insertCols() method that utilizes the XTableColumns interface:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="28:1"><input checked="checked" id="__tabbed_28_1" name="__tabbed_28" type="radio" /><div class="tabbed-labels"><label for="__tabbed_28_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">insertColumn</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XColumnRowRange</span> <span class="n">crRange</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XColumnRowRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
  <span class="n">XTableColumns</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">crRange</span><span class="p">.</span><span class="na">getColumns</span><span class="p">();</span>
  <span class="n">cols</span><span class="p">.</span><span class="na">insertByIndex</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>   <span class="c1">// add 1 column at idx position</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>The insertion of an arbitrary number of blank cells into a sheet is a bit more
complicated because existing cells must be 'moved' out of the way, and this can be
done by moving them downwards or to the right. The shift-able cells are specified as a
cell range, and the sheet's XCellRangeMovement interface moves them in a specific
direction. XCellRangeMovement is supported by the Spreadsheet service.</p>
<p>The Calc.insertCells() method implements this approach:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="29:1"><input checked="checked" id="__tabbed_29_1" name="__tabbed_29" type="radio" /><div class="tabbed-labels"><label for="__tabbed_29_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">insertCells</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                        <span class="n">XCellRange</span> <span class="n">cellRange</span><span class="p">,</span> <span class="kt">boolean</span> <span class="n">isShiftRight</span><span class="p">)</span>
<span class="cm">/* insert blank cells at cellRange, moving the existing ones</span>
<span class="cm">   to the right or down depending on the boolean argument */</span>
<span class="p">{</span>
  <span class="n">XCellRangeMovement</span> <span class="n">mover</span> <span class="o">=</span>
                       <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XCellRangeMovement</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
  <span class="n">CellRangeAddress</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">getAddress</span><span class="p">(</span><span class="n">cellRange</span><span class="p">);</span>  <span class="c1">// cells to shift</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">isShiftRight</span><span class="p">)</span>   <span class="c1">// move right</span>
    <span class="n">mover</span><span class="p">.</span><span class="na">insertCells</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">CellInsertMode</span><span class="p">.</span><span class="na">RIGHT</span><span class="p">);</span>
  <span class="k">else</span>                <span class="c1">// or move down</span>
    <span class="n">mover</span><span class="p">.</span><span class="na">insertCells</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">CellInsertMode</span><span class="p">.</span><span class="na">DOWN</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of insertCells()</span>
</code></pre></div>
</div>
</div>
</div>
<p>An example call:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="30:1"><input checked="checked" id="__tabbed_30_1" name="__tabbed_30" type="radio" /><div class="tabbed-labels"><label for="__tabbed_30_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XCellRange</span> <span class="n">blanks</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A4999:B5001&quot;</span><span class="p">);</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">insertCells</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">blanks</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>  <span class="c1">// shift right</span>
</code></pre></div>
</div>
</div>
</div>
<p>This shifts the last three rows of the produce sheet (A4999:B5001) to the right by two
cells, producing Figure 11.</p>
<p><img alt="" src="images/23-Garlic_Secrets-11.png" /></p>
<p>Figure 11. Shifted Cells at the end of the Produce Sheet.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="22-Styles.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 22. Styles" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 22. Styles
            </div>
          </div>
        </a>
      
      
        
        <a href="24-Complex_Data_Manipulation.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 24. Complex Data Manipulation" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 24. Complex Data Manipulation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>