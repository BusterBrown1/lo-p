
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 42. Sending E-mail - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-42-sending-e-mail" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 42. Sending E-mail
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 42. Sending E-mail
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="42-Sending_E-mail.html" class="md-nav__link md-nav__link--active">
        Chapter 42. Sending E-mail
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-simplesystemmailsimplecommandmail" class="md-nav__link">
    1.  SimpleSystemMail/SimpleCommandMail
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-using-the-mailserviceprovider-service" class="md-nav__link">
    2.  Using the MailServiceProvider Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-using-javamail" class="md-nav__link">
    3.  Using JavaMail
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-desktop-api" class="md-nav__link">
    4.  The Desktop API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-thunderbird-scripting" class="md-nav__link">
    5.  Thunderbird Scripting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-office-mail-merge" class="md-nav__link">
    6.  Office Mail Merge
  </a>
  
    <nav class="md-nav" aria-label="6.  Office Mail Merge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-preparing-the-mail-merge-inputs" class="md-nav__link">
    6.1.  Preparing the Mail Merge Inputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-programming-the-mail-merge" class="md-nav__link">
    6.2.  Programming the Mail Merge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-specializing-the-merge" class="md-nav__link">
    6.3.  Specializing the Merge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-mergetask-implementing-mail-merging" class="md-nav__link">
    6.4.  mergeTask(): Implementing Mail Merging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-mail-merge-reliability" class="md-nav__link">
    6.5.  Mail Merge Reliability
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-simplesystemmailsimplecommandmail" class="md-nav__link">
    1.  SimpleSystemMail/SimpleCommandMail
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-using-the-mailserviceprovider-service" class="md-nav__link">
    2.  Using the MailServiceProvider Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-using-javamail" class="md-nav__link">
    3.  Using JavaMail
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-desktop-api" class="md-nav__link">
    4.  The Desktop API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-thunderbird-scripting" class="md-nav__link">
    5.  Thunderbird Scripting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-office-mail-merge" class="md-nav__link">
    6.  Office Mail Merge
  </a>
  
    <nav class="md-nav" aria-label="6.  Office Mail Merge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-preparing-the-mail-merge-inputs" class="md-nav__link">
    6.1.  Preparing the Mail Merge Inputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-programming-the-mail-merge" class="md-nav__link">
    6.2.  Programming the Mail Merge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-specializing-the-merge" class="md-nav__link">
    6.3.  Specializing the Merge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-mergetask-implementing-mail-merging" class="md-nav__link">
    6.4.  mergeTask(): Implementing Mail Merging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-mail-merge-reliability" class="md-nav__link">
    6.5.  Mail Merge Reliability
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/42-Sending_E-mail.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-42-sending-e-mail">Chapter 42. Sending E-mail</h1>
<p>The Jargon file is a humorous collection of computer 
slang (online at http://www.catb.org/jargon/html/), and its 
entry for Zawinski's "Law of Software Envelopment" 
(http://www.catb.org/jargon/html/Z/Zawinskis-Law.html) 
came to mind while I was preparing this chapter. It states: 
"Every program attempts to expand until it can 
read mail. Those programs which cannot so 
expand are replaced by ones which can."<br />
Office is a reasonable example (if you replace 'read' with 'send') because, depending 
on how you count things, its API contains three different ways of sending e-mail. If 
you program in Java, the number increases to six! These approaches are summarized 
in Table 1, and none are without drawbacks. </p>
<p>API Services/Classes Used Drawbacks 
Office API<br />
(coded in Java) 
SimpleSystemMail or 
SimpleCommandMail 
User must click "Ok" in a "Confirm" 
dialog before the e-mail is sent. </p>
<p>MailServiceProvider 
(joint best choice) 
Two DLLs must be repositioned in the 
Office installation before the code will 
work. </p>
<p>Firewalls may block it. </p>
<p>MailMerge Works well, but focuses on mail 
merge rather than general purpose e-
mail. </p>
<p>The user must configure Office's e-
mail settings in Writer before the code 
will work. </p>
<p>Java only 
(no use of Office) </p>
<p>JavaMail: Session, 
Message, Transport, and 
others (joint best 
choice) 
Requires the download of the 
javax.mail JAR. </p>
<p>Firewalls may block it.  </p>
<p>Desktop.mail() Attachments are not supported as 
standard in the mailto: protocol. </p>
<p>The e-mail client appears, and the user 
must press "Send". </p>
<p>Process &amp; batch file Needs a separate batch file. </p>
<p>Tied to the Thunderbird e-mail client. </p>
<p>The e-mail client appears, and the user 
must press "Send". </p>
<div class="admonition note">
<p class="admonition-title">Topics</p>
</div>
<p>SimpleSystemMail / 
SimpleCommandMail; 
Using the 
MailServiceProvider 
Service; Using 
JavaMail; The Desktop 
API; Thunderbird 
Scripting; Office Mail 
Merge 
Example folders: "Mail 
Tests" and "Utils" 
Table 1. Office and Java Approaches for Sending E-mail. </p>
<p>My aim is to write a sendMessage() function that sends a text message, optionally 
including a file attachment, to a specified e-mail address. The mail will be sent 
through an SMTP (Simple Mail Transfer Protocol) server that uses STARTTLS to 
encrypt the link. I've tested the code using my local departmental server, and with my 
Gmail account.  </p>
<p>One surprising entry in Table 1 is Office's mail merge, which typically utilizes a 
Writer template file and a spreadsheet (or database) to generate form letters addressed 
to different people. These letters can be saved to files, sent to a printer, or posted out 
as e-mail attachments. It's the last alternative that led me to include mail merging in 
this chapter. </p>
<p>Table 1 identifies two "joint best choice" approaches for sending e-mail. If the mail-
out is part of other Office-related tasks, such as the run-time generation of a 
document, then its best to use Office's MailServiceProvider service since it nicely 
integrates with the rest of the API. However, if you plan to write a standalone e-mail 
application which loads and sends ODF attachments, then JavaMail has more features 
(https://java.net/projects/javamail/pages/Home).  </p>
<p>I'll start this chapter by explaining the Office services for sending e-mail: 
SimpleSystemMail/SimpleCommandMail, and the newer MailServiceProvider. Then 
I'll switch to non-Office approaches, looking first at JavaMail, followed by two 
techniques which don't need an extra JAR file but do require the user to interact with 
the OSes e-mail client. I'll finish with mail merge in Office. </p>
<h2 id="1-simplesystemmailsimplecommandmail">1.  SimpleSystemMail/SimpleCommandMail</h2>
<p>The SimpleSystemMail and SimpleCommandMail services in the system module 
send e-mail using the OSes default e-mail client. They both implement the same 
interfaces, but SimpleSystemMail is for Windows, and SimpleCommandMail for 
Linux and MacOS. Figure 1 shows the services and some of their interfaces. </p>
<p><img alt="" src="images/42-Sending_E-mail-1.png" /></p>
<p>Figure 1. The SimpleSystemMail and SimpleCommandMail Services. </p>
<p>By utilizing the machine's e-mail client, the services don't need the programmer to 
enter the mail server address, its port, and a login and password, since this 
information is in the client's account settings (or user profile). A drawback of this 
approach is that the message passes through the client's GUI, and the user must press 
a "Send" button (or equivalent) to post the message. Fortunately, XSimpleMailClient 
lets the user interface be mostly hidden, but a "Confirm" dialog like the one in Figure 
2 still pops up. </p>
<p><img alt="" src="images/42-Sending_E-mail-2.png" /></p>
<p>Figure 2.  The "Confirm" Dialog when using<br />
SimpleSystemMail/SimpleCommandMail. </p>
<p>This dialog can be disabled via the checkbox shown in Figure 2, but that's a bad idea 
from a security viewpoint. </p>
<p>SimpleSystemMail and SimpleCommandMail are utilized by sendEmailByClient() in 
my Mail.java utility class: </p>
<p>// in the Mail class 
public static void sendEmailByClient(String to, String subject,<br />
                                      String body, String fnm)<br />
{ 
  System.out.println("Sending e-mail by client..."); 
  try { 
    XSimpleMailClientSupplier mcSupp =<br />
        Lo.createInstanceMCF(XSimpleMailClientSupplier.class,<br />
                    "com.sun.star.system.SimpleSystemMail"); 
                       // windows e-mail client service 
    if (mcSupp == null) { 
      mcSupp = Lo.createInstanceMCF( 
                     XSimpleMailClientSupplier.class,<br />
                     "com.sun.star.system.SimpleCommandMail"); 
                   // returns null on Windows; used on Linux/Mac 
      if (mcSupp == null) { 
        System.out.println("Unable to create client"); 
        return; 
      } 
    } </p>
<pre><code>XSimpleMailClient mc = mcSupp.querySimpleMailClient(); 
                // defaults to ThunderBird on my OS

XSimpleMailMessage msg = mc.createSimpleMailMessage(); 
msg.setRecipient(to); 
msg.setSubject(subject);

XSimpleMailMessage2 msg2 = Lo.qi(XSimpleMailMessage2.class, msg); 
msg2.setBody(body);

if (fnm != null) { 
  String[] attachs = new String[1];  
  attachs[0] = FileIO.getAbsolutePath(fnm);  // attachment 
  msg.setAttachement(attachs); 
}

mc.sendSimpleMailMessage(msg,  
               SimpleMailClientFlags.NO_USER_INTERFACE); 
     // hides GUI but still displays a "Confirm" dialog
</code></pre>
<p>} 
  catch(com.sun.star.uno.Exception e) 
  {  System.out.println(e);  } 
}  // end of sendEmailByClient() </p>
<p>The function first tries to instantiate the Windows SimpleSystemMail service, which 
returns null on a Linux/Mac platform, and then switches to SimpleCommandMail 
(which returns null on Windows). The resulting XSimpleMailClientSupplier instance 
is used to obtain a reference to the system's default e-mail client, as represented by 
XSimpleMailClient. </p>
<p>An XSimpleMailMessage object is initialized with the recipient, subject line, body 
text, and optionally attached file. One of the quirks of the API is that the body text is 
added via the XSimpleMailMessage2 subclass of  XSimpleMailMessage. </p>
<p>A typical call to sendEmailByClient(): </p>
<p>// part of LoMailer.java... </p>
<p>Mail.sendEmailByClient("xxx@xxx", "Test", "Body", "skinner.png"); </p>
<p>The default e-mail client on Windows is the application associated with the mailto 
protocol, as depicted in Figure 3. </p>
<p><img alt="" src="images/42-Sending_E-mail-3.png" /></p>
<p>Figure 3. The Default E-mail Client of Windows 7. </p>
<p>A good description of how to set up this association can be found at 
http://www.ubergizmo.com/how-to/set-default-email-client-windows/ </p>
<h2 id="2-using-the-mailserviceprovider-service">2.  Using the MailServiceProvider Service</h2>
<p>The MailServiceProvider service utilizes a Python script called mailmerge.py which 
creates a socket-based link to the specified mail server. If that link utilizes SSL (or its 
successor TLS) for encrypted communication, then your code will probably crash 
with the error message "No SSL support included in this Python".  </p>
<p>This bug (https://bugs.documentfoundation.org/show_bug.cgi?id=77354) is marked 
as "RESOLVED NOTOURBUG" at Office's bugzilla website which seems a bit 
dismissive. The problem appears to be due to the position of Office's application 
folders in Window's PATH environment variable. When Windows searches for two 
DLLs, ssleay32.dll and libeay32.dll, which implement OpenSSL, it may find incorrect 
versions in folders mentioned earlier in PATH. It's these incorrect DLLs that cause 
Python to issue the cryptic error. One solution is to copy the correct DLLs from 
Office's "program\" folder into the "program\python-core-???\lib\" folder (??? is a 
version number, such as 3.3.3), thereby ensuring they're chosen first. </p>
<p>Another issue with switching to MailServiceProvider is that the programmer must 
supply more information  to setup the SMTP connection, namely the address of the 
mail server, its port, and the login and password for accessing the server. </p>
<p>MailServiceProvider is utilized by the Mail.sendEmail() function. Given below are 
examples of how it sends e-mail to my local fivedots.coe.psu.ac.th mail server and to 
the Gmail server at smtp.gmail.com: </p>
<p>// part of LoMailer.java... </p>
<p>Mail.sendEmail("fivedots.coe.psu.ac.th", 25, "ad", password, 
      "xxx@xxx", "Test 1", "Body 1", "skinner.png"); </p>
<p>Mail.sendEmail("smtp.gmail.com", 587,<br />
               "Andrew.Davison50@gmail.com", password, 
      "xxx@xxx","Test 2", "Body 2", "addresses.ods"); </p>
<p>The Mail.sendEmail() arguments are: the mail server address, its port, the login and 
password for the server, the recipient of the mail, the subject line, the body text, and 
an optional attachment filename. </p>
<p>SMTP is built on top of a TCP network link, and in these security conscious days 
many companies and universities (including mine) use firewalls to block everything 
but Web links. That means I cannot use MailServiceProvider to access my Gmail 
account at work since its mail server is beyond my departmental firewall. However, I 
can access the fivedots departmental mail server. </p>
<p>MailServiceProvider is located in the mail module, along with several interfaces. The 
other important service is MailMessage for constructing e-mail messages. Figure 4 
shows the relationships between the services and their interfaces. </p>
<p><img alt="" src="images/42-Sending_E-mail-4.png" /></p>
<p>Figure 4. The MailServiceProvider and MailMessage Services. </p>
<p>An SMTP service is created via the XMailServiceProvider interface: </p>
<p>// part of Mail.sendEmail() 
       : 
XMailServiceProvider msp = 
          Lo.createInstanceMCF(XMailServiceProvider.class, 
                "com.sun.star.mail.MailServiceProvider"); 
if (msp == null) { 
  System.out.println("Could not create MailServiceProvider"); 
  return; 
} </p>
<p>XMailService service = msp.create(MailServiceType.SMTP); 
if (service == null) { 
  System.out.println("Could not create SMTP MailService"); 
  return; 
} </p>
<p>A listener can be attached to the service, to report on its connection status: </p>
<p>// part of Mail.sendEmail() 
      : 
service.addConnectionListener( new XConnectionListener() { 
  public void connected(EventObject e) 
  {  System.out.println("Connected to server " +getServerName(e)); } </p>
<p>public void disconnected(EventObject e) 
  {  System.out.println("  Disconnected"); } </p>
<p>public void disposing(EventObject e) {} 
}); </p>
<p>The connection requires address, port, protocol, login and password details, which are 
supplied through XCurrentContext and XAuthenticator: </p>
<dl>
<dt>// in the Mail class</dt>
<dt>public static void sendEmail(String mailhost, int port,</dt>
<dt>String user, String password,</dt>
<dt>String to, String subject, String body, String fnm)</dt>
<dt>{</dt>
<dd>// service creation code; see above </dd>
</dl>
<p>// initialize service data: context and authenticator 
  XCurrentContext xcc = new XCurrentContext() { 
    public Object getValueByName(String name) 
    { 
      if (name.equals("ServerName")) 
        return (Object) mailhost; 
      else if (name.equals("Port")) 
        return (Object) new Integer(port); 
      else if (name.equals("ConnectionType")) 
        return (Object) "Ssl";     // or "Insecure"; 
      else if (name.equals("Timeout")) 
        return (Object)  new Integer(60); 
      System.out.println("Do not recognize \"" + name + "\""); 
      return null; 
    } 
  }; </p>
<p>XAuthenticator auth = new XAuthenticator() { 
    public String getUserName() 
    { return user;  } 
    public String getPassword() 
    { return password;  } 
  }; </p>
<p>// connect to service 
  service.connect(xcc, auth); 
  System.out.println("Isconnected: " + service.isConnected()); </p>
<p>I've hardwired a time of 60 seconds in XCurrentContext which sets how long the code 
waits for a connection before giving up. </p>
<p>MailMessage utilizes an unusual create() method, and the message's body is 
represented by an XTransferable instance rather than a string: </p>
<p>// part of Mail.sendEmail() 
      : 
String from = user + "@" + mailhost;  // person sending this e-mail 
XMailMessage msg = com.sun.star.mail.MailMessage.create( 
                 Lo.getContext(), to, from, 
                 subject, new TextTransferable(body)); </p>
<p>The online documentation for MailMessage.create() (use "lodoc MailMessage" to 
access it) is misleading in that it doesn’t mention the need for the component context, 
which is obtained with the Lo.getContext() call.  </p>
<p>My TextTransferable class implements the XTransferable interface, which defines 
how different MIME data types are transferred. XTransferable is mainly used in two 
ways – for packaging e-mail data (as here), and for moving data to and from the 
clipboard (which I'll discuss in the next chapter). </p>
<p>TextTransferable lets Unicode text be treated as a transferable: </p>
<p>// in the Utils/ folder 
public class TextTransferable implements XTransferable 
{ 
  private final String text; 
  private final String UNICODE_MIMETYPE ="text/plain;charset=utf-16"; </p>
<p>public TextTransferable(String s) 
  {  text = s;  } </p>
<p>public Object getTransferData(DataFlavor df)<br />
                         throws UnsupportedFlavorException 
  { if (!df.MimeType.equalsIgnoreCase(UNICODE_MIMETYPE)) 
      throw new UnsupportedFlavorException(); 
    return text; 
  } </p>
<p>public DataFlavor[] getTransferDataFlavors() 
  { DataFlavor[] dfs = new DataFlavor[1]; 
    dfs[0] = new DataFlavor(UNICODE_MIMETYPE, "Unicode Text", 
                                      new Type(String.class)); 
    return dfs; 
  } </p>
<p>public boolean isDataFlavorSupported(DataFlavor df) 
  {  return df.MimeType.equalsIgnoreCase(UNICODE_MIMETYPE);  } </p>
<p>}  // end of TextTransferable class </p>
<p>A DataFlavor object hold three fields: the MIME type string for the data (e.g. </p>
<p>"text/plain"), a 'human presentable' name for the data (which can be anything), and the 
corresponding Office data type. </p>
<p>We're not finished with transferable data since an attached file must also be packaged 
in a similar way using Office's MailAttachment class and my FileTransferable class: </p>
<p>// part of Mail.sendEmail() 
if (fnm != null) 
  msg.addAttachment( new MailAttachment( 
                             new FileTransferable(fnm), fnm)); </p>
<p>FileTransferable looks up the MIME type for its supplied file, and stores the file 
contents in a byte array which is returned by getTransferData(): </p>
<p>// in the Utils/ folder 
public class FileTransferable implements XTransferable 
{ 
  private String mimeType = "application/octet-stream";   // default 
  private byte[] fileData = null; </p>
<p>public FileTransferable(String fnm) 
  { <br />
    mimeType = Info.getMIMEType(fnm); 
    try { 
      fileData = Files.readAllBytes( Paths.get(fnm)); 
    } 
    catch(java.lang.Exception e) 
    {  System.out.println("Could not read bytes from " + fnm);  } 
  }  // end of FileTransferable() </p>
<p>public Object getTransferData(DataFlavor df)<br />
                               throws UnsupportedFlavorException 
  { if (!df.MimeType.equalsIgnoreCase(mimeType)) 
      throw new UnsupportedFlavorException(); 
    return fileData; 
  }  // end of getTransferData() </p>
<p>public DataFlavor[] getTransferDataFlavors() 
  { DataFlavor[] flavors = new DataFlavor[1]; 
    flavors[0] = new DataFlavor(mimeType, mimeType,<br />
                                      new Type(byte[].class)); 
    return flavors; 
  } </p>
<p>public boolean isDataFlavorSupported(DataFlavor df) 
  {  return df.MimeType.equalsIgnoreCase(mimeType);  } </p>
<p>}  // end of FileTransferable class </p>
<p>MIME type lookup is implemented by Info.getMIMEType() which uses Java's 
MimetypesFileTypeMap to examine a file of MIME types stored in my Utils/ folder: </p>
<p>// in the Info class 
private static final String MIME_FNM = "mime.types"; </p>
<p>public static String getMIMEType(String fnm) 
{ 
  File f = new File(fnm); 
  try { 
    MimetypesFileTypeMap mftMap = new MimetypesFileTypeMap( 
                          FileIO.getUtilsFolder() + MIME_FNM); 
    return mftMap.getContentType(f); 
  } 
  catch(java.lang.Exception e) 
  {  System.out.println("Could not find " + MIME_FNM); <br />
     return "application/octet-stream";   // better than nothing 
  } 
}  // end of getMIMEType() </p>
<p>Back in Mail.sendEmail(), all that's left to do is to send the message using 
XSmtpService.sendMailMessage(): </p>
<p>// part of Mail.sendEmail()... </p>
<p>XSmtpService smtpService = Lo.qi(XSmtpService.class, service); 
smtpService.sendMailMessage(msg); </p>
<p>service.disconnect(); </p>
<h2 id="3-using-javamail">3.  Using JavaMail</h2>
<p>JavaMail can send and receive e-mail via SMTP, POP3 and IMAP (its website is 
https://java.net/projects/javamail/pages/Home). Although JavaMail is mainly intended 
to be a component of Java EE, it can be downloaded as a single JAR file 
(javax.mail.jar) as an add-on to the JDK. It's being actively developed (the current 
version is 1.5.6, released in mid 2016), and the website has lots of examples (see 
http://java.net/projects/javamail/downloads/download/javamail-samples.zip), a FAQ, 
and API documentation (at https://javamail.java.net/nonav/docs/api/). </p>
<p>The main textbook about JavaMail is: 
JavaMail API 1st Edition 
Elliotte Rusty Harold 
O'Reilly, 2013 
This started out as a chapter in Harold's "Java Network Programming" text, but was 
separated off after the 3rd edition. </p>
<p>Another nice resource if you want to build a GUI e-mail client using JavaMail is 
chapter 5 of The Art of Java by Herbert Schlidt and James Holmes, McGraw Hill, 
2003. </p>
<p>JavaMail utilizes the same approach as mailmerge.py mentioned earlier – it creates an 
SMTP connection using a TCP socket link to a mail server. As such it suffers from 
the same problem with firewalls, which means that I can't use it with my Gmail 
account when I'm at work. </p>
<p>My non-Office e-mail support functions are in JMail.java, and have a similar interface 
to the Office versions. For instance, JMail.sendEmail() is employed to send an e-mail 
with JavaMail. The following two calls use the fivedots and Gmail servers: </p>
<p>// in JMailer.java... </p>
<p>JMail.sendEmail("fivedots.coe.psu.ac.th", 25, "ad", password, 
      "xxx@xxx", "Test 1", "Body 1", "skinner.png"); </p>
<p>JMail.sendEmail("smtp.gmail.com", 587,<br />
               "Andrew.Davison50@gmail.com", password, 
      "xxx@xxx","Test 2", "Body 2", "addresses.ods"); </p>
<p>They're no different from my earlier Mail.sendEmail() examples, except for the name 
of the support class. The arguments are: the mail server address, its port, the login and 
password for the server, the recipient of the mail, the subject line, the body text, and 
an optional attachment. </p>
<p>JavaMail sending is based around three classes: Transport, Session, and Message. </p>
<p>Transport specifies the underlying communication link, while Session handles the 
details of the communication protocol using that link. For example, secure 
communication is setup through properties passed to Session.getInstance(): </p>
<p>// part of JMail.sendEmail()... </p>
<p>Properties props = new Properties(); 
props.put("mail.smtp.starttls.enable", "true"); 
props.put("mail.smtp.ssl.trust", "*");  // no certificate needed 
props.put("mail.smtp.timeout", "60000"); </p>
<p>Session session = Session.getInstance(props); </p>
<p>The mail server address, port, login and password details are used to create a 
SMTPTransport instance (a subclass of Transport): </p>
<p>// part of JMail.sendEmail()... </p>
<p>URLName url = new URLName("smtp", mailhost, port, "",<br />
                                              user, password); 
Transport transport = new SMTPTransport(session, url); 
transport.connect(mailhost, port, user, password); </p>
<p>JavaMail supports two kinds of listeners, one for the connection and the other for 
message delivery. Simple implementations are given in JMail.sendEmail(): </p>
<p>// part of JMail.sendEmail()... </p>
<pre><code>  :
</code></pre>
<p>transport.addConnectionListener( new ConnectionListener() { 
  public void opened(ConnectionEvent e)<br />
  {  System.out.println("  Connection opened to: "+e.getSource()); } </p>
<p>public void disconnected(ConnectionEvent e)<br />
  {  System.out.println("  Connection disconnected"); } </p>
<p>public void closed(ConnectionEvent e)<br />
  {  System.out.println("  Connection closed"); } 
}); </p>
<p>transport.addTransportListener( new TransportListener() { 
  public void messageDelivered(TransportEvent e)<br />
  {  System.out.println("  Message delivered");  } </p>
<p>public void messageNotDelivered(TransportEvent e)<br />
  {  System.out.println("  Message not delivered");  } </p>
<p>public void messagePartiallyDelivered(TransportEvent e)<br />
  {  System.out.println("  Message partially delivered");  } 
}); </p>
<p>An SMTP message has fields for the recipient, subject line, body text, and an optional 
attached file: </p>
<p>// part of JMail.sendEmail() 
      : 
SMTPMessage msg = new SMTPMessage(session); 
msg.setReturnOption(SMTPMessage.RETURN_HDRS); 
msg.setNotifyOptions(SMTPMessage.NOTIFY_SUCCESS | 
                     SMTPMessage.NOTIFY_FAILURE); </p>
<p>msg.setFrom();  // uses default 
msg.setRecipient(Message.RecipientType.TO, new InternetAddress(to)); 
msg.setSentDate(new Date()); 
msg.setSubject(subject); </p>
<p>if (attachFnm == null) 
  msg.setText(body); 
else {   // add body text and file as attachments 
  MimeBodyPart p1 = new MimeBodyPart(); 
  p1.setText(body); </p>
<p>String mimeType = Info.getMIMEType(attachFnm); </p>
<p>MimeBodyPart p2 = new MimeBodyPart(); 
  FileDataSource fds = new FileDataSource(attachFnm); 
  p2.setDataHandler(new DataHandler(fds));  // add data, 
  p2.setFileName(fds.getName());            // filename, 
  p2.setHeader("Content-Type", mimeType);   // MIME type </p>
<p>// create multipart 
  Multipart mp = new MimeMultipart(); 
  mp.addBodyPart(p1);   // for body text<br />
  mp.addBodyPart(p2);   // for the attached file<br />
  msg.setContent(mp); 
} </p>
<p>If the message contains body text and an attachment then it's necessary to add them as 
MimeBodyPart objects in a Multipart container. Body text on its own can be added 
using SMTPMessage.setText().  </p>
<p>The MimeBodyPart holding the attachment must include the file's MIME type in its 
"Content-type" header. </p>
<p>Once the message has been sent, the link is closed: </p>
<p>transport.sendMessage(msg, msg.getAllRecipients()); 
transport.close(); </p>
<h2 id="4-the-desktop-api">4.  The Desktop API</h2>
<p>The Java equivalent of Office's SimpleSystemMail/SimpleCommandMail service is 
the Desktop.mail() method. It utilizes the OSes default e-mail client to post a 
message, which means that there's no need to download the javax.mail JAR. The 
delivery doesn't need to explicitly include the mail server address, port, login, and 
password since they're obtained from the client's settings.  </p>
<p>Desktop.mail() utilizes the mailto protocol to communicate with the client, but its 
specification (in RFC 2368, at http://www.ietf.org/rfc/rfc2368.txt) doesn't cover 
attachments. There are unofficial extensions supported by some clients, but they're not 
part of Thunderbird (but see the next section). </p>
<p>The mailto syntax is: 
"mailto:" recipients [ "?" key "=" value  ("&amp;" key "=" value)* ]<br />
with 
 recipients: comma-separated e-mail addresses without spaces; Outlook needs 
semicolons instead of commas; 
 key: subject, cc, bcc, body (note: there's no attachment keyword); 
 value: URL-encoded text (e.g. space becomes %20). </p>
<p>An example:<br />
mailto:xxx@xxx?subject=Hello&amp;body=How%20are%20you%3F 
Desktop.mail() is employed by JMail.sendEmailByClient(). An example of its use: 
JMail.sendEmailByClient("xxx@xxx", "Hello", "How are you?"); 
There's no way in Desktop to suppress the client's GUI, which appears on-screen, and 
the user must press the "Send" button (or equivalent) to post out the message. </p>
<p>JMail.sendEmailByClient() is: </p>
<p>// in the JMail class 
public static void sendEmailByClient(String to,<br />
                                    String subject, String body) 
{  sendEmailByClient(to, subject, body, null);  } </p>
<p>public static void sendEmailByClient(String to, String subject, <br />
                                     String body, String fnm) 
{<br />
  if (!Desktop.isDesktopSupported()) { 
    System.out.println("Desktop mail not supported"); 
    return; 
  } </p>
<p>// construct "mailto:" string for Desktop.mail() 
  String uriStr = String.format("mailto:%s?subject=%s&amp;body=%s", 
                            encodeMailto(to), encodeMailto(subject),<br />
                            encodeMailto(body) ); 
  if (fnm != null) 
    uriStr += "&amp;attachment=\"" + FileIO.getAbsolutePath(fnm) + "\"";  <br />
  try { 
    Desktop desktop = Desktop.getDesktop(); 
    desktop.mail(new URI(uriStr)); 
  }<br />
  catch (Exception e)<br />
  {  System.out.println(e); } 
}  // end of sendEmailByClient() </p>
<p>public static String encodeMailto(String str)<br />
{ 
  try { 
    return URLEncoder.encode(str, "UTF-8").replace("+", "%20"); 
  }<br />
  catch (UnsupportedEncodingException e) { 
     System.out.println("Could not encode: \"" + str + "\""); 
     return null; 
  } 
}  // end of encodeMailto() </p>
<p>Following the mailto specification, the key values in the mailto string must be URL 
encoded. </p>
<p>sendEmailByClient() has an attachment argument mainly because I've read that some 
clients, such as Outlook, can accept it. But if I try to use an attachment with 
Thunderbird, the call to Desktop.mail() fails. </p>
<h2 id="5-thunderbird-scripting">5.  Thunderbird Scripting</h2>
<p>The reason for my uncertainty about Thunderbird supporting attachments is that 
although it doesn't allow them in "mailto" strings, it can process attachments via its 
GUI, and the command line (see 
http://kb.mozillazine.org/Command_line_arguments_-_Thunderbird). Its command 
line features open up another way of sending e-mail: by having Java execute 
Thunderbird through an external script.  </p>
<p>My Windows batch file, called TBExec.bat, applies various checks to its command 
line arguments, and then invokes Thunderbird using: </p>
<p>thunderbird.exe -compose "to='%1',subject='%2',<br />
                          body='%3',attachment='%CD%\%4'"  </p>
<p>The "attachment" value is an absolute file name. </p>
<p>The Java code uses Runtime.exec() to execute the batch file, passing it three or four 
arguments: </p>
<p>// in the JMail class 
public static void sendEmailByTB(String to, String subject,<br />
                                 String body, String fnm)<br />
{<br />
  String mailExec =<br />
      String.format("cmd /c TBExec.bat %s \"%s\" \"%s\"", 
                                       to, subject, body); 
  if (fnm != null)  // add attachment argument 
    mailExec += " " + fnm; 
  try { 
    Process p = Runtime.getRuntime().exec(mailExec); 
    p.waitFor(); 
    System.out.println("Sent e-mail using Thunderbird"); 
  } 
  catch (java.lang.Exception e) { 
    System.out.println("Unable to send Thunderbird mail: " + e); 
  } 
}  // end of sendEmailByTB() </p>
<p>As with Desktop.mail(), there's no way to stop the Thunderbird GUI from being 
displayed, and the user has to press the "Send" button to send off the message. </p>
<h2 id="6-office-mail-merge">6.  Office Mail Merge</h2>
<p>Mail merge usually involves a spreadsheet of data and a form letter stored as a Writer 
template (an OTT file). Data from the spreadsheet replaces fields in the template, such 
as <Name> and <Address>, with real names and addresses, creating a series of 
personalized letters. Other common uses are to generate labels and envelopes. </p>
<p>After the letters (or labels or envelopes) have been created, they can be saved to files 
(or to a single file), sent to a printer, or attached to e-mails. It's because of this last 
choice that I've included mail merging here. </p>
<p>Figure 5 pictures the mail merge stages in more detail. </p>
<p><img alt="" src="images/42-Sending_E-mail-5.png" /></p>
<p>Figure 5. Mail Merging using a Spreadsheet and a Writer Template. </p>
<h3 id="61-preparing-the-mail-merge-inputs">6.1.  Preparing the Mail Merge Inputs</h3>
<p>Mail merge configuration is most easily done using Office's GUI and wizards, and is 
excellently explained in chapter 11 of the Writer Guide (available from 
https://th.libreoffice.org/get-help/documentation/). </p>
<p>A screenshot of a typical spreadsheet is shown in Figure 6. </p>
<p><img alt="" src="images/42-Sending_E-mail-6.png" /></p>
<p>Figure 6. The addresses.ods Spreadsheet. </p>
<p>The field names employed in the template correspond to column names in the 
spreadsheet (e.g. "Title" and "First Name"). Also, if the merging involves posting out 
of e-mails then there must be an "E-mail" column in the sheet; those addresses will be 
used as the message recipients. </p>
<p>The spreadsheet has to be converted into a data source for the merge. This is done via 
Office's  File &gt; Wizards &gt; Address Data Source menu item, as explained in the Writer 
Guide. The outcome is a new ODB file with the same name as the spreadsheet 
(addresses.odb in my case). This data source can be viewed from inside Calc by 
selecting the menu item View &gt; Data Sources. The GUI display is shown in Figure 7. </p>
<p><img alt="" src="images/42-Sending_E-mail-7.png" /></p>
<p>Figure 7. Addresses.ods with a Data Source. </p>
<p>The "Addresses" data source has been opened to show its "Addresses" table. Both of 
these names will be needed later when we start programming. </p>
<p>The next step is to add fields in the "Addresses" table to the Writer template. This 
involves dragging field names from the top row of the  table over to the template, and 
positioning them in the text. Figure 8 shows part of the resulting template, stored in 
formLetter.ott. </p>
<p><img alt="" src="images/42-Sending_E-mail-8.png" /></p>
<p>Figure 8. Part of formLetter.ott. </p>
<p>The fields are automatically displayed in angled brackets inside gray rectangles.  </p>
<h3 id="62-programming-the-mail-merge">6.2.  Programming the Mail Merge</h3>
<p>The MailMerge service is located in the text module; most of its programming 
involves setting properties, and then calling XJob.execute(). The main services and 
interfaces are shown in Figure 9. </p>
<p><img alt="" src="images/42-Sending_E-mail-9.png" /></p>
<p>Figure 9. The MailMerge Service and Interfaces. </p>
<p>The XMailMergeBroadcaster interface is employed to attach a listener to the merging 
process, and XCancellable can kill the merge. </p>
<p>If you look at the documentation for the MailMerge and DataAccessDescriptor 
services (e.g. use "lodoc MailMerge"), you'll discover many properties in both, and 
that most (but not all) of the DataAccessDescriptor properties are redefined in 
MailMerge. </p>
<p>The coding is summarized by the following snippet from Mail.mergeTask(): </p>
<dl>
<dt>// in Mail.mergeTask()</dt>
<dd>XJob job = Lo.createInstanceMCF(XJob.class,<br />
                             "com.sun.star.text.MailMerge"); </dd>
<dt>XPropertySet props = Lo.qi(XPropertySet.class, job);</dt>
<dt>Props.setProperty(props, "DataSourceName", dataSourceName);</dt>
<dt>Props.setProperty(props, "Command", tableName);</dt>
<dd>// many more properties are set... </dd>
<dd></dd>
</dl>
<p>job.execute(new NamedValue[0]);  </p>
<p>The MailMerge service is created as an XJob interface. Service properties are set, and 
then the merge is carried out by calling XJob.execute(). The NamedValue array is 
empty since there's no need to set any more properties using it. </p>
<h3 id="63-specializing-the-merge">6.3.  Specializing the Merge</h3>
<p>Mail.mergeTask() is passed numerous property values. To simplify its interface, the 
call is hidden inside three other functions called Mail.mergeLetter(), 
Mail.mergePrint(), and Mail.mergeEmail(), which focus on the three different 
outcomes of a merge (see Figure 5). </p>
<p>Mail.mergeLetter() takes four arguments, three of which (data source name, table 
name, template filename) are needed for any kind of merge: </p>
<p>// in  the Mail class 
public static void mergeLetter(String dataSourceName,<br />
                               String tableName, String templateFnm,<br />
                               boolean isSingle) 
{ System.out.println("Merging letters to files..."); 
  mergeTask(dataSourceName, tableName, templateFnm,<br />
          MailMergeType.FILE, 
          isSingle, null, false, null, null, null); 
  }  // end of mergeLetter() </p>
<p>The following call to Mail.mergeLetter() saves six letters as "letter0.odt" to 
"letter5.odt": </p>
<p>// in MailMerge.java... </p>
<p>private static final String DATA_SOURCE_NAME = "Addresses";<br />
private static final String TABLE_NAME = "Addresses";<br />
private static final String TEMPLATE_FNM = "formLetter.ott";  </p>
<p>Mail.mergeLetter(DATA_SOURCE_NAME, TABLE_NAME, TEMPLATE_FNM, false); </p>
<p>I've defined the data source name, table name, and template filename as constants to 
make the call to Mail.mergeLetter() easier to read. The boolean argument specifies 
whether a single file should hold all the generated letters. The generated filenames are 
hardwired inside Mail.mergeTask() to be "letter" and a number. </p>
<p>Six files are created since the spreadsheet (see Figure 6) has six rows of data. </p>
<p>Mail.mergePrint() is passed the same first three arguments (data source name, table 
name, template filename), and a printer name and a boolean to signal whether 
multiple print jobs should be created: </p>
<p>// in MailMerge.java... </p>
<p>Mail.mergePrint(DATA_SOURCE_NAME, TABLE_NAME, TEMPLATE_FNM, 
                "FinePrint", false); </p>
<p>This example will send a single combined print job to the "FinePrint" printer. The 
printer name can be obtained using one of the techniques explained in the previous 
chapter. </p>
<p>Mail.mergePrint() calls Mail.mergeTask() with its printer name and multiple jobs 
boolean arguments set: </p>
<p>// in the Mail class 
public static void mergePrint(String dataSourceName,<br />
                              String tableName, String templateFnm,<br />
                       String printerName, boolean isMultipleJobs) 
{<br />
  System.out.println("Merging letters for printing..."); 
  mergeTask(dataSourceName, tableName, templateFnm,<br />
            MailMergeType.PRINTER, 
           false, printerName, isMultipleJobs, null, null, null); 
}  // end of mergePrint() </p>
<p>Mail.mergeEmail() is passed the data source name, table name, and template filename 
as before, and the mail server's password, e-mail subject line and body string: </p>
<p>// in MailMerge.java... </p>
<p>Mail.mergeEmail(DATA_SOURCE_NAME, TABLE_NAME, TEMPLATE_FNM,<br />
                password,<br />
                "Hello", "Please read the attached message."); </p>
<p>Six e-mails are sent to the addresses listed in the "E-mail" column of the spreadsheet 
(see Figure 6). Each e-mail contains the subject and body text supplied in the call, and 
an attached copy of the personalized letter. </p>
<p>Mail.mergeEmail() calls Mail.mergeTask(): </p>
<p>// in the Mail class 
public static void mergeEmail(String dataSourceName,<br />
                              String tableName, String templateFnm,<br />
                        String passwd, String subject, String body) 
{<br />
  System.out.println("Merging letters for sending as e-mail..."); 
  boolean isConfigured = checkMailConfig(passwd); 
  System.out.println("--&gt; Mailhost is " +<br />
              (isConfigured ? "" : "NOT ") + "configured"); 
  if (isConfigured) 
    mergeTask(dataSourceName, tableName, templateFnm,<br />
              MailMergeType.MAIL, 
              false, null, false, passwd, subject, body); 
}  // end of mergeEmail() </p>
<p>The e-mailing employs the same mailmerge.py Python script as MailServiceProvider, 
which means it will crash when using SSL encryption unless ssleay32.dll and 
libeay32.dll have been copied from Office's "program\" folder into "program\python-
core-???\lib\". Please refer back to section 2 for more details. </p>
<p>mailmerge.py attempts to open a link with the specified mail server at the given port, 
and usually has to supply a login and password to be allowed access. If you look back 
at the arguments passed to Mail.mergeEmail() you can see that the password is 
supplied, but what about the mail server address, its port, and a login name?  The only 
way to specify them is via Writer's option dialog. The relevant windows are shown in </p>
<p><img alt="" src="images/42-Sending_E-mail-10.png" /></p>
<p>Figure 10. </p>
<p><img alt="" src="images/42-Sending_E-mail-10.png" /></p>
<p>Figure 10. Setting Writer E-mail Options. </p>
<p>The left-hand dialog allows the mail server's address and port to be entered 
(fivedots.coe.psu.ac.th and 25). If secure communication is required (i.e. SSL, TLS, or 
STARTTLS), then the secure SSL checkbox is ticked and the "Server Authentication" 
button pressed. A second dialog opens, shown on the right in Figure 10, which lets 
you enter a login and password for accessing the server. It's good practice not to enter 
a password since the data is stored as plain text in "registrymodifications.xcu" in 
Office's user configuration directory (often the folder 
$APPDATA$\LibreOffice\??\user). It's safer to pass the password to 
Mail.mergeTask() at run time, as I've done in Mail.mergeEmail(). </p>
<p>mergeEmail() calls Mail.checkMailConfig() to check if the mail server address, port 
number, username, and password can be found in "registrymodifications.xcu". If the 
first three aren't present then checkMailConfig() returns false and the merge is 
aborted. If the password is found, then a stern warning message is printed, but 
merging continues. </p>
<p>checkMailConfig() calls Info.getRegItemProp() which uses XPath to search through 
"registrymodifications.xcu" for the specified property names and values.  </p>
<h3 id="64-mergetask-implementing-mail-merging">6.4.  mergeTask(): Implementing Mail Merging</h3>
<p>mergeTask() is an expanded version of the code snippet given above which creates an 
XJob instance, sets properties in the MailMerge service, and calls XJob.execute(). </p>
<p>The properties settings are spread across if-tests which determine if the task involves 
file creation, printing, or e-mail. Also, a listener is attached to the merge process. The 
mergeTask() code: </p>
<p>// in the Mail class 
public static void mergeTask(String dataSourceName,<br />
                               String tableName, 
                               String templateFnm,<br />
         short outputType, boolean isSingle,           // for FILE 
         String printerName, boolean isMultipleJobs,   // for PRINTER 
         String passwd, String subject, String body)   // for MAIL 
{<br />
  XJob job = Lo.createInstanceMCF(XJob.class,<br />
                          "com.sun.star.text.MailMerge"); 
  if (job == null) { 
    System.out.println("Could not create MailMerge service"); 
    return; 
  } </p>
<p>XPropertySet props = Lo.qi(XPropertySet.class, job);  </p>
<p>// standard task properties 
  Props.setProperty(props, "DataSourceName", dataSourceName); <br />
  Props.setProperty(props, "Command", tableName); 
  Props.setProperty(props, "CommandType", CommandType.TABLE);<br />
  Props.setProperty(props, "DocumentURL",<br />
                                FileIO.fnmToURL(templateFnm));  </p>
<p>// vary properties based on output type 
  Props.setProperty(props, "OutputType", outputType); 
  if (outputType == MailMergeType.FILE) { 
    Props.setProperty(props, "SaveAsSingleFile", isSingle);  <br />
    Props.setProperty(props, "FileNamePrefix", "letter"); <br />
                                      // hardwired filename 
  } 
  else if (outputType == MailMergeType.PRINTER) { 
    Props.setProperty(props, "SinglePrintJobs", isMultipleJobs); 
                      // true means one print job for each letter 
    PropertyValue[] pProps =<br />
       Props.makeProps("PrinterName", printerName, "Wait", true); <br />
                                        //  synchronous printing 
           // from com.sun.star.view.PrintOptions 
    Props.setProperty(props, "PrintOptions", pProps); 
  } 
  else if (outputType == MailMergeType.MAIL) { 
    if (passwd != null) 
      Props.setProperty(props, "OutServerPassword", passwd); </p>
<pre><code>Props.setProperty(props, "AddressFromColumn", "E-mail");   
                                  // hardwired column name 
Props.setProperty(props, "Subject", subject); 
Props.setProperty(props, "MailBody", body);

Props.setProperty(props, "SendAsAttachment", true); 
Props.setProperty(props, "AttachmentName", "letter.pdf");  
                                // hardwired filename and type 
Props.setProperty(props, "AttachmentFilter",  
                                   "writer_pdf_Export");
</code></pre>
<p>} </p>
<p>// monitor task's execution 
  XMailMergeBroadcaster xmmb =<br />
                       Lo.qi(XMailMergeBroadcaster.class, job); 
  xmmb.addMailMergeEventListener( new XMailMergeListener() 
  { 
    int count = 0; 
    long start = System.currentTimeMillis(); </p>
<pre><code>public void notifyMailMergeEvent(MailMergeEvent e) 
{ count++; 
  XModel model = e.Model; 
  // Props.showProps("Mail merge event", model.getArgs()); 
  long currTime = System.currentTimeMillis(); 
  System.out.println("  Letter " + count + ": " + 
                            (currTime - start) + "ms"); 
  start = currTime; 
}
</code></pre>
<p>}); </p>
<p>try { 
    job.execute(new NamedValue[0]);<br />
  } 
  catch (com.sun.star.uno.Exception e) {<br />
    System.out.println("Could not start executing task: " + e);<br />
  }<br />
}  // end of mergeTask() </p>
<p>There are four properties that are always set:  </p>
<p>Props.setProperty(props, "DataSourceName", dataSourceName); <br />
Props.setProperty(props, "Command", tableName); 
Props.setProperty(props, "CommandType", CommandType.TABLE);<br />
Props.setProperty(props, "DocumentURL",<br />
                              FileIO.fnmToURL(templateFnm));  </p>
<p>These specify the use of a spreadsheet table, the data source name, and the template 
filename (as a URI). </p>
<p>The other properties are divided up based on the MailMergeType constants FILE, 
PRINT, and MAIL (see "lodoc MailMergeType").  </p>
<p>I've hardwired certain properties to reduce the number of arguments that need to be 
passed to Mail.mergeLetter(), Mail.mergePrint(), and Mail.mergeEmail(). </p>
<p>The listener implements the XMailMergeListener interface, and is attached through 
XMailMergeBroadcaster. notifyMailMergeEvent() is called each time a new letter is 
created. For my addresses.ods spreadsheet, it's triggered six times since there are six 
rows of data (see Figure 6). </p>
<p>notifyMailMergeEvent() prints only timing information for each letter task, but more 
details could be obtained by accessing the event's model. </p>
<h3 id="65-mail-merge-reliability">6.5.  Mail Merge Reliability</h3>
<p>Office's  mail merge wizard, which implements the "Office API" parts of Figure 5, 
and so corresponds to my Mail.mergeTask()function, has a long history of crashing.  </p>
<p>Mail.mergeTask() has always worked fine in my tests, except that it displays a 
"LibreOffice has stopped working" error dialog after terminating. However, no 
zombie Office processes are left over, so the dialog can be safely ignored and closed. </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="41-Printing.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 41. Printing
            </div>
          </div>
        </a>
      
      
        <a href="43-Using_the_Clipboard.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 43. Using the Clipboard
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>