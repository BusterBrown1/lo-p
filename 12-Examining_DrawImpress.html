
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 12. Examining a Draw/Impress Document - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-12-examining-a-drawimpress-document" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 12. Examining a Draw/Impress Document
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 12. Examining a Draw/Impress Document
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="12-Examining_DrawImpress.html" class="md-nav__link md-nav__link--active">
        Chapter 12. Examining a Draw/Impress Document
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-accessing-slidespages" class="md-nav__link">
    1.  Accessing Slides/Pages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-page-layers" class="md-nav__link">
    2.  Page Layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-styles" class="md-nav__link">
    3.  Styles
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-accessing-slidespages" class="md-nav__link">
    1.  Accessing Slides/Pages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-page-layers" class="md-nav__link">
    2.  Page Layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-styles" class="md-nav__link">
    3.  Styles
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/12-Examining_DrawImpress.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-12-examining-a-drawimpress-document">Chapter 12. Examining a Draw/Impress Document<a class="headerlink" href="#chapter-12-examining-a-drawimpress-document" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Examining
Slides/Pages; Page
Layers;  Styles</p>
<p>Example folders: "Draw
Tests" and "Utils"</p>
</div>
<p>This chapter describes the SlidesInfo.java example, which
shows the basics of how to open and display a Draw or
Impress file. The code also illustrates how the slides or pages can be examined,
including how to retrieve information on their layers and styles.</p>
<p>The SlidesInfo.java main() function:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Usage: SlidesInfo &lt;filename&gt;&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XComponent</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">openDoc</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not open the file: &quot;</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Draw</span><span class="p">.</span><span class="na">isShapesBased</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;-- not a drawing or slides presentation&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>    <span class="c1">// need delay or zoom may not work</span>

  <span class="n">GUI</span><span class="p">.</span><span class="na">zoom</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">GUI</span><span class="p">.</span><span class="na">ENTIRE_PAGE</span><span class="p">);</span>
         <span class="c1">// or GUI.OPTIMAL, GUI.PAGE_WIDTH, GUI.ENTIRE_PAGE</span>
  <span class="c1">// GUI.zoomValue(doc, 60);   // percentage size</span>

  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\nNo of slides: &quot;</span> <span class="o">+</span>
                          <span class="n">Draw</span><span class="p">.</span><span class="na">getSlidesCount</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>

  <span class="n">XDrawPage</span> <span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">getSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">// access first page</span>

  <span class="n">Size</span> <span class="n">sz</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">getSlideSize</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Size of slide (mm): (&quot;</span> <span class="o">+</span>
                            <span class="n">sz</span><span class="p">.</span><span class="na">Width</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span> <span class="n">sz</span><span class="p">.</span><span class="na">Height</span> <span class="o">+</span> <span class="s">&quot;)\n&quot;</span><span class="p">);</span>
  <span class="n">reportLayers</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">reportStyles</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span> <span class="c1">// end of main()</span>
</code></pre></div>
<p>Lo.openDoc() is capable of opening any Office document, and importing documents
in other formats, so it's worthwhile checking the resulting XComponent object before
progressing. Draw.isShapesBased() returns true if the file holds a Draw or Impress
document:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isShapesBased</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">Info</span><span class="p">.</span><span class="na">isDocType</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">Lo</span><span class="p">.</span><span class="na">DRAW_SERVICE</span><span class="p">)</span> <span class="o">||</span>
          <span class="n">Info</span><span class="p">.</span><span class="na">isDocType</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">Lo</span><span class="p">.</span><span class="na">IMPRESS_SERVICE</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
<p>The document is made visible on-screen by calling GUI.setVisible(), and the
application view is resized so all the drawing (or slide) is visible inside the window.
Draw.zoom() can be passed three different constants for showing the entire width of
the page, the entire page, or an optimal view that zooms in so all the 'data' on the page
is visible without the empty space around it. Alternatively, Draw.zoomValue() allows
the user to supply a zooming percentage.</p>
<p>These two methods are defined using Lo.dispatchCmd(), which was introduced at the
end of Chapter 4:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">zoom</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">,</span> <span class="kt">short</span> <span class="n">view</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">view</span> <span class="o">==</span> <span class="n">OPTIMAL</span><span class="p">)</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">dispatchCmd</span><span class="p">(</span><span class="s">&quot;ZoomOptimal&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">view</span> <span class="o">==</span> <span class="n">PAGE_WIDTH</span><span class="p">)</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">dispatchCmd</span><span class="p">(</span><span class="s">&quot;ZoomPageWidth&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">view</span> <span class="o">==</span> <span class="n">ENTIRE_PAGE</span><span class="p">)</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">dispatchCmd</span><span class="p">(</span><span class="s">&quot;ZoomPage&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Did not recognize zoom view: &quot;</span> <span class="o">+</span>
                              <span class="n">view</span> <span class="o">+</span> <span class="s">&quot;; using optimal&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">dispatchCmd</span><span class="p">(</span><span class="s">&quot;ZoomOptimal&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of zoom()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">zoomValue</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">value</span><span class="p">)</span>
<span class="c1">// zoom to a specific value using a dispatch</span>
<span class="p">{</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">zoomLabels</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Zoom.Value&quot;</span><span class="p">,</span> <span class="s">&quot;Zoom.ValueSet&quot;</span><span class="p">,</span> <span class="s">&quot;Zoom.Type&quot;</span><span class="p">};</span>
  <span class="n">Object</span><span class="o">[]</span> <span class="n">zoomVals</span> <span class="o">=</span> <span class="p">{(</span><span class="kt">short</span><span class="p">)</span><span class="n">value</span><span class="p">,</span> <span class="mi">28703</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">dispatchCmd</span><span class="p">(</span><span class="s">&quot;Zoom&quot;</span><span class="p">,</span> <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="n">zoomLabels</span><span class="p">,</span> <span class="n">zoomVals</span><span class="p">));</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of zoomValue()</span>
</code></pre></div>
<p>I found the four dispatch commands ("ZoomOptimal", "ZoomPageWidth",
"ZoomPage", and "Zoom") by browsing the "Development/DispatchCommands"
documentation page at
<a href="https://wiki.documentfoundation.org/Development/DispatchCommands">https://wiki.documentfoundation.org/Development/DispatchCommands</a>. A great
offline source is the UICommands.ods spreadsheet, put together by Ariel Constenla-
Haile, which can be obtained from
<a href="https://arielch.fedorapeople.org/devel/ooo/UICommands.ods">https://arielch.fedorapeople.org/devel/ooo/UICommands.ods</a>.</p>
<p>Draw.zoomValue() uses the "Zoom" dispatch which requires the setting of properties.
Its "Zoom.Type" parameter can be assigned 0, 1, 2, or 3 which correspond to zooming
in terms of percentages, an optimal view, entire page, or page width. Unfortunately, I
was only able to get the 0 value to work, which is why the others are handled by
Draw.zoom().</p>
<p>The call to Lo.delay() at the end of the zoom methods gives Office time to carry out
the zooming before my code does anything else. The same trick is utilized in the
main() function, after the call to GUI.setVisible().</p>
<h2 id="1-accessing-slidespages">1.  Accessing Slides/Pages<a class="headerlink" href="#1-accessing-slidespages" title="Permanent link">&para;</a></h2>
<p>Most of my Draw class method names include the word 'slide' (e.g.</p>
<p>Draw.getSlidesCount(),  Draw.getSlide(), Draw.getSlideSize()). That's a bit
misleading since most of them will work just as well with Draw or Impress
documents. For example, Draw.getSlidesCount() will return 1 when applied to a
newly created Draw document.</p>
<p>Draw.getSlidesCount() calls Draw.getSlides() which returns an XDrawPages object;
XDrawPages supports a getCount() method:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getSlidesCount</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XDrawPages</span> <span class="n">slides</span> <span class="o">=</span> <span class="n">getSlides</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">slides</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">slides</span><span class="p">.</span><span class="na">getCount</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of getSlidesCount()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XDrawPages</span> <span class="nf">getSlides</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="c1">// return all the pages as an XDrawPages object</span>
<span class="p">{</span>
  <span class="n">XDrawPagesSupplier</span> <span class="n">supplier</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDrawPagesSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">supplier</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">supplier</span><span class="p">.</span><span class="na">getDrawPages</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of getSlides()</span>
</code></pre></div>
<p>getSlides() employs the XDrawPagesSupplier interface which is part of
GenericDrawingDocument shown in Figure 2 of Chapter 11.</p>
<p>Draw.getSlide() (note: no "s") also calls Draw.getSlides(), but treats the XDrawPages
object as an indexed container of XDrawPage objects:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XDrawPage</span> <span class="nf">getSlide</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>   <span class="k">return</span> <span class="n">getSlide</span><span class="p">(</span> <span class="n">getSlides</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">idx</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XDrawPage</span> <span class="nf">getSlide</span><span class="p">(</span><span class="n">XDrawPages</span> <span class="n">slides</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XDrawPage</span> <span class="n">slide</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">slide</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDrawPage</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">slides</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not get slide &quot;</span> <span class="o">+</span> <span class="n">idx</span><span class="p">);</span>  <span class="p">}</span>
  <span class="k">return</span> <span class="n">slide</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getSlide()</span>
</code></pre></div>
<p>Draw.getSlideSize() returns a com.sun.star.awt.Size object created from looking up
the "Width" and "Height" properties of the supplied slide/page:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">Size</span> <span class="nf">getSlideSize</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">xDrawPage</span><span class="p">)</span>
<span class="c1">// get size of the given page (in mm units)</span>
<span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xDrawPage</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">props</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
       <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No slide properties found&quot;</span><span class="p">);</span>
       <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
     <span class="p">}</span>
    <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">Integer</span><span class="p">)</span> <span class="n">props</span><span class="p">.</span><span class="na">getPropertyValue</span><span class="p">(</span><span class="s">&quot;Width&quot;</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="p">(</span><span class="n">Integer</span><span class="p">)</span> <span class="n">props</span><span class="p">.</span><span class="na">getPropertyValue</span><span class="p">(</span><span class="s">&quot;Height&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="n">width</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">height</span><span class="o">/</span><span class="mi">100</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not get page dimensions&quot;</span><span class="p">);</span>
     <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getSlideSize()</span>
</code></pre></div>
<p>These Width" and "Height" properties are stored in XDrawPage's GenericDrawPage
service, shown in Figure 5 of Chapter 11.</p>
<p>My Draw class specifies measurements in millimeters rather than Office's 1/100 mm
units. For instance, Draw.getSlideSize() would return Office page dimensions of
28000 by 21000 as (280, 210).</p>
<h2 id="2-page-layers">2.  Page Layers<a class="headerlink" href="#2-page-layers" title="Permanent link">&para;</a></h2>
<p>A Draw or Impress page consists of five layers called "layout", "controls",
"measurelines", "background", and "backgroundobjects". The first three are described
in the Draw user guide, but"measurelines" is called "Dimension Lines".</p>
<p>Probably "layout" is the most important layer since that's where shapes are located.
Form controls (e.g. buttons) are added to "controls", which is always the top-most
layer. "background", and "backgroundobjects" refer to the master page graphic and
any shapes on that page.</p>
<p>Each layer can be made visible or invisible independent of the others. It's also
possible to create new layers.</p>
<p>reportLayers() in SlidesInfo.java prints each layer's properties:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in SlidesInfo.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">reportLayers</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XLayerManager</span> <span class="n">lm</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">getLayerManager</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">lm</span><span class="p">.</span><span class="na">getCount</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">Props</span><span class="p">.</span><span class="na">showObjProps</span><span class="p">(</span><span class="s">&quot; Layer &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">lm</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">uno</span><span class="p">.</span><span class="na">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{}</span>

  <span class="n">XLayer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">getLayer</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;backgroundobjects&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">showObjProps</span><span class="p">(</span><span class="s">&quot;Background Object Props&quot;</span><span class="p">,</span> <span class="n">layer</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of reportLayers()</span>
</code></pre></div>
<p>Draw.getLayerManager() obtains an XLayerManager instance which can be treated as
an indexed container of XLayer objects. Draw.getLayer() converts the
XLayerManager into a named container, so it can be searched by layer name.</p>
<p>Typical output from reportLayers() is:</p>
<div class="highlight"><pre><span></span><code>Layer 0 Properties
  Description ==
  IsLocked == false
  IsPrintable == true
  IsVisible == true
  Name == layout
  Title ==

 Layer 1 Properties
  Description ==
  IsLocked == false
  IsPrintable == true
  IsVisible == true
  Name == background
  Title ==

 Layer 2 Properties
  Description ==
  IsLocked == false
  IsPrintable == true
  IsVisible == true
  Name == backgroundobjects
  Title ==

 Layer 3 Properties
  Description ==
  IsLocked == false
  IsPrintable == true
  IsVisible == true
  Name == controls
  Title ==

 Layer 4 Properties
  Description ==
  IsLocked == false
  IsPrintable == true
  IsVisible == true
  Name == measurelines
  Title ==

Background Object Props Properties
  Description ==
  IsLocked == false
  IsPrintable == true
  IsVisible == true
  Name == backgroundobjects
  Title ==
</code></pre></div>
<p>Each layer contains six properties. Four are defined by the Layer service; use
<code>lodoc layer service drawing</code> to see its documentation. The most useful property is
probably "IsVisible" which toggles the layer's visibility.</p>
<h2 id="3-styles">3.  Styles<a class="headerlink" href="#3-styles" title="Permanent link">&para;</a></h2>
<p>Draw and Impress utilize the same style organization as text documents, which was
explained in Chapter 6. Figure 1 shows its structure.</p>
<p><img alt="" src="images/12-Examining_DrawImpress-1.png" /></p>
<p>Figure 1. Draw/Impress Style Families and their Property Sets.</p>
<p>The style family names are different from those in text documents. The "Default"
style family corresponds to the styles defined in a document's default master page.</p>
<p>Figure 2 shows this master page in Impress.</p>
<p><img alt="" src="images/12-Examining_DrawImpress-2.png" /></p>
<p>Figure 2. The Default Master Page in Impress.</p>
<p>The master page (also known as a template in Impress' GUI) contains style
information related to the title, seven outline levels and background areas (e.g. the
date, the footer, and the slide number in Figure 2). Not all the master page styles are
shown in Figure 2; for instance, there's a subtitle style, notes area, and a header.</p>
<p>If a slide deck is formatted using a master page (Impress template) other than
"Default", such as "Inspiration", then the style family name will be changed
accordingly. The "Inspiration" family contains the same properties (styles) as
"Default", but with different values.</p>
<p>Details on coding with master pages and Impress templates are given in the
MastersUse.java and PointsBuilder.java examples in Chapter 17.</p>
<p>The other Draw/Impress style families are "cell", "graphics" and "table". "table" and
"cell" contain styles which affect the colors used to draw a table and its cells.
"graphics" affects the appearance of shapes. Examples of how to use the "graphics"
style family are given in the DrawPictures.java example in Chapter 14.</p>
<p>The reportStyles() method inside SlidesInfo.java is:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">reportStyles</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="c1">// report style information: families, styles, properties</span>
<span class="p">{</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">styleNames</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">getStyleFamilyNames</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Style Families in this document:&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">printNames</span><span class="p">(</span><span class="n">styleNames</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">String</span> <span class="n">styleName</span> <span class="p">:</span> <span class="n">styleNames</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">conNames</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">getStyleNames</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">styleName</span><span class="p">);</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Styles in the \&quot;&quot;</span> <span class="o">+</span>
                        <span class="n">styleName</span> <span class="o">+</span> <span class="s">&quot;\&quot; style family:&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">printNames</span><span class="p">(</span><span class="n">conNames</span><span class="p">);</span>
  <span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">  XPropertySet props = Info.getStyleProps(doc,</span>
<span class="cm">                                &quot;Default&quot;, &quot;outline1&quot;);</span>
<span class="cm">  XPropertySet props = Info.getStyleProps(doc,</span>
<span class="cm">                                &quot;graphics&quot;, &quot;objectwitharrow&quot;);</span>
<span class="cm">         // accessing a style causes Office to crash upon exiting</span>
<span class="cm">  Props.showProps(&quot;Object Arrow Properties&quot;, props);   // long</span>
<span class="cm">*/</span>
<span class="p">}</span>  <span class="c1">// end of reportStyles()</span>
</code></pre></div>
<p>The method prints the names of the style families, and the names of the styles
(property sets) inside each family. Typical output is:</p>
<div class="highlight"><pre><span></span><code>Style Families in this document:
  &quot;Inspiration&quot;  &quot;cell&quot;  &quot;graphics&quot;  &quot;table&quot;

Styles in the &quot;Inspiration&quot; style family:
  &quot;background&quot;  &quot;backgroundobjects&quot;  &quot;notes&quot;  &quot;outline1&quot;
  &quot;outline2&quot;  &quot;outline3&quot;  &quot;outline4&quot;  &quot;outline5&quot;
  &quot;outline6&quot;  &quot;outline7&quot;  &quot;outline8&quot;  &quot;outline9&quot;
  &quot;subtitle&quot;  &quot;title&quot;

Styles in the &quot;cell&quot; style family:
  &quot;blue1&quot;  &quot;blue2&quot;  &quot;blue3&quot;  &quot;bw1&quot;
  &quot;bw2&quot;  &quot;bw3&quot;  &quot;default&quot;  &quot;earth1&quot;
  &quot;earth2&quot;  &quot;earth3&quot;  &quot;gray1&quot;  &quot;gray2&quot;
  &quot;gray3&quot;  &quot;green1&quot;  &quot;green2&quot;  &quot;green3&quot;
  &quot;lightblue1&quot;  &quot;lightblue2&quot;  &quot;lightblue3&quot;  &quot;orange1&quot;
  &quot;orange2&quot;  &quot;orange3&quot;  &quot;seetang1&quot;  &quot;seetang2&quot;
  &quot;seetang3&quot;  &quot;sun1&quot;  &quot;sun2&quot;  &quot;sun3&quot;
  &quot;turquoise1&quot;  &quot;turquoise2&quot;  &quot;turquoise3&quot;  &quot;yellow1&quot;
  &quot;yellow2&quot;  &quot;yellow3&quot;

Styles in the &quot;graphics&quot; style family:
 &quot;Object with no fill and no line&quot; &quot;headline&quot; &quot;headline1&quot; &quot;headline2&quot;
  &quot;measure&quot; &quot;objectwitharrow&quot; &quot;objectwithoutfill&quot; &quot;objectwithshadow&quot;
  &quot;standard&quot;  &quot;text&quot;  &quot;textbody&quot;  &quot;textbodyindent&quot;
  &quot;textbodyjustfied&quot;  &quot;title&quot;  &quot;title1&quot;  &quot;title2&quot;

Styles in the &quot;table&quot; style family:
  &quot;blue&quot;  &quot;bw&quot;  &quot;default&quot;  &quot;earth&quot;
  &quot;green&quot;  &quot;lightblue&quot;  &quot;orange&quot;  &quot;seetang&quot;
  &quot;sun&quot;  &quot;turquoise&quot;  &quot;yellow&quot;
</code></pre></div>
<p>The final part of reportStyles() prints the properties for a specified style. The code is
commented out for two reasons – first, the output can be extremely long, but the main
reason is that Office has a problem accessing drawing styles. Although
Info.getStyleProps() works, allowing style properties to be accessed and changed,
Office crashes when the program exits. It's fairly benign since the Office process is
fully terminated, but an error message appears on-screen.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="11-Draw_Impress_APIs.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 11. Draw/Impress APIs Overview" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 11. Draw/Impress APIs Overview
            </div>
          </div>
        </a>
      
      
        
        <a href="13-Basic_Shapes.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 13. Drawing Basic Shapes" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 13. Drawing Basic Shapes
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>