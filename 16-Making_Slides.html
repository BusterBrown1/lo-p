
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/16-Making_Slides.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 16. Making Slides - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-16-making-slides" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 16. Making Slides
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 16. Making Slides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="16-Making_Slides.html" class="md-nav__link md-nav__link--active">
        Chapter 16. Making Slides
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-first-slide-title-and-subtitle" class="md-nav__link">
    1.  The First Slide (Title and Subtitle)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-the-second-slide-title-bullets-and-image" class="md-nav__link">
    2.  The Second Slide (Title, Bullets, and Image)
  </a>
  
    <nav class="md-nav" aria-label="2.  The Second Slide (Title, Bullets, and Image)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-adding-bullets-to-a-text-area" class="md-nav__link">
    2.1.  Adding Bullets to a Text Area
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-offsetting-an-image" class="md-nav__link">
    2.2.  Offsetting an Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-third-slide-title-and-video" class="md-nav__link">
    3.  The Third Slide (Title and Video)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-fourth-slide-title-and-buttons" class="md-nav__link">
    4.  The Fourth Slide (Title and Buttons)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-shape-animation" class="md-nav__link">
    5.  Shape Animation
  </a>
  
    <nav class="md-nav" aria-label="5.  Shape Animation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#more-complex-shape-animations" class="md-nav__link">
    More Complex Shape Animations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-the-fifth-slide-various-dispatch-shapes" class="md-nav__link">
    6.  The Fifth Slide (Various Dispatch Shapes)
  </a>
  
    <nav class="md-nav" aria-label="6.  The Fifth Slide (Various Dispatch Shapes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-viewing-the-fifth-slide" class="md-nav__link">
    6.1.  Viewing the Fifth Slide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-adding-a-dispatch-shape-to-the-visible-page" class="md-nav__link">
    6.2.  Adding a Dispatch Shape to the Visible Page
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-using-jna-to-click-and-drag" class="md-nav__link">
    6.3.  Using JNA to Click and Drag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-things-that-can-go-wrong" class="md-nav__link">
    6.4.  Things that Can Go Wrong
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-3d-shapes-might-be-different-but-arent" class="md-nav__link">
    6.5.  3D Shapes Might be Different (but aren't)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-first-slide-title-and-subtitle" class="md-nav__link">
    1.  The First Slide (Title and Subtitle)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-the-second-slide-title-bullets-and-image" class="md-nav__link">
    2.  The Second Slide (Title, Bullets, and Image)
  </a>
  
    <nav class="md-nav" aria-label="2.  The Second Slide (Title, Bullets, and Image)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-adding-bullets-to-a-text-area" class="md-nav__link">
    2.1.  Adding Bullets to a Text Area
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-offsetting-an-image" class="md-nav__link">
    2.2.  Offsetting an Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-third-slide-title-and-video" class="md-nav__link">
    3.  The Third Slide (Title and Video)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-fourth-slide-title-and-buttons" class="md-nav__link">
    4.  The Fourth Slide (Title and Buttons)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-shape-animation" class="md-nav__link">
    5.  Shape Animation
  </a>
  
    <nav class="md-nav" aria-label="5.  Shape Animation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#more-complex-shape-animations" class="md-nav__link">
    More Complex Shape Animations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-the-fifth-slide-various-dispatch-shapes" class="md-nav__link">
    6.  The Fifth Slide (Various Dispatch Shapes)
  </a>
  
    <nav class="md-nav" aria-label="6.  The Fifth Slide (Various Dispatch Shapes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-viewing-the-fifth-slide" class="md-nav__link">
    6.1.  Viewing the Fifth Slide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-adding-a-dispatch-shape-to-the-visible-page" class="md-nav__link">
    6.2.  Adding a Dispatch Shape to the Visible Page
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-using-jna-to-click-and-drag" class="md-nav__link">
    6.3.  Using JNA to Click and Drag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-things-that-can-go-wrong" class="md-nav__link">
    6.4.  Things that Can Go Wrong
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-3d-shapes-might-be-different-but-arent" class="md-nav__link">
    6.5.  3D Shapes Might be Different (but aren't)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/main/docs/16-Making_Slides.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-16-making-slides">Chapter 16. Making Slides<a class="headerlink" href="#chapter-16-making-slides" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Creating Slides:
title, subtitle, bullets,
images, video, buttons;
Shape Animations;
Dispatch Shapes (special
symbols, block arrows,
3D shapes, flowchart
elements, callouts, and
stars); Slide Viewing</p>
<p>Example folders: "Draw
Tests" and "Utils"</p>
</div>
<p>The MakeSlides.java example creates a deck of five slides,
illustrating different aspects of slide generation:</p>
<ul>
<li>Slide 1. A slide combining a title and subtitle (see
Figure 3);</li>
<li>Slide 2. A slide with a title, bullet points, and an image
(see Figure 4);</li>
<li>Slide 3. A slide with a title, and an embedded video
which plays automatically when that slide appears during a slide show (see Figure
6);</li>
<li>Slide 4. A slide with an ellipse and a rounded rectangle acting as buttons. During a
slide show, clicking on the ellipse starts a video playing in an external viewer.
Clicking on the rounded rectangle causes the slide show to jump to the first slide
in the deck (see Figure 7);</li>
<li>Slide 5. This slide contains eight shapes generated using dispatches, including
special symbols, block arrows, 3D shapes, flowchart elements, callouts, and stars
(see Figure 9).</li>
</ul>
<p>MakeSlides.java creates a slide deck, adds the five slides to it, and finishes by saving
the presentation in "makeslides.odp":</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span> <span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XComponent</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">createImpressDoc</span><span class="p">(</span><span class="n">loader</span><span class="p">);</span>  <span class="c1">// Impress doc</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Impress doc creation failed&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// first slide: title + subtitle</span>
  <span class="n">XDrawPage</span> <span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">getSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">showShapesInfo</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">titleSlide</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Java-Generated Slides&quot;</span><span class="p">,</span>
                                      <span class="s">&quot;Using LibreOffice&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">showShapesInfo</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>

  <span class="c1">// second slide (bullets and image)</span>
  <span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">doBullets</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>

  <span class="c1">// third slide: title and video</span>
  <span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">titleOnlySlide</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Clock Video&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">drawMedia</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;clock.avi&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

  <span class="c1">// fourth slide: buttons</span>
  <span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">buttonShapes</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>

  <span class="c1">// fifth slide: shapes created with dispatches</span>
  <span class="n">dispatchShapes</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>

  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Total no. of slides: &quot;</span> <span class="o">+</span>
                              <span class="n">Draw</span><span class="p">.</span><span class="na">getSlidesCount</span><span class="p">(</span><span class="n">doc</span><span class="p">));</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">saveDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;makeslides.odp&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span> <span class="c1">// end of main()</span>
</code></pre></div>
<p>The five slides are explained in the following sections.</p>
<h2 id="1-the-first-slide-title-and-subtitle">1.  The First Slide (Title and Subtitle)<a class="headerlink" href="#1-the-first-slide-title-and-subtitle" title="Permanent link">&para;</a></h2>
<p>Draw.createImpressDoc() calls Lo.createDoc(), supplying it with the Impress
document string type:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XComponent</span> <span class="nf">createImpressDoc</span><span class="p">(</span><span class="n">XComponentLoader</span> <span class="n">loader</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createDoc</span><span class="p">(</span><span class="s">&quot;simpress&quot;</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
<p>This creates a new slide deck with one slide whose layout depends on Impress' default
settings. Figure 1 shows the usual layout when a user starts Impress.</p>
<p><img alt="" src="images/16-Making_Slides-1.png" /></p>
<p>Figure 1. The Default New Slide in Impress.</p>
<p>The slide contains two empty presentation shapes – the text rectangle at the top is a
TitleTextShape, and the larger rectangle below is a SubTitleShape.</p>
<p>This first slide, which is at index position 0 in the deck, can be referred to by calling
Draw.getSlide():</p>
<div class="highlight"><pre><span></span><code><span class="n">XDrawPage</span> <span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">getSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</code></pre></div>
<p>This is the same method used to get the first page in a Draw document, so I won't go
through it again. The XDrawPage object can be examined by calling
Draw.showShapesInfo() which lists all the shapes (both draw and presentation ones)
on the slide:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">showShapesInfo</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">dp</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Draw Page shapes:&quot;</span><span class="p">);</span>
  <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XShape</span><span class="o">&gt;</span> <span class="n">shapes</span> <span class="o">=</span> <span class="n">getShapes</span><span class="p">(</span><span class="n">dp</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">shapes</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span> <span class="p">:</span> <span class="n">shapes</span><span class="p">)</span>
      <span class="n">showShapeInfo</span><span class="p">(</span><span class="n">shape</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of showShapesInfo()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">showShapeInfo</span><span class="p">(</span><span class="n">XShape</span> <span class="n">xShape</span><span class="p">)</span>
<span class="p">{</span> <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  Shape service: &quot;</span> <span class="o">+</span> <span class="n">xShape</span><span class="p">.</span><span class="na">getShapeType</span><span class="p">()</span> <span class="o">+</span>
                     <span class="s">&quot;; z-order: &quot;</span> <span class="o">+</span> <span class="n">getZOrder</span><span class="p">(</span><span class="n">xShape</span><span class="p">));</span>
<span class="p">}</span>  <span class="c1">// end of showShapeInfo()</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getZOrder</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="p">(</span><span class="n">Integer</span><span class="p">)</span> <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="s">&quot;ZOrder&quot;</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
<p>Draw.showShapesInfo() output for the first slide is:</p>
<div class="highlight"><pre><span></span><code>Draw Page shapes:
  Shape service: com.sun.star.presentation.TitleTextShape; z-order: 0
  Shape service: com.sun.star.presentation.SubtitleShape; z-order: 1
</code></pre></div>
<p>Obviously, the default layout sometimes isn't the one we want. One solution would be
to delete the unnecessary shapes on the slide, then add the shapes that we do want. A
better approach is the programming equivalent of selecting a different slide layout.</p>
<p>This is implemented as several Draw methods, called titleSlide(), bulletsSlide(),
titleOnlySlide(), and blankSlide(), which change the slide's layout to those shown in
Figure 2.</p>
<p><img alt="" src="images/16-Making_Slides-2.png" /></p>
<p>Figure 2. Slide Layout Methods.</p>
<p>A title/subtitle layout is used for the first slide by calling:</p>
<div class="highlight"><pre><span></span><code><span class="n">Draw</span><span class="p">.</span><span class="na">titleSlide</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Java-Generated Slides&quot;</span><span class="p">,</span>
                                       <span class="s">&quot;Using LibreOffice&quot;</span><span class="p">);</span>
</code></pre></div>
<p>It generates the slide shown in Figure 3.</p>
<p><img alt="" src="images/16-Making_Slides-3.png" /></p>
<p>Figure 3. The Title and Subtitle Slide.</p>
<p>Having a Draw.titleSlide() method may seem a bit silly since we've seen that the first
slide already uses this layout (e.g. in Figure 1). That's true for my Impress setup, but
may not be the case for other installations with different configurations.</p>
<p>The other layouts shown on the right of Figure 1 could also be implemented as Draw
methods, but the four in Figure 2 seem most useful. They set the "Layout" property in
the DrawPage service in the com.sun.star.presentation module (not the one in the
drawing module).</p>
<p>The documentation for DrawPage (use <code>lodoc DrawPage presentation service</code>)
only says that "Layout" stores a short; it doesn't list the possible values or how they
correspond to layouts. However, there is a list at the excellent Japanese Office
website,  <a href="https://openoffice3.web.fc2.com/OOoBasic_Impress.html#OOoIPLy01a">https://openoffice3.web.fc2.com/OOoBasic_Impress.html#OOoIPLy01a</a>,
which I used as the basis of the layout constants in my Draw class:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_SUB</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="c1">// title, and subtitle below (the default, usually)</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_BULLETS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
           <span class="c1">// the usual one you want</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_CHART</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_2CONTENT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
                   <span class="c1">// 2 boxes: 1x2  (row x column), 1 row</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_CONTENT_CHART</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_CONTENT_CLIP</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_CHART_CONTENT</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_TABLE</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_CLIP_CONTENT</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_CONTENT_OBJECT</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_OBJECT</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_CONTENT_2CONTENT</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
            <span class="c1">// 3 boxes in 2 columns: 1 in first col, 2 in second</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_OBJECT_CONTENT</span> <span class="o">=</span> <span class="mi">13</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_CONTENT_OVER_CONTENT</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>
            <span class="c1">// 2 boxes: 2x1, 1 column</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_2CONTENT_CONTENT</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
            <span class="c1">// 3 boxes in 2 columns: 2 in first col, 1 in second</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_2CONTENT_OVER_CONTENT</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
            <span class="c1">// 3 boxes on 2 rows: 2 on first row, 1 on second</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_CONTENT_OVER_OBJECT</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_4OBJECT</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>  <span class="c1">// 4 boxes: 2x2</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_ONLY</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
            <span class="c1">// title only; no body shape</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_BLANK</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_VTITLE_VTEXT_CHART</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>
       <span class="c1">// vertical title, vertical text, and chart</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_VTITLE_VTEXT</span> <span class="o">=</span> <span class="mi">28</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_VTEXT</span> <span class="o">=</span> <span class="mi">29</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_VTEXT_CLIP</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_CENTERED_TEXT</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_4CONTENT</span> <span class="o">=</span> <span class="mi">33</span><span class="p">;</span> <span class="c1">// 4 boxes: 2x2</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LAYOUT_TITLE_6CONTENT</span> <span class="o">=</span> <span class="mi">34</span><span class="p">;</span> <span class="c1">// 6 boxes: 2x3</span>
</code></pre></div>
<p>The four constants highlighted above are used by the Draw methods described next.</p>
<p>Draw.titleSlide() starts by setting the slide's "Layout" property to
LAYOUT_TITLE_SUB:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">titleSlide</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">currSlide</span><span class="p">,</span>
                              <span class="n">String</span> <span class="n">title</span><span class="p">,</span> <span class="n">String</span> <span class="n">subTitle</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Layout&quot;</span><span class="p">,</span> <span class="n">LAYOUT_TITLE_SUB</span><span class="p">);</span>
                                 <span class="c1">// title and subtitle</span>

  <span class="c1">// add the title text to the title shape</span>
  <span class="n">XShape</span> <span class="n">xs</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">findShapeByType</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="n">Draw</span><span class="p">.</span><span class="na">TITLE_TEXT</span><span class="p">);</span>
  <span class="n">XText</span> <span class="n">textField</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xs</span><span class="p">);</span>
  <span class="n">textField</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>

  <span class="c1">// add the subtitle text to the subtitle shape</span>
  <span class="n">xs</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">findShapeByType</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="n">Draw</span><span class="p">.</span><span class="na">SUBTITLE_TEXT</span><span class="p">);</span>
  <span class="n">textField</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xs</span><span class="p">);</span>
  <span class="n">textField</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">subTitle</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of titleSlide()</span>
</code></pre></div>
<p>This changes the slide's layout to an empty TitleTextShape and SubtitleShape. The
functions adds title and subtitle strings to these shapes, and returns. The tricky part  is
obtaining a reference to a particular shape so it can be modified.</p>
<p>One (bad) solution is to use the index ordering of the shapes on the slide, which is
displayed by Draw.showShapesInfo(). It turns out that TitleTextShape is first (i.e. at
index 0), and SubtitleShape second. This can be used to write the following code:</p>
<div class="highlight"><pre><span></span><code><span class="n">XShapes</span> <span class="n">xShapes</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XShapes</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">currSlide</span><span class="p">);</span>

<span class="n">XShape</span> <span class="n">titleShape</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XShape</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xShapes</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="n">XShape</span> <span class="n">subTitleShape</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XShape</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xShapes</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
</code></pre></div>
<p>This is a bit hacky, so I coded Draw.findShapeByType() instead, which searches for a
shape based on its type:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">findShapeByType</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span>
                                     <span class="n">String</span> <span class="n">shapeType</span><span class="p">)</span>
<span class="p">{</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XShape</span><span class="o">&gt;</span> <span class="n">shapes</span> <span class="o">=</span> <span class="n">getShapes</span><span class="p">(</span><span class="n">slide</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">shapes</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No shapes were found in the draw page&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span> <span class="p">:</span> <span class="n">shapes</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">shapeType</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">shape</span><span class="p">.</span><span class="na">getShapeType</span><span class="p">()))</span>
      <span class="k">return</span> <span class="n">shape</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No shape found of type \&quot;&quot;</span> <span class="o">+</span>
                                        <span class="n">shapeType</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of findShapeByType()</span>
</code></pre></div>
<p>I added constants to the Draw class so the programmer wouldn't have to remember
long shape type names:</p>
<p><div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TITLE_TEXT</span> <span class="o">=</span>
                   <span class="s">&quot;com.sun.star.presentation.TitleTextShape&quot;</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SUBTITLE_TEXT</span> <span class="o">=</span>
                   <span class="s">&quot;com.sun.star.presentation.SubtitleShape&quot;</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">BULLETS_TEXT</span> <span class="o">=</span>
</code></pre></div>
                   "com.sun.star.presentation.OutlinerShape";</p>
<p>This allows me to find the title shape by calling:</p>
<div class="highlight"><pre><span></span><code><span class="n">XShape</span> <span class="n">xs</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">findShapeByType</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="n">Draw</span><span class="p">.</span><span class="na">TITLE_TEXT</span><span class="p">);</span>
</code></pre></div>
<h2 id="2-the-second-slide-title-bullets-and-image">2.  The Second Slide (Title, Bullets, and Image)<a class="headerlink" href="#2-the-second-slide-title-bullets-and-image" title="Permanent link">&para;</a></h2>
<p>The second slide uses a title and bullet points layout, with an image added at the
bottom right corner. The relevant lines in MakeSlides.java are:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in main() in MakeSlides.java...</span>
<span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">doBullets</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>
</code></pre></div>
<p>The result is shown in Figure 4.</p>
<p><img alt="" src="images/16-Making_Slides-4.png" /></p>
<p>Figure 4. A Slide with a Title, Bullet Points, and an Image.</p>
<p>The slide is created by doBullets() in MakeSlides.java:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in MakeSlides.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">doBullets</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">currSlide</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XText</span> <span class="n">body</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">bulletsSlide</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
                                 <span class="s">&quot;What is an Algorithm?&quot;</span><span class="p">);</span>

  <span class="c1">// bullet levels are 0, 1, 2,...</span>

  <span class="n">Draw</span><span class="p">.</span><span class="na">addBullet</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;An algorithm is a finite</span>
<span class="s">                          set of unambiguous instructions</span>
<span class="s">                          for solving a problem.&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">addBullet</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;An algorithm is correct if on</span>
<span class="s">                          all legitimate inputs, it outputs</span>
<span class="s">                          the right answer in a finite amount</span>
<span class="s">                          of time&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">addBullet</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Can be expressed as&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">addBullet</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;pseudocode&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">addBullet</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;flow charts&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">addBullet</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;text in a natural language</span>
<span class="s">                                          (e.g. English)&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">addBullet</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;computer code&quot;</span><span class="p">);</span>

  <span class="c1">// add the image</span>
  <span class="n">XShape</span> <span class="n">im</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawImageOffset</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;skinner.png&quot;</span><span class="p">,</span>
                                               <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
            <span class="c1">// in bottom right corner, and scaled if necessary</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">moveToBottom</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="n">im</span><span class="p">);</span>  <span class="c1">//move pic below slide text</span>
<span class="p">}</span>  <span class="c1">// end of doBullets()</span>
</code></pre></div>
<p>Draw.bulletsSlide() works in a similar way to Draw.titleSlide() – first the slide's
layout is set, then the presentation shapes are found and modified:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XText</span> <span class="nf">bulletsSlide</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">currSlide</span><span class="p">,</span> <span class="n">String</span> <span class="n">title</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Layout&quot;</span><span class="p">,</span> <span class="n">LAYOUT_TITLE_BULLETS</span><span class="p">);</span>

  <span class="c1">// add the title text to the title shape</span>
  <span class="n">XShape</span> <span class="n">xs</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">findShapeByType</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="n">Draw</span><span class="p">.</span><span class="na">TITLE_TEXT</span><span class="p">);</span>
  <span class="n">XText</span> <span class="n">textField</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xs</span><span class="p">);</span>
  <span class="n">textField</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>

  <span class="c1">// return a reference to the bullet text area</span>
  <span class="n">xs</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">findShapeByType</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="n">Draw</span><span class="p">.</span><span class="na">BULLETS_TEXT</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xs</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of bulletsSlide()</span>
</code></pre></div>
<p>The <code>Draw.LAYOUT_TITLE_BULLETS</code> constant changes the slide's layout to contain
two presentation shapes – a TitleTextShape at the top, and an OutlinerShape beneath
it (as in the second picture in Figure 2). Draw.bulletsSlide() calls
Draw.findShapeByType() twice to find these shapes, but it does nothing to the
OutlinerShape itself, returning it as an XText reference. This allows text to be inserted
into the shape by other code (i.e. by Draw.addBullet()).</p>
<h3 id="21-adding-bullets-to-a-text-area">2.1.  Adding Bullets to a Text Area<a class="headerlink" href="#21-adding-bullets-to-a-text-area" title="Permanent link">&para;</a></h3>
<p>Draw.addBullet() converts the shape's XText reference into an XTextRange, which
offers a setString() method:</p>
<div class="highlight"><pre><span></span><code>  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addBullet</span><span class="p">(</span><span class="n">XText</span> <span class="n">bullsText</span><span class="p">,</span> <span class="kt">int</span> <span class="n">level</span><span class="p">,</span>
                                                     <span class="n">String</span> <span class="n">text</span><span class="p">)</span>
  <span class="p">{</span> <span class="c1">// access the end of the bullets text</span>
    <span class="n">XTextRange</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTextRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="n">bullsText</span><span class="p">).</span><span class="na">getEnd</span><span class="p">();</span>

    <span class="c1">// set the bullet&#39;s level</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="s">&quot;NumberingLevel&quot;</span><span class="p">,(</span><span class="kt">short</span><span class="p">)</span><span class="n">level</span><span class="p">);</span>

    <span class="n">tr</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">text</span> <span class="o">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>  <span class="c1">// add the text</span>
  <span class="p">}</span>  <span class="c1">// end of addBullet()</span>
</code></pre></div>
<p>As explained in Chapter 5, XTextRange is part of the TextRange service which
inherits both paragraph and character property classes, as indicated by Figure 5.</p>
<p><img alt="" src="images/16-Making_Slides-5.png" /></p>
<p>Figure 5. The TextRange Service.</p>
<p>A look through the ParagraphProperties documentation reveals a "NumberingLevel"
property which affects the displayed bullet level (use <code>lodoc ParagraphProperties</code>).</p>
<p>Another way of finding out about the properties associated with XTextRange is to use
my Props.showObjProps() to list all of them:</p>
<div class="highlight"><pre><span></span><code><span class="n">Props</span><span class="p">.</span><span class="na">showObjProps</span><span class="p">(</span><span class="s">&quot;TextRange in OutlinerShape&quot;</span><span class="p">,</span> <span class="n">tr</span><span class="p">);</span>
</code></pre></div>
<p>The bullet text is added with XTextRange.setString(). A newline is added to the text
before the set, to ensure that the string is treated as a complete paragraph. The
drawback is that the newline causes an extra bullet symbol to be drawn after the real
bullet points. This can be seen in Figure 4, at the bottom of the slide. (Principal
Skinner is pointing at it.)</p>
<h3 id="22-offsetting-an-image">2.2.  Offsetting an Image<a class="headerlink" href="#22-offsetting-an-image" title="Permanent link">&para;</a></h3>
<p>The AnimBicycle.java example in Chapter 14 employed a version of
Draw.drawImage() based around specifying an (x, y) position on the page and a width
and height for the image frame. Draw.drawImageOffset() used here is a variant which
specifies its position in terms of fractional offsets from the top-left corner of the slide.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="n">XShape</span> <span class="n">im</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawImageOffset</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;skinner.png&quot;</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
</code></pre></div>
<p>The last two arguments mean that the image's top-left corner will be placed at a point
that is 0.6 of the slide's width across and 0.5 of its height down. drawImageOffset()
also scales the image so that it doesn't extend beyond the right and bottom edges of
the slide. The scaling is the same along both dimensions so the picture isn't distorted.</p>
<p>The code for Draw.drawImageOffset():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">drawImageOffset</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span>
                <span class="n">String</span> <span class="n">imFnm</span><span class="p">,</span> <span class="kt">double</span> <span class="n">xOffset</span><span class="p">,</span> <span class="kt">double</span> <span class="n">yOffset</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">xOffset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">xOffset</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;xOffset should be between 0-1; using 0.5&quot;</span><span class="p">);</span>
    <span class="n">xOffset</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">yOffset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">yOffset</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;yOffset should be between 0-1; using 0.5&quot;</span><span class="p">);</span>
    <span class="n">yOffset</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Size</span> <span class="n">slideSize</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">getSlideSize</span><span class="p">(</span><span class="n">slide</span><span class="p">);</span>  <span class="c1">// in mm units</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">slideSize</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Image drawing cannot proceed&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Math</span><span class="p">.</span><span class="na">round</span><span class="p">(</span><span class="n">slideSize</span><span class="p">.</span><span class="na">Width</span> <span class="o">*</span> <span class="n">xOffset</span><span class="p">);</span> <span class="c1">//in mm units</span>
  <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Math</span><span class="p">.</span><span class="na">round</span><span class="p">(</span><span class="n">slideSize</span><span class="p">.</span><span class="na">Height</span> <span class="o">*</span> <span class="n">yOffset</span><span class="p">);</span>

  <span class="kt">int</span> <span class="n">maxWidth</span> <span class="o">=</span> <span class="n">slideSize</span><span class="p">.</span><span class="na">Width</span> <span class="o">-</span> <span class="n">x</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">maxHeight</span> <span class="o">=</span> <span class="n">slideSize</span><span class="p">.</span><span class="na">Height</span> <span class="o">-</span> <span class="n">y</span><span class="p">;</span>
  <span class="n">Size</span> <span class="n">imSize</span> <span class="o">=</span> <span class="n">Images</span><span class="p">.</span><span class="na">calcScale</span><span class="p">(</span><span class="n">imFnm</span><span class="p">,</span> <span class="n">maxWidth</span><span class="p">,</span> <span class="n">maxHeight</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">drawImage</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="n">imFnm</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                         <span class="n">imSize</span><span class="p">.</span><span class="na">Width</span><span class="p">,</span> <span class="n">imSize</span><span class="p">.</span><span class="na">Height</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of drawImageOffset()</span>
</code></pre></div>
<p>drawImageOffset()  uses the slide's size to determine an (x, y) position for the image,
and its width and height. Images.calcScale() calculates the best width and height for
the image frame such that the image will be drawn entirely on the slide:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Images class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">Size</span> <span class="nf">calcScale</span><span class="p">(</span><span class="n">String</span> <span class="n">fnm</span><span class="p">,</span> <span class="kt">int</span> <span class="n">maxWidth</span><span class="p">,</span>
                                             <span class="kt">int</span> <span class="n">maxHeight</span><span class="p">)</span>
<span class="p">{</span> <span class="n">Size</span> <span class="n">imSize</span> <span class="o">=</span> <span class="n">Images</span><span class="p">.</span><span class="na">getSize100mm</span><span class="p">(</span><span class="n">fnm</span><span class="p">);</span>   <span class="c1">// in 1/100 mm units</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">imSize</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>

  <span class="c1">// calculate the scale factors to obtain these maximums</span>
  <span class="kt">double</span> <span class="n">widthScale</span> <span class="o">=</span> <span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">maxWidth</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="n">imSize</span><span class="p">.</span><span class="na">Width</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">heightScale</span> <span class="o">=</span> <span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">maxHeight</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="n">imSize</span><span class="p">.</span><span class="na">Height</span><span class="p">;</span>

  <span class="c1">// use the smallest scale factor</span>
  <span class="kt">double</span> <span class="n">scaleFactor</span> <span class="o">=</span> <span class="p">(</span><span class="n">widthScale</span> <span class="o">&lt;</span> <span class="n">heightScale</span><span class="p">)</span> <span class="o">?</span>
                                      <span class="n">widthScale</span> <span class="p">:</span> <span class="n">heightScale</span><span class="p">;</span>
  <span class="c1">// calculate new dimensions for the image</span>
  <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Math</span><span class="p">.</span><span class="na">round</span><span class="p">(</span><span class="n">imSize</span><span class="p">.</span><span class="na">Width</span> <span class="o">*</span> <span class="n">scaleFactor</span><span class="o">/</span><span class="mi">100</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Math</span><span class="p">.</span><span class="na">round</span><span class="p">(</span><span class="n">imSize</span><span class="p">.</span><span class="na">Height</span> <span class="o">*</span> <span class="n">scaleFactor</span><span class="o">/</span><span class="mi">100</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of calcScale()</span>
</code></pre></div>
<p>calcScale() uses Images.getSize100mm() to retrieve the size of the image in 1/100
mm units, and then a scale factor is calculated for both the width and height. This is
used to set the image frame's dimensions when the graphic is loaded by drawImage().</p>
<h2 id="3-the-third-slide-title-and-video">3.  The Third Slide (Title and Video)<a class="headerlink" href="#3-the-third-slide-title-and-video" title="Permanent link">&para;</a></h2>
<p>The third slide consists of a title shape and a video frame, which looks like Figure 6.</p>
<p><img alt="" src="images/16-Making_Slides-6.png" /></p>
<p>Figure 6. A Slide Containing a Video Frame.</p>
<p>When this slide appears in a slide show, the video will automatically start playing.</p>
<p>The code for generating this slide is:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// main() of MakeSlides.java...</span>
<span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">Draw</span><span class="p">.</span><span class="na">titleOnlySlide</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Clock Video&quot;</span><span class="p">);</span>
<span class="n">Draw</span><span class="p">.</span><span class="na">drawMedia</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;clock.avi&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
</code></pre></div>
<p>Draw.titleOnlySlide()  works in a similar way to titleSlide() and bulletsSlide():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">titleOnlySlide</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">currSlide</span><span class="p">,</span> <span class="n">String</span> <span class="n">header</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Layout&quot;</span><span class="p">,</span> <span class="n">LAYOUT_TITLE_ONLY</span><span class="p">);</span>
                                  <span class="c1">// title only; no body shape</span>
  <span class="c1">// add the text to the title shape</span>
  <span class="n">XShape</span> <span class="n">xs</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">findShapeByType</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="n">Draw</span><span class="p">.</span><span class="na">TITLE_TEXT</span><span class="p">);</span>
  <span class="n">XText</span> <span class="n">textField</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xs</span><span class="p">);</span>
  <span class="n">textField</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">header</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of titleOnlySlide()</span>
</code></pre></div>
<p>The MediaShape service doesn't appear in the Office documentation. Perhaps one
reason for its absence is that the shape behaves a little 'erratically'. In particular,
although MakeSlides.java successfully builds a slide deck containing the video,
Office crashes upon exiting. Also, when the deck is run as a slide show, the video
frame is sometimes incorrectly placed, although the video plays correctly.</p>
<p>Draw.drawMedia() is defined as:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">drawMedia</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span> <span class="n">String</span> <span class="n">fnm</span><span class="p">,</span>
                            <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span>
<span class="c1">// causes Office to crash on exiting</span>
<span class="p">{</span>
  <span class="n">XShape</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">addShape</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="s">&quot;MediaShape&quot;</span><span class="p">,</span>
                                       <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
  <span class="c1">// Props.showObjProps(&quot;Shape&quot;, shape);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Loading media: \&quot;&quot;</span> <span class="o">+</span> <span class="n">fnm</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="s">&quot;MediaURL&quot;</span><span class="p">,</span> <span class="n">FileIO</span><span class="p">.</span><span class="na">fnmToURL</span><span class="p">(</span><span class="n">fnm</span><span class="p">));</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="s">&quot;Loop&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">shape</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of drawMedia()</span>
</code></pre></div>
<p>In the absence of documentation, I used Props.showObjProps() to list the properties
for the MediaShape:</p>
<div class="highlight"><pre><span></span><code><span class="n">Props</span><span class="p">.</span><span class="na">showObjProps</span><span class="p">(</span><span class="s">&quot;Shape&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
</code></pre></div>
<p>The "MediaURL" property requires a file in URL format, and "Loop" is a boolean for
making the animation play repeatedly.</p>
<p>Office supports the AVI and WMV video formats, but not MP4.</p>
<h2 id="4-the-fourth-slide-title-and-buttons">4.  The Fourth Slide (Title and Buttons)<a class="headerlink" href="#4-the-fourth-slide-title-and-buttons" title="Permanent link">&para;</a></h2>
<p>The fourth slide has two 'buttons' – an ellipse which starts a video playing in an
external application, and a rounded rectangle which makes the presentation jump to
the first slide. These actions are both implemented using the "OnClick" property for
presentation shapes. Figure 7 shows how the slide looks.</p>
<p><img alt="" src="images/16-Making_Slides-7.jpg" /></p>
<p>Figure 7. A Slide with Two 'Buttons'.</p>
<p>The relevant code in main() of MakeSlides.java is:</p>
<div class="highlight"><pre><span></span><code><span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">buttonShapes</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>
</code></pre></div>
<p>This button approach to playing a video doesn't suffer from the strange behavior when
using MediaShape on the third slide.</p>
<p>The buttonShapes() method in MakeSlides.java creates the slide:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in MakeSlides.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">buttonShapes</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">currSlide</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">titleOnlySlide</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Wildlife Video Via Button&quot;</span><span class="p">);</span>

  <span class="c1">// button in the center of the slide</span>
  <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Size</span> <span class="n">sz</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">getSlideSize</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
  <span class="n">XShape</span> <span class="n">ellipse</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawEllipse</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="p">(</span><span class="n">sz</span><span class="p">.</span><span class="na">Width</span><span class="o">-</span><span class="n">width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">sz</span><span class="p">.</span><span class="na">Height</span><span class="o">-</span><span class="n">height</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">addText</span><span class="p">(</span><span class="n">ellipse</span><span class="p">,</span> <span class="s">&quot;Start Video&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>

  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">ellipse</span><span class="p">,</span> <span class="s">&quot;OnClick&quot;</span><span class="p">,</span> <span class="n">ClickAction</span><span class="p">.</span><span class="na">DOCUMENT</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">ellipse</span><span class="p">,</span> <span class="s">&quot;Bookmark&quot;</span><span class="p">,</span>
                        <span class="n">FileIO</span><span class="p">.</span><span class="na">fnmToURL</span><span class="p">(</span><span class="s">&quot;wildlife.wmv&quot;</span><span class="p">));</span>

  <span class="c1">// draw a rounded rectangle with text</span>
  <span class="n">XShape</span> <span class="n">button</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawRectangle</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
           <span class="n">sz</span><span class="p">.</span><span class="na">Width</span><span class="o">-</span><span class="n">width</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">sz</span><span class="p">.</span><span class="na">Height</span><span class="o">-</span><span class="n">height</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">addText</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="s">&quot;Click to go\nto Slide 1&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">setGradientColor</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="s">&quot;Radial red/yellow&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="s">&quot;CornerRadius&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span> <span class="c1">// 1/100 mm units</span>

  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="s">&quot;OnClick&quot;</span><span class="p">,</span> <span class="n">ClickAction</span><span class="p">.</span><span class="na">FIRSTPAGE</span><span class="p">);</span>
     <span class="c1">// clicking makes the presentation jump to first slide</span>
<span class="p">}</span>  <span class="c1">// end of buttonShapes()</span>
</code></pre></div>
<p>A minor point of interest is that a rounded rectangle is a RectangleShape, but with its
"CornerRadius" property set.</p>
<p>The more important part of the method is the two uses of the "OnClick" property from
the presentation Shape class.</p>
<p>Clicking on the ellipse executes the video file "wildlife.wmv". This requires
"OnClick" to be assigned the ClickAction.DOCUMENT constant, and "Bookmark" to
refer to the file as an URL.</p>
<p>Clicking on the rounded rectangle causes the slide show to jump back to the first
page. This needs "OnClick" to be set to ClickAction.FIRSTPAGE.</p>
<p>Several other forms of click action are listed in Table 1.</p>
<table>
<thead>
<tr>
<th>ClickAction</th>
<th>Name Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td>NONE</td>
<td>No action is performed on the click.</td>
</tr>
<tr>
<td></td>
<td>Animation and fade effects are also switched off.</td>
</tr>
<tr>
<td>PREVPAGE</td>
<td>The presentation jumps to the previous page.</td>
</tr>
<tr>
<td>NEXTPAGE</td>
<td>The presentation jumps to the next page.</td>
</tr>
<tr>
<td>FIRSTPAGE</td>
<td>The presentation continues with the first page.</td>
</tr>
<tr>
<td>LASTPAGE</td>
<td>The presentation continues with the last page.</td>
</tr>
<tr>
<td>BOOKMARK</td>
<td>The presentation jumps to a bookmark.</td>
</tr>
<tr>
<td>DOCUMENT</td>
<td>The presentation jumps to another document.</td>
</tr>
<tr>
<td>INVISIBLE</td>
<td>The object renders itself invisible after a click.</td>
</tr>
<tr>
<td>SOUND</td>
<td>A sound is played after a click.</td>
</tr>
<tr>
<td>VERB</td>
<td>An OLE verb is performed on this object.</td>
</tr>
<tr>
<td>VANISH</td>
<td>The object vanishes with its effect.</td>
</tr>
<tr>
<td>PROGRAM</td>
<td>Another program is executed after a click.</td>
</tr>
<tr>
<td>MACRO</td>
<td>An Office macro is executed after the click.</td>
</tr>
<tr>
<td>STOPPRESENTATION</td>
<td>The presentation is stopped after the click.</td>
</tr>
</tbody>
</table>
<p>Table 1. ClickAction Effects.</p>
<p>Table 1 shows that it's possible to jump to various places in a slide show, and also
execute macros and external programs. In both cases, the "Bookmark" property is
used to specify the URL of the macro or program. For example, the following will
invoke Windows' calculator when the button is pressed:</p>
<div class="highlight"><pre><span></span><code><span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="s">&quot;OnClick&quot;</span><span class="p">,</span> <span class="n">ClickAction</span><span class="p">.</span><span class="na">PROGRAM</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="s">&quot;Bookmark&quot;</span><span class="p">,</span>
           <span class="n">FileIO</span><span class="p">.</span><span class="na">fnmToURL</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getenv</span><span class="p">(</span><span class="s">&quot;SystemRoot&quot;</span><span class="p">)</span> <span class="o">+</span>
                           <span class="s">&quot;\\System32\\calc.exe&quot;</span><span class="p">)</span> <span class="p">);</span>
</code></pre></div>
<p>"Bookmark" requires an absolute path to the application, converted to URL form.</p>
<p>The ClickAction documentation can be reached using <code>lodoc ClickAction</code>, which
loads the IDL webpage for the enumeration. Clicking on the "ClickAction" enum
name takes you to a table very like the one in Table 1.</p>
<h2 id="5-shape-animation">5.  Shape Animation<a class="headerlink" href="#5-shape-animation" title="Permanent link">&para;</a></h2>
<p>Shape animations are performed during a slide show, and are regulated through three
presentation Shape properties: "Effect", "Speed" and "TextEffect".</p>
<p>"Effect" can be assigned a large range of animation effects, which are defined as
constants in the AnimationEffect enumeration. Use <code>lodoc AnimationEffect</code>  to
reach the presentation Shape service, then browse for its "Effect" property.</p>
<p>Alternatively, you can find details in the com.sun.star.presentation module (use
<code>lodoc presentation module</code>). Another nice summary, in the form of a large table, is in the
Developer's Guide at
<a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/Drawings/Animations_and_Interactions/">https://wiki.openoffice.org/wiki/Documentation/DevGuide/Drawings/Animations_and_Interactions/</a>
(use <code>loGuide "Animations and Interactions"</code>). Figure 8 shows part of that table.</p>
<p><img alt="" src="images/16-Making_Slides-8.png" /></p>
<p>Figure 8. Part of the AnimationEffect Constants Table
in the Developer's Guide.</p>
<p>There are two broad groups of effects: those that move a shape onto the slide when the
page appears, and fade effects that make a shape gradually appear in a given spot.</p>
<p>The following code fragment makes the ellipse on the fourth slide fade into view,
starting with the bottom of the shape:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in buttonShapes() in MakeSlides.java</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">ellipse</span><span class="p">,</span> <span class="s">&quot;Effect&quot;</span><span class="p">,</span>
                      <span class="n">AnimationEffect</span><span class="p">.</span><span class="na">FADE_FROM_BOTTOM</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">ellipse</span><span class="p">,</span> <span class="s">&quot;Speed&quot;</span><span class="p">,</span> <span class="n">AnimationSpeed</span><span class="p">.</span><span class="na">SLOW</span><span class="p">);</span>
</code></pre></div>
<p>The animation speed can be set to AnimationSpeed.SLOW,
AnimationSpeed.MEDIUM, or AnimationSpeed.FAST.</p>
<p>Unfortunately, there seems to be a problem saving these effects in the presentation file
("makeSlides.odp") created by MakeSlides.java. When that file is opened as a slide
show, no animation effects occur – the ellipse is simply displayed.</p>
<p>It seems that the shape animation properties are not saved to the ODP file, because
when the ellipse is examined inside Impress, its "Custom Animation" task pane is
empty.</p>
<h4 id="more-complex-shape-animations">More Complex Shape Animations<a class="headerlink" href="#more-complex-shape-animations" title="Permanent link">&para;</a></h4>
<p>If you browse chapter 9 of the Impress user's guide on slide shows, its animation
capabilities extend well beyond the constants in AnimationEffect. These features are
available through the XAnimationNode interface, which is obtained like so:</p>
<div class="highlight"><pre><span></span><code><span class="n">XAnimationNodeSupplier</span> <span class="n">nodeSupp</span> <span class="o">=</span>
                 <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XAnimationNodeSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">slide</span><span class="p">);</span>
<span class="n">XAnimationNode</span> <span class="n">slideNode</span> <span class="o">=</span> <span class="n">nodeSupp</span><span class="p">.</span><span class="na">getAnimationNode</span><span class="p">();</span>
</code></pre></div>
<p>XAnimationNode allows a programmer much finer control over animation timings
and animation paths for shapes. XAnimationNode is part of the large
com.sun.star.animations package (see <code>lodoc animations module</code>). I won't be use
XAnimationNode here.</p>
<h2 id="6-the-fifth-slide-various-dispatch-shapes">6.  The Fifth Slide (Various Dispatch Shapes)<a class="headerlink" href="#6-the-fifth-slide-various-dispatch-shapes" title="Permanent link">&para;</a></h2>
<p>The fifth slide is a hacky, slow solution for generating the numerous shapes in
Impress' GUI which have no corresponding classes in the API. The approach uses
dispatch commands, JNA, and Java's Robot class (first described back in Chapter 4).</p>
<p>The resulting slide is shown in Figure 9.</p>
<p><img alt="" src="images/16-Making_Slides-9.jpg" /></p>
<p>Figure 9. Shapes Created by Dispatch Commands.</p>
<p>The shapes in Figure 9 are just a few of the many available via Impress' "Drawing
Toolbar", shown in Figure 10. The relevant menus are labeled and their sub-menus
are shown beneath the toolbar.</p>
<p><img alt="" src="images/16-Making_Slides-10.png" /></p>
<p>Figure 10. The Shapes Available from the Drawing Toolbar.</p>
<p>Each sub-menu shape has a name which appears in a tooltip when the cursor is placed
over the shape's icon. This text turns out to be very useful when writing the dispatch
commands.</p>
<p>There's also a "3D-Objects" toolbar which offers the shapes in Figure 11.</p>
<p><img alt="" src="images/16-Making_Slides-11.jpg" /></p>
<p>Figure 11. The 3D-Objects Toolbar.</p>
<p>Some of these 3D shapes are available in the API as undocumented Shape subclasses,
but I was unable to programmatically resize the shapes to make them visible. The
only way I could get them to appear at a reasonable size was by creating them with
dispatch commands.</p>
<p>Although there's no mention of these custom and 3D shapes in the Developer's Guide,
their dispatch commands do appear in the UICommands.ods spreadsheet (available
from <a href="https://arielch.fedorapeople.org/devel/ooo/UICommands.ods">https://arielch.fedorapeople.org/devel/ooo/UICommands.ods</a>). They're also
mentioned, in less detail, in the online documentation for Impress dispatches at
<a href="https://wiki.documentfoundation.org/Development/DispatchCommands#Impress_slots_.28sdslots.29">https://wiki.documentfoundation.org/Development/DispatchCommands#Impress_slots_.28sdslots.29</a>.</p>
<p>It's quite easy to match up the tooltip names in the GUI with the dispatch names. For
example, the smiley face in the Symbol shapes menu is called "Smiley Face" in the
GUI and ".uno:SymbolShapes.smiley" in the UICommands spreadsheet.</p>
<p>MakeSlides.java generates the eight shapes in Figure 9 by calling dispatchShapes():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in MakeSlides.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">dispatchShapes</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XDrawPage</span> <span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">titleOnlySlide</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Dispatched Shapes&quot;</span><span class="p">);</span>

  <span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">wait</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">gotoPage</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">currSlide</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Viewing Slide number: &quot;</span> <span class="o">+</span>
       <span class="n">Draw</span><span class="p">.</span><span class="na">getSlideNumber</span><span class="p">(</span><span class="n">Draw</span><span class="p">.</span><span class="na">getViewedPage</span><span class="p">(</span><span class="n">doc</span><span class="p">)));</span>

  <span class="c1">// first row</span>
  <span class="n">XShape</span> <span class="n">dShape</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addDispatchShape</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
                      <span class="s">&quot;BasicShapes.diamond&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>

  <span class="n">Draw</span><span class="p">.</span><span class="na">addDispatchShape</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
                      <span class="s">&quot;HalfSphere&quot;</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>  <span class="c1">// 3D</span>

  <span class="n">dShape</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addDispatchShape</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
               <span class="s">&quot;CalloutShapes.cloud-callout&quot;</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">setBitmapColor</span><span class="p">(</span><span class="n">dShape</span><span class="p">,</span> <span class="s">&quot;Sky&quot;</span><span class="p">);</span>

  <span class="n">dShape</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addDispatchShape</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
            <span class="s">&quot;FlowChartShapes.flowchart-card&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">setHatchingColor</span><span class="p">(</span><span class="n">dShape</span><span class="p">,</span> <span class="s">&quot;Black -45 degrees&quot;</span><span class="p">);</span>

  <span class="c1">// second row</span>
  <span class="n">dShape</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addDispatchShape</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
                    <span class="s">&quot;StarShapes.star12&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">setGradientColor</span><span class="p">(</span><span class="n">dShape</span><span class="p">,</span> <span class="s">&quot;Radial red/yellow&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dShape</span><span class="p">,</span> <span class="s">&quot;LineStyle&quot;</span><span class="p">,</span> <span class="n">LineStyle</span><span class="p">.</span><span class="na">NONE</span><span class="p">);</span>
                                         <span class="c1">// no outline</span>

  <span class="n">dShape</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addDispatchShape</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
                    <span class="s">&quot;SymbolShapes.heart&quot;</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dShape</span><span class="p">,</span> <span class="s">&quot;FillColor&quot;</span><span class="p">,</span> <span class="mh">0xFF0000</span><span class="p">);</span>

  <span class="n">Draw</span><span class="p">.</span><span class="na">addDispatchShape</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
             <span class="s">&quot;ArrowShapes.left-right-arrow&quot;</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
             <span class="c1">// Block Arrow sub-menu</span>

  <span class="n">dShape</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addDispatchShape</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
                      <span class="s">&quot;Cyramid&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
                      <span class="c1">// 3D pyramid, misspelt</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">setBitmapColor</span><span class="p">(</span><span class="n">dShape</span><span class="p">,</span> <span class="s">&quot;Stone&quot;</span><span class="p">);</span>

  <span class="n">Draw</span><span class="p">.</span><span class="na">showShapesInfo</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of dispatchShapes()</span>
</code></pre></div>
<p>A title-only slide is created, followed by eight calls to Draw.addDispatchShape() to
create two rows of four shapes in Figure 9.</p>
<h3 id="61-viewing-the-fifth-slide">6.1.  Viewing the Fifth Slide<a class="headerlink" href="#61-viewing-the-fifth-slide" title="Permanent link">&para;</a></h3>
<p>Draw.addDispatchShape() requires the fifth slide to be the active, visible window on-
screen. This necessitates a call to GUI.setVisible() to make the document visible, but
that isn't quite enough. Making the document visible causes the first slide to be
displayed, not the fifth one.</p>
<p>Impress offers many ways of viewing slides, which are implemented in the API as
view classes that inherit the Controller service. The inheritance structure is shown in
Figure 12.</p>
<p><img alt="" src="images/16-Making_Slides-12.png" /></p>
<p>Figure 12. Impress View Classes.</p>
<p>When a Draw or Impress document is being edited, the view is
DrawingDocumentDrawView, which supports a number of useful properties, such as
"ZoomType" and "VisibleArea". Its XDrawView interface is employed for getting
and setting the current page displayed in this view.</p>
<p>Draw.gotoPage() gets the XController interface for the document, and converts it to
XDrawView so the visible page can be set:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">gotoPage</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">,</span> <span class="n">XDrawPage</span> <span class="n">page</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XController</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="n">GUI</span><span class="p">.</span><span class="na">getCurrentController</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">gotoPage</span><span class="p">(</span><span class="n">ctrl</span><span class="p">,</span> <span class="n">page</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of jumpToPage()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">gotoPage</span><span class="p">(</span><span class="n">XController</span> <span class="n">ctrl</span><span class="p">,</span> <span class="n">XDrawPage</span> <span class="n">page</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XDrawView</span> <span class="n">xDrawView</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDrawView</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">);</span>
  <span class="n">xDrawView</span><span class="p">.</span><span class="na">setCurrentPage</span><span class="p">(</span><span class="n">page</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of gotoPage()</span>
</code></pre></div>
<p>After the call to Draw.gotoPage(), the specified draw page will be visible on-screen,
and so receive any dispatch commands.</p>
<p>Draw.getViewedPage()  returns a reference to the currently viewed page by calling
XDrawView.getCurrentPage():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XDrawPage</span> <span class="nf">getViewedPage</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XController</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="n">GUI</span><span class="p">.</span><span class="na">getCurrentController</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">XDrawView</span> <span class="n">xDrawView</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDrawView</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">xDrawView</span><span class="p">.</span><span class="na">getCurrentPage</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of getViewedPage()</span>
</code></pre></div>
<h3 id="62-adding-a-dispatch-shape-to-the-visible-page">6.2.  Adding a Dispatch Shape to the Visible Page<a class="headerlink" href="#62-adding-a-dispatch-shape-to-the-visible-page" title="Permanent link">&para;</a></h3>
<p>If you try adding a smiley face to a slide inside Impress, it's a two-step process. It isn't
enough only to click on the icon, it's also necessary to drag the cursor over the page in
order for the shape to appear and be resized.</p>
<p>These steps are necessary for all the Drawing toolbar and 3D-Objects shapes, and are
emulated by my code. The programming equivalent of clicking on the icon is done by
calling Lo.dispatchCmd(), while implementing a mouse drag utilizes JNA and Java's
Robot class.</p>
<p>Draw.addDispatchShape() uses createDispatchShape() to create the shape, and then
positions and resizes it:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">addDispatchShape</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span>
              <span class="n">String</span> <span class="n">shapeDispatch</span><span class="p">,</span>
              <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">warnsPosition</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
  <span class="n">XShape</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">createDispatchShape</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="n">shapeDispatch</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">shape</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">setPosition</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
    <span class="n">setSize</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">shape</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of addDispatchShape()</span>
</code></pre></div>
<p>Draw.createDispatchShape() implements icon selection and click-and-drag:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Draw</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">createDispatchShape</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span>
                                      <span class="n">String</span> <span class="n">shapeDispatch</span><span class="p">)</span>
<span class="p">{</span> <span class="kt">int</span> <span class="n">numShapes</span> <span class="o">=</span> <span class="n">slide</span><span class="p">.</span><span class="na">getCount</span><span class="p">();</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">dispatchCmd</span><span class="p">(</span><span class="n">shapeDispatch</span><span class="p">);</span>
            <span class="c1">// select the shape icon; Office must be visible</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">wait</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>

  <span class="c1">// click and drag on the page to create the shape on the page;</span>
  <span class="c1">// the current page must be visible</span>
  <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Point</span> <span class="n">p1</span> <span class="o">=</span>
              <span class="n">JNAUtils</span><span class="p">.</span><span class="na">getClickPoint</span><span class="p">(</span> <span class="n">JNAUtils</span><span class="p">.</span><span class="na">getHandle</span><span class="p">()</span> <span class="p">);</span>
  <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Point</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">JNAUtils</span><span class="p">.</span><span class="na">getOffsetPoint</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
                                          <span class="c1">// hardwired offset</span>
  <span class="n">JNAUtils</span><span class="p">.</span><span class="na">doDrag</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">);</span>  <span class="c1">// drag the cursor between p1 and p2</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">wait</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>

  <span class="cm">/* get a reference to the shape by assuming it&#39;s</span>
<span class="cm">     the top one on the page */</span>
  <span class="kt">int</span> <span class="n">numShapes2</span> <span class="o">=</span> <span class="n">slide</span><span class="p">.</span><span class="na">getCount</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">numShapes2</span> <span class="o">==</span> <span class="n">numShapes</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// there&#39;s a new shape</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Shape \&quot;&quot;</span> <span class="o">+</span> <span class="n">shapeDispatch</span> <span class="o">+</span> <span class="s">&quot;\&quot; created&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">Draw</span><span class="p">.</span><span class="na">findTopShape</span><span class="p">(</span><span class="n">slide</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>   <span class="c1">// no new shape</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Shape \&quot;&quot;</span> <span class="o">+</span> <span class="n">shapeDispatch</span> <span class="o">+</span>
                                              <span class="s">&quot;\&quot; not created&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of createDispatchShape()</span>
</code></pre></div>
<p>The click-and-drag operation doesn't return a reference to the shape, so
createDispatchShape() ends by calling Draw.findTopShape(). It returns a reference to
the top-most shape on the page, which I'm assuming is the new shape.</p>
<h3 id="63-using-jna-to-click-and-drag">6.3.  Using JNA to Click and Drag<a class="headerlink" href="#63-using-jna-to-click-and-drag" title="Permanent link">&para;</a></h3>
<p>JNAUtils.getHandle() returns Window's handle for Office, and getClickPoint()
calculates the center of the Office window:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in JNAUtils</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">Point</span> <span class="nf">getClickPoint</span><span class="p">(</span><span class="n">HWND</span> <span class="n">handle</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Rectangle</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">getBounds</span><span class="p">(</span><span class="n">handle</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">bounds</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Bounding rectangle is null&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="n">xCenter</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">.</span><span class="na">x</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">.</span><span class="na">width</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">yCenter</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">.</span><span class="na">y</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">.</span><span class="na">height</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">xCenter</span><span class="p">,</span> <span class="n">yCenter</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of getClickPoint()</span>
</code></pre></div>
<p>I'm hoping that this point is somewhere on the slide.</p>
<p>JNAUtils.getOffsetPoint() creates a second point offset some distance from the first:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">Point</span> <span class="nf">getOffsetPoint</span><span class="p">(</span><span class="n">Point</span> <span class="n">p1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">xDist</span><span class="p">,</span> <span class="kt">int</span> <span class="n">yDist</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span> <span class="n">p1</span><span class="p">.</span><span class="na">x</span> <span class="o">+</span> <span class="n">xDist</span><span class="p">,</span> <span class="n">p1</span><span class="p">.</span><span class="na">y</span> <span class="o">+</span> <span class="n">yDist</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
<p>Again, I'm hoping this point is on the slide.</p>
<p>JNAUtils.doDrag() employs Java's Robot class to send mouse actions to the active
window. doDrag() moves the cursor to the first point, then sends press and move
events to simulate a cursor drag to the second point. It finishes by sending a release
event for the mouse button:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in JNAUtils</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">doDrag</span><span class="p">(</span><span class="kd">final</span> <span class="n">Point</span> <span class="n">clickPt</span><span class="p">,</span>
                                    <span class="kd">final</span> <span class="n">Point</span> <span class="n">releasePt</span><span class="p">)</span>
<span class="c1">// drag the cursor between the two points</span>
<span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">clickPt</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Click point is null&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">releasePt</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Release point is null&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">EventQueue</span><span class="p">.</span><span class="na">invokeLater</span><span class="p">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="n">Point</span> <span class="n">oldPos</span> <span class="o">=</span> <span class="n">MouseInfo</span><span class="p">.</span><span class="na">getPointerInfo</span><span class="p">().</span><span class="na">getLocation</span><span class="p">();</span>
        <span class="n">Robot</span> <span class="n">r</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Robot</span><span class="p">();</span>
        <span class="n">r</span><span class="p">.</span><span class="na">mouseMove</span><span class="p">(</span><span class="n">clickPt</span><span class="p">.</span><span class="na">x</span><span class="p">,</span> <span class="n">clickPt</span><span class="p">.</span><span class="na">y</span><span class="p">);</span>
        <span class="n">Lo</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span>
        <span class="n">r</span><span class="p">.</span><span class="na">mousePress</span><span class="p">(</span><span class="n">InputEvent</span><span class="p">.</span><span class="na">BUTTON1_MASK</span><span class="p">);</span>
        <span class="n">Lo</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span>
        <span class="n">r</span><span class="p">.</span><span class="na">mouseMove</span><span class="p">(</span><span class="n">releasePt</span><span class="p">.</span><span class="na">x</span><span class="p">,</span> <span class="n">releasePt</span><span class="p">.</span><span class="na">y</span><span class="p">);</span>
        <span class="n">Lo</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span>
        <span class="n">r</span><span class="p">.</span><span class="na">mouseRelease</span><span class="p">(</span><span class="n">InputEvent</span><span class="p">.</span><span class="na">BUTTON1_MASK</span><span class="p">);</span>
        <span class="n">r</span><span class="p">.</span><span class="na">mouseMove</span><span class="p">(</span><span class="n">oldPos</span><span class="p">.</span><span class="na">x</span><span class="p">,</span> <span class="n">oldPos</span><span class="p">.</span><span class="na">y</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">catch</span><span class="p">(</span><span class="n">AWTException</span> <span class="n">e</span><span class="p">)</span>
      <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unable to carry out Drag: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>  <span class="c1">// end of doDrag()</span>
</code></pre></div>
<p>The Robot events must be added to Java's event queue, so are wrapped up in a call to
EventQueue.invokeLater(). The final call to Robot.mouseMove() moves the cursor
back to its original position.</p>
<h3 id="64-things-that-can-go-wrong">6.4.  Things that Can Go Wrong<a class="headerlink" href="#64-things-that-can-go-wrong" title="Permanent link">&para;</a></h3>
<p>createDispatchShape() assumes that the slide being edited by Office is the visible,
active window. If these conditions aren't met then the dispatch and the dragging will
go to the wrong window. Unfortunately, calling GUI.setVisible() and
Draw.gotoPage() do not guarantee these conditions, since after their call the OS or the
user may inadvertently change the desktop's focus. A different window could become
active, and so receive those commands.</p>
<p>There are also timing issues: the call to Lo.dispatchCmd() returns immediately, but
the processing of the dispatch by Office may take hundreds of milliseconds. This is
why calls to Lo.delay() are scattered through the code, to give the dispatches time to
be processed.</p>
<p>There's also a timing problem with EventQueue.invokeLater() which returns
immediately after queuing up the Robot actions. The processing of its events may also
take many hundreds of milliseconds, so createDispatchShape() must call Lo.delay()
after returning from JNAUtils.doDrag().</p>
<p>Yet another problem is my assumption that the press and drag points are on the slide,
and not some other part of the application window, such as the toolbar.</p>
<h3 id="65-3d-shapes-might-be-different-but-arent">6.5.  3D Shapes Might be Different (but aren't)<a class="headerlink" href="#65-3d-shapes-might-be-different-but-arent" title="Permanent link">&para;</a></h3>
<p>3D shapes are available both through the 3D-Objects toolbar (see Figure 11), and as
undocumented Shape APIs. The classes don't match up exactly with the eight shapes
in the toolbar, but are similar.The classes are Shape3DCubeObject,
Shape3DSphereObject, , Shape3DPolygonObject, Shape3DLatheObject,
Shape3DExtrudeObject, and Shape3DSceneObject, which all belong to the
com.sun.star.drawing package.</p>
<p>It should be possible to build a 3D cube by calling:</p>
<div class="highlight"><pre><span></span><code><span class="n">XShape</span> <span class="n">shape3D</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">addShape</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span>
                      <span class="s">&quot;Shape3DCubeObject&quot;</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>
<p>I tried this, and it nearly worked. The resulting slide contains a Shape3DCubeObject
object, which I deduced by listing all the shapes on the current slide with
Draw.showShapesInfo(). Unfortunately, the shape is invisible because its width and
height are 0. No amount of fiddling with its properties could change these zero
dimensions.</p>
<p>The conclusion of all this programming ugliness is that the API needs to be brought
up to date so it can access all the shapes available through the GUI.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="15-Complex_Shapes.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 15. Complex Shapes" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 15. Complex Shapes
            </div>
          </div>
        </a>
      
      
        
        <a href="17-Slide_Deck_Manipulation.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 17. Slide Deck Manipulation" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 17. Slide Deck Manipulation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>