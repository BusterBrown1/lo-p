
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 13. Drawing Basic Shapes - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-13-drawing-basic-shapes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 13. Drawing Basic Shapes
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 13. Drawing Basic Shapes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="13-Basic_Shapes.html" class="md-nav__link md-nav__link--active">
        Chapter 13. Drawing Basic Shapes
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-drawing-shapes" class="md-nav__link">
    1.  Drawing Shapes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-a-black-dashed-line" class="md-nav__link">
    2.  A Black Dashed Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-a-red-ellipse" class="md-nav__link">
    3.  A Red Ellipse
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-a-rectangle-with-a-variety-of-fills" class="md-nav__link">
    4.  A Rectangle with a Variety of Fills
  </a>
  
    <nav class="md-nav" aria-label="4.  A Rectangle with a Variety of Fills">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-gradient-color" class="md-nav__link">
    4.1.  Gradient Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-gradient-awt-color" class="md-nav__link">
    4.2.  Gradient AWT Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-hatching" class="md-nav__link">
    4.3.  Hatching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-bitmap-color" class="md-nav__link">
    4.4.  Bitmap Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-bitmap-file-color" class="md-nav__link">
    4.5.  Bitmap File Color
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-text" class="md-nav__link">
    5.  Text
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-using-a-shape-name" class="md-nav__link">
    6.  Using a Shape Name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-a-transparent-circle-and-a-polar-line" class="md-nav__link">
    7.  A Transparent Circle and a Polar Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-a-math-formula-as-an-ole-shape" class="md-nav__link">
    8.  A Math formula as an OLE Shape
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-polygons" class="md-nav__link">
    9.  Polygons
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-drawing-shapes" class="md-nav__link">
    1.  Drawing Shapes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-a-black-dashed-line" class="md-nav__link">
    2.  A Black Dashed Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-a-red-ellipse" class="md-nav__link">
    3.  A Red Ellipse
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-a-rectangle-with-a-variety-of-fills" class="md-nav__link">
    4.  A Rectangle with a Variety of Fills
  </a>
  
    <nav class="md-nav" aria-label="4.  A Rectangle with a Variety of Fills">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-gradient-color" class="md-nav__link">
    4.1.  Gradient Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-gradient-awt-color" class="md-nav__link">
    4.2.  Gradient AWT Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-hatching" class="md-nav__link">
    4.3.  Hatching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-bitmap-color" class="md-nav__link">
    4.4.  Bitmap Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-bitmap-file-color" class="md-nav__link">
    4.5.  Bitmap File Color
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-text" class="md-nav__link">
    5.  Text
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-using-a-shape-name" class="md-nav__link">
    6.  Using a Shape Name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-a-transparent-circle-and-a-polar-line" class="md-nav__link">
    7.  A Transparent Circle and a Polar Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-a-math-formula-as-an-ole-shape" class="md-nav__link">
    8.  A Math formula as an OLE Shape
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-polygons" class="md-nav__link">
    9.  Polygons
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/13-Basic_Shapes.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-13-drawing-basic-shapes">Chapter 13. Drawing Basic Shapes</h1>
<p>This chapter contains an assortment of basic shape 
creation examples, including the following: 
 simple shapes: line, ellipse, rectangle, text; 
 shape fills: solid, gradients, hatching, bitmaps; 
 an OLE shape (a math formulae); 
 polygons, multiple lines, partial ellipses. </p>
<p>The examples come from two files, DrawPicture.java and 
AnimBicycle.java. The main() function of DrawPicture.java: </p>
<p>public static void main (String args[]) 
{ 
  XComponentLoader loader = Lo.loadOffice(); 
  XComponent doc = Draw.createDrawDoc(loader); 
  if (doc == null) { 
    System.out.println("Draw doc creation failed"); 
    Lo.closeOffice(); 
    return; 
  } </p>
<p>GUI.setVisible(doc, true); 
  Lo.delay(1000);    // need delay or zoom may not work 
  GUI.zoom(doc, GUI.ENTIRE_PAGE); </p>
<p>XDrawPage currSlide = Draw.getSlide(doc, 0); //access first page 
  drawShapes(currSlide); </p>
<p>Draw.drawFormula(currSlide, "func e^{i %pi} + 1 = 0", <br />
                                           23, 20, 20, 40); 
  // animShapes(currSlide);  // explained in Chapter 9 </p>
<p>XShape s = Draw.findShapeByName(currSlide, "text1"); 
  Draw.reportPosSize(s); </p>
<p>Lo.saveDoc(doc, "picture.odg"); 
  Lo.closeDoc(doc); 
  Lo.closeOffice(); 
} // end of main() </p>
<p>DrawPicture.java creates a new Draw document, and finishes by saving it to the file 
"picture.odg": </p>
<p>XComponent doc = Draw.createDrawDoc(loader); 
       :  // add shapes to the document 
       : 
Lo.saveDoc(doc, "picture.odg"); // "odg" is Draw's extension </p>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>A Black Dashed </p>
</div>
<p>Line; A Red Ellipse; 
Filled Rectangles; Text; 
Shape Names; A 
Transparent Circle and a 
Polar Line; A Math 
Formula as an OLE 
Shape; Polygons; 
Multiple Lines, Partial 
Elipses 
Example folders: "Draw 
Tests" and "Utils" 
Aside from saving Office formats,  Lo.saveDoc() recognizes other graphical forms 
based on the filename extension (e.g. a document saved to "picture.png" will create a 
PNG file). </p>
<p>Draw.createDrawDoc() is a wrapper around Lo.createDoc() to create a  Draw 
document: </p>
<p>public static XComponent createDrawDoc(XComponentLoader loader) 
{  return Lo.createDoc("sdraw", loader);  } </p>
<p>There's also Draw.createImpressDoc(): </p>
<p>public static XComponent createImpressDoc(XComponentLoader loader) 
{  return Lo.createDoc("simpress", loader);  } </p>
<h2 id="1-drawing-shapes">1.  Drawing Shapes</h2>
<p>The drawShapes() method inside DrawPictures.java draws the six shapes shown in </p>
<p><img alt="" src="images/13-Basic_Shapes-1.jpg" /></p>
<p>Figure 1. </p>
<p><img alt="" src="images/13-Basic_Shapes-1.jpg" /></p>
<p>Figure 1. The Six Shapes Drawn by drawShapes(). </p>
<p>Almost every Draw method call Draw.makeShape() which creates a shape instance 
and sets its size and position on the page: </p>
<p>// in the Draw class 
public static XShape makeShape(String shapeType,<br />
                       int x, int y, int width, int height) 
{ XShape shape = null; 
  try { 
    shape = Lo.createInstanceMSF(XShape.class,<br />
                         "com.sun.star.drawing." + shapeType); 
    shape.setPosition( new Point(x<em>100,y</em>100) ); 
    shape.setSize( new Size(width<em>100, height</em>100) ); 
  } 
  catch(Exception e) 
  {  System.out.println("Unable to create shape: " + shapeType);  } </p>
<p>return shape; 
}  // end of makeShape() </p>
<p>The method assumes that the shape is defined inside the com.sun.star.drawing 
package, i.e. that it's a shape which subclasses com.sun.star.drawing.Shape, like those 
in Figure 6 of Chapter 11. The code converts the supplied (x, y) coordinate, width, 
and height from millimeters to Office's 1/100 mm values.  </p>
<p>The exact meaning of the position and the size of a shape is a little tricky. If its width 
and height are positive, then the position is the top-left corner of the rectangle defined 
by those dimensions. However, the user can supply negative dimensions, which 
means that "top-left corner" may be on the right or bottom of the rectangle (see Figure 
2(a)). Office handles this by storing the rectangle with a new top-left point, so all the 
dimensions can be positive (see Figure 2(b)).  </p>
<p><img alt="" src="images/13-Basic_Shapes-2.png" /></p>
<p>Figure 2. How Office Stores a Shape with a Negative Height. </p>
<p>This means that your code should not assume that the position and size of a shape 
remain unchanged after being set with XShape.setPosition() and XShape.setSize(). </p>
<p>makeShape() is called by Draw.addShape() which adds the generated shape to the 
page. It also check if the (x, y) coordinate is located on the page. If it isn't, 
warnPosition() prints a warning message. </p>
<p>// in the Draw class 
public static XShape addShape(XDrawPage slide, String shapeType,<br />
                            int x, int y, int width, int height) 
{ warnsPosition(slide, x, y); 
  XShape shape = makeShape(shapeType, x, y, width, height); 
  if (shape != null) 
    slide.add(shape); 
  return shape; 
}  // end of addShape() </p>
<p>drawShapes() in the DrawPicture.java example is shown below. It creates the six 
shapes shown in Figure 1. </p>
<p>// in DrawPicture.java 
private static void drawShapes(XDrawPage currSlide) 
{ 
  // black dashed line; uses (x1, y1) (x2, y2) 
  XShape line1 = Draw.drawLine(currSlide, 50, 50, 200, 200); 
  Props.setProperty(line1, "LineColor", 0x000000);   // black 
  Draw.setDashedLine(line1, true); 
  // Lo.delay(2000);  // to reduce the speed of the change 
  // Draw.setDashedLine(line1, false); </p>
<p>// red ellipse; uses (x, y) width, height 
  XShape circle1 = Draw.drawEllipse(currSlide, 100, 100, 75, 25); 
  Props.setProperty(circle1, "FillColor", 0xFF0000); </p>
<p>// rectangle with different fills; uses (x, y) width, height 
  XShape rect1 = Draw.drawRectangle(currSlide, 70, 70, 25, 50); 
  // Props.setProperty(rect1, "FillColor", 0x00FF00); // green 
  // Draw.setGradientColor(rect1, "Gradient 4"); 
                               // "Radial red/yellow"); 
  // Draw.setGradientColor(rect1, java.awt.Color.GREEN,<br />
                                  java.awt.Color.RED); 
  // Draw.setHatchingColor(rect1, "Red crossed 45 degrees"); 
  // Draw.setBitmapColor(rect1, "Roses"); 
  Draw.setBitmapFileColor(rect1, "crazy_blue.jpg"); </p>
<p>// text defined using (x, y), width, height [size] 
  XShape text1 = Draw.drawText(currSlide, "Hello LibreOffice",<br />
                                     120, 120, 60, 30, 24); 
  Props.setProperty(text1, "Name", "text1"); 
  Props.showProps("TextShape's Text Properties", <br />
                              Draw.getTextProperties(text1)); </p>
<p>// gray transparent circle; uses (x,y), radius 
  XShape circle2 = Draw.drawCircle(currSlide, 40, 150, 20); 
  Props.setProperty(circle2, "FillColor",<br />
                      Lo.getColorInt(java.awt.Color.GRAY)); 
  Draw.setTransparency(circle2, 25); </p>
<p>// thick line; uses (x,y), angle clockwise from x-axis, length 
  XShape line2 = Draw.drawPolarLine(currSlide, 60, 200, 45, 100); 
  Props.setProperty(line2, "LineWidth", 300);    // 3mm 
}  // end of drawShapes() </p>
<p>There's a number of variations possible for each shape, represented by commented out 
code. The following sections look at how the six shapes are drawn. </p>
<h2 id="2-a-black-dashed-line">2.  A Black Dashed Line</h2>
<p>Draw.drawLine() calls Draw.addShape() to create a com.sun.star.drawing.LineShape 
instance. In common with other shapes, a line is defined in terms of its enclosing 
rectangle, represented by its top-left corner, width, and height. Draw.drawLine() 
allows the programmer to define the line using its endpoints: </p>
<p>// in the Draw class 
public static XShape drawLine(XDrawPage slide,<br />
                  int x1, int y1, int x2, int y2) 
{ 
  // make sure size is non-zero 
  if ((x1 == x2) &amp;&amp; (y1 == y2)) { 
    System.out.println("Line is a point"); 
    return null; 
  } 
  int width = x2 - x1;   // may be negative 
  int height = y2 - y1;  // may be negative 
  return addShape(slide, "LineShape",  x1, y1, width, height); 
}  // end of drawLine() </p>
<p>As mentioned above, Office will store a shape with a modified position and size if one 
or both of its dimensions is negative. As an example, consider if Draw.drawLine() is 
called with the coordinates (10,20) and (20,10). The call to addShape() would be 
passed a positive width (10mm) and a negative height (-10mm). This would be drawn 
as in Figure 3(a) but would be stored using the shape position and size in Figure 3(c). </p>
<p><img alt="" src="images/13-Basic_Shapes-3.png" /></p>
<p>Figure 3. How a Line with a Negative Height is Stored as a Shape. </p>
<p>This kind of transformation may be important if your code modifies a shape after it 
has been added to the slide, as my animation examples do in the next chapter. </p>
<p>Back in DrawPicture.java's drawShapes(), the line's properties are adjusted. The 
hardest part of this is finding the property's name in the API documentation, because 
properties are typically defined across multiple services, including LineShape, Shape, 
FillProperties, ShadowProperties, LineProperties, and RotationDescriptor. If the 
property is related to the shape's text then you should check TextProperties, 
CharacterProperties, and ParagraphProperties as well. Figure 7 of Chapter 11 shows 
the situation for RectangleShape, and its much the same for other shapes. You should 
start looking in the documentation for the shape (i.e. use lodoc LineShape 
drawing), and move up the hierarchy. </p>
<p>You can click on the inheritance diagram at the top of the page (e.g. like the one in 
Figure 4) to look in the different services. </p>
<p><img alt="" src="images/13-Basic_Shapes-4.png" /></p>
<p>Figure 4. The LineShape Inheritance Diagram in the<br />
LibreOffice Online Documentation. </p>
<p>drawShapes() will color the line black and make it dashed, which suggests that I 
should examine the LineProperties class. Its relevant properties are "LineColor" for 
color and "LineStyle" and "LineDash" for creating dashes, as in Figure 5. </p>
<p><img alt="" src="images/13-Basic_Shapes-5.png" /></p>
<p>Figure 5. Relevant Properties in the LineProperties Class. </p>
<p>Line color can be set with a single call to Props.setProperty(), but line dashing is a 
little more complicated, so is handled by Draw.setDashedLine(): </p>
<p>// in drawShapes() in DrawPicture.java 
Props.setProperty(line1, "LineColor", 0x000000);   // black 
Draw.setDashedLine(line1, true); </p>
<p>The color parameter for "LineColor" is an RGB hexadecimal. There are other ways of 
defining color, which I'll explain in a moment. </p>
<p>Draw.setDashedLine() has to assign a LineStyle object to "LineStyle" and a LineDash 
object to "LineDash". The line style is easily set since LineStyle is an enumeration 
with three possible values. A LineDash object requires more work: </p>
<p>// in the Draw class 
public static void setDashedLine(XShape shape, boolean isDashed) 
{ 
  // create a LineDash object 
  LineDash ld = new LineDash();<br />
  ld.Dots = 0; ld.DotLen = 100;  // dashes only; no dots 
  ld.Dashes = 5; 
  ld.DashLen = 200; 
  ld.Distance = 200; </p>
<p>// set the properties for the line 
  XPropertySet props = Lo.qi(XPropertySet.class, shape); 
  try { 
    if (isDashed) {  // draw a dashed line 
      props.setPropertyValue("LineStyle", LineStyle.DASH); 
      props.setPropertyValue("LineDash", ld); 
    } 
    else // draw a solid line 
      props.setPropertyValue("LineStyle", LineStyle.SOLID); 
  } 
  catch(Exception e) 
  {  System.out.println("Could not set dashed line property");  } 
}  // end of setDashedLine() </p>
<p>setDashedLine() can be used to toggle a line's dashes on or off. </p>
<h2 id="3-a-red-ellipse">3.  A Red Ellipse</h2>
<p>A red ellipse is drawn using: </p>
<p>// in drawShapes() in DrawPicture.java 
XShape circle1 = Draw.drawEllipse(currSlide, 100, 100, 75, 25); 
Props.setProperty(circle1, "FillColor", 0xFF0000); </p>
<p>Draw.drawEllipse() is similar to drawLine() except that an EllipseShape is created by 
Draw.addShape(): </p>
<p>// in the Draw class 
public static XShape drawEllipse(XDrawPage slide,<br />
                           int x, int y, int width, int height) 
{  return addShape(slide, "EllipseShape", x, y, width, height);  } </p>
<p>I want to fill the circle with a solid color, which suggests the setting of a property in 
FillProperties. A visit to the online documentation for EllipseShape reveals an 
inheritance diagram like the one in Figure 6. </p>
<p><img alt="" src="images/13-Basic_Shapes-6.png" /></p>
<p>Figure 6. The EllipseShape Inheritance Diagram in the<br />
LibreOffice Online Documentation. </p>
<p>Clicking on the FillProperties rectangle jumps to its documentation, which lists a 
"FillColor" property (see Figure 7). </p>
<p><img alt="" src="images/13-Basic_Shapes-7.png" /></p>
<p>Figure 7. Relevant Properties in the FillProperties Class. </p>
<p>Both the "FillColor" and "FillStyle" properties should be set, but the default value for 
"FillStyle" is already FillStyle.SOLID, which is what's needed. </p>
<h2 id="4-a-rectangle-with-a-variety-of-fills">4.  A Rectangle with a Variety of Fills</h2>
<p>The rectangle example in drawShapes() comes in six different colors: </p>
<p>// in drawShapes() in DrawPicture.java 
  // rectangle with different fills 
  XShape rect1 = Draw.drawRectangle(currSlide, 70, 70, 25, 50); 
  // Props.setProperty(rect1, "FillColor", 0x00FF00); // green </p>
<p>// Draw.setGradientColor(rect1, "Gradient 4"); 
                                      // "Radial red/yellow"); </p>
<p>// Draw.setGradientColor(rect1, java.awt.Color.GREEN,<br />
                                  java.awt.Color.RED); </p>
<p>// Draw.setHatchingColor(rect1, "Red crossed 45 degrees"); </p>
<p>// Draw.setBitmapColor(rect1, "Roses"); </p>
<p>Draw.setBitmapFileColor(rect1, "crazy_blue.jpg"); </p>
<p>They're shown in Figure 8. </p>
<p><img alt="" src="images/13-Basic_Shapes-8.jpg" /></p>
<p>Figure 8. Six Ways of Filling a Rectangle. </p>
<h3 id="41-gradient-color">4.1.  Gradient Color</h3>
<p>The second example in Figure 8 ("gradient color") is implemented using 
Draw.setGradientColor(): </p>
<p>// in the Draw class 
public static void setGradientColor(XShape shape, String name) 
{ 
  XPropertySet props = Lo.qi(XPropertySet.class, shape); 
  try { 
    props.setPropertyValue("FillStyle", FillStyle.GRADIENT); 
    props.setPropertyValue("FillGradientName", name); 
  } 
  catch(com.sun.star.lang.IllegalArgumentException e) 
  {  System.out.println("\"" + name + "\" is not a<br />
                        recognized gradient color name");  } 
  catch(Exception e) 
  {  System.out.println("Could not set to \"" + name + "\"");  } 
}  // end of setGradientColor() </p>
<p>The hardest part of using this function is determining what name value to pass to the 
"FillGradientName" property (e.g. "Gradient 4" in the call in drawShapes()). The 
easiest solution is to fire up Office's Draw application, and check out the gradient 
names listed in the "Line and Filling" toolbar. Figure 9 shows what happens when the 
user selects a shape and chooses the "Gradient" menu item from the combo box. </p>
<p><img alt="" src="images/13-Basic_Shapes-9.png" /></p>
<p>Figure 9. The Gradient Names in LibreOffice. </p>
<p>If you supply a name which is not in Figure 9's list, then "Linear blue/white" is used 
instead. </p>
<h3 id="42-gradient-awt-color">4.2.  Gradient AWT Color</h3>
<p>The third example in Figure 8 shows what happens when you define your own 
gradient and angle of change. In drawShapes(), the call is: 
Draw.setGradientColor(rect1, java.awt.Color.GREEN,<br />
                                  java.awt.Color.RED); 
This creates a gradient change from green to red downwards through the shape. </p>
<p>Draw.setGradientColor() calls a four argument version of itself which specifies the 
gradient angle: </p>
<p>// in the Draw class 
public static void setGradientColor(XShape shape,<br />
              java.awt.Color startColor, java.awt.Color endColor) 
{  setGradientColor(shape, startColor, endColor, 0);  } </p>
<p>public static void setGradientColor(XShape shape,<br />
   java.awt.Color startColor, java.awt.Color endColor, int angle) 
/<em> if angle == 90 then the gradient changes from the left 
   to the right side of the shape </em>/ 
{ 
  // create Gradient object 
  Gradient grad = new Gradient();<br />
  grad.Style = GradientStyle.LINEAR;<br />
  grad.StartColor = Lo.getColorInt(startColor);<br />
  grad.EndColor = Lo.getColorInt(endColor);  </p>
<p>grad.Angle = (short)(angle*10);    // in 1/10 degree units 
  grad.Border = 0;<br />
  grad.XOffset = 0; grad.YOffset = 0;<br />
  grad.StartIntensity = 100; grad.EndIntensity = 100;<br />
  grad.StepCount = 10;  </p>
<p>XPropertySet props = Lo.qi(XPropertySet.class, shape); 
  try { 
    props.setPropertyValue("FillStyle", FillStyle.GRADIENT); 
    props.setPropertyValue("FillGradient", grad); 
  } 
  catch(Exception e) 
  {  System.out.println("Could not set gradient colors");  } 
}  // end of setGradientColor() </p>
<p>setGradientColor() sets the properties "FillStyle" and "FillGradient". The latter 
requires a Gradient object, which is documented in the FillProperties class, as shown 
in Figure 10. </p>
<p><img alt="" src="images/13-Basic_Shapes-10.png" /></p>
<p>Figure 10. The "FillGradient" Property in the FillProperties Class. </p>
<p>The online documentation for FillProperties can be reached using lodoc 
FillProperties service reference. </p>
<p>Clicking on the "com::sun::star::awt::Gradient" name in Figure 10 loads its 
documentation, which lists ten fields that need to be set. </p>
<p>The colors passed to Draw.setGradientColor() are the Java AWT constants for red and 
green (java.awt.Color.RED and java.awt.Color.GREEN), but any Color objects could 
be used. They're converted to hexadecimals by Lo.getColorInt(): </p>
<p>public static int getColorInt(java.awt.Color color)<br />
// return the color as an integer, ignoring the alpha channel 
{  <br />
  if (color == null) { 
    System.out.println("No color supplied"); 
    return 0; 
  } 
  else 
    return (color.getRGB() &amp; 0xffffff); 
} // end of getColorInt() </p>
<h3 id="43-hatching">4.3.  Hatching</h3>
<p>The fourth fill in Figure 8 employs hatching. In drawShapes(), the call is: </p>
<p>Draw.setHatchingColor(rect1, "Red crossed 45 degrees"); </p>
<p>Draw.setHatchingColor() is: </p>
<p>public static void setHatchingColor(XShape shape, String name) 
{ 
  XPropertySet props = Lo.qi(XPropertySet.class, shape); 
  try { 
    props.setPropertyValue("FillStyle", FillStyle.HATCH); 
    props.setPropertyValue("FillHatchName", name); 
  } 
  catch(com.sun.star.lang.IllegalArgumentException e) 
  {  System.out.println("\"" + name + "\" not a hatching name");  } 
  catch(Exception e) 
  {  System.out.println("Could not set color \"" + name + "\"");  } 
}  // end of setHatchingColor() </p>
<p>This function is much the same as setGradientColor() except that it utilizes 
"FillHatchName" rather than "FillGradientName", and the fill style is set to 
FillStyle.HATCH. Suitable hatching names can be found by looking at the relevant 
list in Draw's "Line and Filling" toolbar. Figure 11 shows the "Hatching" menu item. </p>
<p><img alt="" src="images/13-Basic_Shapes-11.png" /></p>
<p>Figure 11. The Hatching Names in LibreOffice. </p>
<h3 id="44-bitmap-color">4.4.  Bitmap Color</h3>
<p>The fifth rectangle fill in Figure 8 utilizes a bitmap color: 
Draw.setBitmapColor(rect1, "Roses"); 
The function is: </p>
<p>public static void setBitmapColor(XShape shape, String name) 
{ 
  XPropertySet props = Lo.qi(XPropertySet.class, shape); 
  try { 
    props.setPropertyValue("FillStyle", FillStyle.BITMAP); 
    props.setPropertyValue("FillBitmapName", name); 
  } 
  catch(com.sun.star.lang.IllegalArgumentException e) 
  {  System.out.println("\"" + name + "\" is not a bitmap");  } 
  catch(Exception e) 
  {  System.out.println("Could not set to \"" + name + "\"");  } 
}  // end of setBitmapColor() </p>
<p>This is also similar to setGradientColor() and setHatchingColor() but uses a different 
"FillStyle" value, and assigns a name to "FillBitmapName". As you might have 
guessed by now, the best source for these names is the  "Line and Filling" toolbar 
shown in Figure 12. </p>
<p><img alt="" src="images/13-Basic_Shapes-12.png" /></p>
<p>Figure 12. The Bitmap Names in LibreOffice. </p>
<h3 id="45-bitmap-file-color">4.5.  Bitmap File Color</h3>
<p>The final fill in Figure 8 loads a bitmap from "crazy_blue.jpg": 
Draw.setBitmapFileColor(rect1, "crazy_blue.jpg"); 
setBitmapFileColor() is: </p>
<p>public static void setBitmapFileColor(XShape shape, String fnm) 
{ 
  XPropertySet props = Lo.qi(XPropertySet.class, shape); 
  try { 
    props.setPropertyValue("FillStyle", FillStyle.BITMAP); 
    props.setPropertyValue("FillBitmapURL", FileIO.fnmToURL(fnm)); 
  } 
  catch(Exception e) 
  {  System.out.println("Could not set color \"" + fnm + "\"");  } 
}  // end of setBitmapFileColor() </p>
<p>The "FillBitmapURL" property requires a URL, so the filename is converted by 
FileIO.fnmToURL(). </p>
<h2 id="5-text">5.  Text</h2>
<p>The "Hello LibreOffice" text shape in Figure 1 is created by calling Draw.drawText(): </p>
<p>XShape text1 = Draw.drawText(currSlide, "Hello LibreOffice",<br />
                             120, 120, 60, 30, 24); </p>
<p>The first four numerical parameters define the shape's bounding rectangle in terms of<br />
its top-left coordinate, width, and height. The fifth, optional number specifies a font 
size (in this case, 24pt). </p>
<p>drawText() calls addShape() with "TextShape": </p>
<p>// in the Draw class 
public static XShape drawText(XDrawPage slide, String msg, 
            int x, int y, int width, int height, int fontSize) 
{ XShape shape = addShape(slide, "TextShape", x,y, width, height); 
  addText(shape, msg, fontSize); 
  return shape; 
}  // end of drawText() </p>
<p>addText() adds the message to the shape, and sets its font size: </p>
<p>public static void addText(XShape shape, String msg, int fontSize) 
{ 
  XText xText = Lo.qi(XText.class, shape); 
  XTextCursor cursor = xText.createTextCursor(); 
  cursor.gotoEnd(false); 
  if (fontSize &gt; 0) 
    Props.setProperty(cursor, "CharHeight", fontSize); 
  XTextRange range = Lo.qi(XTextRange.class, cursor); 
  range.setString(msg); 
}  // end of addText() </p>
<p>The shape is converted into an XText reference, and the text range selected with a 
cursor. </p>
<p>The "CharHeight" property comes from the CharacterProperties service, which is 
inherited by the Text service (as shown in Figure 7 of Chapter 11). </p>
<p>Some Help with Text Properties 
The text-related properties for a shape can be accessed with 
Draw.getTextProperties(): </p>
<p>public static XPropertySet getTextProperties(XShape xShape) 
{ 
  XText xText = Lo.qi(XText.class, xShape); 
  XTextCursor cursor = xText.createTextCursor(); 
  cursor.gotoStart(false); 
  cursor.gotoEnd(true); 
  XTextRange xTextRange = Lo.qi(XTextRange.class, cursor); 
  return Lo.qi(XPropertySet.class, xTextRange); 
}  // end of getTextProperties() </p>
<p>drawShapes() in DrawPicture.java calls Draw.getTextProperties() on the text1 
TextShape, and prints all its properties: </p>
<p>// in drawShapes() in DrawPicture.java 
Props.showProps("TextShape's Text Properties", <br />
                                Draw.getTextProperties(text1)); </p>
<p>The output is long, but includes the line: 
CharHeight == 24.0 
which indicates that the font size was correctly changed by the earlier call to 
Draw.drawText(). </p>
<h2 id="6-using-a-shape-name">6.  Using a Shape Name</h2>
<p>Immediately after the call to Draw.drawText(), the shape's name is set: </p>
<p>// in drawShapes() in DrawPicture.java 
Props.setProperty(text1, "Name", "text1"); </p>
<p>The "Name" property, which is defined in the Shape class, is a useful way of referring 
to a shape. The main() function of DrawPicture.java passes a name to 
Draw.findShapeByName(): </p>
<p>// in main() in DrawPicture.java 
XShape s = Draw.findShapeByName(currSlide, "text1"); 
Draw.reportPosSize(s); </p>
<p>Draw.findShapeByName() iterates through a list of shapes extracted from the slide, 
and returns the shape with the supplied name: </p>
<p>// in the Draw class 
public static XShape findShapeByName(XDrawPage slide,<br />
                                     String shapeName) 
{ ArrayList<XShape> shapes = getShapes(slide); 
  if (shapes == null) { 
    System.out.println("No shapes were found in the draw page"); 
    return null; 
  } </p>
<p>for (XShape shape : shapes) { 
    String nm = (String)Props.getProperty(shape, "Name"); 
    if (shapeName.equals(nm)) 
      return shape; 
  } </p>
<p>System.out.println("No shape named \"" + shapeName + "\""); 
  return null; 
}  // end of findShapeByName() </p>
<p>Draw.getShapes() builds a list of shapes by iterating through the XDrawPage object 
as an indexed container of shapes: </p>
<p>// in the Draw class 
public static ArrayList<XShape> getShapes(XDrawPage slide) 
{ 
  if (slide == null) { 
    System.out.println("Slide is null"); 
    return null; 
  } 
  if (slide.getCount() == 0) { 
    System.out.println("Slide does not contain any shapes"); 
    return null; 
  } </p>
<p>ArrayList<XShape> xShapesList = new ArrayList<XShape>(); 
  try { 
    for(int j=0; j &lt; slide.getCount(); j++) 
      xShapesList.add( Lo.qi(XShape.class, slide.getByIndex(j))); 
  } 
  catch(Exception e) 
  {   System.out.println("Shapes extraction error in slide");  } </p>
<p>return xShapesList; 
}  // end of getShapes() </p>
<p>Draw.reportPosSize() prints some brief information about a shape, including its name, 
shape type, position, and size: </p>
<p>// in the Draw class 
public static void reportPosSize(XShape shape) 
{ 
  if (shape == null) { 
    System.out.println("The shape is null"); 
    return; 
  } 
  System.out.println("Shape name: " +<br />
                        Props.getProperty(shape, "Name")); 
  System.out.println("  Type: " + shape.getShapeType()); 
  Point pt = shape.getPosition(); 
  Size sz = shape.getSize(); 
  System.out.println("  Position/size: (" +<br />
               pt.X/100 + ", " +  pt.Y/100 +  ") / (" +<br />
               sz.Width/100 + ", " + sz.Height/100 + ")"); 
}  // end of reportPosSize() </p>
<p>XShape.getShapeType() returns the class name of the shape as a string (in this case, 
"com.sun.star.drawing.TextShape"). </p>
<h2 id="7-a-transparent-circle-and-a-polar-line">7.  A Transparent Circle and a Polar Line</h2>
<p>The last two shapes created by DrawPicture.java's drawShapes() are a gray 
transparent circle and a polar line.  </p>
<p>// in drawShapes() in DrawPicture.java 
// gray transparent circle; uses (x,y), radius 
XShape circle2 = Draw.drawCircle(currSlide, 40, 150, 20); 
Props.setProperty(circle2, "FillColor",<br />
                  Lo.getColorInt(java.awt.Color.GRAY)); 
Draw.setTransparency(circle2, 25); </p>
<p>// thick line; uses (x,y), angle clockwise from x-axis, length 
XShape line2 = Draw.drawPolarLine(currSlide, 60, 200, 45, 100); 
Props.setProperty(line2, "LineWidth", 300);    // 3mm </p>
<p>A polar line is one defined using polar coordinates, which specifies the coordinate of 
one end of the line, and the angle and length of the line from that point. </p>
<p>Draw.drawCircle() uses an EllipseShape, and Draw.drawPolarLine() converts the 
polar values into two coordinates so Draw.drawLine() can be called. </p>
<h2 id="8-a-math-formula-as-an-ole-shape">8.  A Math formula as an OLE Shape</h2>
<p>Draw/Impress documents can include OLE objects through OLE2Shape, which 
allows a shape to link to an external document. Probably the most popular kind of 
OLE shape is the chart, but I'll delay a detailed discussion of that topic until Part 5, 
although there is a code snippet below. </p>
<p>The best way of finding out what OLE objects are available is to go to Draw's (or 
Impress') Insert menu  Object  "OLE Object" dialog. It lists Office spreadsheet, 
chart, drawing, presentation, and formula documents, and a range of Microsoft and 
PDF types (when you click on "Further objects").  </p>
<p>The DrawPicture.java OLE example displays a mathematical formula, as in Figure 13. </p>
<p><img alt="" src="images/13-Basic_Shapes-13.png" /></p>
<p>Figure 13. A Math Formula in a Draw Document. </p>
<p>DrawPicture.java renders the formula by calling Draw.addFormula(), which hides the 
tricky aspects of instatiating the OLE shape: </p>
<p>// in main() in DrawPicture.java 
Draw.drawFormula(currSlide, "func e^{i %pi} + 1 = 0", <br />
                                         23, 20, 20, 40); </p>
<p>The second argument is a formula string, written using Office's Math notation. For an 
overview, see the "Commands Reference" appendix of the "Math Guide", available 
from https://www.libreoffice.org/get-help/documentation/. </p>
<p>Draw.drawFormula() is coded as: </p>
<p>public static XShape drawFormula(XDrawPage slide, String formula, 
                                 int x, int y, int width, int height) 
{ <br />
  XShape shape = addShape(slide, "OLE2Shape", x, y, width, height); 
  Props.setProperty(shape, "CLSID", Lo.MATH_CLSID);  // a formula </p>
<p>XModel model = Lo.qi(XModel.class,<br />
                          Props.getProperty(shape, "Model") ); 
  Props.setProperty(model, "Formula", formula);  <br />
                      // from FormulaProperties 
  return shape; 
}  // end of drawFormula() </p>
<p>OLE2Shape uses a "CLSID" property to hold the class ID of the OLE object. Setting 
this property affects the shape's model (data format), which is stored in the "Model" 
property. drawFormula() casts this property to XModel and, since the model 
represents formula data, it has a "Formula" property where the formula string is 
stored. </p>
<p>Creating Other Kinds of OLE Shape 
The use of a "Formula" property in Draw.drawFormula() only works for an OLE 
shape representing a formula. How are other kinds of data stored? 
The first step is to set the OLE shape's class ID to the correct value, which will affect 
its "Model" property. A short list of class ID constants are included at the start of the 
Lo utility class, along with a few commented out IDs which I haven’t tested. </p>
<p>Creating an OLE2Shape for a chart begins like so: </p>
<p>XShape shape = addShape(slide, "OLE2Shape", x, y, width, height); 
Props.setProperty(shape, "CLSID", Lo.CHART_CLSID);  // a chart </p>
<p>XModel model = Lo.qi(XModel.class,<br />
                          Props.getProperty(shape, "Model") ); </p>
<p>Online information on how to use XModel to store a chart, a graphic, or something 
else, is pretty sparse. I've found the best start is to list the services that support the 
XModel reference. This is done by calling Info.showServices(): 
Info.showServices("OLE2Shape Model", model); 
For the version of model in drawFormula(), it reports: </p>
<p>OLE2Shape Model Supported Services (2) 
  "com.sun.star.document.OfficeDocument" 
  "com.sun.star.formula.FormulaProperties" </p>
<p>This gives a strong hint to look inside the FormulaProperties service, to find a 
property for storing the formula string. A look at the documentation (lodoc 
FormulaProperties service) reveals a "Formula" property, which I used in 
drawFormula(). </p>
<p>When the model refers to chart data, the same call to Info.showServices() prints: </p>
<p>OLE2Shape Model Supported Services (3) 
  "com.sun.star.chart.ChartDocument" 
  "com.sun.star.chart2.ChartDocument" 
  "com.sun.star.document.OfficeDocument" </p>
<p>The com.sun.star.chart2 package is the newer way of manipulating charts, which 
suggests that the XModel interfaces should be converted to an interface of 
com.sun.star.chart2.ChartDocument. The most useful is XChartDocument, which is 
obtained via: 
XChartDocument chartDoc = Lo.qi(XChartDocument.class, model); 
XChartDocument supports a rich set of chart manipulation methods.  I'll return to 
charts in Part 5. </p>
<h2 id="9-polygons">9.  Polygons</h2>
<p>The main() function of AnimBicycle.java calls Draw.drawPolygon() twice to create 
regular polygons for a square and pentagon: </p>
<p>// in AnimBicycle.java 
XShape square = Draw.drawPolygon(currSlide, 125, 125, 25, 4); 
                                  // (x,y), radius, no. of sides 
Props.setProperty(square, "FillColor", 0x3fe694);  // pale green </p>
<p>XShape pentagon = Draw.drawPolygon(currSlide, 150, 75, 5); 
                                  // (x,y), no. of sides 
                                  // radius uses a default value 
Props.setProperty(pentagon, "FillColor", 0xe7b9c7);  // purple </p>
<p>The polygons can be seen in Figure 14. </p>
<p><img alt="" src="images/13-Basic_Shapes-14.png" /></p>
<p>Figure 14. Bicycle and Shapes. </p>
<p>Draw.drawPolygon() is: </p>
<p>// in the Draw class 
public static XShape drawPolygon(XDrawPage slide, 
                    int x, int y, int radius, int nSides) 
{ 
  XShape polygon = addShape(slide, "PolyPolygonShape", 0, 0, 0, 0); 
     // for shapes formed by one <em>or more</em> polygons </p>
<p>Point[] pts = genPolygonPoints(x, y, radius, nSides); 
  Point[][] polys = new Point[][] {pts}; 
     // an array of Point arrays, one Point array for each polygon </p>
<p>Props.setProperty(polygon, "PolyPolygon", polys); 
  return polygon; 
}  // end of drawPolygon() </p>
<p>drawPolygon() creates a "PolyPolygonShape" shape which is designed to store 
multiple polygons. This is why the polys data structure instantiated at the end of 
drawPolygon()  is an array of points arrays, since the shape's "PolyPolygon" property 
can hold multiple point arrays. However, drawPolygon() only creates a single points 
array by calling genPolygonPoints(). </p>
<p>A points array defining the four points of a square could be: </p>
<p>Point[] pts = new Point[4]; 
pts[0] = new Point(4000, 1200); 
pts[1] = new Point(4000, 2000); 
pts[2] = new Point(5000, 2000); 
pts[3] = new Point(5000, 1200); </p>
<p>Note that the coordinates of each point use Office's 1/100 mm units.   </p>
<p>genPolygonPoints() generates a points array for a regular polygon based on the 
coordinate of the center of the polygon, the distance from the center to each point (the 
shape's radius), and the required number of sides: </p>
<p>private static Point[] genPolygonPoints(int x, int y,<br />
                                  int radius, int nSides) 
{ if (nSides &lt; 3) { 
    System.out.println("Too few sides; must be 3 or more"); 
    nSides = 3; 
  } 
  else if (nSides &gt; 30) { 
    System.out.println("Too many sides; must be 30 or less"); 
    nSides = 30; 
  } </p>
<p>Point[] pts = new Point[nSides]; 
  double angleStep = Math.PI/nSides; 
  for (int i = 0; i &lt; nSides; i++) { 
    pts[i] = new Point( 
       (int) Math.round(x<em>100 +<br />
                        radius</em>100 * Math.cos(i<em>2</em>angleStep)), 
       (int) Math.round(y<em>100 +<br />
                        radius</em>100 * Math.sin(i<em>2</em>angleStep)) ); 
  } 
  return pts; 
}  // end of genPolygonPoints() </p>
<ol>
<li>Mult-line Shapes 
A PolyLineShape can hold multiple line paths, where a path is a sequence of 
connected lines. Draw.drawLines() only creates a single line path, based on being 
passed arrays of x- and  y- axis coordinates. For example, the following code in 
AnimBicycle creates the crossed lines at the top-left of Figure 14: </li>
</ol>
<p>// in AnimBicycle.java 
int[] xs = {10, 30, 10, 30}; 
int[] ys = {10, 100, 100, 10}; 
Draw.drawLines(currSlide, xs, ys); </p>
<p>Draw.drawLines() is: </p>
<p>// in the Draw class 
public static XShape drawLines(XDrawPage slide, int[] xs, int[] ys) 
{ 
  if (xs.length != ys.length) { 
    System.out.println("The two arrays must be the same length"); 
    return null; 
  } </p>
<p>int numPoints = xs.length; 
  Point[] pts = new Point[numPoints]; 
  for (int i = 0; i &lt; numPoints; i++) 
    pts[i] = new Point(xs[i]<em>100, ys[i]</em>100);  //in 1/100 mm units </p>
<p>Point[][] linePaths = new Point[][] {pts}; 
    // an array of Point arrays, one Point array for each line path </p>
<p>XShape polyLine = addShape(slide, "PolyLineShape", 0, 0, 0, 0); 
     // for a shape formed from multiple line paths </p>
<p>Props.setProperty(polyLine, "PolyPolygon", linePaths); 
  return polyLine; 
}  // end of drawLines() </p>
<p>drawLines() creates an array of Point arrays which is stored in the PolyLineShape 
property called "PolyPolygon". However, drawLines() only adds a single points array 
to the linePaths data structure since only one line path is being created. </p>
<ol>
<li>Partial Ellipses 
EllipseShape contains a "CircleKind" property that determines whether the entire 
ellipse should be drawn, or only a portion of it. The properties "CircleStartAngle" and 
"CircleEndAngle" define the angles where the solid part of the ellipse starts and 
finishes. Zero degrees is the positive x-axis, and the angle increase in 1/100 degrees 
units counter-clockwise around the center of the ellipse. </li>
</ol>
<p>AnimBicycle.java contains the following example: </p>
<p>// in AnimBicycle.java 
XShape pie = Draw.drawEllipse(currSlide, 30,<br />
                               slideSize.Width-100, 40, 20); </p>
<p>Props.setProperty(pie, "CircleStartAngle", 9000); // 90 degrees ccw 
Props.setProperty(pie, "CircleEndAngle", 36000);  // 360 degrees ccw </p>
<p>Props.setProperty(pie, "CircleKind", CircleKind.SECTION); 
                         // CircleKind.CUT, CircleKind.ARC </p>
<p>This creates the blue partial ellipse shown at the bottom left of Figure 14. </p>
<p>Figure 15 shows the different results when "CircleKind" is set to 
CircleKind.SECTION, CircleKind.CUT, and CircleKind.ARC. </p>
<p><img alt="" src="images/13-Basic_Shapes-15.png" /></p>
<p>Figure 15. Different Types of Partial Ellipse </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="12-Examining_DrawImpress.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 12. Examining a Draw/Impress
            </div>
          </div>
        </a>
      
      
        <a href="14-Animation.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 14. Animation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>