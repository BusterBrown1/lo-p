
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/31-XY_Scatter_Charts.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 31. XY (Scatter) Charts - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-31-xy-scatter-charts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 31. XY (Scatter) Charts
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 31. XY (Scatter) Charts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link md-nav__link--active">
        Chapter 31. XY (Scatter) Charts
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-a-scatter-chart-with-regressions" class="md-nav__link">
    1.  A Scatter Chart (with Regressions)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-calculating-regressions" class="md-nav__link">
    2.  Calculating Regressions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-drawing-a-regression-curve" class="md-nav__link">
    3.  Drawing a Regression Curve
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-changing-axis-scales" class="md-nav__link">
    4.  Changing Axis Scales
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adding-error-bars" class="md-nav__link">
    5.  Adding Error Bars
  </a>
  
    <nav class="md-nav" aria-label="5.  Adding Error Bars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-creating-new-chart-data" class="md-nav__link">
    5.1.  Creating New Chart Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-creating-the-data-sink" class="md-nav__link">
    5.2.  Creating the Data Sink
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-linking-the-data-sink-to-the-chart" class="md-nav__link">
    5.3.  Linking the Data Sink to the Chart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-bringing-it-all-together" class="md-nav__link">
    5.4.  Bringing it All Together
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-a-scatter-chart-with-regressions" class="md-nav__link">
    1.  A Scatter Chart (with Regressions)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-calculating-regressions" class="md-nav__link">
    2.  Calculating Regressions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-drawing-a-regression-curve" class="md-nav__link">
    3.  Drawing a Regression Curve
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-changing-axis-scales" class="md-nav__link">
    4.  Changing Axis Scales
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adding-error-bars" class="md-nav__link">
    5.  Adding Error Bars
  </a>
  
    <nav class="md-nav" aria-label="5.  Adding Error Bars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-creating-new-chart-data" class="md-nav__link">
    5.1.  Creating New Chart Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-creating-the-data-sink" class="md-nav__link">
    5.2.  Creating the Data Sink
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-linking-the-data-sink-to-the-chart" class="md-nav__link">
    5.3.  Linking the Data Sink to the Chart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-bringing-it-all-together" class="md-nav__link">
    5.4.  Bringing it All Together
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/main/docs/31-XY_Scatter_Charts.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-31-xy-scatter-charts">Chapter 31. XY (Scatter) Charts<a class="headerlink" href="#chapter-31-xy-scatter-charts" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>A Scatter Chart
(with Regressions);
Calculating Regressions;
Drawing a Regression
Curve; Changing Axis
Scales; Adding Error
Bars</p>
<p>Example folders:
"Chart2 Tests" and
"Utils"</p>
</div>
<p>This chapter continues using the Chart2Views.java
example from previous chapters, but looks at how various
kinds of scatter charts can be generated from spreadsheet
data.</p>
<p>A scatter chart is a good way to display (x, y) coordinate
data since the x-axis values are treated as numbers not
categories. In addition, regression functions can be calculated and displayed, the axis
scales can be changed, and error bars added.</p>
<p>The relevant lines of Chart2Views.java are:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2Views.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XSpreadsheetDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">openDoc</span><span class="p">(</span><span class="n">CHARTS_DATA</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>

  <span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">XSpreadsheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheet</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="c1">// ---- use different chart templates ----</span>

  <span class="n">scatterChart</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>               <span class="c1">// see sections 1-3</span>
  <span class="c1">// scatterLineLogChart(doc, sheet);     // section 4</span>
  <span class="c1">// scatterLineErrorChart(doc, sheet);   // section 5</span>

         <span class="p">:</span>  <span class="c1">// more chart examples</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">waitEnter</span><span class="p">();</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
<h2 id="1-a-scatter-chart-with-regressions">1.  A Scatter Chart (with Regressions)<a class="headerlink" href="#1-a-scatter-chart-with-regressions" title="Permanent link">&para;</a></h2>
<p>scatterChart() in Chart2Views.java utilizes the "Ice Cream Sales vs. Temperature"
table in "chartsData.ods" (see Figure 1) to generate the scatter chart in Figure 2.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-1.png" /></p>
<p>Figure 1. The  "Ice Cream Sales vs. Temperature" Table.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-2.png" /></p>
<p>Figure 2. Scatter Chart for the Table in Figure 1.</p>
<p>Note that the x-axis in Figure 1 is numerical, showing values ranging between 10.0
and 26.0. This range is calculated automatically by the template.</p>
<p>scatterChart() is:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Chart2Views.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">scatterChart</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                       <span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CellRangeAddress</span> <span class="n">rangeAddr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A110:B122&quot;</span><span class="p">);</span>
  <span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">insertChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span>
              <span class="n">rangeAddr</span><span class="p">,</span> <span class="s">&quot;C109&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s">&quot;ScatterSymbol&quot;</span><span class="p">);</span>
                 <span class="c1">// ScatterSymbol, ScatterLine, ScatterLineSymbol</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;A104&quot;</span><span class="p">);</span>

  <span class="n">Chart2</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A109&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setXAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A110&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;B110&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">rotateYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="mi">90</span><span class="p">);</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setDataPointLabels</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">DP_NONE</span><span class="p">);</span>
                                       <span class="c1">// reduce clutter</span>

  <span class="c1">// Chart2.calcRegressions(chartDoc);</span>
  <span class="c1">// Chart2.drawRegressionCurve(chartDoc, Chart2.LINEAR);</span>
<span class="p">}</span>  <span class="c1">// end of scatterChart()</span>
</code></pre></div>
<p>If the Chart2.calcRegressions() line is uncommented then several different regression
functions are calculated using the chart's data. Their equations and R<sup>2</sup> values are
printed as shown below:</p>
<div class="highlight"><pre><span></span><code>Linear regression curve:
  Curve equation: f(x) = 30.09x - 159.5
  R^2 value: 0.917

Logarithmic regression curve:
  Curve equation: f(x) = 544.1 ln(x) - 1178
  R^2 value: 0.921

Exponential regression curve:
  Curve equation: f(x) = 81.62 exp( 0.0826 x )
  R^2 value: 0.865

Power regression curve:
  Curve equation: f(x) = 4.545 x^1.525
  R^2 value: 0.906

Polynomial regression curve:
  Curve equation: f(x) =  - 0.5384x^2 + 50.24x - 340.1
  R^2 value: 0.921

Moving average regression curve:
  Curve equation: Moving average trend line with period = %PERIOD
  R^2 value: NaN
</code></pre></div>
<p>A logarithmic or quadratic polynomial are the best matches, but linear is a close third.
The "moving average" R<sup>2</sup> result is NaN (Not-a-Number) since no average of period 2
matches the data.</p>
<p>If the Chart2.drawRegressionCurve() call is uncommented, the chart drawing will
include a linear regression line and its equation and R<sup>2</sup> value (see Figure 3).</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-3.png" /></p>
<p>Figure 3. Scatter Chart with Linear Regression Line for the Table in Figure 1.</p>
<p>The regression function is f(x) = 30.09x - 159.47, and the C value is 0.92 (to 2 dp). If
the constant is changed to Chart2.LOGARITHMIC in the call to
Chart2.drawRegressionCurve() then the generated function is f(x) = 544.1 ln(x) –
1178 with an R<sup>2</sup> value of 0.92. Other regression curves are represented by the Chart2
constants EXPONENTIAL, POWER, POLYNOMIAL, and MOVING_AVERAGE.</p>
<h2 id="2-calculating-regressions">2.  Calculating Regressions<a class="headerlink" href="#2-calculating-regressions" title="Permanent link">&para;</a></h2>
<p>Chart2.calcRegressions() is:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="c1">// globals</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">CURVE_KINDS</span> <span class="o">=</span>
      <span class="p">{</span> <span class="n">LINEAR</span><span class="p">,</span> <span class="n">LOGARITHMIC</span><span class="p">,</span> <span class="n">EXPONENTIAL</span><span class="p">,</span> <span class="n">POWER</span><span class="p">,</span>
        <span class="n">POLYNOMIAL</span><span class="p">,</span> <span class="n">MOVING_AVERAGE</span> <span class="p">};</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">CURVE_NAMES</span> <span class="o">=</span>
      <span class="p">{</span> <span class="s">&quot;Linear&quot;</span><span class="p">,</span> <span class="s">&quot;Logarithmic&quot;</span><span class="p">,</span> <span class="s">&quot;Exponential&quot;</span><span class="p">,</span> <span class="s">&quot;Power&quot;</span><span class="p">,</span>
        <span class="s">&quot;Polynomial&quot;</span><span class="p">,</span> <span class="s">&quot;Moving average&quot;</span> <span class="p">};</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">calcRegressions</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">CURVE_KINDS</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">XRegressionCurve</span> <span class="n">curve</span> <span class="o">=</span> <span class="n">createCurve</span><span class="p">(</span><span class="n">CURVE_KINDS</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">CURVE_NAMES</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot; regression curve:&quot;</span><span class="p">);</span>
    <span class="n">evalCurve</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">curve</span><span class="p">);</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of calcRegressions()</span>
</code></pre></div>
<p>createCurve() matches the regression constants defined in CURVE_KINDS[] to
regression services offered by the API:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XRegressionCurve</span> <span class="nf">createCurve</span><span class="p">(</span><span class="kt">int</span> <span class="n">curveKind</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">curveKind</span> <span class="o">==</span> <span class="n">LINEAR</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XRegressionCurve</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                <span class="s">&quot;com.sun.star.chart2.LinearRegressionCurve&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">curveKind</span> <span class="o">==</span> <span class="n">LOGARITHMIC</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XRegressionCurve</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                <span class="s">&quot;com.sun.star.chart2.LogarithmicRegressionCurve&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">curveKind</span> <span class="o">==</span> <span class="n">EXPONENTIAL</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XRegressionCurve</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                <span class="s">&quot;com.sun.star.chart2.ExponentialRegressionCurve&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">curveKind</span> <span class="o">==</span> <span class="n">POWER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XRegressionCurve</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                <span class="s">&quot;com.sun.star.chart2.PotentialRegressionCurve&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">curveKind</span> <span class="o">==</span> <span class="n">POLYNOMIAL</span><span class="p">)</span>        <span class="c1">// assume degree == 2</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XRegressionCurve</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                <span class="s">&quot;com.sun.star.chart2.PolynomialRegressionCurve&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">curveKind</span> <span class="o">==</span> <span class="n">MOVING_AVERAGE</span><span class="p">)</span>    <span class="c1">// assume period == 2</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XRegressionCurve</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
         <span class="s">&quot;com.sun.star.chart2.MovingAverageRegressionCurve&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Did not recognize regression line kind: &quot;</span> <span class="o">+</span>
                       <span class="n">curveKind</span> <span class="o">+</span> <span class="s">&quot;; using linear&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XRegressionCurve</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                <span class="s">&quot;com.sun.star.chart2.LinearRegressionCurve&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of createCurve()</span>
</code></pre></div>
<p>There are seven regression curve services in the chart2 module, all of which support
the XRegressionCurve interface, as shown in Figure 4.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-4.png" /></p>
<p>Figure 4. The Regression Curve Services</p>
<p>The RegressionCurve service shown in Figure 4 is not a superclass for the other
services. Also note that the regression curve service for power functions is called
"PotentialRegressionCurve".</p>
<p>Chart2.evalCurve() uses XRegressionCurve.getCalculator() to access the
XRegressionCurveCalculator interface. It sets up the data and parameters for a
particular curve, and prints the results of curve fitting:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">evalCurve</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                             <span class="n">XRegressionCurve</span> <span class="n">curve</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XRegressionCurveCalculator</span> <span class="n">curveCalc</span> <span class="o">=</span> <span class="n">curve</span><span class="p">.</span><span class="na">getCalculator</span><span class="p">();</span>

  <span class="kt">int</span> <span class="n">degree</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">getCurveType</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="o">!=</span> <span class="n">LINEAR</span><span class="p">)</span>
    <span class="n">degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>   <span class="c1">// assumes POLYNOMIAL curve has degree == 2</span>
  <span class="n">curveCalc</span><span class="p">.</span><span class="na">setRegressionProperties</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
          <span class="c1">// args: degree, forceIntercept, interceptValue, period</span>

  <span class="n">XDataSource</span> <span class="n">dataSource</span> <span class="o">=</span> <span class="n">getDataSource</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="c1">// printLabeledSeqs(dataSource);</span>

  <span class="kt">double</span><span class="o">[]</span> <span class="n">xVals</span> <span class="o">=</span> <span class="n">getChartData</span><span class="p">(</span><span class="n">dataSource</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="kt">double</span><span class="o">[]</span> <span class="n">yVals</span> <span class="o">=</span> <span class="n">getChartData</span><span class="p">(</span><span class="n">dataSource</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="n">curveCalc</span><span class="p">.</span><span class="na">recalculateRegression</span><span class="p">(</span><span class="n">xVals</span><span class="p">,</span> <span class="n">yVals</span><span class="p">);</span>

  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  Curve equation: &quot;</span> <span class="o">+</span>
                            <span class="n">curveCalc</span><span class="p">.</span><span class="na">getRepresentation</span><span class="p">());</span>
  <span class="kt">double</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">curveCalc</span><span class="p">.</span><span class="na">getCorrelationCoefficient</span><span class="p">();</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;  R^2 value: %.3f\n&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">cc</span><span class="o">*</span><span class="n">cc</span><span class="p">));</span>   <span class="c1">// 3 dp</span>
<span class="p">}</span>  <span class="c1">// end of evalCurve()</span>
</code></pre></div>
<p>The calculation is configured by calling
XRegressionCurveCalculator.setRegressionProperties(), and carried out by
XRegressionCurveCalculator.recalculateRegression().</p>
<p>The degree argument of setRegressionProperties() specifies the polynomial curve's
degree, which I've hardwired to be quadratic (i.e. a degree of 2). The period argument
is used when a moving average curve is being fitted.</p>
<p>recalculateRegression() requires two arrays of x- and y- axis values for the scatter
points. These are obtained from the chart's data source by calling
Chart2.getDataSource() which returns the XDataSource interface for the DataSeries
service.</p>
<p>Figure 5 shows the XDataSource, XRegressionCurveContainer, and XDataSink
interfaces of the DataSeries service.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-5.png" /></p>
<p>Figure 5. More Detailed DataSeries Service.</p>
<p>In previous chapters, I've only used the XDataSeries interface, which offers access to
the data points in the chart. The XDataSource interface, which is read-only, gives
access to the underlying data that was used to create the points. The data is stored as
an array of XLabeledDataSequence objects; each object contains a label and a
sequence of data.</p>
<p>Chart2.getDataSource() is defined as:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XDataSource</span> <span class="nf">getDataSource</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XDataSeries</span><span class="o">[]</span> <span class="n">dataSeriesArr</span> <span class="o">=</span> <span class="n">getDataSeries</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDataSource</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">dataSeriesArr</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span> <span class="c1">// get first</span>
<span class="p">}</span>
</code></pre></div>
<p>This method assumes that the programmer wants the first data source in the data
series. This is adequate for most charts which only use one data source.</p>
<p>Chart2.printLabeledSeqs() is a diagnostic function for printing all the labeled data
sequences stored in an XDataSource:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printLabeledSeqs</span><span class="p">(</span><span class="n">XDataSource</span> <span class="n">dataSource</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XLabeledDataSequence</span><span class="o">[]</span> <span class="n">dataSeqs</span> <span class="o">=</span> <span class="n">dataSource</span><span class="p">.</span><span class="na">getDataSequences</span><span class="p">();</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No. of sequences in data source: &quot;</span> <span class="o">+</span>
                                         <span class="n">dataSeqs</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dataSeqs</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Object</span><span class="o">[]</span> <span class="n">labelSeq</span> <span class="o">=</span> <span class="n">dataSeqs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">getLabel</span><span class="p">().</span><span class="na">getData</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">labelSeq</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot; :&quot;</span><span class="p">);</span>
    <span class="n">Object</span><span class="o">[]</span> <span class="n">valsSeq</span> <span class="o">=</span> <span class="n">dataSeqs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">getValues</span><span class="p">().</span><span class="na">getData</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">Object</span> <span class="n">val</span> <span class="p">:</span> <span class="n">valsSeq</span><span class="p">)</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">val</span><span class="p">);</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
    <span class="n">String</span> <span class="n">srRep</span> <span class="o">=</span> <span class="n">dataSeqs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">getValues</span><span class="p">().</span>

                            <span class="n">getSourceRangeRepresentation</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  Source range: &quot;</span> <span class="o">+</span> <span class="n">srRep</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of printLabeledSeqs()</span>
</code></pre></div>
<p>When these function is applied to the data source for the scatter chart, the following is
printed:</p>
<div class="highlight"><pre><span></span><code>No. of sequences in data source: 2
Temperature °C :  14.2  16.4  11.9  15.2  18.5  22.1  19.4
                  25.1  23.4  18.1  22.6  17.2
Source range: $examples.$A$111:$A$122

Ice Cream Sales :  215.0  325.0  185.0  332.0  406.0  522.0
                   412.0  614.0  544.0  421.0  445.0  408.0
Source range: $examples.$B$111:$B$122
</code></pre></div>
<p>This output shows that the data source consists of two XLabeledDataSequence
objects, representing the x- and y- values in the data source (see Figure 1). These
objects' data are extracted as arrays by calls to Chart2.getChartData():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="c1">// part of evalCurve()</span>
     <span class="p">:</span>
<span class="n">XDataSource</span> <span class="n">dataSource</span> <span class="o">=</span> <span class="n">getDataSource</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
<span class="n">printLabeledSeqs</span><span class="p">(</span><span class="n">dataSource</span><span class="p">);</span>

<span class="kt">double</span><span class="o">[]</span> <span class="n">xVals</span> <span class="o">=</span> <span class="n">getChartData</span><span class="p">(</span><span class="n">dataSource</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="kt">double</span><span class="o">[]</span> <span class="n">yVals</span> <span class="o">=</span> <span class="n">getChartData</span><span class="p">(</span><span class="n">dataSource</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">curveCalc</span><span class="p">.</span><span class="na">recalculateRegression</span><span class="p">(</span><span class="n">xVals</span><span class="p">,</span> <span class="n">yVals</span><span class="p">);</span>
</code></pre></div>
<p>When recalculateRegression() has finished, various results about the fitted curve can
be extracted from the XRegressionCurveCalculator variable, curveCalc. evalCurve()
prints the function string (using getRepresentation()) and the R
2
 value (using
getCorrelationCoefficient()).</p>
<h2 id="3-drawing-a-regression-curve">3.  Drawing a Regression Curve<a class="headerlink" href="#3-drawing-a-regression-curve" title="Permanent link">&para;</a></h2>
<p>One of the surprising things about drawing a regression curve is that there's no need to
explicitly calculate the curve's function with XRegressionCurveCalculator. Instead
Chart2.drawRegressionCurve() only has to initialize the curve via the data series'
XRegressionCurveContainer interface (see Figure 5). drawRegressionCurve() is:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">drawRegressionCurve</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                       <span class="kt">int</span> <span class="n">curveKind</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XDataSeries</span><span class="o">[]</span> <span class="n">dataSeriesArr</span> <span class="o">=</span> <span class="n">getDataSeries</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="n">XRegressionCurveContainer</span> <span class="n">rcCon</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span>
             <span class="n">XRegressionCurveContainer</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">dataSeriesArr</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span>

  <span class="n">XRegressionCurve</span> <span class="n">curve</span> <span class="o">=</span> <span class="n">createCurve</span><span class="p">(</span><span class="n">curveKind</span><span class="p">);</span>
  <span class="n">rcCon</span><span class="p">.</span><span class="na">addRegressionCurve</span><span class="p">(</span><span class="n">curve</span><span class="p">);</span>  <span class="c1">// calculates the curve</span>

  <span class="c1">// show equation and R^2 value</span>
  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">curve</span><span class="p">.</span><span class="na">getEquationProperties</span><span class="p">();</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;ShowCorrelationCoefficient&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;ShowEquation&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

  <span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="n">getNumberFormatKey</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="s">&quot;0.00&quot;</span><span class="p">);</span>   <span class="c1">// 2 dp</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;NumberFormat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of drawRegressionCurve()</span>
</code></pre></div>
<p>The XDataSeries interface for the first data series in the chart is converted to
XRegressionCurveContainer, and an XRegressionCurve instance added to it. This
triggers the calculation of the curve's function. The rest of drawRegressionCurve()
deals with how the function information is displayed on the chart.</p>
<p>XRegressionCurve.getEquationProperties() returns a property set which is an instance
of the RegressionCurveEquation class, shown in Figure 6.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-6.png" /></p>
<p>Figure 6. The RegressionCurveEquation Property Class.</p>
<p>RegressionCurveEquation inherits properties related to character, fill, and line, since
it controls how the curve, function string, and R<sup>2</sup> value are drawn on the chart. These
last two are made visible by setting the "ShowEquation" and
"ShowCorrelationCoefficient" properties to true, which are defined in
RegressionCurveEquation. Online documentation on this class can be accessed using
<code>lodoc RegressionCurveEquation</code>.</p>
<p>Another useful property is "NumberFormat" which can be used to reduce the number
of decimal places used when printing the function and R<sup>2</sup> value.</p>
<p>Chart2.getNumberFormatKey() converts a number format string into a number format
key, which is assigned to the "NumberFormat" property:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getNumberFormatKey</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                     <span class="n">String</span> <span class="n">nfStr</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XNumberFormatsSupplier</span> <span class="n">xfs</span> <span class="o">=</span>
                <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XNumberFormatsSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">chartDoc</span><span class="p">);</span>
  <span class="n">XNumberFormats</span> <span class="n">nFormats</span> <span class="o">=</span> <span class="n">xfs</span><span class="p">.</span><span class="na">getNumberFormats</span><span class="p">();</span>
  <span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">nFormats</span><span class="p">.</span><span class="na">queryKey</span><span class="p">(</span><span class="n">nfStr</span><span class="p">,</span>
              <span class="k">new</span> <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Locale</span><span class="p">(</span><span class="s">&quot;en&quot;</span><span class="p">,</span> <span class="s">&quot;us&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">),</span> <span class="kc">false</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access key for format: \&quot;&quot;</span> <span class="o">+</span>
                                                    <span class="n">nfStr</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">key</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getNumberFormatKey()</span>
</code></pre></div>
<p>The string-to-key conversion is straight forward if you know what number format
string to use, but there's little documentation on them. Probably the best approach is to
use the Format  Cells menu item in a spreadsheet document, and examine the
dialog in Figure 7.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-7.png" /></p>
<p>Figure 7. The Format Cells Dialog.</p>
<p>When you select a given category and format, the number format string is shown in
the "Format Code" field at the bottom of the dialog. Figure 7 shows that the format
string for two decimal place numbers is "0.00". This string should be passed to
getNumberFormatKey() in drawRegressionCurve():</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="n">getNumberFormatKey</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="s">&quot;0.00&quot;</span><span class="p">);</span>
</code></pre></div>
<h2 id="4-changing-axis-scales">4.  Changing Axis Scales<a class="headerlink" href="#4-changing-axis-scales" title="Permanent link">&para;</a></h2>
<p>Another way to understand scatter data is by changing the chart's axis scaling.
Alternatives to linear are logarithmic, exponential, or power, although I've found that
the latter two cause the chart to be drawn incorrectly.</p>
<p>scatterLineLogChart() in Chart2Views.java utilizes the "Power Function Test" table
in "chartsData.ods" (see Figure 8).</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-8.png" /></p>
<p>Figure 8. The "Power Function Test" Table.</p>
<p>I used the formula "<code>=4.1*POWER(E&lt;number&gt;, 3.2</code>)" (i.e. [*** Not rendered ***] ) to generate the
"Actual" column from the "Input" column's cells. Then I manually rounded the results
and copied them into the "Output" column.</p>
<p>The data range passed to the Chart.insertChart() uses the "Input" and "Output"
columns of the table in Figure 8. The generated scatter chart in Figure 9 uses log
scaling for the axes, and fits a power function to the data points.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-9.png" /></p>
<p>Figure 9. Scatter Chart for the Table in Figure 8.</p>
<p>The power  function fits the data so well that the black regression line lies over the
blue data curve. The regression function is f(x) = 3.89 x^2.32 (i.e.          ) with R<sup>2</sup>
= 1.00, which is close to the power formula I used to generate the "Actual" column
data.</p>
<p>scatterLineLogChart() is:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Chart2Views.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">scatterLineLogChart</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                        <span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CellRangeAddress</span> <span class="n">rangeAddr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E110:F120&quot;</span><span class="p">);</span>
  <span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span>
         <span class="n">Chart2</span><span class="p">.</span><span class="na">insertChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">rangeAddr</span><span class="p">,</span>
                         <span class="s">&quot;A121&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s">&quot;ScatterLineSymbol&quot;</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;A121&quot;</span><span class="p">);</span>

  <span class="n">Chart2</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E109&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setXAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E110&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;F110&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">rotateYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="mi">90</span><span class="p">);</span>

  <span class="c1">// change x- and y- axes to log scaling</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">scaleXAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">LOGARITHMIC</span><span class="p">);</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">scaleYAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">LOGARITHMIC</span><span class="p">);</span>
              <span class="c1">// LINEAR, LOGARITHMIC, (EXPONENTIAL, POWER)</span>

  <span class="n">Chart2</span><span class="p">.</span><span class="na">drawRegressionCurve</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">POWER</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of scatterLineLogChart()</span>
</code></pre></div>
<p>Chart2.scaleXAxis() and Chart2.scaleYAxis() call the more general
Chart2.scaleAxis() function:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XAxis</span> <span class="nf">scaleXAxis</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                               <span class="kt">int</span> <span class="n">scaleType</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">scaleAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">X_AXIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scaleType</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XAxis</span> <span class="nf">scaleYAxis</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                               <span class="kt">int</span> <span class="n">scaleType</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">scaleAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">Y_AXIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scaleType</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
<p>Chart2.scaleAxis() utilizes XAxis.getScaleData() and XAxis.setScaleData() to access
and modify the axis scales:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XAxis</span> <span class="nf">scaleAxis</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">axisVal</span><span class="p">,</span>
                                          <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">scaleType</span><span class="p">)</span>
<span class="cm">/* scaleTypes: LINEAR, LOGARITHMIC, EXPONENTIAL, POWER, but</span>
<span class="cm">   latter two seem unstable */</span>
<span class="p">{</span>
  <span class="n">XAxis</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">getAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">axisVal</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>

  <span class="n">ScaleData</span> <span class="n">sd</span> <span class="o">=</span> <span class="n">axis</span><span class="p">.</span><span class="na">getScaleData</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">scaleType</span> <span class="o">==</span> <span class="n">LINEAR</span><span class="p">)</span>
    <span class="n">sd</span><span class="p">.</span><span class="na">Scaling</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XScaling</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                       <span class="s">&quot;com.sun.star.chart2.LinearScaling&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">scaleType</span> <span class="o">==</span> <span class="n">LOGARITHMIC</span><span class="p">)</span>
    <span class="n">sd</span><span class="p">.</span><span class="na">Scaling</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XScaling</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                       <span class="s">&quot;com.sun.star.chart2.LogarithmicScaling&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">scaleType</span> <span class="o">==</span> <span class="n">EXPONENTIAL</span><span class="p">)</span>
    <span class="n">sd</span><span class="p">.</span><span class="na">Scaling</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XScaling</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                       <span class="s">&quot;com.sun.star.chart2.ExponentialScaling&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">scaleType</span> <span class="o">==</span> <span class="n">POWER</span><span class="p">)</span>
    <span class="n">sd</span><span class="p">.</span><span class="na">Scaling</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XScaling</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                       <span class="s">&quot;com.sun.star.chart2.PowerScaling&quot;</span><span class="p">);</span>
  <span class="k">else</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Did not recognize scaling: &quot;</span> <span class="o">+</span> <span class="n">scaleType</span><span class="p">);</span>
  <span class="n">axis</span><span class="p">.</span><span class="na">setScaleData</span><span class="p">(</span><span class="n">sd</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">axis</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of scaleAxis()</span>
</code></pre></div>
<p>The different scaling services all support the XScaling interface, as illustrated by
Figure 10.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-10.png" /></p>
<p>Figure 10. The Scaling Services.</p>
<h2 id="5-adding-error-bars">5.  Adding Error Bars<a class="headerlink" href="#5-adding-error-bars" title="Permanent link">&para;</a></h2>
<p>scatterLineErrorChart() in Chart2Views.java employs the "Impact Data : 1018 Cold
Rolled" table in "chartsData.ods" (see Figure 11).</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-11.png" /></p>
<p>Figure 11. The "Impact Data : 1018 Cold Rolled" Table.</p>
<p>The data range passed to the Chart.insertChart() uses the "Temperature" and "Mean"
columns of the table; the "Stderr" column is added separately to generate error bars
along the y-axis. The resulting scatter chart is shown in Figure 12.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-12.png" /></p>
<p>Figure 12. Scatter Chart with Error Bars for the Table in Figure 11.</p>
<p>scatterLineLogChart() is:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Chart2Views.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">scatterLineErrorChart</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                          <span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CellRangeAddress</span> <span class="n">rangeAddr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A142:B146&quot;</span><span class="p">);</span>
  <span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">insertChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span>
              <span class="n">rangeAddr</span><span class="p">,</span> <span class="s">&quot;F115&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s">&quot;ScatterLineSymbol&quot;</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;A123&quot;</span><span class="p">);</span>

  <span class="n">Chart2</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A141&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setXAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A142&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="s">&quot;Impact Energy (Joules)&quot;</span><span class="p">);</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">rotateYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="mi">90</span><span class="p">);</span>

  <span class="c1">// y-axis error bars</span>
  <span class="n">String</span> <span class="n">sheetName</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheetName</span><span class="p">(</span><span class="n">sheet</span><span class="p">);</span>
  <span class="n">String</span> <span class="n">errorLabel</span> <span class="o">=</span> <span class="n">sheetName</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="s">&quot;C142&quot;</span><span class="p">;</span>
  <span class="n">String</span> <span class="n">errorRange</span> <span class="o">=</span> <span class="n">sheetName</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="s">&quot;C143:C146&quot;</span><span class="p">;</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setYErrorBars</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">errorLabel</span><span class="p">,</span> <span class="n">errorRange</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of scatterLineErrorChart()</span>
</code></pre></div>
<p>The new feature in scatterLineErrorChart() is the call to Chart2.setYErrorBars(),
which I'll explain over the next four subsections.</p>
<h3 id="51-creating-new-chart-data">5.1.  Creating New Chart Data<a class="headerlink" href="#51-creating-new-chart-data" title="Permanent link">&para;</a></h3>
<p>The secret to adding extra data to a chart is XDataSink.setData(). XDataSink is yet
another interface for the DataSeries service (see Figure 5).</p>
<p>There are several stages required, which are depicted in Figure 13.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-13.png" /></p>
<p>Figure 13.  Using XDataSink to Add Data to a Chart.</p>
<p>The DataProvider service produces two XDataSequence objects which are combined
to become a XLabeledDataSequence object. An array of these objects is passed to
XDataSink.setData().</p>
<p>The DataProvider service is accessed with one line of code:</p>
<div class="highlight"><pre><span></span><code><span class="n">XDataProvider</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getDataProvider</span><span class="p">();</span>
</code></pre></div>
<p>Chart2.createLDSeq() creates a XLabeledDataSequence instance from two
XDataSequence objects, one acting as a label the other as data. The XDataSequence
object representing the data must have its "Role" property set to indicate the type of
the data.</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XLabeledDataSequence</span> <span class="nf">createLDSeq</span><span class="p">(</span><span class="n">XDataProvider</span> <span class="n">dp</span><span class="p">,</span>
            <span class="n">String</span> <span class="n">role</span><span class="p">,</span> <span class="n">String</span> <span class="n">dataLabel</span><span class="p">,</span> <span class="n">String</span> <span class="n">dataRange</span><span class="p">)</span>
<span class="c1">// create labeled data sequence using label and data;</span>
<span class="c1">// the data has the specified role</span>
<span class="p">{</span>
  <span class="c1">// create data sequence for the label</span>
  <span class="n">XDataSequence</span> <span class="n">labelSeq</span> <span class="o">=</span>
       <span class="n">dp</span><span class="p">.</span><span class="na">createDataSequenceByRangeRepresentation</span><span class="p">(</span><span class="n">dataLabel</span><span class="p">);</span>

  <span class="c1">// create data sequence for the data</span>
  <span class="n">XDataSequence</span> <span class="n">dataSeq</span> <span class="o">=</span>
       <span class="n">dp</span><span class="p">.</span><span class="na">createDataSequenceByRangeRepresentation</span><span class="p">(</span><span class="n">dataRange</span><span class="p">);</span>
  <span class="n">XPropertySet</span> <span class="n">dsProps</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">dataSeq</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dsProps</span><span class="p">,</span> <span class="s">&quot;Role&quot;</span><span class="p">,</span> <span class="n">role</span><span class="p">);</span>
                       <span class="c1">//specify data role (type)</span>

  <span class="c1">// create labeled data sequence using label and data seqs</span>
  <span class="n">XLabeledDataSequence</span> <span class="n">ldSeq</span> <span class="o">=</span>
         <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XLabeledDataSequence</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                 <span class="s">&quot;com.sun.star.chart2.data.LabeledDataSequence&quot;</span><span class="p">);</span>
  <span class="n">ldSeq</span><span class="p">.</span><span class="na">setLabel</span><span class="p">(</span><span class="n">labelSeq</span><span class="p">);</span>  <span class="c1">// add label</span>
  <span class="n">ldSeq</span><span class="p">.</span><span class="na">setValues</span><span class="p">(</span><span class="n">dataSeq</span><span class="p">);</span>  <span class="c1">// add data</span>
  <span class="k">return</span> <span class="n">ldSeq</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of createLDSeq()</span>
</code></pre></div>
<p>Four arguments are passed to createLDSeq(): a reference to the XDataProvider
interface, a role string, a label, and a data range. For example:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.setYErrorBars(); see section 5.4 below</span>
    <span class="p">:</span>
<span class="n">String</span> <span class="n">label</span> <span class="o">=</span> <span class="n">sheetName</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="s">&quot;C142&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">dataRange</span> <span class="o">=</span> <span class="n">sheetName</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="s">&quot;C143:C146&quot;</span><span class="p">;</span>
<span class="n">XLabeledDataSequence</span> <span class="n">lds</span> <span class="o">=</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">createLDSeq</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="s">&quot;error-bars-y-positive&quot;</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">dataRange</span><span class="p">);</span>
</code></pre></div>
<p>Role strings are defined in DataSequenceRole, which is documented on the page that
describes chart2's data submodule (call <code>lodoc chart2 data module</code>, and scroll to
the bottom).</p>
<p>XDataSink.setData() can accept multiple XLabeledDataSequence objects in an array,
making it possible to add several kinds of data to the chart at once. This is just as well
since I need to add two XLabeledDataSequence objects, one for the error bars above
the data points (i.e. up the y-axis), and another for the error bars below the points (i.e.</p>
<p>down the y-axis). The code for doing this:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.setYErrorBars(); see section 5.4 below</span>
    <span class="p">:</span>
<span class="n">XDataSink</span> <span class="n">dataSink</span> <span class="o">=</span> <span class="p">...</span>    <span class="c1">// create the data sink</span>

<span class="n">XDataProvider</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getDataProvider</span><span class="p">();</span>

<span class="n">XLabeledDataSequence</span> <span class="n">posErrSeq</span> <span class="o">=</span>    <span class="c1">// bars above data points</span>
    <span class="n">createLDSeq</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="s">&quot;error-bars-y-positive&quot;</span><span class="p">,</span> <span class="n">dataLabel</span><span class="p">,</span> <span class="n">dataRange</span><span class="p">);</span>

<span class="n">XLabeledDataSequence</span> <span class="n">negErrSeq</span> <span class="o">=</span>    <span class="c1">// bars below the data points</span>
    <span class="n">createLDSeq</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="s">&quot;error-bars-y-negative&quot;</span><span class="p">,</span> <span class="n">dataLabel</span><span class="p">,</span> <span class="n">dataRange</span><span class="p">);</span>

<span class="n">XLabeledDataSequence</span><span class="o">[]</span> <span class="n">ldSeqArr</span> <span class="o">=</span> <span class="p">{</span> <span class="n">posErrSeq</span><span class="p">,</span> <span class="n">negErrSeq</span> <span class="p">};</span>
     <span class="c1">// build array</span>

<span class="c1">// add the two error bars to the data sink</span>
<span class="n">dataSink</span><span class="p">.</span><span class="na">setData</span><span class="p">(</span><span class="n">ldSeqArr</span><span class="p">);</span>

<span class="c1">// add the data sink to the chart ...</span>
</code></pre></div>
<p>This code fragment leaves two topics unexplained: how the data sink is initially
created, and how the data sink is linked to the chart.</p>
<h3 id="52-creating-the-data-sink">5.2.  Creating the Data Sink<a class="headerlink" href="#52-creating-the-data-sink" title="Permanent link">&para;</a></h3>
<p>The data sink for error bars relies on the ErrorBar service, which is shown in Figure
14.</p>
<p><img alt="" src="images/31-XY_Scatter_Charts-14.png" /></p>
<p>Figure 14. The ErrorBar Service</p>
<p>The ErrorBar service stores error bar properties and implements the XDataSink
interface. The following code fragment creates an instance of the ErrorBar service,
sets some of its properties, and converts it to an XDataSink:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.setYErrorBars(); see section 5.4 below</span>
    <span class="p">:</span>
<span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                              <span class="s">&quot;com.sun.star.chart2.ErrorBar&quot;</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;ShowPositiveError&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;ShowNegativeError&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;ErrorBarStyle&quot;</span><span class="p">,</span> <span class="n">ErrorBarStyle</span><span class="p">.</span><span class="na">FROM_DATA</span><span class="p">);</span>

<span class="n">XDataSink</span> <span class="n">dataSink</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDataSink</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
</code></pre></div>
<p>For details on the ErrorBar service, execute <code>lodoc chart2 ErrorBar</code>.</p>
<h3 id="53-linking-the-data-sink-to-the-chart">5.3.  Linking the Data Sink to the Chart<a class="headerlink" href="#53-linking-the-data-sink-to-the-chart" title="Permanent link">&para;</a></h3>
<p>Once the data sink has been filled with XLabeledDataSequence objects, it can be
linked to the data series in the chart. For error bars this is done via the properties
"ErrorBarX" and "ErrorBarY". For example, the following code assigns a data sink to
the data series' "ErrorBarY" property:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.setYErrorBars(); see section 5.4 below</span>
    <span class="p">:</span>
<span class="n">XDataSeries</span><span class="o">[]</span> <span class="n">dsa</span> <span class="o">=</span> <span class="n">getDataSeries</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
<span class="n">XDataSeries</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">dsa</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&quot;ErrorBarY&quot;</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
</code></pre></div>
<p>Note that the value assigned to "ErrorBarY" is not an XDataSink interface (e.g. not
dataSink from the earlier code fragment) but its property set (i.e. props).</p>
<h3 id="54-bringing-it-all-together">5.4.  Bringing it All Together<a class="headerlink" href="#54-bringing-it-all-together" title="Permanent link">&para;</a></h3>
<p>Chart2.setYErrorBars() combines the previous code fragments into a single method:
the data sink is created (as a property set), XLabeledDataSequence data is added to it,
and then the sink is linked to the chart's data series:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setYErrorBars</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                <span class="n">String</span> <span class="n">dataLabel</span><span class="p">,</span> <span class="n">String</span> <span class="n">dataRange</span><span class="p">)</span>
<span class="c1">// see sections 5.1 – 5.3. for details of this code</span>
<span class="p">{</span>
  <span class="c1">// initialize error bar properties</span>
  <span class="n">XPropertySet</span> <span class="n">errorBarProps</span> <span class="o">=</span>
      <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                           <span class="s">&quot;com.sun.star.chart2.ErrorBar&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">errorBarProps</span><span class="p">,</span> <span class="s">&quot;ShowPositiveError&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">errorBarProps</span><span class="p">,</span> <span class="s">&quot;ShowNegativeError&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">errorBarProps</span><span class="p">,</span> <span class="s">&quot;ErrorBarStyle&quot;</span><span class="p">,</span>
                                       <span class="n">ErrorBarStyle</span><span class="p">.</span><span class="na">FROM_DATA</span><span class="p">);</span>

  <span class="c1">// convert into data sink</span>
  <span class="n">XDataSink</span> <span class="n">dataSink</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDataSink</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">errorBarProps</span><span class="p">);</span>

  <span class="c1">// use data provider to create labeled data sequences</span>
  <span class="c1">// for the +/- error ranges</span>
  <span class="n">XDataProvider</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getDataProvider</span><span class="p">();</span>

  <span class="n">XLabeledDataSequence</span> <span class="n">posErrSeq</span> <span class="o">=</span>
      <span class="n">createLDSeq</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="s">&quot;error-bars-y-positive&quot;</span><span class="p">,</span> <span class="n">dataLabel</span><span class="p">,</span> <span class="n">dataRange</span><span class="p">);</span>
  <span class="n">XLabeledDataSequence</span> <span class="n">negErrSeq</span> <span class="o">=</span>
      <span class="n">createLDSeq</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="s">&quot;error-bars-y-negative&quot;</span><span class="p">,</span> <span class="n">dataLabel</span><span class="p">,</span> <span class="n">dataRange</span><span class="p">);</span>
  <span class="n">XLabeledDataSequence</span><span class="o">[]</span> <span class="n">ldSeqArr</span> <span class="o">=</span> <span class="p">{</span> <span class="n">posErrSeq</span><span class="p">,</span> <span class="n">negErrSeq</span> <span class="p">};</span>

  <span class="c1">// store the error bar data sequences in the data sink</span>
  <span class="n">dataSink</span><span class="p">.</span><span class="na">setData</span><span class="p">(</span><span class="n">ldSeqArr</span><span class="p">);</span>

  <span class="c1">// store error bar in data series</span>
  <span class="n">XDataSeries</span><span class="o">[]</span> <span class="n">dataSeriesArr</span> <span class="o">=</span> <span class="n">getDataSeries</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="n">XDataSeries</span> <span class="n">dataSeries</span> <span class="o">=</span> <span class="n">dataSeriesArr</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dataSeries</span><span class="p">,</span> <span class="s">&quot;ErrorBarY&quot;</span><span class="p">,</span> <span class="n">errorBarProps</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of setYErrorBars()</span>
</code></pre></div>
<p>This is not our last visit to DataSink and XDataSink. I'll use their features again in the
next chapter.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 30. Bar, Pie, Area, Line Charts" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 30. Bar, Pie, Area, Line Charts
            </div>
          </div>
        </a>
      
      
        
        <a href="32-Bubble_Net_Stock_Charts.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 32. Bubble, Net, Stock Charts" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 32. Bubble, Net, Stock Charts
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>