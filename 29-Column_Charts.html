
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/29-Column_Charts.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>Chapter 29. Column Charts - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-29-column-charts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 29. Column Charts
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 29. Column Charts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="29-Column_Charts.html" class="md-nav__link md-nav__link--active">
        Chapter 29. Column Charts
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-creating-a-chart-title" class="md-nav__link">
    1.  Creating a Chart Title
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-creating-axis-titles" class="md-nav__link">
    2.  Creating Axis Titles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-rotating-axis-titles" class="md-nav__link">
    3.  Rotating Axis Titles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-what-chart-templates-are-available" class="md-nav__link">
    4.  What Chart Templates are Available?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-multiple-columns" class="md-nav__link">
    5.  Multiple Columns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-3d-pizazz" class="md-nav__link">
    6.  3D Pizazz
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-the-column-and-line-chart" class="md-nav__link">
    7.  The Column and Line Chart
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-creating-a-chart-title" class="md-nav__link">
    1.  Creating a Chart Title
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-creating-axis-titles" class="md-nav__link">
    2.  Creating Axis Titles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-rotating-axis-titles" class="md-nav__link">
    3.  Rotating Axis Titles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-what-chart-templates-are-available" class="md-nav__link">
    4.  What Chart Templates are Available?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-multiple-columns" class="md-nav__link">
    5.  Multiple Columns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-3d-pizazz" class="md-nav__link">
    6.  3D Pizazz
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-the-column-and-line-chart" class="md-nav__link">
    7.  The Column and Line Chart
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/flywire/lo-p/edit/main/docs/29-Column_Charts.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="chapter-29-column-charts">Chapter 29. Column Charts<a class="headerlink" href="#chapter-29-column-charts" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Creating a Chart
Title; Creating Axis
Titles; Rotating Axis
Titles; What Chart
Templates are
Available?; Multiple
Columns; 3D Pizazz;
The Column and Line
Chart</p>
<p>Example folders:
"Chart2 Tests" and
"Utils"</p>
</div>
<p>All the chart examples in the next four chapters come from
the same program, Chart2Views.java, which loads a
spreadsheet from "chartsData.ods". Depending on the
function, a different table in the sheet is used to create a
chart from a template. The main() function is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Chart2Views.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">CHARTS_DATA</span> <span class="o">=</span>
<span class="s">&quot;chartsData.ods&quot;</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XSpreadsheetDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">openDoc</span><span class="p">(</span><span class="n">CHARTS_DATA</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not open &quot;</span> <span class="o">+</span> <span class="n">CHARTS_DATA</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">XSpreadsheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheet</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="c1">// ---- use different chart templates ----</span>

  <span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span> <span class="n">colChart</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
                                <span class="c1">// see sections 1-3</span>

  <span class="c1">// String[] templateNames = Chart2.getChartTemplates(chartDoc);</span>
                                <span class="c1">// section 4</span>
  <span class="c1">// Lo.printNames(templateNames, 1);</span>

  <span class="c1">// multColChart(doc, sheet);  // sections 5 &amp; 6</span>
  <span class="c1">// colLineChart(doc, sheet);  // section 7</span>

  <span class="c1">// barChart(doc, sheet);</span>

  <span class="c1">// pieChart(doc, sheet);</span>
  <span class="c1">// pie3DChart(doc, sheet);</span>
  <span class="c1">// donutChart(doc, sheet);</span>

  <span class="c1">// areaChart(doc, sheet);</span>

  <span class="c1">// lineChart(doc, sheet);</span>
  <span class="c1">// linesChart(doc, sheet);</span>

  <span class="c1">// scatterChart(doc, sheet);</span>
  <span class="c1">// scatterLineLogChart(doc, sheet);</span>
  <span class="c1">// scatterLineErrorChart(doc, sheet);</span>

  <span class="c1">// labeledBubbleChart(doc, sheet);</span>

  <span class="c1">// netChart(doc, sheet);</span>

  <span class="c1">// happyStockChart(doc, sheet);</span>
  <span class="c1">// stockPricesChart(doc, sheet);</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">waitEnter</span><span class="p">();</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
</div>
</div>
</div>
<p>colChart() utilizes the "Sneakers Sold this Month" table in "chartsData.ods" (see
Figure 1) to generate the column chart in Figure 2.</p>
<p><img alt="" src="images/29-Column_Charts-1.png" /></p>
<p>Figure 1. The "Sneakers Sold this Month" Table.</p>
<p><img alt="" src="images/29-Column_Charts-2.png" /></p>
<p>Figure 2. The Column Chart for the Table in Figure 1.</p>
<p>colChart() is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Chart2Views.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">XChartDocument</span> <span class="nf">colChart</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                       <span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CellRangeAddress</span> <span class="n">rangeAddr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A2:B8&quot;</span><span class="p">);</span>
  <span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span>
      <span class="n">Chart2</span><span class="p">.</span><span class="na">insertChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">rangeAddr</span><span class="p">,</span> <span class="s">&quot;C3&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s">&quot;Column&quot;</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;A1&quot;</span><span class="p">);</span>

  <span class="n">Chart2</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A1&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setXAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A2&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;B2&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">rotateYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="mi">90</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">chartDoc</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of colChart()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The column chart created by Chart2.insertChart() utilizes the cell range A2:B8, which
spans the two columns of the table, but not the title in cell A1. The "C3" argument
specifies where the top-left corner of the chart will be positioned in the sheet, and
15x11 are the dimensions of the image in millimeters.</p>
<p>Calc.gotoCell() causes the application window's view of the spreadsheet to move so
that cell "A1" is visible, which lets the user see the sneakers table and the chart
together.</p>
<p>If the three set methods and rotateYAxisTitle() are left out of colChart(), then the
generated chart will have no titles as in Figure 3.</p>
<p><img alt="" src="images/29-Column_Charts-3.png" /></p>
<p>Figure 3. The Column Chart for the Table in Figure 1, with no Titles.</p>
<h2 id="1-creating-a-chart-title">1.  Creating a Chart Title<a class="headerlink" href="#1-creating-a-chart-title" title="Permanent link">&para;</a></h2>
<p>Chart2.setTitle() is passed a string which becomes the chart's title. For example:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// part of colChart() in Chart2Views.java...</span>
<span class="n">Chart2</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A1&quot;</span><span class="p">));</span>
</code></pre></div>
</div>
</div>
</div>
<p>utilizes the string from cell "A1" of the spreadsheet (see Figure 1).</p>
<p>Setting a title requires three interfaces: XTitled, XTitle, and XFormattedString.
XTitled is utilized by several chart services, as shown in Figure 4.</p>
<p><img alt="" src="images/29-Column_Charts-4.png" /></p>
<p>Figure 4. Services Using the XTitled Interface.</p>
<p>The XChartDocument interface is converted into XTitled by Chart2.setTitle(), so an
XTitle object can be assigned to the chart:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setTitle</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span> <span class="n">String</span> <span class="n">title</span><span class="p">)</span>
<span class="cm">/* set the title, and use Arial, 14 pt style */</span>
<span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Chart title: \&quot;&quot;</span> <span class="o">+</span> <span class="n">title</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
  <span class="n">XTitled</span> <span class="n">xTitled</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTitled</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">chartDoc</span><span class="p">);</span>
  <span class="n">XTitle</span> <span class="n">xtitle</span> <span class="o">=</span> <span class="n">createTitle</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xtitle</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">xTitled</span><span class="p">.</span><span class="na">setTitleObject</span><span class="p">(</span><span class="n">xtitle</span><span class="p">);</span>
    <span class="n">setXTitleFont</span><span class="p">(</span><span class="n">xtitle</span><span class="p">,</span> <span class="s">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setTitle()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The XTitle object is an instance of the Title service which inherits a wide assortment
of properties related to the text's paragraph, fill, and line styling, as shown in Figure 5.</p>
<p><img alt="" src="images/29-Column_Charts-5.png" /></p>
<p>Figure 5. The Title Service.</p>
<p>Text is added to the XTitle object by Chart2.createTitle(), as an XFormattedString
array:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XTitle</span> <span class="nf">createTitle</span><span class="p">(</span><span class="n">String</span> <span class="n">titleString</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XTitle</span> <span class="n">xtitle</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XTitle</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                            <span class="s">&quot;com.sun.star.chart2.Title&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xtitle</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unable to create xtitle interface&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">XFormattedString</span> <span class="n">xtitleStr</span> <span class="o">=</span>
       <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XFormattedString</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
           <span class="s">&quot;com.sun.star.chart2.FormattedString&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xtitleStr</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unable to create formatted string&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">xtitleStr</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">titleString</span><span class="p">);</span>
  <span class="n">XFormattedString</span><span class="o">[]</span> <span class="n">titleArray</span> <span class="o">=</span>
             <span class="k">new</span> <span class="n">XFormattedString</span><span class="o">[]</span> <span class="p">{</span><span class="n">xtitleStr</span><span class="p">};</span>
  <span class="n">xtitle</span><span class="p">.</span><span class="na">setText</span><span class="p">(</span><span class="n">titleArray</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">xtitle</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of createTitle()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The use of an XFormatttedString[] array may seem to be overkill when the title is a
single string, but it also allows character properties to be associated with the string
through XFormattedString2, as shown in Figure 6.</p>
<p><img alt="" src="images/29-Column_Charts-6.png" /></p>
<p>Figure 6. The FormattedString Service.</p>
<p>Character properties allow the font and point size of the title to be changed to Arial
14pt by Chart2.setXTitleFont():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setXTitleFont</span><span class="p">(</span><span class="n">XTitle</span> <span class="n">xtitle</span><span class="p">,</span>
                                 <span class="n">String</span> <span class="n">fontName</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ptSize</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XFormattedString</span><span class="o">[]</span> <span class="n">foStrs</span> <span class="o">=</span> <span class="n">xtitle</span><span class="p">.</span><span class="na">getText</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">foStrs</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">foStrs</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="s">&quot;CharFontName&quot;</span><span class="p">,</span> <span class="n">fontName</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">foStrs</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="s">&quot;CharHeight&quot;</span><span class="p">,</span> <span class="n">ptSize</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setXTitleFont()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The "CharFontName" and "CharHeight" properties come from the
CharacterProperties class.</p>
<h2 id="2-creating-axis-titles">2.  Creating Axis Titles<a class="headerlink" href="#2-creating-axis-titles" title="Permanent link">&para;</a></h2>
<p>Setting the axes titles needs a reference to the XAxis interface. Incidentally, this
interface name is a little misleading since "X" is the naming convention for interfaces,
not a reference to the x-axis.</p>
<p>Figure 9 in Chapter 28 shows that the XAxis interface is available via the
XCoordinateSystem interface, which can be obtained by calling
Chart2.getCoordSystem(). XCoordinateSystem.getAxisByDimension() can then be
employed to get an axis reference. This is implemented by Chart2.getAxis():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="c1">// globals: axis values</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">X_AXIS</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">Y_AXIS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">Z_AXIS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XAxis</span> <span class="nf">getAxis</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                  <span class="kt">int</span> <span class="n">axisVal</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XCoordinateSystem</span> <span class="n">coordSys</span> <span class="o">=</span> <span class="n">getCoordSystem</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">coordSys</span><span class="p">.</span><span class="na">getAxisByDimension</span><span class="p">(</span><span class="n">axisVal</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not get the axis&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getAxis()</span>
</code></pre></div>
</div>
</div>
</div>
<p>XCoordinateSystem.getAxisByDimension() takes two integer arguments: the first
represents the axis (x-, y-, or  z-), while the second is a primary or secondary index (0
or 1) for the chosen axis. Chart2.java includes wrapper functions for Chart2.getAxis()
for the most common cases:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XAxis</span> <span class="nf">getXAxis</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">getAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">X_AXIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="p">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="n">XAxis</span> <span class="nf">getYAxis</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">getAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">Y_AXIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="p">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="n">XAxis</span> <span class="nf">getXAxis2</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">getAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">X_AXIS</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="p">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="n">XAxis</span> <span class="nf">getYAxis2</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">getAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">Y_AXIS</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Chart2.setAxisTitle() calls Chart2.getAxis() to get a reference to the correct axis, and
then reuses many of the methods described earlier for setting the chart title:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setAxisTitle</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                     <span class="n">String</span> <span class="n">title</span><span class="p">,</span> <span class="kt">int</span> <span class="n">axisVal</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XAxis</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">getAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">axisVal</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="n">XTitled</span> <span class="n">titledAxis</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTitled</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">axis</span><span class="p">);</span>
  <span class="n">XTitle</span> <span class="n">xtitle</span> <span class="o">=</span> <span class="n">createTitle</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xtitle</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">titledAxis</span><span class="p">.</span><span class="na">setTitleObject</span><span class="p">(</span><span class="n">xtitle</span><span class="p">);</span>
    <span class="n">setXTitleFont</span><span class="p">(</span><span class="n">xtitle</span><span class="p">,</span> <span class="s">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">);</span>  <span class="c1">// Arial 12pt</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setAxisTitle()</span>
</code></pre></div>
</div>
</div>
</div>
<p>As with Chart2.getAxis(), Chart2.java includes wrapper methods for
Chart2.setAxisTitle() to simplify common axis cases:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setXAxisTitle</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                 <span class="n">String</span> <span class="n">title</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">setAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">X_AXIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="p">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setYAxisTitle</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                 <span class="n">String</span> <span class="n">title</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">setAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">Y_AXIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setXAxis2Title</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                  <span class="n">String</span> <span class="n">title</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">setAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">X_AXIS</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="p">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setYAxis2Title</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                  <span class="n">String</span> <span class="n">title</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">setAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">Y_AXIS</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="3-rotating-axis-titles">3.  Rotating Axis Titles<a class="headerlink" href="#3-rotating-axis-titles" title="Permanent link">&para;</a></h2>
<p>The default orientation for titles is horizontal, which is fine for the chart and x-axis
titles, but can cause the y-axis title to occupy too much horizontal space. The solution
is to call Chart2.rotateYAxisTitle() with an angle (usually 90 degrees) to turn the text
counter-clockwise so it's vertically orientated (see Figure 2).</p>
<p>The implementation accesses the XTitle interface for the axis title, and then modifies
its "TextRotation" property from the Title service (see Figure 5).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:1"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">rotateYAxisTitle</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                    <span class="kt">int</span> <span class="n">angle</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">rotateAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">Y_AXIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">angle</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">rotateAxisTitle</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                   <span class="kt">int</span> <span class="n">axisVal</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">angle</span><span class="p">)</span>
<span class="c1">// + angle is rotation counter-clockwise from horizontal</span>
<span class="p">{</span>
  <span class="n">XTitle</span> <span class="n">xtitle</span> <span class="o">=</span> <span class="n">getAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">axisVal</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xtitle</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">xtitle</span><span class="p">,</span> <span class="s">&quot;TextRotation&quot;</span><span class="p">,</span> <span class="n">angle</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of rotateAxisTitle()</span>



<span class="kd">public</span> <span class="kd">static</span> <span class="n">XTitle</span> <span class="nf">getAxisTitle</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                  <span class="kt">int</span> <span class="n">axisVal</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XAxis</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">getAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">axisVal</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="n">XTitled</span> <span class="n">titledAxis</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTitled</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">axis</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">titledAxis</span><span class="p">.</span><span class="na">getTitleObject</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of getAxisTitle()</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="4-what-chart-templates-are-available">4.  What Chart Templates are Available?<a class="headerlink" href="#4-what-chart-templates-are-available" title="Permanent link">&para;</a></h2>
<p>colChart() in Chart2Views.java returns its XChartDocument reference. This isn't
necessary for rendering the chart, but allows the reference to be passed to
Chart2.getChartTemplates():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:1"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in main() in Chart2Views.java...</span>
<span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span> <span class="n">colChart</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">templateNames</span> <span class="o">=</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">getChartTemplates</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
<span class="n">Lo</span><span class="p">.</span><span class="na">printNames</span><span class="p">(</span><span class="n">templateNames</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The only way to list the chart templates supported by the chart2 module (i.e. those
shown in Table 1 of Chapter 28) is by querying an existing chart document. That's the
purpose of Chart2.getChartTemplates():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">getChartTemplates</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XChartTypeManager</span> <span class="n">ctMan</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getChartTypeManager</span><span class="p">();</span>
  <span class="k">return</span> <span class="n">Info</span><span class="p">.</span><span class="na">getAvailableServices</span><span class="p">(</span><span class="n">ctMan</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Normally XChartTypeManager is used to create a template instance, but
Info.getAvailableServices() accesses its
XMultiServiceFactory.getAvailableServiceNames() method to list the names of all its
supported services, which are templates:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Info class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">getAvailableServices</span><span class="p">(</span><span class="n">Object</span> <span class="n">obj</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XMultiServiceFactory</span> <span class="n">msf</span> <span class="o">=</span>
                  <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XMultiServiceFactory</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">obj</span><span class="p">);</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">serviceNames</span> <span class="o">=</span> <span class="n">msf</span><span class="p">.</span><span class="na">getAvailableServiceNames</span><span class="p">();</span>
  <span class="n">Arrays</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">serviceNames</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">serviceNames</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getAvailableServices()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The output lists has 66 names, starting and ending like so:</p>
<div class="highlight"><pre><span></span><code>&quot;com.sun.star.chart2.template.Area&quot;
&quot;com.sun.star.chart2.template.Bar&quot;
&quot;com.sun.star.chart2.template.Bubble&quot;
&quot;com.sun.star.chart2.template.Column&quot;
&quot;com.sun.star.chart2.template.ColumnWithLine&quot;
     :
&quot;com.sun.star.chart2.template.ThreeDLineDeep&quot;
&quot;com.sun.star.chart2.template.ThreeDPie&quot;
&quot;com.sun.star.chart2.template.ThreeDPieAllExploded&quot;
&quot;com.sun.star.chart2.template.ThreeDScatter&quot;
</code></pre></div>
<p>Sixty-four of those names appear in Chapter 28's Table 1. The two missing are
"GL3DBar" and "GL3DBarRoundedRectangle", which were reported as being "not
ready for general use" in an OpenOffice forum posting from May 2014.</p>
<h2 id="5-multiple-columns">5.  Multiple Columns<a class="headerlink" href="#5-multiple-columns" title="Permanent link">&para;</a></h2>
<p>The multColChart() method in Chart2Views.java uses a table containing three
columns of data (see Figure 7) to generate two column graphs in the same chart, as in
Figure 8.</p>
<p><img alt="" src="images/29-Column_Charts-7.png" /></p>
<p>Figure 7. The "States with the Most Colleges" Table.</p>
<p><img alt="" src="images/29-Column_Charts-8.png" /></p>
<p>Figure 8. A Multiple Column Chart Generated from the Table in Figure 7.</p>
<p>multColChart() is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:1"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Chart2Views.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">multColChart</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                 <span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CellRangeAddress</span> <span class="n">rangeAddr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E15:G21&quot;</span><span class="p">);</span>
  <span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span>
     <span class="n">Chart2</span><span class="p">.</span><span class="na">insertChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">rangeAddr</span><span class="p">,</span> <span class="s">&quot;A22&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s">&quot;Column&quot;</span><span class="p">);</span>
                         <span class="c1">// ThreeDColumnDeep, ThreeDColumnFlat</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;A13&quot;</span><span class="p">);</span>

  <span class="n">Chart2</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E13&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setXAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E15&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;F14&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">rotateYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="mi">90</span><span class="p">);</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">viewLegend</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

  <span class="c1">// for a 3D version</span>
  <span class="c1">// Chart2.showAxisLabel(chartDoc, Chart2.Z_AXIS, 0, false);</span>
  <span class="c1">// Chart2.setChartShape3D(chartDoc, &quot;cylinder&quot;);</span>
                               <span class="c1">// box, cylinder, cone, pyramid</span>
<span class="p">}</span>  <span class="c1">// end of multColChart()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The same "Column" chart template is used as in colChart(), and the additional column
of data is treated as an extra column graph. The chart title and axis titles are added in
the same way as before, and a legend is included by calling Chart2.viewLegend():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:1"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">viewLegend</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                              <span class="kt">boolean</span> <span class="n">isVisible</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XDiagram</span> <span class="n">diagram</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getFirstDiagram</span><span class="p">();</span>
  <span class="n">XLegend</span> <span class="n">legend</span> <span class="o">=</span> <span class="n">diagram</span><span class="p">.</span><span class="na">getLegend</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">isVisible</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">legend</span> <span class="o">==</span> <span class="kc">null</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">XLegend</span> <span class="n">leg</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XLegend</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                              <span class="s">&quot;com.sun.star.chart2.Legend&quot;</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">leg</span><span class="p">,</span> <span class="s">&quot;LineStyle&quot;</span><span class="p">,</span> <span class="n">LineStyle</span><span class="p">.</span><span class="na">NONE</span><span class="p">);</span>
                         <span class="c1">// no outline around legend</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">leg</span><span class="p">,</span> <span class="s">&quot;FillStyle&quot;</span><span class="p">,</span> <span class="n">FillStyle</span><span class="p">.</span><span class="na">SOLID</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">leg</span><span class="p">,</span> <span class="s">&quot;FillTransparence&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
                         <span class="c1">// transparent solid background</span>
    <span class="n">diagram</span><span class="p">.</span><span class="na">setLegend</span><span class="p">(</span><span class="n">leg</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">diagram</span><span class="p">.</span><span class="na">getLegend</span><span class="p">(),</span> <span class="s">&quot;Show&quot;</span><span class="p">,</span> <span class="n">isVisible</span><span class="p">);</span>
                                   <span class="c1">// toggle visibility</span>
<span class="p">}</span>  <span class="c1">// end of viewLegend()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The legend is accessible via the chart diagram service. viewLegend() creates an
instance, and sets a few properties to make it look nicer.</p>
<p>Figure 9 shows the Legend service, which defines several properties, and inherits
many others from FillProperties and LineProperties. The "LineStyle", "FillStyle", and
"FillTransparence" properties utilized in viewLegend() come from the inherited
property classes, but "Show" is from the Legend service.</p>
<p><img alt="" src="images/29-Column_Charts-9.png" /></p>
<p>Figure 9. The Legend Service.</p>
<p>The XLegend interface contains no methods, and is used only to access the properties
in its defining service.</p>
<h2 id="6-3d-pizazz">6.  3D Pizazz<a class="headerlink" href="#6-3d-pizazz" title="Permanent link">&para;</a></h2>
<p>I'm not a fan of 3D charts which are often harder to understand than their 2D
equivalents, even if they do look more "hi-tech". But if you really want  a 3D version
of a chart, it's mostly just a matter of changing the template name in the call to
Chart2.insertChart().</p>
<p>If the "Column" string is changed to "ThreeDColumnDeep" or "ThreeDColumnFlat"
in insertChart() in multColChart(), then the charts in Figure 10 appear.</p>
<p><img alt="" src="images/29-Column_Charts-10.jpg" /></p>
<p>Figure 10. Deep and Flat 3D Column Charts.</p>
<p>"deep" orders the two 3D graphs along the z-axis, and labels the axis.</p>
<p>The x-axis labels are rotated automatically in the top-most chart of Figure 10 because
the width of the chart wasn't sufficient to draw them horizontally, and that's caused
the graphs to be squashed into less vertical space.</p>
<p>multColChart() contains two commented out lines which illustrate how a 3D graph
can be changed:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:1"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// part of multColChart() in Chart2Views.java...</span>
<span class="n">Chart2</span><span class="p">.</span><span class="na">showAxisLabel</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">Z_AXIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
                                           <span class="c1">// hide labels</span>
<span class="n">Chart2</span><span class="p">.</span><span class="na">setChartShape3D</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="s">&quot;cylinder&quot;</span><span class="p">);</span>
                  <span class="c1">// shape can be: box, cylinder, cone, pyramid</span>
</code></pre></div>
</div>
</div>
</div>
<p>Chart2.showAxisLabel() is passed the boolean false to switch off the display of the z-
axis labels. Chart2.setChartShape3D() changes the shape of the columns; in this case
to cylinders, as in Figure 11.</p>
<p><img alt="" src="images/29-Column_Charts-11.jpg" /></p>
<p>Figure 11. Modified Deep 3D Column Chart.</p>
<p>Chart2.showAxisLabel() uses Chart2.getAxis() to access the XAxis interface, and
then modifies its "Show" property:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:1"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">showAxisLabel</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                 <span class="kt">int</span> <span class="n">axisVal</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="kt">boolean</span> <span class="n">isVisible</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XAxis</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">getAxis</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">axisVal</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="c1">//Props.showObjProps(&quot;Axis&quot;, axis);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="s">&quot;Show&quot;</span><span class="p">,</span> <span class="n">isVisible</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of showAxisLabel()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The Axis service contains a large assortment of properties (online documentation can
be read by calling <code>lodoc chart2 axis service</code>), and inherits character and line
properties depicted in Figure 12.</p>
<p><img alt="" src="images/29-Column_Charts-12.png" /></p>
<p>Figure 12. The Axis Service.</p>
<p>Chart2.setChartShape3D() affects the data 'points' (which in a 3D column chart are
boxes by default). This requires access to the XDataSeries array of data points by
calling Chart2.getDataSeries(), and then the "Geometry3D" property in the DataSeries
service is modified. Figure 11 in Chapter 28 shows the service and its interfaces, and
most of its properties are inherited from the DataPointProperties class, including
"Geometry3D". The code for  Chart2.setChartShape3D():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:1"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setChartShape3D</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                   <span class="n">String</span> <span class="n">shape</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XDataSeries</span><span class="o">[]</span> <span class="n">dataSeriesArr</span> <span class="o">=</span> <span class="n">getDataSeries</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">XDataSeries</span> <span class="n">dataSeries</span> <span class="p">:</span> <span class="n">dataSeriesArr</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">shape</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;box&quot;</span><span class="p">))</span>
      <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dataSeries</span><span class="p">,</span> <span class="s">&quot;Geometry3D&quot;</span><span class="p">,</span>
                                    <span class="n">DataPointGeometry3D</span><span class="p">.</span><span class="na">CUBOID</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">shape</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;cylinder&quot;</span><span class="p">))</span>
      <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dataSeries</span><span class="p">,</span> <span class="s">&quot;Geometry3D&quot;</span><span class="p">,</span>
                                    <span class="n">DataPointGeometry3D</span><span class="p">.</span><span class="na">CYLINDER</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">shape</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;cone&quot;</span><span class="p">))</span>
      <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dataSeries</span><span class="p">,</span> <span class="s">&quot;Geometry3D&quot;</span><span class="p">,</span>
                                    <span class="n">DataPointGeometry3D</span><span class="p">.</span><span class="na">CONE</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">shape</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;pyramid&quot;</span><span class="p">))</span>
      <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dataSeries</span><span class="p">,</span> <span class="s">&quot;Geometry3D&quot;</span><span class="p">,</span>
                                    <span class="n">DataPointGeometry3D</span><span class="p">.</span><span class="na">PYRAMID</span><span class="p">);</span>
    <span class="k">else</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Did not recognize 3D shape: &quot;</span> <span class="o">+</span> <span class="n">shape</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setChartShape3D()</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="7-the-column-and-line-chart">7.  The Column and Line Chart<a class="headerlink" href="#7-the-column-and-line-chart" title="Permanent link">&para;</a></h2>
<p>Another way to display the multiple columns of data in the "States with the Most
Colleges" table (Figure 7) is to draw a column and line chart. The column is generated
from the first data column, and the line graph uses the second column. The result is
shown in Figure 13.</p>
<p><img alt="" src="images/29-Column_Charts-13.png" /></p>
<p>Figure 13. A Column and Line Chart Generated from the Table in Figure 7.</p>
<p>colLineChart() in Chart2Views.java generates Figure 13:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:1"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in Chart2Views.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">colLineChart</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                 <span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CellRangeAddress</span> <span class="n">rangeAddr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E15:G21&quot;</span><span class="p">);</span>
  <span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">insertChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span>
                     <span class="n">rangeAddr</span><span class="p">,</span> <span class="s">&quot;A22&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s">&quot;ColumnWithLine&quot;</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">gotoCell</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;A13&quot;</span><span class="p">);</span>

  <span class="n">Chart2</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E13&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setXAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E15&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">setYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;F14&quot;</span><span class="p">));</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">rotateYAxisTitle</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="mi">90</span><span class="p">);</span>
  <span class="n">Chart2</span><span class="p">.</span><span class="na">viewLegend</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of colLineChart()</span>
</code></pre></div>
</div>
</div>
</div>
<p>It's identical to mulColChart() except for the template string ("ColumnWithLine")
passed to Chart2.insertChart().</p>
<p>A chart's coordinate system may utilize multiple chart types. Up to now a chart
template (e.g. "Column") has been converted to a single chart type (e.g.
ColumnChartType) by the chart API (specifically by the chart type manager), but the
"ColumnWithLine" template is different. The manager implements that template
using two chart types, "ColumnChartType" and "LineChartType". This is reported by
Chart2.insertChart() calling Chart2.printChartTypes():</p>
<div class="highlight"><pre><span></span><code>No. of chart types: 2
  com.sun.star.chart2.ColumnChartType
  com.sun.star.chart2.LineChartType
</code></pre></div>
<p>Chart2.printChartTypes() uses Chart2.getChartTypes(), which was defined earlier:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:1"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printChartTypes</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XChartType</span><span class="o">[]</span> <span class="n">chartTypes</span> <span class="o">=</span> <span class="n">getChartTypes</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">chartTypes</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No. of chart types: &quot;</span> <span class="o">+</span> <span class="n">chartTypes</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="n">XChartType</span> <span class="n">ct</span> <span class="p">:</span> <span class="n">chartTypes</span><span class="p">)</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">ct</span><span class="p">.</span><span class="na">getChartType</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="k">else</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Chart type: &quot;</span> <span class="o">+</span>
                          <span class="n">chartTypes</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">.</span><span class="na">getChartType</span><span class="p">());</span>
<span class="p">}</span>  <span class="c1">// end of printChartTypes()</span>
</code></pre></div>
</div>
</div>
</div>
<p>Why is this separation of a single template into two chart types important?
The short answer is that it complicates the search for a chart template's data. For
example, my earlier Chart2.getChartType() returns the first chart type in the
XChartType[] array since most templates only use a single chart type:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="22:1"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="__tabbed_22_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XChartType</span> <span class="nf">getChartType</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XChartType</span><span class="o">[]</span> <span class="n">chartTypes</span> <span class="o">=</span> <span class="n">getChartTypes</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">chartTypes</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>This method is insufficient for examining a chart created with the "ColumnWithLine"
template since the XChartType[] array holds two chart types. A programmer will have
to use findChartType(), which searches the array for the specified chart type:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="23:1"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="__tabbed_23_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XChartType</span> <span class="nf">findChartType</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                       <span class="n">String</span> <span class="n">chartType</span><span class="p">)</span>
<span class="p">{</span> <span class="n">String</span> <span class="n">srchName</span> <span class="o">=</span> <span class="s">&quot;com.sun.star.chart2.&quot;</span> <span class="o">+</span>
                               <span class="n">chartType</span><span class="p">.</span><span class="na">toLowerCase</span><span class="p">();</span>
  <span class="n">XChartType</span><span class="o">[]</span> <span class="n">chartTypes</span> <span class="o">=</span> <span class="n">getChartTypes</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">XChartType</span> <span class="n">ct</span> <span class="p">:</span> <span class="n">chartTypes</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">ctName</span> <span class="o">=</span> <span class="n">ct</span><span class="p">.</span><span class="na">getChartType</span><span class="p">().</span><span class="na">toLowerCase</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ctName</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">srchName</span><span class="p">))</span>
      <span class="k">return</span> <span class="n">ct</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Chart type &quot;</span> <span class="o">+</span> <span class="n">srchName</span> <span class="o">+</span> <span class="s">&quot; not found&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of findChartType()</span>
</code></pre></div>
</div>
</div>
</div>
<p>For example, the following call returns a reference to the line chart type:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="24:1"><input checked="checked" id="__tabbed_24_1" name="__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="__tabbed_24_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XChartType</span> <span class="n">lineCT</span> <span class="o">=</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">findChartType</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="s">&quot;LineChartType&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The simple getChartType()  is used in Chart2.getDataSeries():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="25:1"><input checked="checked" id="__tabbed_25_1" name="__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="__tabbed_25_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XDataSeries</span><span class="o">[]</span> <span class="nf">getDataSeries</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XChartType</span> <span class="n">xChartType</span> <span class="o">=</span> <span class="n">getChartType</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="n">XDataSeriesContainer</span> <span class="n">dsCon</span> <span class="o">=</span>
                   <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDataSeriesContainer</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xChartType</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">dsCon</span><span class="p">.</span><span class="na">getDataSeries</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">//end of getDataSeries()</span>
</code></pre></div>
</div>
</div>
</div>
<p>This means that Chart2.getDataSeries() can only access the data associated with the
column (the first chart type) in a "ColumnWithLine" chart document. The fix is to use
a more complex version of Chart2.getDataSeries():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="26:1"><input checked="checked" id="__tabbed_26_1" name="__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="__tabbed_26_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XDataSeries</span><span class="o">[]</span> <span class="nf">getDataSeries</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                          <span class="n">String</span> <span class="n">chartType</span><span class="p">)</span>
<span class="c1">// get the data series associated with the specified chart type</span>
<span class="p">{</span>
  <span class="n">XChartType</span> <span class="n">xChartType</span> <span class="o">=</span> <span class="n">findChartType</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">chartType</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xChartType</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="n">XDataSeriesContainer</span> <span class="n">dsCon</span> <span class="o">=</span>
                   <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDataSeriesContainer</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xChartType</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">dsCon</span><span class="p">.</span><span class="na">getDataSeries</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">//end of getDataSeries()</span>
</code></pre></div>
</div>
</div>
</div>
<p>This version requires a chart type string argument to get the correct chart type. For
example, the call:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="27:1"><input checked="checked" id="__tabbed_27_1" name="__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="__tabbed_27_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XDataSeries</span><span class="o">[]</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">getDataSeries</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="s">&quot;LineChartType&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>returns the data series associated with the line chart type.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="28-Chart2_API_Overview.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 28. Chart2 API Overview" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 28. Chart2 API Overview
            </div>
          </div>
        </a>
      
      
        
        <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 30. Bar, Pie, Area, Line Charts" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 30. Bar, Pie, Area, Line Charts
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>