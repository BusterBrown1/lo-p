
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 32. Bubble, Net, Stock Charts - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-32-bubble-net-stock-charts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 32. Bubble, Net, Stock Charts
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 32. Bubble, Net, Stock Charts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link md-nav__link--active">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-bubble-chart" class="md-nav__link">
    1.  The Bubble Chart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-the-net-chart" class="md-nav__link">
    2.  The Net Chart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-stock-chart" class="md-nav__link">
    3.  The Stock Chart
  </a>
  
    <nav class="md-nav" aria-label="3.  The Stock Chart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-modifying-the-chart-dates" class="md-nav__link">
    3.1.  Modifying the Chart Dates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-changing-the-stock-values-appearance" class="md-nav__link">
    3.2.  Changing the Stock Values Appearance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-adding-a-line-graph-to-a-stock-chart" class="md-nav__link">
    4.  Adding a Line Graph to a Stock Chart
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-bubble-chart" class="md-nav__link">
    1.  The Bubble Chart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-the-net-chart" class="md-nav__link">
    2.  The Net Chart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-stock-chart" class="md-nav__link">
    3.  The Stock Chart
  </a>
  
    <nav class="md-nav" aria-label="3.  The Stock Chart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-modifying-the-chart-dates" class="md-nav__link">
    3.1.  Modifying the Chart Dates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-changing-the-stock-values-appearance" class="md-nav__link">
    3.2.  Changing the Stock Values Appearance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-adding-a-line-graph-to-a-stock-chart" class="md-nav__link">
    4.  Adding a Line Graph to a Stock Chart
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/32-Bubble_Net_Stock_Charts.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-32-bubble-net-stock-charts">Chapter 32. Bubble, Net, Stock Charts</h1>
<p>This chapter concludes my use of the Chart2Views.java 
example by looking at how bubble, net and stock charts 
can be generated from spreadsheet data.  </p>
<p>The relevant lines of Chart2Views.java are: </p>
<p>// part of Chart2Views.java 
public static void main(String args[]) 
{ 
  XComponentLoader loader = Lo.loadOffice(); 
  XSpreadsheetDocument doc = Calc.openDoc(CHARTS_DATA, loader); </p>
<p>GUI.setVisible(doc, true); 
  XSpreadsheet sheet = Calc.getSheet(doc, 0); </p>
<p>// ---- use different chart templates ---- </p>
<p>labeledBubbleChart(doc, sheet);  // see section 1 </p>
<p>// netChart(doc, sheet);         // section 2 </p>
<p>// happyStockChart(doc, sheet);  // section 3 
  // stockPricesChart(doc, sheet); // section 4 </p>
<p>Lo.waitEnter(); 
  Lo.closeDoc(doc); 
  Lo.closeOffice(); 
}  // end of main() </p>
<h2 id="1-the-bubble-chart">1.  The Bubble Chart</h2>
<p>A bubble chart is a variation of a scatter chart where each data point shows the 
relationship between three variables. Two variables are used for a bubble's (x, y) 
coordinate, and the third affects the bubble's size.  </p>
<p>labeledBubbleChart() in Chart2Views.java utilizes the "World data" table in 
"chartsData.ods" (see Figure 1).  </p>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>The Bubble </p>
</div>
<p>Chart; The Net Chart; 
The Stock Chart: basic 
and modified candle 
sticks; Stock Chart and 
Line Graph 
Example folders: 
"Chart2 Tests" and 
"Utils" </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-1.png" /></p>
<p>Figure 1. The "World data" Table. </p>
<p>The data range passed to the Chart.insertChart() uses the first three columns of the 
table; the "Country" column is added separately. The generated scatter chart is shown 
in Figure 2. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-2.png" /></p>
<p>Figure 2. Bubble Chart for the Table in Figure 1. </p>
<p>labeledBubbleChart() is: </p>
<p>// in Chart2Views.java 
private static void labeledBubbleChart(XSpreadsheetDocument doc, 
                                XSpreadsheet sheet) 
{ 
  CellRangeAddress rangeAddr = Calc.getAddress(sheet, "H63:J93"); 
  XChartDocument chartDoc = 
      Chart2.insertChart(sheet, rangeAddr, "A62",18,11, "Bubble"); 
  Calc.gotoCell(doc, "A62"); </p>
<p>Chart2.setTitle(chartDoc, Calc.getString(sheet, "H62")); 
  Chart2.setXAxisTitle(chartDoc, Calc.getString(sheet, "H63")); 
  Chart2.setYAxisTitle(chartDoc, Calc.getString(sheet, "I63")); 
  Chart2.rotateYAxisTitle(chartDoc, 90); 
  Chart2.viewLegend(chartDoc, true); </p>
<p>// change the data points 
  XDataSeries[] ds = Chart2.getDataSeries(chartDoc); 
  Props.setProperty(ds[0], "Transparency", 50); <br />
                           // 100 == fully transparent 
  Props.setProperty(ds[0], "BorderStyle", LineStyle.SOLID); 
  Props.setProperty(ds[0], "BorderColor", Calc.RED); </p>
<p>Props.setProperty(ds[0], "LabelPlacement", Chart2.DP_CENTER); 
  // Chart2.setDataPointLabels(chartDoc, Chart2.DP_NUMBER); </p>
<p>/<em> 
  String sheetName = Calc.getSheetName(sheet); 
  String label = sheetName + "." + "K63"; 
  String names = sheetName + "." + "K64:K93"; 
  Chart2.addCatLabels(chartDoc, label, names); 
</em>/ 
  }  // end of labeledBubbleChart() </p>
<p>The transparency and border properties of all the data points are set via the 
DataPointProperties class for the data series. Without transparency, large bubbles 
could obscure or completely hide smaller bubbles. </p>
<p>If the call to Chart2.setDataPointLabels() is uncommented, the result is messy, as 
shown in Figure 3. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-3.png" /></p>
<p>Figure 3. Numerically Labeled Bubble Chart for the Table in Figure 1. </p>
<p>Instead of labeling the bubbles with population sizes, it would be better to use the 
"Country" values (see Figure 1). Chart2.addCatLabels() implements this feature, 
producing Figure 4. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-4.png" /></p>
<p>Figure 4. Category Labeled Bubble Chart for the Table in Figure 1. </p>
<p>Chart2.addCatLabels() employs the "Country" data to create an 
XLabeledDataSequence object which is assigned the role "categories". It is then 
assigned to the x-axis as category-based scale data: </p>
<p>// in the Chart2 class 
public static void addCatLabels(XChartDocument chartDoc,<br />
                           String dataLabel, String dataRange) 
{ 
  // create 'categories' labeled data sequence 
  XDataProvider dp = chartDoc.getDataProvider(); 
  XLabeledDataSequence dLSeq =<br />
             createLDSeq(dp, "categories", dataLabel, dataRange); </p>
<p>// assign sequence to x-axis as category scale data 
  XAxis axis = getAxis(chartDoc, X_AXIS, 0); 
  if (axis == null) 
    return; 
  ScaleData sd = axis.getScaleData(); 
  sd.Categories = dLSeq; 
  axis.setScaleData(sd); </p>
<p>setDataPointLabels(chartDoc, Chart2.DP_CATEGORY); 
     // label the data points with categories 
}  // end of addCatLabels() </p>
<p>When setDataPointLabels() displays category data for the points, the new x-axis 
categories are utilized. </p>
<h2 id="2-the-net-chart">2.  The Net Chart</h2>
<p>The net chart (also called a radar chart) is useful for comparing multiple columns of 
data (often between three and eight columns) in a 2D arrangement that resembles a 
spider's web. Although net charts have an interesting look, a lot of people dislike them 
(e.g. see "A Critique of Radar Charts" by Graham Odds at 
http://blog.scottlogic.com/2011/09/23/a-critique-of-radar-charts.html). </p>
<p>netChart() in Chart2Views.java utilizes the "No of Calls per Day" table in 
"chartsData.ods" (see Figure 5).  </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-5.png" /></p>
<p>Figure 5. The "No of Calls per Day" Table. </p>
<p>The generated net chart is shown in Figure 6. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-6.png" /></p>
<p>Figure 6. Net Chart for the Table in Figure 5. </p>
<p>netChart() is: </p>
<p>// in Chart2Views.java 
private static void netChart(XSpreadsheetDocument doc, 
                             XSpreadsheet sheet) 
{ CellRangeAddress rangeAddr = Calc.getAddress(sheet, "A56:D63"); 
  XChartDocument chartDoc = 
      Chart2.insertChart(sheet, rangeAddr, "E55",16,11, "NetLine"); 
                           // Net, NetLine, NetSymbol 
                           // StackedNet, PercentStackedNet 
  Calc.gotoCell(doc, "E55"); </p>
<p>Chart2.setTitle(chartDoc, Calc.getString(sheet, "A55")); 
  Chart2.viewLegend(chartDoc, true); 
  Chart2.setDataPointLabels(chartDoc, Chart2.DP_NONE); </p>
<p>// reverse x-axis so days increase clockwise around net 
  XAxis xAxis = Chart2.getXAxis(chartDoc); 
  ScaleData sd = xAxis.getScaleData(); 
  sd.Orientation = AxisOrientation.REVERSE; 
  xAxis.setScaleData(sd); 
}  // end of netChart() </p>
<p>Different net chart templates allow points to be shown, the areas filled with color, and 
the lines to be stacked or displayed as percentages. </p>
<p>netChart() changes the x-axis which wraps around the circumference of the chart. By 
default, the axis is drawn in a counter-clockwise direction starting from the top of the 
net. This order doesn't seem right for the days of the week in this example, so I made 
the order clockwise, as in Figure 6. </p>
<h2 id="3-the-stock-chart">3.  The Stock Chart</h2>
<p>A stock chart is a specialized column graph for displaying stocks and shares 
information. All stock chart templates require at least three columns of data 
concerning the lowest price, highest price, and closing price of a stock (or share). It's 
also possible to include two other columns that detail the stock's opening price and 
transaction volume. </p>
<p>The stock template names reflect the data columns they utilize: 
 StockLowHighClose 
 StockOpenLowHighClose 
 StockVolumeLowHighClose 
 StockVolumeOpenLowHighClose 
The names also indicate the ordering of the columns in the data range supplied to the 
template. For example, "StockVolumeOpenLowHighClose" requires five columns of 
data in the order: transaction volume, opening price, lowest price, highest price, and 
closing price. </p>
<p>happyStockChart() in Chart2Views.java utilizes the "Happy Systems (HASY)" table 
in "chartsData.ods" (see Figure 7).  </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-7.png" /></p>
<p>Figure 7. The "Happy Systems (HASY)" Table. </p>
<p>The table has six columns, the first being the x-axis categories, which are usually 
dates. The other columns follow the order required by the 
"StockVolumeOpenLowHighClose" template. </p>
<p>The generated stock chart is shown in Figure 8. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-8.png" /></p>
<p>Figure 8. Stock Chart for the Table in Figure 7. </p>
<p>The chart is made up of two graphs with a common x-axis: a column graph for the 
stock volume on each day, and a candle-stick graph showing the lowest, opening, 
closing, and highest stock values. Figure 9 gives details of how these elements are 
drawn. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-9.png" /></p>
<p>Figure 9. The Elements of a Stock Chart. </p>
<p>The thin red lines drawn on the columns in Figure 9 denote the range between the 
lowest and highest stock value on that day. The white and black blocks represent the 
stock's change between its opening and closing price. A white block (often called a 
"white day") means the price has increased, while black (a "black day") means that it 
has decreased. </p>
<p>happyStockChart() is: </p>
<p>// in Chart2Views.java 
private static void happyStockChart(XSpreadsheetDocument doc, 
                                    XSpreadsheet sheet) 
{ CellRangeAddress rangeAddr = Calc.getAddress(sheet, "A86:F104"); 
  XChartDocument chartDoc = 
      Chart2.insertChart(sheet, rangeAddr, "A105", 25, 14, 
                               "StockVolumeOpenLowHighClose"); 
  Calc.gotoCell(doc, "A105"); </p>
<p>Chart2.setTitle(chartDoc, Calc.getString(sheet, "A85")); 
  Chart2.setXAxisTitle(chartDoc, Calc.getString(sheet, "A86")); 
  Chart2.setYAxisTitle(chartDoc, Calc.getString(sheet, "B86")); 
  Chart2.rotateYAxisTitle(chartDoc, 90); </p>
<p>Chart2.setYAxis2Title(chartDoc, "Stock Value"); 
  Chart2.rotateYAxis2Title(chartDoc, 90); </p>
<p>Chart2.setDataPointLabels(chartDoc, Chart2.DP_NONE);<br />
                     // too cluttered if numerical data is shown </p>
<p>// change 2nd y-axis min and max; default is poor ($0 - $20) 
  XAxis yAxis2 = Chart2.getYAxis2(chartDoc); 
  ScaleData sd = yAxis2.getScaleData(); 
  sd.Minimum = 83; 
  sd.Maximum = 103; 
  yAxis2.setScaleData(sd); </p>
<p>// more stock chart code; explained in a moment... </p>
<p>}  // end of happyStockChart() </p>
<p>happyStockChart() sets and rotates the secondary y-axis title, which appears on the 
right of the chart. Chart2.setYAxis2Title() and Chart2.rotateYAxis2Title() are 
implemented in the same way as Chart2.setYAxisTitle() and 
Chart2.rotateYAxisTitle() described in Chapter 29, section 3. </p>
<p>happyStockChart() also changes the second y-axis' range; the default shows prices 
between $0 and $20, which is too low. New minimum and maximum values are 
assigned to the axis' scale data. </p>
<h3 id="31-modifying-the-chart-dates">3.1.  Modifying the Chart Dates</h3>
<p>A common problem is that date information clutters the stock chart, making it harder 
to read. Figure 8 shows that the stock template is clever enough to only draw every 
second date, but this is still too much information for the limited space. </p>
<p>One solution is to increase the x-axis interval so a tick mark (and date string) is only 
drawn for every third day, as in Figure 10. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-10.png" /></p>
<p>Figure 10. Stock Chart with Three-day Intervals for the X-Axis. </p>
<p>Changing the interval is implemented by adjusting the time increment for the x-axis in 
its ScaleData object: </p>
<p>// part of happyStockChart() in Chart2Views.java... </p>
<pre><code>:
</code></pre>
<p>// change x-axis type from number to date 
XAxis xAxis = Chart2.getXAxis(chartDoc); 
sd = xAxis.getScaleData(); 
sd.AxisType = AxisType.DATE; </p>
<p>// set major increment to 3 days 
TimeInterval ti = new TimeInterval(3, TimeUnit.DAY); 
TimeIncrement tc = new TimeIncrement(); 
tc.MajorTimeInterval = ti; 
sd.TimeIncrement = tc; 
xAxis.setScaleData(sd); </p>
<p>Before the interval can be changed, the axis type must be changed to be of type 
DATE. Information on the ScaleData class can be accessed by calling lodoc chart2 
scaledata. </p>
<p>Another technique for making the dates easier to read is to rotate their labels. The 
following code rotates each label counter-clockwise by 45 degrees: </p>
<p>// part of happyStockChart() in Chart2Views.java... </p>
<pre><code>:
</code></pre>
<p>XAxis xAxis = Chart2.getXAxis(chartDoc); 
Props.setProperty(xAxis, "TextRotation", 45); </p>
<p>The resulting chart is shown in Figure 11. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-11.png" /></p>
<p>Figure 11. Stock Chart with Rotated X-Axis Labels. </p>
<p>Note that the template has automatically switched back to showing every date instead 
of every second one in Figure 8. </p>
<h3 id="32-changing-the-stock-values-appearance">3.2.  Changing the Stock Values Appearance</h3>
<p>This section describes two changes to the candle stick part of the chart: adjusting the 
colors used in the "white days" and "black days" blocks, and making the high-low 
stock line easier to read. The results appear in Figure 12. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-12.png" /></p>
<p>Figure 12. Stock Chart with Modified Candle Sticks. </p>
<p>A stock chart is made up of two chart types: a column chart type for the volume 
information, and a candle stick chart type for the stock prices. This information can be 
listed by calling Chart2.printChartTypes(): </p>
<p>// in happyStockChart() 
Chart2Views.javaChart2.printChartTypes(chartDoc); </p>
<p>It produces: </p>
<p>No. of chart types: 2 
  com.sun.star.chart2.ColumnChartType 
  com.sun.star.chart2.CandleStickChartType </p>
<p>In order to affect the candle stick chart type's data it is necessary to access its 
XChartType instance. This can be done with the two-argument version of 
Chart2.findChartType(): </p>
<p>// in happyStockChart()<br />
XChartType candleCT = Chart2.findChartType(chartDoc,<br />
                                   "CandleStickChartType"); </p>
<p>Figure 13 shows that the XChartType interface is supported by the ChartType service, 
and the CandleStickChartType subclass.  </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-13.png" /></p>
<p>Figure 13. The ChartType Service. </p>
<p>CandleStickChartType contains some useful properties, including "WhiteDay" and 
"BlackDay" (for details call lodoc chart2 CandleStickChartType). These 
properties store sets containing multiple values from the FillProperties and 
LineProperties services. They can be accessed like so: </p>
<p>// part of happyStockChart() in Chart2Views.java... </p>
<pre><code>:
</code></pre>
<p>XChartType candleCT = Chart2.findChartType(chartDoc,<br />
                                   "CandleStickChartType"); 
XPropertySet props = Lo.qi(XPropertySet.class,<br />
                         Props.getProperty(candleCT, "WhiteDay")); 
Props.showObjProps("WhiteDay", props); 
Props.setProperty(props, "FillColor", Calc.GREEN); </p>
<p>The same sort of change can be done to the "FillColor" property inside the 
"BlackDay" property  set. Both changes are implemented inside 
Chart2.colorStockBars(): </p>
<p>// in the Chart2 class 
public static void colorStockBars(XChartType ct, 
                            int wDayColor, int bDayColor) 
{ if (!ct.getChartType().equals( 
                  "com.sun.star.chart2.CandleStickChartType")) 
    System.out.println("Chart type not a candle stick: " +<br />
                                            ct.getChartType()); 
  else { 
    XPropertySet props = Lo.qi(XPropertySet.class,<br />
                          Props.getProperty(ct, "WhiteDay")); 
    Props.setProperty(props, "FillColor", wDayColor); </p>
<pre><code>props = Lo.qi(XPropertySet.class,  
                      Props.getProperty(ct, "BlackDay")); 
Props.setProperty(props, "FillColor", bDayColor);
</code></pre>
<p>} 
}  // end of colorStockBars() </p>
<p>Chart2.findChartType() and Chart2.colorStockBars() are called at the end of 
happyStockChart() to change the "white day" blocks to green and the "black day" 
blocks to red: </p>
<p>// part of happyStockChart() in Chart2Views.java... </p>
<pre><code>:
</code></pre>
<p>XChartType candleCT = Chart2.findChartType(chartDoc,<br />
                                   "CandleStickChartType"); 
Chart2.colorStockBars(candleCT, Calc.GREEN, Calc.RED); </p>
<p>Making the high-low lines thicker and yellow requires access to the data series in the 
candle stick chart type (as shown in Figure 13). This is implemented by using the two-
argument version of Chart2.getDataSeries(): 
XDataSeries[] ds = Chart2.getDataSeries(chartDoc,<br />
                                  "CandleStickChartType"); 
The high-low lines are adjusted via the "LineWidth" and "Color" properties in the 
series. The code at the end of  happyStockChart() is: </p>
<p>// part of happyStockChart() in Chart2Views.java... </p>
<pre><code>:
</code></pre>
<p>XDataSeries[] ds = Chart2.getDataSeries(chartDoc,<br />
                                  "CandleStickChartType"); 
Props.setProperty(ds[0], "LineWidth", 120);   // in 1/100 mm<br />
Props.setProperty(ds[0], "Color", Calc.YELLOW); </p>
<h2 id="4-adding-a-line-graph-to-a-stock-chart">4.  Adding a Line Graph to a Stock Chart</h2>
<p>stockPricesChart() in Chart2Views.java utilizes the "Calc Guide Stock Prices" table in 
"chartsData.ods" (see Figure 14).  </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-14.png" /></p>
<p>Figure 14. The "Calc Guide Stock Prices" Table. </p>
<p>The stock chart is created using the first five columns, excluding the "Pork Bellies" 
data. There's no "Volume" column for the stocks, so the "StockOpenLowHighClose" 
template is employed. </p>
<p>The stock chart is shown in Figure 15. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-15.png" /></p>
<p>Figure 15. Stock Chart for the Table in Figure 14. </p>
<p>stockPricesChart() is: </p>
<p>// in Chart2Views.java 
private static void stockPricesChart(XSpreadsheetDocument doc, 
                                      XSpreadsheet sheet) 
{ 
  CellRangeAddress rangeAddr = Calc.getAddress(sheet, "E141:I146"); 
  XChartDocument chartDoc = 
      Chart2.insertChart(sheet, rangeAddr, "E148", 12, 11, 
                                     "StockOpenLowHighClose"); 
  Calc.gotoCell(doc, "A139"); </p>
<p>Chart2.setTitle(chartDoc, Calc.getString(sheet, "E140")); 
  Chart2.setDataPointLabels(chartDoc, Chart2.DP_NONE); 
  Chart2.setXAxisTitle(chartDoc, Calc.getString(sheet, "E141")); 
  Chart2.setYAxisTitle(chartDoc, "Dollars"); 
  Chart2.rotateYAxisTitle(chartDoc, 90); </p>
<p>// more code for adding the "Pork Bellies" line... </p>
<p>}  // end of stockPricesChart() </p>
<p>A line graph showing the movement of "Pork Bellies" is added to the chart by 
Chart2.addStockLine(). The additional code at the end of stockPricesChart() is: </p>
<p>// part of stockPricesChart() in Chart2Views.java... </p>
<pre><code>:
</code></pre>
<p>String sheetName = Calc.getSheetName(sheet); 
String porkLabel = sheetName + "." + "J141"; 
String porkPoints = sheetName + "." + "J142:J146"; 
Chart2.addStockLine(chartDoc, porkLabel, porkPoints); </p>
<p>Chart2.viewLegend(chartDoc, true); </p>
<p>The resulting change to the stock chart is shown in Figure 16. </p>
<p><img alt="" src="images/32-Bubble_Net_Stock_Charts-16.png" /></p>
<p>Figure 16. Stock Chart with Line Graph for the Table in Figure 15. </p>
<p>A data series belongs to a chart type, which is part of the coordinates system. </p>
<p>Therefore the first task is to obtain the chart's coordinate system. A new line chart 
type is added to it, and an empty data series is inserted into the chart type. </p>
<p>The addition of a new chart type to the chart's coordinate system is preformed by 
Chart2.addChartType(). The following adds a line chart type: </p>
<p>// part of Chart2.addStockLine(); see below... </p>
<p>XChartType ct = Chart2.addChartType(chartDoc, "LineChartType"); </p>
<p>Chart2.addChartType() uses Chart2.getCoordSystem() to get the chart's coordinate 
system, and then converts it into an XChartTypeContainer so the new chart type can 
be added: </p>
<p>// in the Chart2 class 
public static XChartType addChartType(XChartDocument chartDoc,<br />
                                      String chartType) 
{ // create new chart type 
  XChartType ct = Lo.createInstanceMCF(XChartType.class,<br />
                         "com.sun.star.chart2." + chartType); 
  if (ct == null) { 
    System.out.println("Unable to create XChartType: "+chartType); 
    return ct; 
  } </p>
<p>// add chart type to coord system 
  XCoordinateSystem coordSys = getCoordSystem(chartDoc); 
  XChartTypeContainer ctCon =<br />
           Lo.qi(XChartTypeContainer.class, coordSys); 
  ctCon.addChartType(ct); 
  return ct; 
}  // end of addChartType() </p>
<p>Chart2.addChartType() returns a reference to the new chart type, and an empty data 
series is added to it by converting the chart type into an XDataSeriesContainer: </p>
<p>// part of Chart2.addStockLine(); see below... </p>
<pre><code>:
</code></pre>
<p>XChartType ct = addChartType(chartDoc, "LineChartType"); 
XDataSeriesContainer dataSeriesCnt =<br />
                        Lo.qi(XDataSeriesContainer.class, ct); </p>
<p>// create (empty) data series in the line chart 
XDataSeries ds = Lo.createInstanceMCF(XDataSeries.class,<br />
                             "com.sun.star.chart2.DataSeries"); 
if (ds == null) { 
  System.out.println("Unable to create XDataSeries: " + ds); 
  return; 
} 
dataSeriesCnt.addDataSeries(ds); </p>
<p>This empty data series is filled with data points via its XDataSink interface, using the 
steps shown in Chapter 31, section 5.1, Figure 13. A DataProvider service is required 
so that two XDataSequence objects can be instantiated, one for the label of an 
XLabeledDataSequence object, the other for its data. The XDataSequence object 
representing the data must have its "Role" property set to "values-y" since it will 
become the y-coordinates of the line graph. </p>
<p>The task of building the XLabeledDataSequence object is handled by 
Chart2.createLDSeq(), which I used in Chapter 31, section 5.1 to add error bars to a 
scatter chart, and in section 1 to place category labels in a bubble chart.  </p>
<p>The code is: </p>
<p>// part of Chart2.addStockLine(); see below... </p>
<pre><code>:
</code></pre>
<p>// treat series as a data sink 
XDataSink dataSink = Lo.qi(XDataSink.class, ds); </p>
<p>// build a sequence representing the y-axis data 
XDataProvider dp = chartDoc.getDataProvider(); 
XLabeledDataSequence dLSeq =<br />
              createLDSeq(dp, "values-y", dataLabel, dataRange); </p>
<p>// add sequence to the sink 
XLabeledDataSequence[] ldSeqArr = { dLSeq }; 
dataSink.setData(ldSeqArr); </p>
<p>All the preceding code fragments of this section are wrapped up inside 
Chart2.addStockLine(): </p>
<p>// in the Chart2 class 
public static void addStockLine(XChartDocument chartDoc,<br />
                             String dataLabel, String dataRange) 
{ // add (empty) line chart to the doc 
  XChartType ct = addChartType(chartDoc, "LineChartType"); 
  XDataSeriesContainer dataSeriesCnt =<br />
                            Lo.qi(XDataSeriesContainer.class, ct); </p>
<p>// create (empty) data series in the line chart 
  XDataSeries ds = Lo.createInstanceMCF(XDataSeries.class,<br />
                                "com.sun.star.chart2.DataSeries"); 
  if (ds == null) { 
    System.out.println("Unable to create XDataSeries: " + ds); 
    return; 
  } 
  Props.setProperty(ds, "Color", 0xFF0000); 
  dataSeriesCnt.addDataSeries(ds); </p>
<p>// treat series as a data sink 
  XDataSink dataSink = Lo.qi(XDataSink.class, ds); </p>
<p>// build a sequence representing the y-axis data 
  XDataProvider dp = chartDoc.getDataProvider(); 
  XLabeledDataSequence dLSeq =<br />
             createLDSeq(dp, "values-y", dataLabel, dataRange); </p>
<p>// add sequence to the sink 
  XLabeledDataSequence[] ldSeqArr = { dLSeq }; 
  dataSink.setData(ldSeqArr); 
}  // end of addStockLine() </p>
<p>Chart2.addStockLine() is passed a reference to the chart document, and references to 
the label and data for the line graph: </p>
<p>// part of stockPricesChart() in Chart2Views.java... </p>
<pre><code>:
</code></pre>
<p>String sheetName = Calc.getSheetName(sheet); 
String porkLabel = sheetName + "." + "J141"; 
String porkPoints = sheetName + "." + "J142:J146"; 
Chart2.addStockLine(chartDoc, porkLabel, porkPoints); </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="31-XY_Scatter_Charts.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 31. XY (Scatter) Charts
            </div>
          </div>
        </a>
      
      
        <a href="33-Charts_in_Others_Docs.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 33. Using Charts in Other
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>