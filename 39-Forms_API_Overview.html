
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 39. Forms API Overview - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-39-forms-api-overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 39. Forms API Overview
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 39. Forms API Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="39-Forms_API_Overview.html" class="md-nav__link md-nav__link--active">
        Chapter 39. Forms API Overview
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#8-longer-examples-can-be-found-in-the-writer-guide-and-base-handbook" class="md-nav__link">
    8.  Longer examples can be found in the "Writer Guide" and "Base Handbook"
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-why-bother-programming-forms" class="md-nav__link">
    1.  Why Bother Programming Forms?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-an-overview-of-the-forms-api" class="md-nav__link">
    2.  An Overview of the Forms API
  </a>
  
    <nav class="md-nav" aria-label="2.  An Overview of the Forms API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-control-confusion" class="md-nav__link">
    2.1.  Control Confusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-more-information-on-the-api" class="md-nav__link">
    2.2.  More Information on the API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-examining-a-text-based-form" class="md-nav__link">
    3.  Examining a Text-based Form
  </a>
  
    <nav class="md-nav" aria-label="3.  Examining a Text-based Form">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-from-document-to-drawpages" class="md-nav__link">
    3.1.  From Document to DrawPages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-from-drawpage-to-form" class="md-nav__link">
    3.2.  From DrawPage to Form
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-from-form-to-formcomponents" class="md-nav__link">
    3.3.  From Form to FormComponents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-from-formcomponent-to-control-model" class="md-nav__link">
    3.4.  From FormComponent to Control Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-using-a-control-model" class="md-nav__link">
    3.5.  Using a Control Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-from-control-model-to-view" class="md-nav__link">
    3.6.  From Control Model to View
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-attaching-listeners-to-a-view" class="md-nav__link">
    4.  Attaching Listeners to a View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-using-examineformjava" class="md-nav__link">
    5.  Using ExamineForm.java
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#8-longer-examples-can-be-found-in-the-writer-guide-and-base-handbook" class="md-nav__link">
    8.  Longer examples can be found in the "Writer Guide" and "Base Handbook"
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-why-bother-programming-forms" class="md-nav__link">
    1.  Why Bother Programming Forms?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-an-overview-of-the-forms-api" class="md-nav__link">
    2.  An Overview of the Forms API
  </a>
  
    <nav class="md-nav" aria-label="2.  An Overview of the Forms API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-control-confusion" class="md-nav__link">
    2.1.  Control Confusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-more-information-on-the-api" class="md-nav__link">
    2.2.  More Information on the API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-examining-a-text-based-form" class="md-nav__link">
    3.  Examining a Text-based Form
  </a>
  
    <nav class="md-nav" aria-label="3.  Examining a Text-based Form">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-from-document-to-drawpages" class="md-nav__link">
    3.1.  From Document to DrawPages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-from-drawpage-to-form" class="md-nav__link">
    3.2.  From DrawPage to Form
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-from-form-to-formcomponents" class="md-nav__link">
    3.3.  From Form to FormComponents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-from-formcomponent-to-control-model" class="md-nav__link">
    3.4.  From FormComponent to Control Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-using-a-control-model" class="md-nav__link">
    3.5.  Using a Control Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-from-control-model-to-view" class="md-nav__link">
    3.6.  From Control Model to View
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-attaching-listeners-to-a-view" class="md-nav__link">
    4.  Attaching Listeners to a View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-using-examineformjava" class="md-nav__link">
    5.  Using ExamineForm.java
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/39-Forms_API_Overview.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-39-forms-api-overview">Chapter 39. Forms API Overview</h1>
<p>Forms are usually found in Writer documents, or as data 
entry interfaces for Base, although they can also be 
employed in Draw, Impress, and Calc. Although Base 
forms are typically employed as front-ends to databases, 
the same capability is available in Writer and the other 
Office applications.   </p>
<p>The LibreOffice "Getting Started Guide" (available at https://th.libreoffice.org/get-
help/documentation/) describes the form features of Writer and Base in chapters 4 and </p>
<h2 id="8-longer-examples-can-be-found-in-the-writer-guide-and-base-handbook">8.  Longer examples can be found in the "Writer Guide" and "Base Handbook"</h2>
<p>documents. </p>
<p>Chapter 15 of the "Writer Guide" explains how to create a form using the "Form 
Controls " and "Form Design" toolbars; it's essentially a matter of dragging check 
boxes, buttons, text fields, pull-down lists, and other controls, onto a form canvas. </p>
<p>Properties associated with a control, such as its name, text label, and position, are set 
by right clicking to access a properties dialog window.  </p>
<p>An important use of Writer forms is to create editable PDF forms. This doesn't 
involve anything more than remembering to save the form-filled document as a PDF 
file when it's finished. There are several online tutorials that explain the details, such 
as "Create PDF Forms with OpenOffice" at 
http://foersom.com/org/HowTo/OoCreatePdfForm.html; although it's written for 
OpenOffice, it can be applied to LibreOffice without change. </p>
<p>Chapter 4 of the "Base Handbook" explains how to create a data input form for a 
library loans database, and much of the GUI interface of control toolbars, form 
canvas, and property dialogs is identical to that found in Writer. Even if you're only 
creating a text-based form, it's well worth reading the Base chapter because it goes 
into detail about the General, Data, and Events tab in the properties dialog. </p>
<p>A somewhat simpler example, which is purely text-based without data sources, can be 
found at http://openoffice.blogs.com/forms_fromscratch.pdf. I used this article (which 
is titled "Creating Forms from Scratch") to create the scratchExample.odt file used 
here. </p>
<h2 id="1-why-bother-programming-forms">1.  Why Bother Programming Forms?</h2>
<p>It's very easy to build a form using Office's "Form Controls " and "Form Design" 
toolbars. The GUI provides immediate feedback on how things will look by switching 
design mode on (where you're building the form) and off (to see how the form will 
look to a user).  </p>
<p>Nevertheless, manipulating a form from code can be useful. This chapter starts with 
an overview of the forms API, and then looks at how data input into an existing form 
can be processed using listeners. This isn't the standard way of adding behavior to </p>
<div class="admonition note">
<p class="admonition-title">Topics</p>
</div>
<p>An Overview of 
the Forms API; 
Examining a Text-based 
Form; Attaching 
Listeners to a View 
Example folders: "Forms 
Tests" and "Utils" 
forms; that capability is typically handled by macros coded in Office Basic (for 
example, see chapter 13 of "Getting Started with LibreOffice" and chapter 9 of the 
"Base Handbook"). I'll be looking at how to code form macros in Chapters 48 and 49. </p>
<p>The next chapter, Chapter 40, will look at how a form can be constructed at run time 
by programmatically adding controls to a new text document. The form is linked to a 
local database, and table and list box controls access its tables in different ways. In 
addition, a variety of listeners are attached to the controls.  </p>
<h2 id="2-an-overview-of-the-forms-api">2.  An Overview of the Forms API</h2>
<p>A key principle behind the forms API is the Model-View-Controller (MVC) pattern 
(e.g. see 
https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller) which 
divides each form control in two: a model (or component) representing the control's 
data, and a view for its GUI. Figure 1 shows the forms MVC model in detail. </p>
<p><img alt="" src="images/39-Forms_API_Overview-1.png" /></p>
<p>Figure 1. The Form API's MVC Model. </p>
<p>The third part of MVC, the controller, links the model and view inside an application. </p>
<p>There might be multiple views attached to a model (i.e. different renderings of the 
same data), and the controller mediates between a view and the model when the user 
tries to change its state (for instance by typing data into a text field). </p>
<p>The thick-edged boxes next to the Model, View and Controller rounded rectangles in 
Figure 1 represent the main Office services and interfaces that implement the model, 
view and controller.  </p>
<h3 id="21-control-confusion">2.1.  Control Confusion</h3>
<p>The two uses of the word "control" in the API can be confusing. When the 
documentation refers to a control by name, such as a "button control" or "text field 
control", then it typically means the data and rendering parts taken as a whole. For 
example, "button control" includes the button's on-screen appearance and its state. </p>
<p>However, when the API only talks about a "control" then this usually means the 
services and interfaces related to its appearance. If the API refers to a control's 
"model" then it means its state.  </p>
<p>Another problem with understanding the forms API is that its functionality is spread 
across several modules and submodules. The form module contains many services, 
interfaces, and seven submodules, which are listed in Table 1. </p>
<p>Form Submodule Purpose 
binding collects functionality for binding form controls to 
external data sources 
component collects form control model descriptions 
control collects form control descriptions 
inspection collects services for inspecting form/components<br />
runtime collects functionality needed during a form's runtime 
submission collects functionality for submitting forms to external 
data sinks 
validation collects functionality to validate form components by 
help of external validator instances 
Table 1. Submodules of the Form Module. </p>
<p>To simplify matters, I'm only going to describe two of the submodules: 
form.component which holds the model-related services, and form.control for the 
view-related services.   </p>
<p>But there's more modules to browse! Figure 2 shows the main services and interfaces 
used to define a button.  </p>
<p><img alt="" src="images/39-Forms_API_Overview-2.png" /></p>
<p>Figure 2. Form Services and Interfaces for a Button. </p>
<p>Four modules are mentioned in Figure 2, written in brackets inside the service 
rectangles. There's a CommandButton service in form.component and a second 
CommandButton in form.control. An examination of these services (and most other 
services in form.component and form.control) reveal them to be basically empty. The 
real 'action' is elsewhere, up in the form module's FormControlModel service, and 
over in Office's very large awt module, which implements its version of Java's AWT.  </p>
<p>The names of the services start to become a little unclear at this point since the words 
"Control" and "Model" often appear together (e.g. in FormControlModel, 
UnoControlButtonModel, and UnoControlModel). My advice is to remember that 
"Model beats Control" . If a class name includes the word "Model", then it's 
probably for the model/data part of the control. If the name contains only "Control" 
then it's most likely for the rendering/appearance or listener part of the control. </p>
<p>For example, UnoControlButtonModel is where the button's data is defined, as a 
lengthy collection of properties. You can quickly view its documentation with lodoc 
UnoControlButtonModel. UnoControlButton is for the button's GUI (see lodoc 
UnoControlButton). Most of the functionality for a button is accessed through its 
XButton interface, which allows a listener to be attached to the button. </p>
<p>Every model (e.g. CommandButton in form.component) inherits the 
FormControlModel service in the form module. This links the control into the 
surrounding form. </p>
<h3 id="22-more-information-on-the-api">2.2.  More Information on the API</h3>
<p>The principal documentation on the forms API is chapter 13 of the Developer's Guide<br />
available as 
https://wiki.openoffice.org/w/images/d/d9/DevelopersGuide_OOo3.1.0.pdf. </p>
<p>Alternatively, you can read the chapter online, starting at 
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Forms/Forms (or use 
loGuide Forms). The guide's form examples are at 
http://api.libreoffice.org/examples/DevelopersGuide/examples.html#Forms. </p>
<h2 id="3-examining-a-text-based-form">3.  Examining a Text-based Form</h2>
<p>ExamineForm.java opens a text document containing a form, and attaches button and 
text field listeners to every button and text field control.  </p>
<p>Figure 3 shows most of the important data structures used by a form. </p>
<p><img alt="" src="images/39-Forms_API_Overview-3.png" /></p>
<p>Figure 3. The Form Data Structures. </p>
<p>A form is stored in a draw page associated with the document. A draw page can 
manage multiple forms, which can be accessed by index or by name (the default form 
is called "Form"). In some types of Office documents, it's possible to have multiple 
draw pages.  </p>
<p>A form contains controls, such as buttons, text fields, and tables, and also nested 
forms. Collectively, controls and nested forms are known as form components, and 
are organized into a tree hierarchy in the draw page. At the lowest level, each basic 
form control is represented by a control shape, a specialized kind of DrawPage shape. </p>
<p>A data source, such as a database, may be attached to a form, which its controls can 
access using SQL queries. </p>
<p>Figure 4 gives a high-level view of how ExamineForm.java "digs down" into a 
document to access each control's model and view. </p>
<p><img alt="" src="images/39-Forms_API_Overview-4.png" /></p>
<p>Figure 4. From Document to Control Model and View. </p>
<p>The words connected by the arrows correspond (in most cases) to services in the 
forms API; the names in blue are the interfaces associated with those services. The 
"Fig. X" rounded rectangles refer to figures later in this chapter which give more 
detail about how the API links from one service to the next.  </p>
<p>Figure 4 starts with the document, and ends with references to a control's model and 
view services. For example, the services for a button are the CommandButton classes 
in the form.component and form.control modules. </p>
<p>Figure 4 has a branch point at the DrawPage service (it's labeled with the word "or") 
since there are two ways of using the API to get from a draw page to control models. </p>
<p>The branch on the left examines the control shapes in the DrawPage, while the branch 
on the right examines the form components.   </p>
<p>I've decided not to explain the the left branch, although it's documented in my 
Forms.java utility class. The left branch corresponds to code in the 
Forms.getModels2() method. </p>
<p>Most of  Figure 4 is implemented as static methods in the Forms class, which means 
that ExamineForm.java is fairly short: </p>
<p>// in ExamineForm.java 
public static void main(String args[]) 
{ 
  if (args.length != 1) { 
    System.out.println("Usage: run ExamineForm <ODT file>"); 
    return; 
  } 
  XComponentLoader loader = Lo.loadOffice(); 
  XComponent doc = Lo.openDoc(args[0], loader); 
  if (doc == null) { 
    System.out.println("Could not open " + args[0]); 
    Lo.closeOffice(); 
    return; 
  } </p>
<p>ArrayList<XControlModel> models = Forms.getModels(doc); 
  System.out.println("No. of control models in form: " +<br />
                                             models.size()); 
  // examine each model 
  for(XControlModel model : models) { 
    System.out.println("  " + Forms.getName(model) + ": " + 
                              Forms.getTypeStr(model)); </p>
<pre><code>// look at the control for each model 
XControl ctrl = Forms.getControl(doc, model); 
if (ctrl == null)  
  System.out.println("   No control found"); 
else {   // attach listener if the control is  
         // a button or text field 
  if (Forms.isButton(model)) 
    attachButtonListener(ctrl, model); 
  else if (Forms.isTextField(model)) 
    attachTextFieldListeners(ctrl); 
}
</code></pre>
<p>} 
  System.out.println(); 
  GUI.setVisible(doc, true); 
  Lo.waitEnter(); </p>
<p>Lo.closeDoc(doc); 
  Lo.closeOffice(); 
}  // end of main() </p>
<p>Forms.getModels() and Forms.getControl() will be used in most forms-based 
programs. Forms.getModels() returns a list of all the control models in the document. </p>
<p>In terms of Figure 4, it moves from the Document service at the top of the figure to 
ControlModel near the bottom. Forms.getControl() completes the descent by 
retrieving the control (view) associated with a given model. </p>
<p>If a control is a button or text field than attachButtonListener() or 
attachTextFieldListeners() are called. These methods are implemented in 
ExamineForm.java, but I'll delay explaining them until I've covered 
Forms.getModels() and Forms.getControl(). </p>
<h3 id="31-from-document-to-drawpages">3.1.  From Document to DrawPages</h3>
<p>Every Office document supports the OfficeDocument service, and the XModel and 
XComponent interfaces. Using XComponent as a starting interface, it's possible to 
change the type to XDrawPagesSupplier (or XDrawPageSupplier), which gives access 
to the DrawPages (or single DrawPage) inside the document. The cast works because 
all Office documents support the GenericDrawingDocument service, as illustrated in </p>
<p><img alt="" src="images/39-Forms_API_Overview-5.png" /></p>
<p>Figure 5. </p>
<p><img alt="" src="images/39-Forms_API_Overview-5.png" /></p>
<p>Figure 5. Part of the GenericDrawingDocument Service Hierarchy </p>
<p>The code that implements the cast: </p>
<p>// in the Forms class 
public static XNameContainer getForms(XComponent doc) 
{ 
  XDrawPage drawPage = getDrawPage(doc); 
  if (drawPage != null) 
    return getForms(drawPage); 
  else 
    return null; 
}  // end of getForms() </p>
<p>public static XDrawPage getDrawPage(XComponent doc) 
// return the first draw page even if there are many 
{ 
  XDrawPageSupplier xSuppPage =<br />
                Lo.qi(XDrawPageSupplier.class, doc); 
  if (xSuppPage != null) 
    // this works if doc supports a single DrawPage 
    return xSuppPage.getDrawPage(); 
  else {  <br />
    // this means that the doc supports multiple DrawPages 
    XDrawPagesSupplier xSuppPages =<br />
                Lo.qi(XDrawPagesSupplier.class, doc); </p>
<pre><code>XDrawPages xPages = xSuppPages.getDrawPages(); 
try { 
  System.out.println("Returning first draw page"); 
  return Lo.qi(XDrawPage.class, xPages.getByIndex(0)); 
} 
catch(Exception e) { 
  System.out.println(e); 
  return null; 
}
</code></pre>
<p>} 
}  // end of getDrawPage() </p>
<p>Forms.getDrawPage() only returns the first draw page in a document, even if many 
pages are available. </p>
<h3 id="32-from-drawpage-to-form">3.2.  From DrawPage to Form</h3>
<p>The XDrawPage interface can be cast to XFormsSupplier which makes the page's<br />
forms accessible. This cast works because of the service hierarchy shown in Figure 6 
which links the DrawPage service to GenericDrawPage. </p>
<p><img alt="" src="images/39-Forms_API_Overview-6.png" /></p>
<p>Figure 6. Part of the DrawPage Service Hierarchy. </p>
<p>XFormsSupplier can supply forms as an indexed sequence (an XIndexContainer) or 
as an associative array using the form names as keys, returned by Forms.getForms(): </p>
<p>// in the Forms class 
public static XNameContainer getForms(XDrawPage drawPage) 
// get all the forms in the page as a named container 
{ 
  XFormsSupplier formsSupp = Lo.qi(XFormsSupplier.class, drawPage); 
  return formsSupp.getForms(); 
} // end of getForms() </p>
<p>The default form in a draw page is called "Form", and can be extracted by calling 
Forms.getForm(doc,"Form"): </p>
<p>// in the Forms class 
public static XForm getForm(XComponent doc, String formName) 
// get the form called formName 
{ 
   XNameContainer namedForms = getForms(doc);  // see above 
   XNameContainer con = getFormByName(formName, namedForms); 
   return Lo.qi(XForm.class, con); 
} </p>
<p>public static XNameContainer getFormByName(String formName, 
                                   XNameContainer namedForms) 
// get the form called formName 
{ try { 
    return Lo.qi(XNameContainer.class,<br />
                       namedForms.getByName(formName)); 
  } 
  catch (Exception e) { 
    System.out.println("Could not find form " + formName + ": " + e); 
    return null; 
  } 
}  // end of getFormByName() </p>
<h3 id="33-from-form-to-formcomponents">3.3.  From Form to FormComponents</h3>
<p>A form is a FormComponents instance, which holds FormComponent instances (i.e. </p>
<p>basic controls) and nested FormComponents (i.e. nested forms). Figure 7 shows a 
simplified service hierarchy for Form, FormComponents, and FormComponent. </p>
<p><img alt="" src="images/39-Forms_API_Overview-7.png" /></p>
<p>Figure 7. Part of the Form Service Hierarchy. </p>
<p>Forms.getModels() collects all the FormComponent instances as a list by recursively 
searching from the top level form (or forms) through all the nested forms : </p>
<p>// in the Forms class 
public static ArrayList<XControlModel> getModels(XComponent doc) 
{ XNameContainer formNamesCon = getForms(doc);  // see above 
  return getModels(formNamesCon); 
} </p>
<p>public static ArrayList<XControlModel> getModels( 
                                         XNameAccess formNamesCon) 
{ 
  ArrayList<XControlModel> models = new ArrayList<XControlModel>(); 
  String nms[] = formNamesCon.getElementNames(); 
  for (int i=0; i &lt; nms.length; i++) { 
    try { 
      XServiceInfo servInfo = Lo.qi(XServiceInfo.class, 
                                  formNamesCon.getByName(nms[i])); 
      if (servInfo.supportsService( 
                             "com.sun.star.form.FormComponents")) { 
        // this means that a nested form has been found 
        XNameAccess childCon = Lo.qi(XNameAccess.class, servInfo); 
        models.addAll( getModels(childCon) );//recursively search it<br />
      } 
      else if (servInfo.supportsService( 
                             "com.sun.star.form.FormComponent")) { 
        XControlModel model = Lo.qi(XControlModel.class, servInfo); 
        models.add(model); 
      } 
    } 
    catch(Exception e) 
    {  System.out.println("Could not access " + nms[i]);  } 
  } 
  return models; 
}  // end of getModels() </p>
<p>The first Forms.getModels() method extracts the top-level form (or forms) from the 
document as a named container, then passes it to the recursive getModels() which 
iterates through the container. If an element is a FormComponents instance then it's a 
nested form, and getModels() is called recursively to collect its controls. If the 
element is of type FormComponent then it's an ordinary control. </p>
<h3 id="34-from-formcomponent-to-control-model">3.4.  From FormComponent to Control Model</h3>
<p>A FormComponent instance can be cast to XControlModel: 
XControlModel model = Lo.qi(XControlModel.class, servInfo); 
XControlModel first appeared at the top of Figure 2 on the left – it’s the interface 
inherited by all models. </p>
<p>The casting is possible because every control model service (e.g. CommandButton in 
the form.component module) inherits both FormComponent and UnoControlModel, 
as depicted by Figure 8. </p>
<p><img alt="" src="images/39-Forms_API_Overview-8.png" /></p>
<p>Figure 8. Part of the Service Hierarchy for the CommandButton Model. </p>
<p>Every model has a hierarchy similar to CommandButton's in Figure 8. For example, 
the text field control model hierarchy appears in Figure 9. </p>
<p><img alt="" src="images/39-Forms_API_Overview-9.png" /></p>
<p>Figure 9. Part of the Service Hierarchy for the TextField Model. </p>
<p>Figures 8 and 9 depict two important coding features. One is that it's possible to cast 
between a form component and a control model, as demonstrated by 
Forms.getModel() shown above. The other is that a model's data is stored in its 
properties, and most of those are NOT in the model's service (i.e. not in 
CommandButton and TextField). Most model properties are in superclasses (i.e. </p>
<p>UnoControlButtonModel in Figure 8 and UnoControlEditModel in Figure 9), which 
are located in the awt module. </p>
<h3 id="35-using-a-control-model">3.5.  Using a Control Model</h3>
<p>Returning to ExamineForm.java, the relevant bit of code is: </p>
<p>// part of ExamineForm.java... </p>
<dl>
<dt>ArrayList<XControlModel> models = Forms.getModels(doc); // see above</dt>
<dt>System.out.println("No. of control models in form: " +</dt>
<dt>models.size());</dt>
<dt>// examine each model</dt>
<dt>for(XControlModel model : models) {</dt>
<dt>System.out.println("  " + Forms.getName(model) + ": " +</dt>
<dt>Forms.getTypeStr(model));</dt>
<dd>} </dd>
</dl>
<p>An XControlModel reference can be utilized in various ways, but two of the main 
ones are examining its subclass service type and accessing its properties. As Figures 8 
and 9 indicate, most of a control's properties are in the UnoControlXXXModel 
service, but may come from other services which can be hard to locate. For example, 
"Name" is from UnoControlDialogElement, a superclass of UnoControlModel (which 
I didn't include in Figures 8 and 9). "ClassId" comes from FormControlModel, which 
is on the "forms branch" of the service hierarchies in the figures. </p>
<p>The easiest thing is to print all the model's properties, by calling 
Props.showObjProps(): 
Props.showObjProps("Model", model); 
Info.showInterfaces() and Info.showServices() are similarly useful, listing all the 
interfaces and services for a model: </p>
<p>Info.showInterfaces("Model", model); 
Info.showServices("Model", model); </p>
<p>The Forms.getName() and Forms.getTypeStr() methods called in the code fragment 
above are defined as: </p>
<p>// in the Forms class 
public static String getName(XControlModel cModel) 
// returns the name of the given form component 
{  return (String) Props.getProperty(cModel, "Name");  } </p>
<p>public static String getTypeStr(XControlModel cModel) 
{ 
  int id = getID(cModel); 
  if (id == -1) 
    return null; </p>
<p>XServiceInfo servInfo = Lo.qi(XServiceInfo.class, cModel); 
  switch (id) { 
    case FormComponentType.COMMANDBUTTON: 
      return "Command button";<br />
    case FormComponentType.RADIOBUTTON: 
      return "Radio button";<br />
    case FormComponentType.IMAGEBUTTON: 
      return "Image button";<br />
    case FormComponentType.CHECKBOX: 
      return "Check Box";<br />
    case FormComponentType.LISTBOX: 
      return "List Box";<br />
    case FormComponentType.COMBOBOX: 
      return "Combo Box";<br />
    case FormComponentType.GROUPBOX: 
      return "Group Box";<br />
    case FormComponentType.FIXEDTEXT: 
      return "Fixed Text";<br />
    case FormComponentType.GRIDCONTROL: 
      return "Grid Control";<br />
    case FormComponentType.FILECONTROL: 
      return "File Control";<br />
    case FormComponentType.HIDDENCONTROL: 
      return "Hidden Control";<br />
    case FormComponentType.IMAGECONTROL: 
      return "Image Control";<br />
    case FormComponentType.DATEFIELD: 
      return "Date Field";<br />
    case FormComponentType.TIMEFIELD: 
      return "Time Field";<br />
    case FormComponentType.NUMERICFIELD: 
      return "Numeric Field";<br />
    case FormComponentType.CURRENCYFIELD: 
      return "Currency Field";<br />
    case FormComponentType.PATTERNFIELD: 
      return "Pattern Field";<br />
    case FormComponentType.TEXTFIELD: 
      // two services with this class id:<br />
      // text field and formatted field<br />
      if ((servInfo != null) &amp;&amp; servInfo.supportsService( 
                     "com.sun.star.form.component.FormattedField")) 
        return "Formatted Field"; 
      else 
        return "Text Field"; 
    default:<br />
      System.out.println("Unknown class ID: " + id); 
      return null; 
  } 
}  // end of getTypeStr() </p>
<p>public static int getID(XControlModel cModel) 
{ 
  // get the ClassId property 
  Short classId = (Short) Props.getProperty(cModel, "ClassId"); 
  if (classId == null) { 
    System.out.println("No class ID found for form component"); 
    return -1; 
  }<br />
  return classId.intValue(); 
}  // end of getID() </p>
<p>Forms.getID returns the "ClassId" integer, which is checked by getTypeStr() against 
values in the FormComponentType enumeration, and mapped to more informative 
strings. </p>
<p>Forms.getID() is utilized in a similar manner in a series of boolean isXXX() methods, 
such as isButton() and isTextField(): </p>
<p>// in the Forms class 
public static boolean isButton(XControlModel cModel) 
{ 
  int id = getID(cModel); 
  if (id == -1) 
    return false; 
  else<br />
    return ((id == FormComponentType.COMMANDBUTTON) || 
            (id == FormComponentType.IMAGEBUTTON)); 
}  // end of isButton() </p>
<p>public static boolean isTextField(XControlModel cModel) 
{ 
  int id = getID(cModel); 
  if (id == -1) 
    return false; 
    else<br />
    return ((id == FormComponentType.DATEFIELD) || 
            (id == FormComponentType.TIMEFIELD) || 
            (id == FormComponentType.NUMERICFIELD) || 
            (id == FormComponentType.CURRENCYFIELD) || 
            (id == FormComponentType.PATTERNFIELD) || 
            (id == FormComponentType.TEXTFIELD)); 
}  // end of isTextField() </p>
<h3 id="36-from-control-model-to-view">3.6.  From Control Model to View</h3>
<p>Having obtained a form's model, it's view becomes accessible, but following the 
MVC pattern, this requires the use of Office's controller (see Figure 1). One way to 
reach the controller is through a document reference (XComponent) and 
XModel.getCurrentController(). The resulting XController interface can be cast to 
XControlAccess, due to the service hierarchy shown in Figure 10. </p>
<p><img alt="" src="images/39-Forms_API_Overview-10.png" /></p>
<p>Figure 10. Part of the DrawingDocumentDrawView Service Hierarchy. </p>
<p>These steps are implemented by GUI.getControlAccess(): </p>
<p>// in the GUI class 
public static XControlAccess getControlAccess(XComponent doc) 
{ return Lo.qi(XControlAccess.class, getCurrentController(doc)); } </p>
<p>public static XController getCurrentController(XComponent doc) 
{<br />
  XModel model = Lo.qi(XModel.class, doc);<br />
  if (model == null) { 
    System.out.println("Document has no data model"); 
    return null; 
  } 
  return model.getCurrentController();<br />
} </p>
<p>Forms.getControl() employs XControlAccess.getControl() to return the model's view 
when supplied with a model: </p>
<p>// in the Forms class 
public static XControl getControl(XComponent doc,<br />
                                       XControlModel cModel) 
{ XControlAccess controlAccess = GUI.getControlAccess(doc); <br />
                                 // see above 
  if (controlAccess == null) { 
    System.out.println("Could not obtain controls access"); 
    return null; 
  } 
  try { 
    return controlAccess.getControl(cModel); 
  } 
  catch (Exception e) { 
    System.out.println("Could not access control: " + e); 
    return null; 
  } 
}  // end of getControl() </p>
<h2 id="4-attaching-listeners-to-a-view">4.  Attaching Listeners to a View</h2>
<p>XControl is an interface of the UnoControl service, which represents an abstract 
control. This class must be cast to a service for a real control, such as 
UnoControlButton or UnoControlEdit in order to call listener methods in XButton or 
XTextComponent. This hierarchy is illustrated by Figure 11. </p>
<p><img alt="" src="images/39-Forms_API_Overview-11.png" /></p>
<p>Figure 11. Part of the Service Hierarchy Below UnoControl. </p>
<p>Back in ExamineForm.java, every button or text field has listeners attached to it: </p>
<p>// part of ExamineForms.java... </p>
<pre><code>:
</code></pre>
<p>// look at the control for each model 
XControl ctrl = Forms.getControl(doc, model); 
if (ctrl == null)<br />
  System.out.println("   No control found"); 
else {   // attach listener if the control is a button or text field 
    if (Forms.isButton(model)) 
      attachButtonListener(ctrl, model); 
    else if (Forms.isTextField(model)) 
      attachTextFieldListeners(ctrl); 
} 
    : </p>
<p>attachButtonListener() and attachTextFieldListener() implement the casting shown in 
Figure 11, starting with an XControl interface. For instance, attachButtonListener() 
connects an anonymous XActionListener object to a button, and sets its action 
command to be the button's label: </p>
<p>// in ExamineForms.java 
private static void attachButtonListener(XControl ctrl,<br />
                                       XControlModel cModel) 
{ XButton xButton = Lo.qi(XButton.class, ctrl); 
  // XControlModel cModel = ctrl.getModel(); 
  xButton.setActionCommand( Forms.getLabel(cModel)); </p>
<p>xButton.addActionListener( new XActionListener() { 
    public void disposing(com.sun.star.lang.EventObject ev) {} </p>
<pre><code>public void actionPerformed(ActionEvent ev) 
{  System.out.println("Pressed \"" + ev.ActionCommand + "\""); }
</code></pre>
<p>}); 
}  // end of attachButtonListener() </p>
<p>Although XActionListener and Java's ActionListener are similar, they're not the same. </p>
<p>For one thing, its necessary to define two methods in XActionListener, 
actionPerformed() and disposing(). </p>
<p>Office supports over 120 kinds of listeners! The best place to browse through them is 
on the documentation webpage for their common superclass, XEventListener. lodoc 
XEventListener should take you to XEventListener in the document module, but 
you want its superclass, XEventListener in the lang module. The first part of its long 
webpage is shown in Figure 12. </p>
<p><img alt="" src="images/39-Forms_API_Overview-12.png" /></p>
<p>Figure 12. The First Part of the XEventListener Documentation Page<br />
in the lang Module. </p>
<p>Although the clickable images on the LibreOffice webpages make moving around the 
service and interface hierarchies very easy, they're not searchable. When the hierarchy 
is very large (as for XEventListener), and not sorted in alphabetical order, it can be 
time-consuming to find a particular subclass.  </p>
<p>I solved the problem by creating a text file, called XEventListenerSubclasses.txt, 
which lists the subclasses of XEventListener in order, and is searchable of course. </p>
<p>You can find it in the Forms Tests/ folder for this chapter. </p>
<p>Alternatively, almost all the listeners for controls are defined in the awt module, so 
you can search that module's documentation page (accessible using lodoc awt 
module). </p>
<p>attachTextFieldListeners() attaches two listeners to a text field control because 
XTextListener isn't triggered when the user types <ENTER>. My solution is to 
connect an XFocusListener which treats <ENTER> as a "lost focus" event when the 
cursor leaves the text field. The code for attachTextFieldListeners(): </p>
<p>// in ExamineForms.java 
private static void attachTextFieldListeners(XControl ctrl) 
// listen for text changes and focus changes in the control 
{ 
  XTextComponent tc = Lo.qi(XTextComponent.class, ctrl); 
  tc.addTextListener( new XTextListener() { 
    public void textChanged(TextEvent ev) 
    { 
      XControlModel cModel = Forms.getEventControlModel(ev); 
      System.out.println( Forms.getName(cModel) +<br />
                 " text: " + Props.getProperty(cModel, "Text")); 
    }  // end of textChanged() </p>
<pre><code>public void disposing(EventObject ev) {}
</code></pre>
<p>}); </p>
<p>XWindow tfWindow = Lo.qi(XWindow.class, ctrl); 
  tfWindow.addFocusListener( new XFocusListener() { </p>
<pre><code>public void focusLost(FocusEvent ev) 
{ XControlModel model = Forms.getEventControlModel(ev); 
  System.out.println("Leaving text: " +  
                      Props.getProperty(model, "Text")); 
}

public void disposing(EventObject ev) {}  // unused 
public void focusGained(FocusEvent ev) {}
</code></pre>
<p>}); </p>
<p>}  // end of attachTextFieldListeners() </p>
<p>Obtaining the Model 
attachButtonListener() and attachTextFieldListeners() demonstrate two ways of 
obtaining the control's model when an event triggers a view listener.  </p>
<p>In attachButtonListener(), an XControl reference is available, which means that 
XControl.getModel() could be called: 
XControlModel cModel = ctrl.getModel(); 
In fact that coding isn't used, since the model reference is available already. </p>
<p>attachTextFieldListeners() shows another approach, which is to examine the event 
object that arrives at the listener's method (e.g. the FocusEvent object received by 
focusLost()). Forms.getEventControlModel() is defined as: </p>
<p>// in the Forms class 
public static XControlModel getEventControlModel(EventObject ev) 
{ 
  XControl xControl = Lo.qi(XControl.class, ev.Source); 
  return xControl.getModel(); 
}  // end of getEventControlModel() </p>
<h2 id="5-using-examineformjava">5.  Using ExamineForm.java</h2>
<p>ExamineForm.java can be called with any form-based ODT file. The simplest one in 
the examples is form1.odt, which consists of only a text field and a button, as shown 
in Figure 13. </p>
<p><img alt="" src="images/39-Forms_API_Overview-13.png" /></p>
<p>Figure 13. The form1.odt Form. </p>
<p>When the user types "abc" and <ENTER> into the text field, followed by two clicks 
of the "Enter" button, the following is printed: </p>
<p>Text Box 1 text: a 
Text Box 1 text: ab 
Text Box 1 text: abc 
Leaving text: abc 
Leaving text: abc 
Pressed "Enter" 
Pressed "Enter" </p>
<p>The focus lost event is reported twice because of the <ENTER> key press and the 
movement of the mouse by the user from the text field to the button. </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="39%20Part%207%20Cross-application.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Part 7 Cross-application
            </div>
          </div>
        </a>
      
      
        <a href="40-Building_a_Form.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 40. Building a Form
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>