
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/39-Forms_API_Overview.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 39. Forms API Overview - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-39-forms-api-overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 39. Forms API Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 39. Forms API Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="39-Forms_API_Overview.html" class="md-nav__link md-nav__link--active">
        Chapter 39. Forms API Overview
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-why-bother-programming-forms" class="md-nav__link">
    1.  Why Bother Programming Forms?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-an-overview-of-the-forms-api" class="md-nav__link">
    2.  An Overview of the Forms API
  </a>
  
    <nav class="md-nav" aria-label="2.  An Overview of the Forms API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-control-confusion" class="md-nav__link">
    2.1.  Control Confusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-more-information-on-the-api" class="md-nav__link">
    2.2.  More Information on the API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-examining-a-text-based-form" class="md-nav__link">
    3.  Examining a Text-based Form
  </a>
  
    <nav class="md-nav" aria-label="3.  Examining a Text-based Form">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-from-document-to-drawpages" class="md-nav__link">
    3.1.  From Document to DrawPages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-from-drawpage-to-form" class="md-nav__link">
    3.2.  From DrawPage to Form
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-from-form-to-formcomponents" class="md-nav__link">
    3.3.  From Form to FormComponents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-from-formcomponent-to-control-model" class="md-nav__link">
    3.4.  From FormComponent to Control Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-using-a-control-model" class="md-nav__link">
    3.5.  Using a Control Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-from-control-model-to-view" class="md-nav__link">
    3.6.  From Control Model to View
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-attaching-listeners-to-a-view" class="md-nav__link">
    4.  Attaching Listeners to a View
  </a>
  
    <nav class="md-nav" aria-label="4.  Attaching Listeners to a View">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-model" class="md-nav__link">
    Obtaining the Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-using-examineformjava" class="md-nav__link">
    5.  Using ExamineForm.java
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-why-bother-programming-forms" class="md-nav__link">
    1.  Why Bother Programming Forms?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-an-overview-of-the-forms-api" class="md-nav__link">
    2.  An Overview of the Forms API
  </a>
  
    <nav class="md-nav" aria-label="2.  An Overview of the Forms API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-control-confusion" class="md-nav__link">
    2.1.  Control Confusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-more-information-on-the-api" class="md-nav__link">
    2.2.  More Information on the API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-examining-a-text-based-form" class="md-nav__link">
    3.  Examining a Text-based Form
  </a>
  
    <nav class="md-nav" aria-label="3.  Examining a Text-based Form">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-from-document-to-drawpages" class="md-nav__link">
    3.1.  From Document to DrawPages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-from-drawpage-to-form" class="md-nav__link">
    3.2.  From DrawPage to Form
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-from-form-to-formcomponents" class="md-nav__link">
    3.3.  From Form to FormComponents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-from-formcomponent-to-control-model" class="md-nav__link">
    3.4.  From FormComponent to Control Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-using-a-control-model" class="md-nav__link">
    3.5.  Using a Control Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-from-control-model-to-view" class="md-nav__link">
    3.6.  From Control Model to View
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-attaching-listeners-to-a-view" class="md-nav__link">
    4.  Attaching Listeners to a View
  </a>
  
    <nav class="md-nav" aria-label="4.  Attaching Listeners to a View">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-model" class="md-nav__link">
    Obtaining the Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-using-examineformjava" class="md-nav__link">
    5.  Using ExamineForm.java
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/main/docs/39-Forms_API_Overview.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-39-forms-api-overview">Chapter 39. Forms API Overview<a class="headerlink" href="#chapter-39-forms-api-overview" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>An Overview of
the Forms API;
Examining a Text-based
Form; Attaching
Listeners to a View</p>
<p>Example folders: "Forms
Tests" and "Utils"</p>
</div>
<p>Forms are usually found in Writer documents, or as data
entry interfaces for Base, although they can also be
employed in Draw, Impress, and Calc. Although Base
forms are typically employed as front-ends to databases,
the same capability is available in Writer and the other
Office applications.</p>
<p>The LibreOffice "Getting Started Guide" (available at <a href="https://th.libreoffice.org/get-help/documentation/">https://th.libreoffice.org/get-help/documentation/</a>)
describes the form features of Writer and Base in chapters 4 and
8.  Longer examples can be found in the "Writer Guide" and "Base Handbook"
documents.</p>
<p>Chapter 15 of the "Writer Guide" explains how to create a form using the "Form
Controls " and "Form Design" toolbars; it's essentially a matter of dragging check
boxes, buttons, text fields, pull-down lists, and other controls, onto a form canvas.
Properties associated with a control, such as its name, text label, and position, are set
by right clicking to access a properties dialog window.</p>
<p>An important use of Writer forms is to create editable PDF forms. This doesn't
involve anything more than remembering to save the form-filled document as a PDF
file when it's finished. There are several online tutorials that explain the details, such
as "Create PDF Forms with OpenOffice" at
<a href="https://foersom.com/org/HowTo/OoCreatePdfForm.html">https://foersom.com/org/HowTo/OoCreatePdfForm.html</a>; although it's written for
OpenOffice, it can be applied to LibreOffice without change.</p>
<p>Chapter 4 of the "Base Handbook" explains how to create a data input form for a
library loans database, and much of the GUI interface of control toolbars, form
canvas, and property dialogs is identical to that found in Writer. Even if you're only
creating a text-based form, it's well worth reading the Base chapter because it goes
into detail about the General, Data, and Events tab in the properties dialog.</p>
<p>A somewhat simpler example, which is purely text-based without data sources, can be
found at <a href="https://openoffice.blogs.com/forms_fromscratch.pdf">https://openoffice.blogs.com/forms_fromscratch.pdf</a>. I used this article (which
is titled "Creating Forms from Scratch") to create the scratchExample.odt file used
here.</p>
<h2 id="1-why-bother-programming-forms">1.  Why Bother Programming Forms?<a class="headerlink" href="#1-why-bother-programming-forms" title="Permanent link">&para;</a></h2>
<p>It's very easy to build a form using Office's "Form Controls " and "Form Design"
toolbars. The GUI provides immediate feedback on how things will look by switching
design mode on (where you're building the form) and off (to see how the form will
look to a user).</p>
<p>Nevertheless, manipulating a form from code can be useful. This chapter starts with
an overview of the forms API, and then looks at how data input into an existing form
can be processed using listeners. This isn't the standard way of adding behavior to
forms; that capability is typically handled by macros coded in Office Basic (for
example, see chapter 13 of "Getting Started with LibreOffice" and chapter 9 of the
"Base Handbook"). I'll be looking at how to code form macros in Chapters 48 and 49.</p>
<p>The next chapter, Chapter 40, will look at how a form can be constructed at run time
by programmatically adding controls to a new text document. The form is linked to a
local database, and table and list box controls access its tables in different ways. In
addition, a variety of listeners are attached to the controls.</p>
<h2 id="2-an-overview-of-the-forms-api">2.  An Overview of the Forms API<a class="headerlink" href="#2-an-overview-of-the-forms-api" title="Permanent link">&para;</a></h2>
<p>A key principle behind the forms API is the Model-View-Controller (MVC) pattern
(e.g. see
<a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller/">https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller/</a>) which
divides each form control in two: a model (or component) representing the control's
data, and a view for its GUI. Figure 1 shows the forms MVC model in detail.</p>
<p><img alt="" src="images/39-Forms_API_Overview-1.png" /></p>
<p>Figure 1. The Form API's MVC Model.</p>
<p>The third part of MVC, the controller, links the model and view inside an application.
There might be multiple views attached to a model (i.e. different renderings of the
same data), and the controller mediates between a view and the model when the user
tries to change its state (for instance by typing data into a text field).</p>
<p>The thick-edged boxes next to the Model, View and Controller rounded rectangles in
Figure 1 represent the main Office services and interfaces that implement the model,
view and controller.</p>
<h3 id="21-control-confusion">2.1.  Control Confusion<a class="headerlink" href="#21-control-confusion" title="Permanent link">&para;</a></h3>
<p>The two uses of the word "control" in the API can be confusing. When the
documentation refers to a control by name, such as a "button control" or "text field
control", then it typically means the data and rendering parts taken as a whole. For
example, "button control" includes the button's on-screen appearance and its state.
However, when the API only talks about a "control" then this usually means the
services and interfaces related to its appearance. If the API refers to a control's
"model" then it means its state.</p>
<p>Another problem with understanding the forms API is that its functionality is spread
across several modules and submodules. The form module contains many services,
interfaces, and seven submodules, which are listed in Table 1.</p>
<table>
<thead>
<tr>
<th>Form Submodule</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>binding</td>
<td>collects functionality for binding form controls to</td>
</tr>
<tr>
<td></td>
<td>external data sources</td>
</tr>
<tr>
<td>component</td>
<td>collects form control model descriptions</td>
</tr>
<tr>
<td>control</td>
<td>collects form control descriptions</td>
</tr>
<tr>
<td>inspection</td>
<td>collects services for inspecting form/components</td>
</tr>
<tr>
<td>runtime</td>
<td>collects functionality needed during a form's runtime</td>
</tr>
<tr>
<td>submission</td>
<td>collects functionality for submitting forms to external</td>
</tr>
<tr>
<td></td>
<td>data sinks</td>
</tr>
<tr>
<td>validation</td>
<td>collects functionality to validate form components by</td>
</tr>
<tr>
<td></td>
<td>help of external validator instances</td>
</tr>
</tbody>
</table>
<p>Table 1. Submodules of the Form Module.</p>
<p>To simplify matters, I'm only going to describe two of the submodules:
form.component which holds the model-related services, and form.control for the
view-related services.</p>
<p>But there's more modules to browse! Figure 2 shows the main services and interfaces
used to define a button.</p>
<p><img alt="" src="images/39-Forms_API_Overview-2.png" /></p>
<p>Figure 2. Form Services and Interfaces for a Button.</p>
<p>Four modules are mentioned in Figure 2, written in brackets inside the service
rectangles. There's a CommandButton service in form.component and a second
CommandButton in form.control. An examination of these services (and most other
services in form.component and form.control) reveal them to be basically empty. The
real 'action' is elsewhere, up in the form module's FormControlModel service, and
over in Office's very large awt module, which implements its version of Java's AWT.</p>
<p>The names of the services start to become a little unclear at this point since the words
"Control" and "Model" often appear together (e.g. in FormControlModel,
UnoControlButtonModel, and UnoControlModel). My advice is to remember that
"Model beats Control" . If a class name includes the word "Model", then it's
probably for the model/data part of the control. If the name contains only "Control"
then it's most likely for the rendering/appearance or listener part of the control.</p>
<p>For example, UnoControlButtonModel is where the button's data is defined, as a
lengthy collection of properties. You can quickly view its documentation with
<code>lodoc UnoControlButtonModel</code>. UnoControlButton is for the button's GUI (see
<code>lodoc UnoControlButton</code>). Most of the functionality for a button is accessed through its
XButton interface, which allows a listener to be attached to the button.</p>
<p>Every model (e.g. CommandButton in form.component) inherits the
FormControlModel service in the form module. This links the control into the
surrounding form.</p>
<h3 id="22-more-information-on-the-api">2.2.  More Information on the API<a class="headerlink" href="#22-more-information-on-the-api" title="Permanent link">&para;</a></h3>
<p>The principal documentation on the forms API is chapter 13 of the Developer's Guide
available as
<a href="https://wiki.openoffice.org/w/images/d/d9/DevelopersGuide_OOo3.1.0.pdf">https://wiki.openoffice.org/w/images/d/d9/DevelopersGuide_OOo3.1.0.pdf</a>.
Alternatively, you can read the chapter online, starting at
<a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/Forms/Forms/">https://wiki.openoffice.org/wiki/Documentation/DevGuide/Forms/Forms/</a> (or use
<code>loGuide Forms</code>). The guide's form examples are at
<a href="https://api.libreoffice.org/examples/DevelopersGuide/examples.html#Forms">https://api.libreoffice.org/examples/DevelopersGuide/examples.html#Forms</a>.</p>
<h2 id="3-examining-a-text-based-form">3.  Examining a Text-based Form<a class="headerlink" href="#3-examining-a-text-based-form" title="Permanent link">&para;</a></h2>
<p>ExamineForm.java opens a text document containing a form, and attaches button and
text field listeners to every button and text field control.</p>
<p>Figure 3 shows most of the important data structures used by a form.</p>
<p><img alt="" src="images/39-Forms_API_Overview-3.png" /></p>
<p>Figure 3. The Form Data Structures.</p>
<p>A form is stored in a draw page associated with the document. A draw page can
manage multiple forms, which can be accessed by index or by name (the default form
is called "Form"). In some types of Office documents, it's possible to have multiple
draw pages.</p>
<p>A form contains controls, such as buttons, text fields, and tables, and also nested
forms. Collectively, controls and nested forms are known as form components, and
are organized into a tree hierarchy in the draw page. At the lowest level, each basic
form control is represented by a control shape, a specialized kind of DrawPage shape.</p>
<p>A data source, such as a database, may be attached to a form, which its controls can
access using SQL queries.</p>
<p>Figure 4 gives a high-level view of how ExamineForm.java "digs down" into a
document to access each control's model and view.</p>
<p><img alt="" src="images/39-Forms_API_Overview-4.png" /></p>
<p>Figure 4. From Document to Control Model and View.</p>
<p>The words connected by the arrows correspond (in most cases) to services in the
forms API; the names in blue are the interfaces associated with those services. The
"Fig. X" rounded rectangles refer to figures later in this chapter which give more
detail about how the API links from one service to the next.</p>
<p>Figure 4 starts with the document, and ends with references to a control's model and
view services. For example, the services for a button are the CommandButton classes
in the form.component and form.control modules.</p>
<p>Figure 4 has a branch point at the DrawPage service (it's labeled with the word "or")
since there are two ways of using the API to get from a draw page to control models.
The branch on the left examines the control shapes in the DrawPage, while the branch
on the right examines the form components.</p>
<p>I've decided not to explain the the left branch, although it's documented in my
Forms.java utility class. The left branch corresponds to code in the
Forms.getModels2() method.</p>
<p>Most of  Figure 4 is implemented as static methods in the Forms class, which means
that ExamineForm.java is fairly short:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in ExamineForm.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Usage: run ExamineForm &lt;ODT file&gt;&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XComponent</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">openDoc</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not open &quot;</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XControlModel</span><span class="o">&gt;</span> <span class="n">models</span> <span class="o">=</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getModels</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No. of control models in form: &quot;</span> <span class="o">+</span>
                                             <span class="n">models</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
  <span class="c1">// examine each model</span>
  <span class="k">for</span><span class="p">(</span><span class="n">XControlModel</span> <span class="n">model</span> <span class="p">:</span> <span class="n">models</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getName</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span>
                              <span class="n">Forms</span><span class="p">.</span><span class="na">getTypeStr</span><span class="p">(</span><span class="n">model</span><span class="p">));</span>

    <span class="c1">// look at the control for each model</span>
    <span class="n">XControl</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getControl</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ctrl</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;   No control found&quot;</span><span class="p">);</span>
    <span class="k">else</span> <span class="p">{</span>   <span class="c1">// attach listener if the control is</span>
             <span class="c1">// a button or text field</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">Forms</span><span class="p">.</span><span class="na">isButton</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
        <span class="n">attachButtonListener</span><span class="p">(</span><span class="n">ctrl</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">Forms</span><span class="p">.</span><span class="na">isTextField</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
        <span class="n">attachTextFieldListeners</span><span class="p">(</span><span class="n">ctrl</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
  <span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">waitEnter</span><span class="p">();</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
<p>Forms.getModels() and Forms.getControl() will be used in most forms-based
programs. Forms.getModels() returns a list of all the control models in the document.
In terms of Figure 4, it moves from the Document service at the top of the figure to
ControlModel near the bottom. Forms.getControl() completes the descent by
retrieving the control (view) associated with a given model.</p>
<p>If a control is a button or text field than attachButtonListener() or
attachTextFieldListeners() are called. These methods are implemented in
ExamineForm.java, but I'll delay explaining them until I've covered
Forms.getModels() and Forms.getControl().</p>
<h3 id="31-from-document-to-drawpages">3.1.  From Document to DrawPages<a class="headerlink" href="#31-from-document-to-drawpages" title="Permanent link">&para;</a></h3>
<p>Every Office document supports the OfficeDocument service, and the XModel and
XComponent interfaces. Using XComponent as a starting interface, it's possible to
change the type to XDrawPagesSupplier (or XDrawPageSupplier), which gives access
to the DrawPages (or single DrawPage) inside the document. The cast works because
all Office documents support the GenericDrawingDocument service, as illustrated in
Figure 5.</p>
<p><img alt="" src="images/39-Forms_API_Overview-5.png" /></p>
<p>Figure 5. Part of the GenericDrawingDocument Service Hierarchy</p>
<p>The code that implements the cast:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Forms class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XNameContainer</span> <span class="nf">getForms</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XDrawPage</span> <span class="n">drawPage</span> <span class="o">=</span> <span class="n">getDrawPage</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">drawPage</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">getForms</span><span class="p">(</span><span class="n">drawPage</span><span class="p">);</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getForms()</span>



<span class="kd">public</span> <span class="kd">static</span> <span class="n">XDrawPage</span> <span class="nf">getDrawPage</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="c1">// return the first draw page even if there are many</span>
<span class="p">{</span>
  <span class="n">XDrawPageSupplier</span> <span class="n">xSuppPage</span> <span class="o">=</span>
                <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDrawPageSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xSuppPage</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
    <span class="c1">// this works if doc supports a single DrawPage</span>
    <span class="k">return</span> <span class="n">xSuppPage</span><span class="p">.</span><span class="na">getDrawPage</span><span class="p">();</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// this means that the doc supports multiple DrawPages</span>
    <span class="n">XDrawPagesSupplier</span> <span class="n">xSuppPages</span> <span class="o">=</span>
                <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDrawPagesSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>

    <span class="n">XDrawPages</span> <span class="n">xPages</span> <span class="o">=</span> <span class="n">xSuppPages</span><span class="p">.</span><span class="na">getDrawPages</span><span class="p">();</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Returning first draw page&quot;</span><span class="p">);</span>
      <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDrawPage</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xPages</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getDrawPage()</span>
</code></pre></div>
<p>Forms.getDrawPage() only returns the first draw page in a document, even if many
pages are available.</p>
<h3 id="32-from-drawpage-to-form">3.2.  From DrawPage to Form<a class="headerlink" href="#32-from-drawpage-to-form" title="Permanent link">&para;</a></h3>
<p>The XDrawPage interface can be cast to XFormsSupplier which makes the page's
forms accessible. This cast works because of the service hierarchy shown in Figure 6
which links the DrawPage service to GenericDrawPage.</p>
<p><img alt="" src="images/39-Forms_API_Overview-6.png" /></p>
<p>Figure 6. Part of the DrawPage Service Hierarchy.</p>
<p>XFormsSupplier can supply forms as an indexed sequence (an XIndexContainer) or
as an associative array using the form names as keys, returned by Forms.getForms():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Forms class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XNameContainer</span> <span class="nf">getForms</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">drawPage</span><span class="p">)</span>
<span class="c1">// get all the forms in the page as a named container</span>
<span class="p">{</span>
  <span class="n">XFormsSupplier</span> <span class="n">formsSupp</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XFormsSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">drawPage</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">formsSupp</span><span class="p">.</span><span class="na">getForms</span><span class="p">();</span>
<span class="p">}</span> <span class="c1">// end of getForms()</span>

<span class="n">The</span> <span class="k">default</span> <span class="n">form</span> <span class="n">in</span> <span class="n">a</span> <span class="n">draw</span> <span class="n">page</span> <span class="n">is</span> <span class="n">called</span> <span class="s">&quot;Form&quot;</span><span class="p">,</span> <span class="n">and</span> <span class="n">can</span> <span class="n">be</span> <span class="n">extracted</span> <span class="n">by</span> <span class="n">calling</span>
<span class="n">Forms</span><span class="p">.</span><span class="na">getForm</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span><span class="s">&quot;Form&quot;</span><span class="p">):</span>

<span class="c1">// in the Forms class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XForm</span> <span class="nf">getForm</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">,</span> <span class="n">String</span> <span class="n">formName</span><span class="p">)</span>
<span class="c1">// get the form called formName</span>
<span class="p">{</span>
   <span class="n">XNameContainer</span> <span class="n">namedForms</span> <span class="o">=</span> <span class="n">getForms</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>  <span class="c1">// see above</span>
   <span class="n">XNameContainer</span> <span class="n">con</span> <span class="o">=</span> <span class="n">getFormByName</span><span class="p">(</span><span class="n">formName</span><span class="p">,</span> <span class="n">namedForms</span><span class="p">);</span>
   <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XForm</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">con</span><span class="p">);</span>
<span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XNameContainer</span> <span class="nf">getFormByName</span><span class="p">(</span><span class="n">String</span> <span class="n">formName</span><span class="p">,</span>
                                   <span class="n">XNameContainer</span> <span class="n">namedForms</span><span class="p">)</span>
<span class="c1">// get the form called formName</span>
<span class="p">{</span> <span class="k">try</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XNameContainer</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                       <span class="n">namedForms</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="n">formName</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not find form &quot;</span> <span class="o">+</span> <span class="n">formName</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getFormByName()</span>
</code></pre></div>
<h3 id="33-from-form-to-formcomponents">3.3.  From Form to FormComponents<a class="headerlink" href="#33-from-form-to-formcomponents" title="Permanent link">&para;</a></h3>
<p>A form is a FormComponents instance, which holds FormComponent instances (i.e.
basic controls) and nested FormComponents (i.e. nested forms). Figure 7 shows a
simplified service hierarchy for Form, FormComponents, and FormComponent.</p>
<p><img alt="" src="images/39-Forms_API_Overview-7.png" /></p>
<p>Figure 7. Part of the Form Service Hierarchy.</p>
<p>Forms.getModels() collects all the FormComponent instances as a list by recursively
searching from the top level form (or forms) through all the nested forms :</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Forms class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XControlModel</span><span class="o">&gt;</span> <span class="nf">getModels</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XNameContainer</span> <span class="n">formNamesCon</span> <span class="o">=</span> <span class="n">getForms</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>  <span class="c1">// see above</span>
  <span class="k">return</span> <span class="n">getModels</span><span class="p">(</span><span class="n">formNamesCon</span><span class="p">);</span>
<span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XControlModel</span><span class="o">&gt;</span> <span class="nf">getModels</span><span class="p">(</span>
                                         <span class="n">XNameAccess</span> <span class="n">formNamesCon</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XControlModel</span><span class="o">&gt;</span> <span class="n">models</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XControlModel</span><span class="o">&gt;</span><span class="p">();</span>
  <span class="n">String</span> <span class="n">nms</span><span class="o">[]</span> <span class="o">=</span> <span class="n">formNamesCon</span><span class="p">.</span><span class="na">getElementNames</span><span class="p">();</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nms</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">XServiceInfo</span> <span class="n">servInfo</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XServiceInfo</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                                  <span class="n">formNamesCon</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="n">nms</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">));</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">servInfo</span><span class="p">.</span><span class="na">supportsService</span><span class="p">(</span>
                             <span class="s">&quot;com.sun.star.form.FormComponents&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="c1">// this means that a nested form has been found</span>
        <span class="n">XNameAccess</span> <span class="n">childCon</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XNameAccess</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">servInfo</span><span class="p">);</span>
        <span class="n">models</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span> <span class="n">getModels</span><span class="p">(</span><span class="n">childCon</span><span class="p">)</span> <span class="p">);</span><span class="c1">//recursively search it</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">servInfo</span><span class="p">.</span><span class="na">supportsService</span><span class="p">(</span>
                             <span class="s">&quot;com.sun.star.form.FormComponent&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">XControlModel</span> <span class="n">model</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XControlModel</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">servInfo</span><span class="p">);</span>
        <span class="n">models</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
    <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access &quot;</span> <span class="o">+</span> <span class="n">nms</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>  <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">models</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getModels()</span>
</code></pre></div>
<p>The first Forms.getModels() method extracts the top-level form (or forms) from the
document as a named container, then passes it to the recursive getModels() which
iterates through the container. If an element is a FormComponents instance then it's a
nested form, and getModels() is called recursively to collect its controls. If the
element is of type FormComponent then it's an ordinary control.</p>
<h3 id="34-from-formcomponent-to-control-model">3.4.  From FormComponent to Control Model<a class="headerlink" href="#34-from-formcomponent-to-control-model" title="Permanent link">&para;</a></h3>
<p>A FormComponent instance can be cast to XControlModel:</p>
<div class="highlight"><pre><span></span><code><span class="n">XControlModel</span> <span class="n">model</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XControlModel</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">servInfo</span><span class="p">);</span>
</code></pre></div>
<p>XControlModel first appeared at the top of Figure 2 on the left – it’s the interface
inherited by all models.</p>
<p>The casting is possible because every control model service (e.g. CommandButton in
the form.component module) inherits both FormComponent and UnoControlModel,
as depicted by Figure 8.</p>
<p><img alt="" src="images/39-Forms_API_Overview-8.png" /></p>
<p>Figure 8. Part of the Service Hierarchy for the CommandButton Model.</p>
<p>Every model has a hierarchy similar to CommandButton's in Figure 8. For example,
the text field control model hierarchy appears in Figure 9.</p>
<p><img alt="" src="images/39-Forms_API_Overview-9.png" /></p>
<p>Figure 9. Part of the Service Hierarchy for the TextField Model.</p>
<p>Figures 8 and 9 depict two important coding features. One is that it's possible to cast
between a form component and a control model, as demonstrated by
Forms.getModel() shown above. The other is that a model's data is stored in its
properties, and most of those are NOT in the model's service (i.e. not in
CommandButton and TextField). Most model properties are in superclasses (i.e.</p>
<p>UnoControlButtonModel in Figure 8 and UnoControlEditModel in Figure 9), which
are located in the awt module.</p>
<h3 id="35-using-a-control-model">3.5.  Using a Control Model<a class="headerlink" href="#35-using-a-control-model" title="Permanent link">&para;</a></h3>
<p>Returning to ExamineForm.java, the relevant bit of code is:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of ExamineForm.java...</span>

<span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XControlModel</span><span class="o">&gt;</span> <span class="n">models</span> <span class="o">=</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getModels</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span> <span class="c1">// see above</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No. of control models in form: &quot;</span> <span class="o">+</span>
                                           <span class="n">models</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="c1">// examine each model</span>
<span class="k">for</span><span class="p">(</span><span class="n">XControlModel</span> <span class="n">model</span> <span class="p">:</span> <span class="n">models</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getName</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span>
                            <span class="n">Forms</span><span class="p">.</span><span class="na">getTypeStr</span><span class="p">(</span><span class="n">model</span><span class="p">));</span>
  <span class="p">:</span>
<span class="p">}</span>
</code></pre></div>
<p>An XControlModel reference can be utilized in various ways, but two of the main
ones are examining its subclass service type and accessing its properties. As Figures 8
and 9 indicate, most of a control's properties are in the UnoControlXXXModel
service, but may come from other services which can be hard to locate. For example,
"Name" is from UnoControlDialogElement, a superclass of UnoControlModel (which
I didn't include in Figures 8 and 9). "ClassId" comes from FormControlModel, which
is on the "forms branch" of the service hierarchies in the figures.</p>
<p>The easiest thing is to print all the model's properties, by calling
Props.showObjProps():</p>
<div class="highlight"><pre><span></span><code><span class="n">Props</span><span class="p">.</span><span class="na">showObjProps</span><span class="p">(</span><span class="s">&quot;Model&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
</code></pre></div>
<p>Info.showInterfaces() and Info.showServices() are similarly useful, listing all the
interfaces and services for a model:</p>
<div class="highlight"><pre><span></span><code><span class="n">Info</span><span class="p">.</span><span class="na">showInterfaces</span><span class="p">(</span><span class="s">&quot;Model&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
<span class="n">Info</span><span class="p">.</span><span class="na">showServices</span><span class="p">(</span><span class="s">&quot;Model&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
</code></pre></div>
<p>The Forms.getName() and Forms.getTypeStr() methods called in the code fragment
above are defined as:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Forms class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">(</span><span class="n">XControlModel</span> <span class="n">cModel</span><span class="p">)</span>
<span class="c1">// returns the name of the given form component</span>
<span class="p">{</span>  <span class="k">return</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span> <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">cModel</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getTypeStr</span><span class="p">(</span><span class="n">XControlModel</span> <span class="n">cModel</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">getID</span><span class="p">(</span><span class="n">cModel</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>

  <span class="n">XServiceInfo</span> <span class="n">servInfo</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XServiceInfo</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cModel</span><span class="p">);</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">COMMANDBUTTON</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Command button&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">RADIOBUTTON</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Radio button&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">IMAGEBUTTON</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Image button&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">CHECKBOX</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Check Box&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">LISTBOX</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;List Box&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">COMBOBOX</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Combo Box&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">GROUPBOX</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Group Box&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">FIXEDTEXT</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Fixed Text&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">GRIDCONTROL</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Grid Control&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">FILECONTROL</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;File Control&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">HIDDENCONTROL</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Hidden Control&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">IMAGECONTROL</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Image Control&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">DATEFIELD</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Date Field&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">TIMEFIELD</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Time Field&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">NUMERICFIELD</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Numeric Field&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">CURRENCYFIELD</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Currency Field&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">PATTERNFIELD</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&quot;Pattern Field&quot;</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">TEXTFIELD</span><span class="p">:</span>
      <span class="c1">// two services with this class id:</span>
      <span class="c1">// text field and formatted field</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">servInfo</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">servInfo</span><span class="p">.</span><span class="na">supportsService</span><span class="p">(</span>
                     <span class="s">&quot;com.sun.star.form.component.FormattedField&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="s">&quot;Formatted Field&quot;</span><span class="p">;</span>
      <span class="k">else</span>
        <span class="k">return</span> <span class="s">&quot;Text Field&quot;</span><span class="p">;</span>
    <span class="k">default</span><span class="p">:</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unknown class ID: &quot;</span> <span class="o">+</span> <span class="n">id</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getTypeStr()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getID</span><span class="p">(</span><span class="n">XControlModel</span> <span class="n">cModel</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// get the ClassId property</span>
  <span class="n">Short</span> <span class="n">classId</span> <span class="o">=</span> <span class="p">(</span><span class="n">Short</span><span class="p">)</span> <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">cModel</span><span class="p">,</span> <span class="s">&quot;ClassId&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">classId</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No class ID found for form component&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">classId</span><span class="p">.</span><span class="na">intValue</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of getID()</span>
</code></pre></div>
<p>Forms.getID returns the "ClassId" integer, which is checked by getTypeStr() against
values in the FormComponentType enumeration, and mapped to more informative
strings.</p>
<p>Forms.getID() is utilized in a similar manner in a series of boolean isXXX() methods,
such as isButton() and isTextField():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Forms class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isButton</span><span class="p">(</span><span class="n">XControlModel</span> <span class="n">cModel</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">getID</span><span class="p">(</span><span class="n">cModel</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">id</span> <span class="o">==</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">COMMANDBUTTON</span><span class="p">)</span> <span class="o">||</span>
            <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">IMAGEBUTTON</span><span class="p">));</span>
<span class="p">}</span>  <span class="c1">// end of isButton()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isTextField</span><span class="p">(</span><span class="n">XControlModel</span> <span class="n">cModel</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">getID</span><span class="p">(</span><span class="n">cModel</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">else</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">id</span> <span class="o">==</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">DATEFIELD</span><span class="p">)</span> <span class="o">||</span>
            <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">TIMEFIELD</span><span class="p">)</span> <span class="o">||</span>
            <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">NUMERICFIELD</span><span class="p">)</span> <span class="o">||</span>
            <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">CURRENCYFIELD</span><span class="p">)</span> <span class="o">||</span>
            <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">PATTERNFIELD</span><span class="p">)</span> <span class="o">||</span>
            <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="n">FormComponentType</span><span class="p">.</span><span class="na">TEXTFIELD</span><span class="p">));</span>
<span class="p">}</span>  <span class="c1">// end of isTextField()</span>
</code></pre></div>
<h3 id="36-from-control-model-to-view">3.6.  From Control Model to View<a class="headerlink" href="#36-from-control-model-to-view" title="Permanent link">&para;</a></h3>
<p>Having obtained a form's model, it's view becomes accessible, but following the
MVC pattern, this requires the use of Office's controller (see Figure 1). One way to
reach the controller is through a document reference (XComponent) and
XModel.getCurrentController(). The resulting XController interface can be cast to
XControlAccess, due to the service hierarchy shown in Figure 10.</p>
<p><img alt="" src="images/39-Forms_API_Overview-10.png" /></p>
<p>Figure 10. Part of the DrawingDocumentDrawView Service Hierarchy.</p>
<p>These steps are implemented by GUI.getControlAccess():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the GUI class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XControlAccess</span> <span class="nf">getControlAccess</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span> <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XControlAccess</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">getCurrentController</span><span class="p">(</span><span class="n">doc</span><span class="p">));</span> <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XController</span> <span class="nf">getCurrentController</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XModel</span> <span class="n">model</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XModel</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">model</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Document has no data model&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">model</span><span class="p">.</span><span class="na">getCurrentController</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">Forms</span><span class="p">.</span><span class="na">getControl</span><span class="p">()</span> <span class="n">employs</span> <span class="n">XControlAccess</span><span class="p">.</span><span class="na">getControl</span><span class="p">()</span> <span class="n">to</span> <span class="k">return</span> <span class="n">the</span> <span class="n">model</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">view</span>
<span class="n">when</span> <span class="n">supplied</span> <span class="n">with</span> <span class="n">a</span> <span class="n">model</span><span class="p">:</span>

<span class="c1">// in the Forms class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XControl</span> <span class="nf">getControl</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">,</span>
                                       <span class="n">XControlModel</span> <span class="n">cModel</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XControlAccess</span> <span class="n">controlAccess</span> <span class="o">=</span> <span class="n">GUI</span><span class="p">.</span><span class="na">getControlAccess</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
                                 <span class="c1">// see above</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">controlAccess</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not obtain controls access&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">controlAccess</span><span class="p">.</span><span class="na">getControl</span><span class="p">(</span><span class="n">cModel</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access control: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getControl()</span>
</code></pre></div>
<h2 id="4-attaching-listeners-to-a-view">4.  Attaching Listeners to a View<a class="headerlink" href="#4-attaching-listeners-to-a-view" title="Permanent link">&para;</a></h2>
<p>XControl is an interface of the UnoControl service, which represents an abstract
control. This class must be cast to a service for a real control, such as
UnoControlButton or UnoControlEdit in order to call listener methods in XButton or
XTextComponent. This hierarchy is illustrated by Figure 11.</p>
<p><img alt="" src="images/39-Forms_API_Overview-11.png" /></p>
<p>Figure 11. Part of the Service Hierarchy Below UnoControl.</p>
<p>Back in ExamineForm.java, every button or text field has listeners attached to it:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of ExamineForms.java...</span>

    <span class="p">:</span>
<span class="c1">// look at the control for each model</span>
<span class="n">XControl</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getControl</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">ctrl</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;   No control found&quot;</span><span class="p">);</span>
<span class="k">else</span> <span class="p">{</span>   <span class="c1">// attach listener if the control is a button or text field</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">Forms</span><span class="p">.</span><span class="na">isButton</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
      <span class="n">attachButtonListener</span><span class="p">(</span><span class="n">ctrl</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">Forms</span><span class="p">.</span><span class="na">isTextField</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
      <span class="n">attachTextFieldListeners</span><span class="p">(</span><span class="n">ctrl</span><span class="p">);</span>
<span class="p">}</span>
    <span class="p">:</span>
</code></pre></div>
<p>attachButtonListener() and attachTextFieldListener() implement the casting shown in
Figure 11, starting with an XControl interface. For instance, attachButtonListener()
connects an anonymous XActionListener object to a button, and sets its action
command to be the button's label:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in ExamineForms.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">attachButtonListener</span><span class="p">(</span><span class="n">XControl</span> <span class="n">ctrl</span><span class="p">,</span>
                                       <span class="n">XControlModel</span> <span class="n">cModel</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XButton</span> <span class="n">xButton</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XButton</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">);</span>
  <span class="c1">// XControlModel cModel = ctrl.getModel();</span>
  <span class="n">xButton</span><span class="p">.</span><span class="na">setActionCommand</span><span class="p">(</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getLabel</span><span class="p">(</span><span class="n">cModel</span><span class="p">));</span>

  <span class="n">xButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span> <span class="k">new</span> <span class="n">XActionListener</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">disposing</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">EventObject</span> <span class="n">ev</span><span class="p">)</span> <span class="p">{}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="p">(</span><span class="n">ActionEvent</span> <span class="n">ev</span><span class="p">)</span>
    <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Pressed \&quot;&quot;</span> <span class="o">+</span> <span class="n">ev</span><span class="p">.</span><span class="na">ActionCommand</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>  <span class="c1">// end of attachButtonListener()</span>
</code></pre></div>
<p>Although XActionListener and Java's ActionListener are similar, they're not the same.
For one thing, its necessary to define two methods in XActionListener,
actionPerformed() and disposing().</p>
<p>Office supports over 120 kinds of listeners! The best place to browse through them is
on the documentation webpage for their common superclass, XEventListener.
<code>lodoc XEventListener</code> should take you to XEventListener in the document module, but
you want its superclass, XEventListener in the lang module. The first part of its long
webpage is shown in Figure 12.</p>
<p><img alt="" src="images/39-Forms_API_Overview-12.png" /></p>
<p>Figure 12. The First Part of the XEventListener Documentation Page
in the lang Module.</p>
<p>Although the clickable images on the LibreOffice webpages make moving around the
service and interface hierarchies very easy, they're not searchable. When the hierarchy
is very large (as for XEventListener), and not sorted in alphabetical order, it can be
time-consuming to find a particular subclass.</p>
<p>I solved the problem by creating a text file, called XEventListenerSubclasses.txt,
which lists the subclasses of XEventListener in order, and is searchable of course.
You can find it in the Forms Tests/ folder for this chapter.</p>
<p>Alternatively, almost all the listeners for controls are defined in the awt module, so
you can search that module's documentation page (accessible using <code>lodoc awt module</code>).</p>
<p>attachTextFieldListeners() attaches two listeners to a text field control because
XTextListener isn't triggered when the user types <ENTER>. My solution is to
connect an XFocusListener which treats <ENTER> as a "lost focus" event when the
cursor leaves the text field. The code for attachTextFieldListeners():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in ExamineForms.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">attachTextFieldListeners</span><span class="p">(</span><span class="n">XControl</span> <span class="n">ctrl</span><span class="p">)</span>
<span class="c1">// listen for text changes and focus changes in the control</span>
<span class="p">{</span>
  <span class="n">XTextComponent</span> <span class="n">tc</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTextComponent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">);</span>
  <span class="n">tc</span><span class="p">.</span><span class="na">addTextListener</span><span class="p">(</span> <span class="k">new</span> <span class="n">XTextListener</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">textChanged</span><span class="p">(</span><span class="n">TextEvent</span> <span class="n">ev</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">XControlModel</span> <span class="n">cModel</span> <span class="o">=</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getEventControlModel</span><span class="p">(</span><span class="n">ev</span><span class="p">);</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getName</span><span class="p">(</span><span class="n">cModel</span><span class="p">)</span> <span class="o">+</span>
                 <span class="s">&quot; text: &quot;</span> <span class="o">+</span> <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">cModel</span><span class="p">,</span> <span class="s">&quot;Text&quot;</span><span class="p">));</span>
    <span class="p">}</span>  <span class="c1">// end of textChanged()</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">disposing</span><span class="p">(</span><span class="n">EventObject</span> <span class="n">ev</span><span class="p">)</span> <span class="p">{}</span>

  <span class="p">});</span>

  <span class="n">XWindow</span> <span class="n">tfWindow</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XWindow</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">);</span>
  <span class="n">tfWindow</span><span class="p">.</span><span class="na">addFocusListener</span><span class="p">(</span> <span class="k">new</span> <span class="n">XFocusListener</span><span class="p">()</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">focusLost</span><span class="p">(</span><span class="n">FocusEvent</span> <span class="n">ev</span><span class="p">)</span>
    <span class="p">{</span> <span class="n">XControlModel</span> <span class="n">model</span> <span class="o">=</span> <span class="n">Forms</span><span class="p">.</span><span class="na">getEventControlModel</span><span class="p">(</span><span class="n">ev</span><span class="p">);</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Leaving text: &quot;</span> <span class="o">+</span>
                          <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s">&quot;Text&quot;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">disposing</span><span class="p">(</span><span class="n">EventObject</span> <span class="n">ev</span><span class="p">)</span> <span class="p">{}</span>  <span class="c1">// unused</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">focusGained</span><span class="p">(</span><span class="n">FocusEvent</span> <span class="n">ev</span><span class="p">)</span> <span class="p">{}</span>
  <span class="p">});</span>

<span class="p">}</span>  <span class="c1">// end of attachTextFieldListeners()</span>
</code></pre></div>
<h4 id="obtaining-the-model">Obtaining the Model<a class="headerlink" href="#obtaining-the-model" title="Permanent link">&para;</a></h4>
<p>attachButtonListener() and attachTextFieldListeners() demonstrate two ways of
obtaining the control's model when an event triggers a view listener.</p>
<p>In attachButtonListener(), an XControl reference is available, which means that
XControl.getModel() could be called:</p>
<div class="highlight"><pre><span></span><code><span class="n">XControlModel</span> <span class="n">cModel</span> <span class="o">=</span> <span class="n">ctrl</span><span class="p">.</span><span class="na">getModel</span><span class="p">();</span>
</code></pre></div>
<p>In fact that coding isn't used, since the model reference is available already.</p>
<p>attachTextFieldListeners() shows another approach, which is to examine the event
object that arrives at the listener's method (e.g. the FocusEvent object received by
focusLost()). Forms.getEventControlModel() is defined as:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Forms class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XControlModel</span> <span class="nf">getEventControlModel</span><span class="p">(</span><span class="n">EventObject</span> <span class="n">ev</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XControl</span> <span class="n">xControl</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XControl</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">ev</span><span class="p">.</span><span class="na">Source</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">xControl</span><span class="p">.</span><span class="na">getModel</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of getEventControlModel()</span>
</code></pre></div>
<h2 id="5-using-examineformjava">5.  Using ExamineForm.java<a class="headerlink" href="#5-using-examineformjava" title="Permanent link">&para;</a></h2>
<p>ExamineForm.java can be called with any form-based ODT file. The simplest one in
the examples is form1.odt, which consists of only a text field and a button, as shown
in Figure 13.</p>
<p><img alt="" src="images/39-Forms_API_Overview-13.png" /></p>
<p>Figure 13. The form1.odt Form.</p>
<p>When the user types "abc" and <ENTER> into the text field, followed by two clicks
of the "Enter" button, the following is printed:</p>
<div class="highlight"><pre><span></span><code>Text Box 1 text: a
Text Box 1 text: ab
Text Box 1 text: abc
Leaving text: abc
Leaving text: abc
Pressed &quot;Enter&quot;
Pressed &quot;Enter&quot;
</code></pre></div>
<p>The focus lost event is reported twice because of the <ENTER> key press and the
movement of the mouse by the user from the text field to the button.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="39%20Part%207%20Cross-application.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Part 7 Cross-application" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Part 7 Cross-application
            </div>
          </div>
        </a>
      
      
        
        <a href="40-Building_a_Form.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 40. Building a Form Programmatically" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 40. Building a Form Programmatically
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>