
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/09-Text_Search.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>Chapter 9. Text Search and Replace - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-9-text-search-and-replace" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 9. Text Search and Replace
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 9. Text Search and Replace
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="09-Text_Search.html" class="md-nav__link md-nav__link--active">
        Chapter 9. Text Search and Replace
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-finding-the-first-matching-phrase" class="md-nav__link">
    1.  Finding the First Matching Phrase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-replacing-all-the-matching-words" class="md-nav__link">
    2.  Replacing all the Matching Words
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-finding-all-matching-phrases" class="md-nav__link">
    3.  Finding all Matching Phrases
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-finding-the-first-matching-phrase" class="md-nav__link">
    1.  Finding the First Matching Phrase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-replacing-all-the-matching-words" class="md-nav__link">
    2.  Replacing all the Matching Words
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-finding-all-matching-phrases" class="md-nav__link">
    3.  Finding all Matching Phrases
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/flywire/lo-p/edit/main/docs/09-Text_Search.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="chapter-9-text-search-and-replace">Chapter 9. Text Search and Replace<a class="headerlink" href="#chapter-9-text-search-and-replace" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Finding the First
Matching Phrase;
Replacing all the
Matching Words;
Finding all Matching
Phrases</p>
<p>Example folders: "Text
Tests" and "Utils"</p>
</div>
<p>The GenericTextDocument service supports the
XSearchable and XReplaceable interfaces (see Chapter 5,
Figure 2), which are the entry points for doing regular
expression based search and replace inside a document.</p>
<p>XSearchable.createSearchDescriptor() builds a search
description (an ordinary string or a regular expression). The search is executed with
XSearchable.findAll() or findFirst() and findNext().</p>
<p>XReplaceable works in a similar way but with a replace descriptor which combines a
replacement string with the search string. XReplaceable.replaceAll() performs search
and replacement, but the XSearchable searching methods are available as well. This is
shown in Figure 1.</p>
<p><img alt="" src="images/09-Text_Search-1.png" /></p>
<p>Figure 1. The XSearchable and XReplaceable Interfaces.</p>
<p>The following code fragment utilizes the XSearchable and XSearchDescriptor
interfaces:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XSearchable</span> <span class="n">searchable</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XSearchable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
<span class="n">XSearchDescriptor</span> <span class="n">srchDesc</span> <span class="o">=</span> <span class="n">searchable</span><span class="p">.</span><span class="na">createSearchDescriptor</span><span class="p">();</span>
<span class="n">srchDesc</span><span class="p">.</span><span class="na">setSearchString</span><span class="p">(</span><span class="s">&quot;colou?r&quot;</span><span class="p">);</span>
       <span class="c1">// a regular expression meaning &quot;color&quot; or &quot;colour&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<p>XReplaceable and XReplaceDescriptor objects are configured in a similar way, as
shown in the examples.</p>
<p>XSearchDescriptor and XReplaceDescriptor contain get and set methods for their
strings. But a lot of the search functionality is expressed as properties in their
SearchDescriptor and ReplaceDescriptor services. Figure 2 summarizes these
arrangements.</p>
<p><img alt="" src="images/09-Text_Search-2.png" /></p>
<p>Figure 2. The SearchDescriptor and ReplaceDescriptor Services.</p>
<p>The next code fragment accesses the SearchDescriptor properties, and switches on
regular expression searching:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XPropertySet</span> <span class="n">srchProps</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">srchDesc</span><span class="p">);</span>
<span class="n">srchProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;SearchRegularExpression&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Alternatively, Props.setProperty() can be employed:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">srchDesc</span><span class="p">,</span> <span class="s">&quot;SearchRegularExpression&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Once a search descriptor has been created (i.e. its string is set and any properties
configured), then one of the findXXX() methods in XSearchable can be called.</p>
<p>For instance, XSearchable.findFirst() returns the text range of the first matching
element (or null), as in:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XInterface</span> <span class="n">srch</span> <span class="o">=</span> <span class="p">(</span><span class="n">XInterface</span><span class="p">)</span> <span class="n">searchable</span><span class="p">.</span><span class="na">findFirst</span><span class="p">(</span><span class="n">srchDesc</span><span class="p">);</span>
<span class="n">XTextRange</span> <span class="n">matchTR</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTextRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">srch</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The example programs, TextReplace.java and ItalicsStyler.java, demonstrate search
and replacement. TextReplace.java uses XSearchable to find the first occurrence of a
regular expression and XReplaceable to replace multiple occurrences of other words.</p>
<p>ItalicsStyler.java calls XSearchable's findAll() to find every occurrence of a phrase.</p>
<h2 id="1-finding-the-first-matching-phrase">1.  Finding the First Matching Phrase<a class="headerlink" href="#1-finding-the-first-matching-phrase" title="Permanent link">&para;</a></h2>
<p>TextReplace.java repeatedly calls XSearchable.findFirst() with regular expressions
taken from an array. The first matching phrase for each expression is reported. For
instance, the call:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">String</span> <span class="n">words</span><span class="o">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;(G|g)rit&quot;</span><span class="p">,</span> <span class="s">&quot;colou?r&quot;</span><span class="p">};</span>
<span class="n">findWords</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">words</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>prints the following when "story.doc" is searched:</p>
<div class="highlight"><pre><span></span><code>Searching for first occurrence of &quot;(G|g)rit&quot;
  - found &quot;Grit&quot;
    - on page 1
    - at char position: 929
Searching for first occurrence of &quot;colou?r&quot;
  - found &quot;colour&quot;
    - on page 5
    - at char position: 10856
</code></pre></div>
<p>Three pieces of information are printed for each match: the text that matched, its page
location, and its character position calculated from the start of the document. The
character position could be obtained from a text cursor or a text view cursor, but I
need a page cursor to access the page number. Therefore the easiest thing to use a text
view cursor, and a linked page cursor.</p>
<p>The code for findWords():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">findWords</span><span class="p">(</span><span class="n">XTextDocument</span> <span class="n">doc</span><span class="p">,</span> <span class="n">String</span><span class="o">[]</span> <span class="n">words</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// get the text view cursor and linked page cursor</span>
  <span class="n">XTextViewCursor</span> <span class="n">tvc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getViewCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">tvc</span><span class="p">.</span><span class="na">gotoStart</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="n">XPageCursor</span> <span class="n">pageCursor</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPageCursor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">tvc</span><span class="p">);</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="n">XSearchable</span> <span class="n">searchable</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XSearchable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
    <span class="n">XSearchDescriptor</span> <span class="n">srchDesc</span> <span class="o">=</span>
                          <span class="n">searchable</span><span class="p">.</span><span class="na">createSearchDescriptor</span><span class="p">();</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">words</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Searching for first occurrence of \&quot;&quot;</span> <span class="o">+</span>
                                                  <span class="n">words</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
      <span class="n">srchDesc</span><span class="p">.</span><span class="na">setSearchString</span><span class="p">(</span><span class="n">words</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
      <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">srchDesc</span><span class="p">,</span> <span class="s">&quot;SearchRegularExpression&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

      <span class="n">XInterface</span>  <span class="n">srch</span> <span class="o">=</span> <span class="p">(</span><span class="n">XInterface</span><span class="p">)</span> <span class="n">searchable</span><span class="p">.</span><span class="na">findFirst</span><span class="p">(</span><span class="n">srchDesc</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">srch</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">XTextRange</span> <span class="n">matchTR</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTextRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">srch</span><span class="p">);</span>
        <span class="n">tvc</span><span class="p">.</span><span class="na">gotoRange</span><span class="p">(</span><span class="n">matchTR</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  - found \&quot;&quot;</span> <span class="o">+</span>
                                   <span class="n">matchTR</span><span class="p">.</span><span class="na">getString</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;    - on page &quot;</span> <span class="o">+</span>
                                     <span class="n">pageCursor</span><span class="p">.</span><span class="na">getPage</span><span class="p">());</span>
        <span class="n">tvc</span><span class="p">.</span><span class="na">gotoStart</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;    - at char position: &quot;</span> <span class="o">+</span>
                                     <span class="n">tvc</span><span class="p">.</span><span class="na">getString</span><span class="p">().</span><span class="na">length</span><span class="p">());</span>
      <span class="p">}</span>
      <span class="k">else</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  - not found&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">uno</span><span class="p">.</span><span class="na">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of findWords()</span>
</code></pre></div>
</div>
</div>
</div>
<p>findWords() creates the text view cursor (tvc), moves it to the start of the document,
and links the page cursor to it:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XPageCursor</span> <span class="n">pageCursor</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPageCursor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">tvc</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>There is only one view cursor in an application, so when the text view cursor moves,
so does the page cursor, and vice versa.</p>
<p>The XSearchable and XSearchDescriptor interfaces are instantiated, and a for-loop
searches for each word in the supplied array. If XSearchable.findFirst() returns a
matching text range, it's used by XTextCursor.gotoRange() to update the position of
the cursor.</p>
<p>After the page position has been printed, the cursor is moved to the start of the
document with selection turned on:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">tvc</span><span class="p">.</span><span class="na">gotoStart</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;    - at char position: &quot;</span> <span class="o">+</span>
                                      <span class="n">tvc</span><span class="p">.</span><span class="na">getString</span><span class="p">().</span><span class="na">length</span><span class="p">());</span>
</code></pre></div>
</div>
</div>
</div>
<p>This means that tvc.getString() will return all the text from the start of the document
to the current matching point, and so length() will return the character position
measured from the beginning of the file. As I've mentioned previously, this approach
may fail if the size of the string being instantiated is too big.</p>
<h2 id="2-replacing-all-the-matching-words">2.  Replacing all the Matching Words<a class="headerlink" href="#2-replacing-all-the-matching-words" title="Permanent link">&para;</a></h2>
<p>TextReplace.java also contains a method called replaceWords(), which takes two
string arrays as arguments:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// code fragment inside TextReplace.java</span>
<span class="n">String</span> <span class="n">ukWords</span><span class="o">[]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&quot;colour&quot;</span><span class="p">,</span> <span class="s">&quot;neighbour&quot;</span><span class="p">,</span> <span class="s">&quot;centre&quot;</span><span class="p">,</span> <span class="s">&quot;behaviour&quot;</span><span class="p">,</span> <span class="s">&quot;metre&quot;</span><span class="p">,</span> <span class="s">&quot;through&quot;</span> <span class="p">};</span>

<span class="n">String</span> <span class="n">usWords</span><span class="o">[]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&quot;color&quot;</span><span class="p">,</span> <span class="s">&quot;neighbor&quot;</span><span class="p">,</span> <span class="s">&quot;center&quot;</span><span class="p">,</span> <span class="s">&quot;behavior&quot;</span><span class="p">,</span> <span class="s">&quot;meter&quot;</span><span class="p">,</span> <span class="s">&quot;thru&quot;</span> <span class="p">};</span>

<span class="n">replaceWords</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">ukWords</span><span class="p">,</span> <span class="n">usWords</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>replaceWords() cycles through the arrays, replacing all occurrences of the words in
the first array (e.g. in ukWords[]) with the corresponding words in the second array
(e.g. in usWords[]). For instance, every occurrence of "colour" is replaced by "color".</p>
<p>The output:</p>
<div class="highlight"><pre><span></span><code>Change all occurrences of ...

  colour -&gt; color
    - no. of changes: 1
  neighbour -&gt; neighbor
    - no. of changes: 2
  centre -&gt; center
    - no. of changes: 2
  behaviour -&gt; behavior
    - no. of changes: 0
  metre -&gt; meter
    - no. of changes: 0
  through -&gt; thru
    - no. of changes: 4
</code></pre></div>
<p>Since replaceWords() doesn't report page and character positions, its code is
somewhat shorter than findWords():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">replaceWords</span><span class="p">(</span><span class="n">XTextDocument</span> <span class="n">doc</span><span class="p">,</span>
                       <span class="n">String</span><span class="o">[]</span> <span class="n">oldWords</span><span class="p">,</span> <span class="n">String</span><span class="o">[]</span> <span class="n">newWords</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XReplaceable</span> <span class="n">replaceable</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XReplaceable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="n">XReplaceDescriptor</span> <span class="n">replaceDesc</span> <span class="o">=</span>
                        <span class="n">replaceable</span><span class="p">.</span><span class="na">createReplaceDescriptor</span><span class="p">();</span>

  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Change all occurrences of ...&quot;</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">oldWords</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">oldWords</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot; -&gt; &quot;</span> <span class="o">+</span> <span class="n">newWords</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
    <span class="n">replaceDesc</span><span class="p">.</span><span class="na">setSearchString</span><span class="p">(</span><span class="n">oldWords</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
    <span class="n">replaceDesc</span><span class="p">.</span><span class="na">setReplaceString</span><span class="p">(</span><span class="n">newWords</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">numChanges</span> <span class="o">=</span> <span class="n">replaceable</span><span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="n">replaceDesc</span><span class="p">);</span>
                           <span class="c1">// replace all occurrence of word</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;    - no. of changes: &quot;</span> <span class="o">+</span> <span class="n">numChanges</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of replaceWords()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The XReplaceable and XReplaceDescriptor interfaces are created in a similar way to
their search versions. The replace descriptor has two set methods, one for the search
string, the other for the replacement string.</p>
<h2 id="3-finding-all-matching-phrases">3.  Finding all Matching Phrases<a class="headerlink" href="#3-finding-all-matching-phrases" title="Permanent link">&para;</a></h2>
<p>ItalicsStyler.java is supplied with a filename and a string on the command line. For
instance:</p>
<div class="highlight"><pre><span></span><code>&gt; run ItalicsStyler story.doc scandal
</code></pre></div>
<p>The program opens the file and uses the "search all' method in XSearchable to find all
occurrences of the string in the document. The matching strings are italicized and
colored red, and the changed document saved as "italicized.doc". These changes are
not performed using XReplaceable methods.</p>
<p>Figure 3 shows a fragment of the resulting document, with the "scandal" text in the
title and header changed. The search ignores case, so the word in the title ("Scandal")
was correctly modified.</p>
<p><img alt="" src="images/09-Text_Search-3.png" /></p>
<p>Figure 3. A Fragment of The Italicized Document.</p>
<p>The ItalicsStyler program also outputs matching details:</p>
<div class="highlight"><pre><span></span><code>Searching for all occurrence of &quot;scandal&quot;
No. of matches: 5
  - found &quot;scandal&quot;
    - on page 1
    - starting at char position: 6
  - found &quot;Scandal&quot;
    - on page 1
    - starting at char position: 2
  - found &quot;scandal&quot;
    - on page 6
    - starting at char position: 13153
  - found &quot;scandal&quot;
    - on page 18
    - starting at char position: 38736
  - found &quot;scandal&quot;
    - on page 21
    - starting at char position: 46425
</code></pre></div>
<p>As with TextReplace.java, the printed details include the page and character positions
of the matches.</p>
<p>The searching in ItalicsStyler.java is performed by italicizeAll(), which bears a close
resemblance to findWords():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:1"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">italicizeAll</span><span class="p">(</span><span class="n">XTextDocument</span> <span class="n">doc</span><span class="p">,</span> <span class="n">String</span> <span class="n">phrase</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// get the text view cursor and linked page cursor</span>
  <span class="n">XTextViewCursor</span> <span class="n">tvc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getViewCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">tvc</span><span class="p">.</span><span class="na">gotoStart</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="n">XPageCursor</span> <span class="n">pageCursor</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPageCursor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">tvc</span><span class="p">);</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="n">XSearchable</span> <span class="n">xSearchable</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XSearchable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
    <span class="n">XSearchDescriptor</span> <span class="n">srchDesc</span> <span class="o">=</span>
                         <span class="n">xSearchable</span><span class="p">.</span><span class="na">createSearchDescriptor</span><span class="p">();</span>

    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Searching for all</span>
<span class="s">                         occurrences of \&quot;&quot;</span> <span class="o">+</span> <span class="n">phrase</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">phraseLen</span> <span class="o">=</span> <span class="n">phrase</span><span class="p">.</span><span class="na">length</span><span class="p">();</span>
    <span class="n">srchDesc</span><span class="p">.</span><span class="na">setSearchString</span><span class="p">(</span><span class="n">phrase</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">srchDesc</span><span class="p">,</span> <span class="s">&quot;SearchCaseSensitive&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

    <span class="n">XIndexAccess</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">xSearchable</span><span class="p">.</span><span class="na">findAll</span><span class="p">(</span><span class="n">srchDesc</span><span class="p">);</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No. of matches: &quot;</span> <span class="o">+</span> <span class="n">matches</span><span class="p">.</span><span class="na">getCount</span><span class="p">());</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">matches</span><span class="p">.</span><span class="na">getCount</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">XTextRange</span> <span class="n">matchTR</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTextRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                                      <span class="n">matches</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">matchTR</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tvc</span><span class="p">.</span><span class="na">gotoRange</span><span class="p">(</span><span class="n">matchTR</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  - found \&quot;&quot;</span> <span class="o">+</span>
                                <span class="n">matchTR</span><span class="p">.</span><span class="na">getString</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;    - on page &quot;</span> <span class="o">+</span>
                                        <span class="n">pageCursor</span><span class="p">.</span><span class="na">getPage</span><span class="p">());</span>
        <span class="n">tvc</span><span class="p">.</span><span class="na">gotoStart</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;    - starting at char position: &quot;</span> <span class="o">+</span>
                    <span class="p">(</span><span class="n">tvc</span><span class="p">.</span><span class="na">getString</span><span class="p">().</span><span class="na">length</span><span class="p">()</span> <span class="o">-</span> <span class="n">phraseLen</span><span class="p">));</span>
        <span class="n">Props</span><span class="p">.</span><span class="na">setProperties</span><span class="p">(</span><span class="n">matchTR</span><span class="p">,</span>
                   <span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="p">{</span><span class="s">&quot;CharColor&quot;</span><span class="p">,</span> <span class="s">&quot;CharPosture&quot;</span><span class="p">},</span>
                   <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{</span> <span class="mh">0xFF0000</span><span class="p">,</span>
                          <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">FontSlant</span><span class="p">.</span><span class="na">ITALIC</span><span class="p">}</span> <span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">uno</span><span class="p">.</span><span class="na">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of italicizeAll()</span>
</code></pre></div>
</div>
</div>
</div>
<p>After the search descriptor string has been defined, the "SearchCaseSensitive"
property in SearchDescriptor is set to false:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:1"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">srchDesc</span><span class="p">.</span><span class="na">setSearchString</span><span class="p">(</span><span class="n">phrase</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">srchDesc</span><span class="p">,</span> <span class="s">&quot;SearchCaseSensitive&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>This allows the search to match text contains both upper and lower case letters, such
as "Scandal". Many other search variants, such as restricting the search to complete
words, and the use of search similarity parameters are described in the
SearchDescriptor documentation (loDoc SearchDescriptor service).</p>
<p>XSearchable.findAll() returns an XIndexAccess collection, which is examined
element-by-element inside a for-loop. The text range for each element is obtained by
applying Lo.qi():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XTextRange</span> <span class="n">matchTR</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qiXTextRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">matches</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
</code></pre></div>
</div>
</div>
</div>
<p>The reporting of the matching page and character position use text view and page
cursors in the same way as findWords() in TextReplace.java.</p>
<p>XTextRange is part of the TextRange service, which inherits ParagraphProperties and
CharacterProperties. These properties are changed to adjust the character color and
style of the selected range:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Props</span><span class="p">.</span><span class="na">setProperties</span><span class="p">(</span><span class="n">matchTR</span><span class="p">,</span>
      <span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="p">{</span><span class="s">&quot;CharColor&quot;</span><span class="p">,</span> <span class="s">&quot;CharPosture&quot;</span><span class="p">},</span>
      <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{</span> <span class="mh">0xFF0000</span><span class="p">,</span> <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">FontSlant</span><span class="p">.</span><span class="na">ITALIC</span><span class="p">}</span> <span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>This changes the "CharColor" and "CharPosture" properties to red and italic.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="08-Graphic_Content.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 8. Graphic Content" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 8. Graphic Content
            </div>
          </div>
        </a>
      
      
        
        <a href="10-Linguistics.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 10. The Linguistics API" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 10. The Linguistics API
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>