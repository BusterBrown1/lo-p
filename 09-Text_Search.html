
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 9. Text Search and Replace - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-9-text-search-and-replace" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 9. Text Search and Replace
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 9. Text Search and Replace
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="09-Text_Search.html" class="md-nav__link md-nav__link--active">
        Chapter 9. Text Search and Replace
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-finding-the-first-matching-phrase" class="md-nav__link">
    1.  Finding the First Matching Phrase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-replacing-all-the-matching-words" class="md-nav__link">
    2.  Replacing all the Matching Words
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-finding-all-matching-phrases" class="md-nav__link">
    3.  Finding all Matching Phrases
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-finding-the-first-matching-phrase" class="md-nav__link">
    1.  Finding the First Matching Phrase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-replacing-all-the-matching-words" class="md-nav__link">
    2.  Replacing all the Matching Words
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-finding-all-matching-phrases" class="md-nav__link">
    3.  Finding all Matching Phrases
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/09-Text_Search.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-9-text-search-and-replace">Chapter 9. Text Search and Replace</h1>
<p>The GenericTextDocument service supports the 
XSearchable and XReplaceable interfaces (see Chapter 5, 
Figure 2), which are the entry points for doing regular 
expression based search and replace inside a document. </p>
<p>XSearchable.createSearchDescriptor() builds a search 
description (an ordinary string or a regular expression). The search is executed with 
XSearchable.findAll() or findFirst() and findNext().  </p>
<p>XReplaceable works in a similar way but with a replace descriptor which combines a 
replacement string with the search string. XReplaceable.replaceAll() performs search 
and replacement, but the XSearchable searching methods are available as well. This is 
shown in Figure 1. </p>
<p><img alt="" src="images/09-Text_Search-1.png" /></p>
<p>Figure 1. The XSearchable and XReplaceable Interfaces. </p>
<p>The following code fragment utilizes the XSearchable and XSearchDescriptor 
interfaces: </p>
<p>XSearchable searchable = Lo.qi(XSearchable.class, doc); 
XSearchDescriptor srchDesc = searchable.createSearchDescriptor(); 
srchDesc.setSearchString("colou?r");  <br />
       // a regular expression meaning "color" or "colour" </p>
<p>XReplaceable and XReplaceDescriptor objects are configured in a similar way, as 
shown in the examples. </p>
<p>XSearchDescriptor and XReplaceDescriptor contain get and set methods for their 
strings. But a lot of the search functionality is expressed as properties in their 
SearchDescriptor and ReplaceDescriptor services. Figure 2 summarizes these 
arrangements. </p>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Finding the First </p>
</div>
<p>Matching Phrase; 
Replacing all the 
Matching Words; 
Finding all Matching 
Phrases 
Example folders: "Text 
Tests" and "Utils" </p>
<p><img alt="" src="images/09-Text_Search-2.png" /></p>
<p>Figure 2. The SearchDescriptor and ReplaceDescriptor Services. </p>
<p>The next code fragment accesses the SearchDescriptor properties, and switches on 
regular expression searching: </p>
<p>XPropertySet srchProps = Lo.qi(XPropertySet.class, srchDesc); 
srchProps.setPropertyValue("SearchRegularExpression", true); </p>
<p>Alternatively, Props.setProperty() can be employed: 
Props.setProperty(srchDesc, "SearchRegularExpression", true); 
Once a search descriptor has been created (i.e. its string is set and any properties 
configured), then one of the findXXX() methods in XSearchable can be called.  </p>
<p>For instance, XSearchable.findFirst() returns the text range of the first matching 
element (or null), as in: </p>
<p>XInterface srch = (XInterface) searchable.findFirst(srchDesc); 
XTextRange matchTR = Lo.qi(XTextRange.class, srch); </p>
<p>The example programs, TextReplace.java and ItalicsStyler.java, demonstrate search 
and replacement. TextReplace.java uses XSearchable to find the first occurrence of a 
regular expression and XReplaceable to replace multiple occurrences of other words. </p>
<p>ItalicsStyler.java calls XSearchable's findAll() to find every occurrence of a phrase.  </p>
<h2 id="1-finding-the-first-matching-phrase">1.  Finding the First Matching Phrase</h2>
<p>TextReplace.java repeatedly calls XSearchable.findFirst() with regular expressions 
taken from an array. The first matching phrase for each expression is reported. For 
instance, the call: </p>
<p>String words[] = {"(G|g)rit", "colou?r"}; 
findWords(doc, words); </p>
<p>prints the following when "story.doc" is searched: </p>
<p>Searching for first occurrence of "(G|g)rit" 
  - found "Grit" 
    - on page 1 
    - at char position: 929 
Searching for first occurrence of "colou?r" 
  - found "colour" 
    - on page 5 
    - at char position: 10856 </p>
<p>Three pieces of information are printed for each match: the text that matched, its page 
location, and its character position calculated from the start of the document. The 
character position could be obtained from a text cursor or a text view cursor, but I 
need a page cursor to access the page number. Therefore the easiest thing to use a text 
view cursor, and a linked page cursor. </p>
<p>The code for findWords(): </p>
<p>private static void findWords(XTextDocument doc, String[] words) 
{ 
  // get the text view cursor and linked page cursor 
  XTextViewCursor tvc = Write.getViewCursor(doc); 
  tvc.gotoStart(false); 
  XPageCursor pageCursor = Lo.qi(XPageCursor.class, tvc); </p>
<p>try { 
    XSearchable searchable = Lo.qi(XSearchable.class, doc); 
    XSearchDescriptor srchDesc =<br />
                          searchable.createSearchDescriptor(); </p>
<pre><code>for(int i = 0; i &lt; words.length; i++ ) { 
  System.out.println("Searching for first occurrence of \"" +  
                                              words[i] + "\""); 
  srchDesc.setSearchString(words[i]); 
  Props.setProperty(srchDesc, "SearchRegularExpression", true);

  XInterface  srch = (XInterface) searchable.findFirst(srchDesc); 
  if (srch != null) { 
    XTextRange matchTR = Lo.qi(XTextRange.class, srch); 
    tvc.gotoRange(matchTR, false);  
    System.out.println("  - found \"" +  
                               matchTR.getString() + "\""); 
    System.out.println("    - on page " +  
                                 pageCursor.getPage()); 
    tvc.gotoStart(true);   
    System.out.println("    - at char position: " +  
                                 tvc.getString().length());  
  } 
  else 
    System.out.println("  - not found"); 
}
</code></pre>
<p>} 
  catch(com.sun.star.uno.Exception e) { 
    System.out.println(e); 
  } 
}  // end of findWords() </p>
<p>findWords() creates the text view cursor (tvc), moves it to the start of the document, 
and links the page cursor to it:<br />
XPageCursor pageCursor = Lo.qi(XPageCursor.class, tvc); 
There is only one view cursor in an application, so when the text view cursor moves, 
so does the page cursor, and vice versa. </p>
<p>The XSearchable and XSearchDescriptor interfaces are instantiated, and a for-loop 
searches for each word in the supplied array. If XSearchable.findFirst() returns a 
matching text range, it's used by XTextCursor.gotoRange() to update the position of 
the cursor.  </p>
<p>After the page position has been printed, the cursor is moved to the start of the 
document with selection turned on: </p>
<p>tvc.gotoStart(true);<br />
System.out.println("    - at char position: " +<br />
                                      tvc.getString().length());  </p>
<p>This means that tvc.getString() will return all the text from the start of the document 
to the current matching point, and so length() will return the character position 
measured from the beginning of the file. As I've mentioned previously, this approach 
may fail if the size of the string being instantiated is too big. </p>
<h2 id="2-replacing-all-the-matching-words">2.  Replacing all the Matching Words</h2>
<p>TextReplace.java also contains a method called replaceWords(), which takes two 
string arrays as arguments: </p>
<p>// code fragment inside TextReplace.java 
String ukWords[] = { 
  "colour", "neighbour", "centre", "behaviour", "metre", "through" }; </p>
<p>String usWords[] = { 
  "color", "neighbor", "center", "behavior", "meter", "thru" }; </p>
<p>replaceWords(doc, ukWords, usWords); </p>
<p>replaceWords() cycles through the arrays, replacing all occurrences of the words in 
the first array (e.g. in ukWords[]) with the corresponding words in the second array 
(e.g. in usWords[]). For instance, every occurrence of "colour" is replaced by "color". </p>
<p>The output: </p>
<p>Change all occurrences of ... </p>
<p>colour -&gt; color 
    - no. of changes: 1 
  neighbour -&gt; neighbor 
    - no. of changes: 2 
  centre -&gt; center 
    - no. of changes: 2 
  behaviour -&gt; behavior 
    - no. of changes: 0 
  metre -&gt; meter 
    - no. of changes: 0 
  through -&gt; thru 
    - no. of changes: 4 </p>
<p>Since replaceWords() doesn't report page and character positions, its code is 
somewhat shorter than findWords(): </p>
<p>private static void replaceWords(XTextDocument doc,<br />
                       String[] oldWords, String[] newWords) 
{ 
  XReplaceable replaceable = Lo.qi(XReplaceable.class, doc); 
  XReplaceDescriptor replaceDesc =<br />
                        replaceable.createReplaceDescriptor(); </p>
<p>System.out.println("Change all occurrences of ..."); 
  for (int i = 0; i &lt; oldWords.length; i++) { 
    System.out.println("  " + oldWords[i] + " -&gt; " + newWords[i]); 
    replaceDesc.setSearchString(oldWords[i]); 
    replaceDesc.setReplaceString(newWords[i]); </p>
<pre><code>int numChanges = replaceable.replaceAll(replaceDesc);      
                       // replace all occurrence of word 
System.out.println("    - no. of changes: " + numChanges);
</code></pre>
<p>} 
}  // end of replaceWords() </p>
<p>The XReplaceable and XReplaceDescriptor interfaces are created in a similar way to 
their search versions. The replace descriptor has two set methods, one for the search 
string, the other for the replacement string. </p>
<h2 id="3-finding-all-matching-phrases">3.  Finding all Matching Phrases</h2>
<p>ItalicsStyler.java is supplied with a filename and a string on the command line. For 
instance: </p>
<blockquote>
<p>run ItalicsStyler story.doc scandal 
The program opens the file and uses the "search all' method in XSearchable to find all 
occurrences of the string in the document. The matching strings are italicized and 
colored red, and the changed document saved as "italicized.doc". These changes are 
not performed using XReplaceable methods. </p>
</blockquote>
<p>Figure 3 shows a fragment of the resulting document, with the "scandal" text in the 
title and header changed. The search ignores case, so the word in the title ("Scandal") 
was correctly modified. </p>
<p><img alt="" src="images/09-Text_Search-3.png" /></p>
<p>Figure 3. A Fragment of The Italicized Document. </p>
<p>The ItalicsStyler program also outputs matching details: </p>
<p>Searching for all occurrence of "scandal" 
No. of matches: 5 
  - found "scandal" 
    - on page 1 
    - starting at char position: 6 
  - found "Scandal" 
    - on page 1 
    - starting at char position: 2 
  - found "scandal" 
    - on page 6 
    - starting at char position: 13153 
  - found "scandal" 
    - on page 18 
    - starting at char position: 38736 
  - found "scandal" 
    - on page 21 
    - starting at char position: 46425 </p>
<p>As with TextReplace.java, the printed details include the page and character positions 
of the matches. </p>
<p>The searching in ItalicsStyler.java is performed by italicizeAll(), which bears a close 
resemblance to findWords(): </p>
<p>private static void italicizeAll(XTextDocument doc, String phrase) 
{ 
  // get the text view cursor and linked page cursor 
  XTextViewCursor tvc = Write.getViewCursor(doc); 
  tvc.gotoStart(false); 
  XPageCursor pageCursor = Lo.qi(XPageCursor.class, tvc); </p>
<p>try { 
    XSearchable xSearchable = Lo.qi(XSearchable.class, doc); 
    XSearchDescriptor srchDesc =<br />
                         xSearchable.createSearchDescriptor(); </p>
<pre><code>System.out.println("Searching for all  
                     occurrences of \"" + phrase + "\""); 
int phraseLen = phrase.length(); 
srchDesc.setSearchString(phrase); 
Props.setProperty(srchDesc, "SearchCaseSensitive", false);

XIndexAccess matches = xSearchable.findAll(srchDesc); 
System.out.println("No. of matches: " + matches.getCount()); 
for (int i = 0; i &lt; matches.getCount(); i++) { 
  XTextRange matchTR = Lo.qi(XTextRange.class,  
                                  matches.getByIndex(i)); 
  if (matchTR != null) { 
    tvc.gotoRange(matchTR, false); 
    System.out.println("  - found \"" +  
                            matchTR.getString() + "\""); 
    System.out.println("    - on page " +  
                                    pageCursor.getPage()); 
    tvc.gotoStart(true); 
    System.out.println("    - starting at char position: " +  
                (tvc.getString().length() - phraseLen)); 
    Props.setProperties(matchTR,  
               new String[] {"CharColor", "CharPosture"}, 
               new Object[] { 0xFF0000,  
                      com.sun.star.awt.FontSlant.ITALIC} ); 
  } 
}
</code></pre>
<p>} 
  catch(com.sun.star.uno.Exception e) { 
    System.out.println(e); 
  } 
}  // end of italicizeAll() </p>
<p>After the search descriptor string has been defined, the "SearchCaseSensitive" 
property in SearchDescriptor is set to false: </p>
<p>srchDesc.setSearchString(phrase); 
Props.setProperty(srchDesc, "SearchCaseSensitive", false); </p>
<p>This allows the search to match text contains both upper and lower case letters, such 
as "Scandal". Many other search variants, such as restricting the search to complete 
words, and the use of search similarity parameters are described in the 
SearchDescriptor documentation (loDoc SearchDescriptor service). </p>
<p>XSearchable.findAll() returns an XIndexAccess collection, which is examined 
element-by-element inside a for-loop. The text range for each element is obtained by 
applying Lo.qi(): 
XTextRange matchTR = Lo.qiXTextRange.class, matches.getByIndex(i)); 
The reporting of the matching page and character position use text view and page 
cursors in the same way as findWords() in TextReplace.java.  </p>
<p>XTextRange is part of the TextRange service, which inherits ParagraphProperties and 
CharacterProperties. These properties are changed to adjust the character color and 
style of the selected range: </p>
<p>Props.setProperties(matchTR,<br />
      new String[] {"CharColor", "CharPosture"}, 
      new Object[] { 0xFF0000, com.sun.star.awt.FontSlant.ITALIC} ); </p>
<p>This changes the "CharColor" and "CharPosture" properties to red and italic.  </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="08-Graphic_Content.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 8. Graphic Content
            </div>
          </div>
        </a>
      
      
        <a href="10-Linguistics.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 10. The Linguistics API
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>