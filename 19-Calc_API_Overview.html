
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 19. Calc API Overview - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-19-calc-api-overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 19. Calc API Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 19. Calc API Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="19-Calc_API_Overview.html" class="md-nav__link md-nav__link--active">
        Chapter 19. Calc API Overview
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-spreadsheet-document" class="md-nav__link">
    1.  The Spreadsheet Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-document-spreadsheets" class="md-nav__link">
    2.  Document Spreadsheets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-spreadsheet-data" class="md-nav__link">
    3.  Spreadsheet Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-spreadsheet-service" class="md-nav__link">
    4.  The Spreadsheet Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-cell-range-services" class="md-nav__link">
    5.  Cell Range Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-cell-services" class="md-nav__link">
    6.  Cell Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-sheet-cell-ranges" class="md-nav__link">
    7.  Sheet Cell Ranges
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-spreadsheet-document" class="md-nav__link">
    1.  The Spreadsheet Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-document-spreadsheets" class="md-nav__link">
    2.  Document Spreadsheets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-spreadsheet-data" class="md-nav__link">
    3.  Spreadsheet Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-spreadsheet-service" class="md-nav__link">
    4.  The Spreadsheet Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-cell-range-services" class="md-nav__link">
    5.  Cell Range Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-cell-services" class="md-nav__link">
    6.  Cell Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-sheet-cell-ranges" class="md-nav__link">
    7.  Sheet Cell Ranges
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/19-Calc_API_Overview.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-19-calc-api-overview">Chapter 19. Calc API Overview<a class="headerlink" href="#chapter-19-calc-api-overview" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>The Spreadsheet 
Document; Document 
Spreadsheets; 
Spreadsheet Data; The 
Spreadsheet Service; 
Cell Range Services; 
Cell Services; Sheet Cell 
Ranges </p>
<p>Example folders: "Calc 
Tests" and "Utils" </p>
</div>
<p>This chapter gives an overview of the main services and 
interfaces used in the Calc parts of the Office API, 
illustrated with small code fragments. I'll revisit these 
topics in greater details (and with larger examples) in 
subsequent chapters. </p>
<p>If you're unfamiliar with Calc, then a good starting point is 
its user guide, available from 
<a href="https://www.libreoffice.org/get-help/documentation/">https://www.libreoffice.org/get-help/documentation/</a>. </p>
<p>Chapter 8 of the Developer's Guide looks at spreadsheet programming, and is 
available from 
<a href="https://wiki.openoffice.org/w/images/d/d9/DevelopersGuide_OOo3.1.0.pdf">https://wiki.openoffice.org/w/images/d/d9/DevelopersGuide_OOo3.1.0.pdf</a>. </p>
<p>Alternatively, you can access the chapter online, starting at 
<a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/Spreadsheets/Spreadsheet">https://wiki.openoffice.org/wiki/Documentation/DevGuide/Spreadsheets/Spreadsheet</a>
_Documents (or use loguide calc). The guide's examples can be found at 
<a href="http://api.libreoffice.org/examples/DevelopersGuide/examples.html#Spreadsheet">http://api.libreoffice.org/examples/DevelopersGuide/examples.html#Spreadsheet</a>. </p>
<p>There's also a few examples in the "Spreadsheet Document Examples" section of 
<a href="http://api.libreoffice.org/examples/examples.html#Java_examples">http://api.libreoffice.org/examples/examples.html#Java_examples</a>. </p>
<h2 id="1-the-spreadsheet-document">1.  The Spreadsheet Document<a class="headerlink" href="#1-the-spreadsheet-document" title="Permanent link">&para;</a></h2>
<p>The Calc API is organized around the SpreadsheetDocument service which subclasses 
OfficeDocument. Figure 1 shows these services, including some of their interfaces. </p>
<p><img alt="" src="images/19-Calc_API_Overview-1.png" /></p>
<p>Figure 1. Some Spreadsheet Services and Interfaces. </p>
<p>Calc's functionality is mostly divided between two Java packages (modules), sheet 
and table, which are documented at 
<a href="http://api.libreoffice.org/docs/idl/ref/namespacecom_1_1sun_1_1star_1_1sheet.html">http://api.libreoffice.org/docs/idl/ref/namespacecom_1_1sun_1_1star_1_1sheet.html</a> 
and 
<a href="http://api.libreoffice.org/docs/idl/ref/namespacecom_1_1sun_1_1star_1_1table.html">http://api.libreoffice.org/docs/idl/ref/namespacecom_1_1sun_1_1star_1_1table.html</a>. </p>
<p>Alternatively, you can try  lodoc star sheet module and lodoc star table 
module, but these only get you 'close' to the right pages.  </p>
<p>The reason for this module division is Office's support for three types of 'table': text 
tables, database tables, and spreadsheets. A spreadsheet is a table with formulae added 
into the mix.  </p>
<h2 id="2-document-spreadsheets">2.  Document Spreadsheets<a class="headerlink" href="#2-document-spreadsheets" title="Permanent link">&para;</a></h2>
<p>A spreadsheet document (i.e. a Calc file) can consist of multiple spreadsheets (or 
sheets). This is implemented using two services – called Spreadsheets (note the 's') 
and Spreadsheet, as in Figure 2. </p>
<p><img alt="" src="images/19-Calc_API_Overview-2.png" /></p>
<p>Figure 2. A Spreadsheet Document Hierarchy. </p>
<p>The sheets stored in a Spreadsheets object can be accessed by index or by name. A 
newly created document always contains a blank spreadsheet in index position 0. </p>
<p>The following code fragment shows how the first sheet in the "test.odt" document is 
accessed: </p>
<p>XComponentLoader loader = Lo.loadOffice(); 
XComponent compdoc = Lo.openDoc("test.odt", loader); 
XSpreadsheetDocument doc =<br />
                 Lo.qi(XSpreadsheetDocument.class, compdoc); </p>
<p>XSpreadsheets sheets = doc.getSheets(); 
XIndexAccess sheetsIdx = Lo.qi(XIndexAccess.class, sheets); 
XSpreadsheet sheet = Lo.qi(XSpreadsheet.class,<br />
                                sheetsIdx.getByIndex(0)); </p>
<p>These steps are hidden by methods in the Calc utility class, so the programmer can 
write: </p>
<p>XComponentLoader loader = Lo.loadOffice(); 
XSpreadsheetDocument doc = Calc.openDoc("test.odt", loader); 
XSpreadsheet sheet = Calc.getSheet(doc, 0); </p>
<p>Some Casting Required 
Surprisingly, XSpreadsheetDocument doesn't subclass XComponent. This means that 
it's not possible to pass an XSpreadsheetDocument reference to a method expecting 
an XComponent argument, such as the original GUI.setVisible(), which had the 
signature: </p>
<p>// in the GUI class (old version) 
public static void setVisible(XComponent objDoc, boolean isVisible); </p>
<p>Text documents can be passed to GUI.setVisible() because XTextDocument does 
subclass XComponent. The same is possible for Draw and Impress documents. </p>
<p>It's possible to manipulate a spreadsheet document as an XComponent, but it must be 
cast first: </p>
<p>XComponent xc = Lo.qi(XComponent.class, doc); 
GUI.setVisible(xc, true); </p>
<p>I decided to hide this casting issue by weakening the typing of methods using 
XComponent parameters. For example, the current version of GUI.setVisible()<br />
assumes that its first argument is of type Object:  </p>
<p>// in the GUI class 
public static void setVisible(Object objDoc, boolean isVisible) 
{ 
  XComponent doc = Lo.qi(XComponent.class, objDoc); 
  XWindow xWindow = getFrame(doc).getContainerWindow(); 
  xWindow.setVisible(isVisible); 
  xWindow.setFocus(); 
}  // end of setVisible() </p>
<p>This GUI.setVisible() can be called with a XSpreadsheet reference: 
GUI.setVisible(doc, true); 
The document is cast to XComponent inside GUI.setVisible() and then progresses as 
before.  </p>
<h2 id="3-spreadsheet-data">3.  Spreadsheet Data<a class="headerlink" href="#3-spreadsheet-data" title="Permanent link">&para;</a></h2>
<p>The data in a spreadsheet can be accessed in many ways: for example, as individual 
cells, cell ranges, collections of cell ranges, rows, and columns. These ways of 
viewing data are supported by different services which are used as labels in Figure 3. </p>
<p><img alt="" src="images/19-Calc_API_Overview-3.png" /></p>
<p>Figure 3. Services used with Spreadsheet Data. </p>
<p>The simplest spreadsheet unit is a cell, which can be located by its (column, row) 
coordinate/position or by its name, as in Figure 4. </p>
<p><img alt="" src="images/19-Calc_API_Overview-4.png" /></p>
<p>Figure 4. Addressing Cells. </p>
<p>For instance, the cell named "C5" in Figure 4 is at coordinate (2,4). Note that row 
names start at '1' but row positions begin at 0. A cell range is defined by the position 
of the top-left and bottom-right cells in the range's rectangle, and can use the same 
dual naming scheme. For example, the cell range B2:D3 is the rectangle between the 
cells (1,1) and (3,2). </p>
<p>A spreadsheet document may contain multiple sheets, so a cell address can include a 
sheet name. The first sheet is called "Sheet1", the second "Sheet2", and so on. For 
example, "Sheet1.A3:Sheet3.D4" refers to a cube of 24 cells consisting of 3 sheets of 
8 cells between A3 and D4. Sheets can be assigned more informative names, if you 
wish.  </p>
<p>A collection of cell ranges is defined using "~" (the tilde) as the concatenation 
operator. For example, "A1:C3~B2:D2" is a group of two ranges, A1:C3 and B2:D2. </p>
<p>The comma, ",", can be used as an alternative concatenation symbol, at least in some 
Calc functions. </p>
<p>There's also an intersection operator, "!", for calculating the intersection of two 
ranges. </p>
<p>Cell references can be relative or absolute, which mainly affect how formulae are 
copied between cells. For example, a formula (=A1*3) in cell "C3" becomes (=B1*3) 
when copied one cell to the right into "D3". However, an absolute reference (which 
uses "<span class="arithmatex">\(" as a prefix) is unaffected when moved. For instance (=\)</span>A$1*3) stops the "A" 
and "1" from being changed by a move. </p>
<p>My Calc.java support class includes methods for converting between simple cell 
names and positions; they don't handle "~", "!", or absolute references using "$". </p>
<h2 id="4-the-spreadsheet-service">4.  The Spreadsheet Service<a class="headerlink" href="#4-the-spreadsheet-service" title="Permanent link">&para;</a></h2>
<p>The Spreadsheet service is a subclass of SheetCellRange, as shown in Figure 5, which 
means that a sheet can be treated as a very big cell range. </p>
<p><img alt="" src="images/19-Calc_API_Overview-5.png" /></p>
<p>Figure 5. The Spreadsheet Service. </p>
<dl>
<dt>A great deal of spreadsheet-related functionality is implemented as interfaces </dt>
<dt>belonging to the Spreadsheet service. The most important is probably XSpreadsheet </dt>
<dt>(see lodoc xspreadsheet reference), which gives the programmer access to a </dt>
<dt>sheet's cells and cell ranges via getCellByPosition(), getCellRangeByPosition(), and </dt>
<dt>getCellRangeByName().  For example: </dt>
<dd>
<p>XSpreadsheet sheet = Calc.getSheet(doc, 0); 
XCell cell = sheet.getCellByPosition(2, 4);    // (column,row) </p>
</dd>
</dl>
<p>XCellRange cellRange1 = sheet.getCellRangeByPosition(1,1,3,2); 
          // startColumn, startRow, endColumn, endRow </p>
<p>XCellRange cellRange2 = sheet.getCellRangeByName("B2:D3"); </p>
<p>Oddly enough there's no getCellByName() method, but my Calc.java class adds one. </p>
<h2 id="5-cell-range-services">5.  Cell Range Services<a class="headerlink" href="#5-cell-range-services" title="Permanent link">&para;</a></h2>
<p>The main service for cell ranges is SheetCellRange, which inherits the CellRange 
service from the table module and several property-based classes, as indicated in </p>
<p><img alt="" src="images/19-Calc_API_Overview-6.png" /></p>
<p>Figure 6. </p>
<p><img alt="" src="images/19-Calc_API_Overview-6.png" /></p>
<p>Figure 6. The Cell Range Services. </p>
<p>SheetCellRange supports an XSheetCellRange interface, but that interface gets most 
of its functionality by inheriting XCellRange from the table module. Most programs 
that manipulate cell ranges tend to use XCellRange rather than XSheetCellRange.   </p>
<p>XCellRange is where the useful cell and cell range access methods are defined, as 
shown in the class diagram in Figure 7. </p>
<p><img alt="" src="images/19-Calc_API_Overview-7.jpg" /></p>
<p>Figure 7. The CellRange Class Diagram. </p>
<p>You can access the documentation using lodoc XCellRange. </p>
<p>What's missing from XCellRange is a way to set the values in a cell range. This is 
supported by the XCellRangeData interface (see Figure 6) which offers a 
setDataArray() method (and a getDataArray()).  </p>
<p>CellProperties in the table module is frequently accessed to adjust cell styling, such as 
color, borders, and the justification and orientation of data inside a cell. However, 
styling for a cell's text is handled by properties in the CharacterProperties or 
ParagraphProperties classes (see Figure 6). </p>
<p>Rows and columns of cells can be accessed using the TableRows and TableColumns 
services (and their corresponding XTableRows and XTableColumns interfaces). </p>
<p>They're accessed through the XColumnRowRange interface shown in Figure 6. Code 
for obtaining the first row of a sheet is: </p>
<p>XColumnRowRange crRange = Lo.qi(XColumnRowRange.class, sheet); 
    // get the XColumnRowRange interface for the sheet </p>
<p>XTableRows rows = crRange.getRows();  // get all the rows 
XIndexAccess con = Lo.qi(XIndexAccess.class, rows); 
                // treat the rows as an indexed container </p>
<p>XCellRange rowRange = Lo.qi(XCellRange.class, con.getByIndex(0)); 
                // access the first row as a cell range </p>
<p>XTableRows is an indexed container containing a sequence of XCellRange objects. </p>
<p>The TableRow services and interfaces are shown in Figure 8: </p>
<p><img alt="" src="images/19-Calc_API_Overview-8.png" /></p>
<p>Figure 8. The TableRow Services and Interfaces. </p>
<p>Similar coding is used to retrieve a column: XColumnRowRange.getColumns() gets 
all the columns. Figure 9 shows the TableColumn services and interfaces. </p>
<p><img alt="" src="images/19-Calc_API_Overview-9.png" /></p>
<p>Figure 9. The TableColumn Services and Interfaces. </p>
<p>My Calc class includes methods that hide these details, so the accessing the first row 
of the sheet becomes: 
XCellRange rowRange = Calc.getRowRange(sheet, 0); </p>
<h2 id="6-cell-services">6.  Cell Services<a class="headerlink" href="#6-cell-services" title="Permanent link">&para;</a></h2>
<p>XCellRange.getCellByPosition() returns a single cell from a given cell range. </p>
<p>However, this method can also be applied to a sheet because the API considers a sheet 
to be a very big cell range. For example: 
XCell cell = sheet.getCellByPosition(2, 4) 
The SheetCell service manages properties related to cell formulae and cell input 
validation. However, most cell functionality comes from inheriting the Cell service in 
the table module, and its XCell interface. This arrangement is shown in Figure 10. </p>
<p>. </p>
<p><img alt="" src="images/19-Calc_API_Overview-10.png" /></p>
<p>Figure 10. The SheetCell Services and Interfaces. </p>
<dl>
<dt>SheetCell doesn't support an XSheetCell interface; instead most programming is done </dt>
<dt>using XCell. XCell contains useful methods for getting and setting the values in a cell </dt>
<dt>(which may be numbers, text, or formulae). For example, the following stores the </dt>
<dt>number 9 in the cell at coordinate (2, 4) (the "C5" cell): </dt>
<dd>
<p>XSpreadsheet sheet = Calc.getSheet(doc, 0); 
XCell cell = sheet.getCellByPosition(2, 4);    // (column,row) 
cell.setValue(9); </p>
</dd>
</dl>
<p>SheetCell inherits the same properties as SheetCellRange. For example, 
CellProperties stores cell formatting properties, while text styling properties are 
supported by CharacterProperties and ParagraphProperties (see Figure 10). </p>
<p>The Cell service supports both the XCell and XText interfaces. Via the XText 
interface, it's possible to manipulate cell text in the same way that text is handled in a 
text document. However, for most purposes, it’s enough to use XCell's setFormula() 
which, despite its name, can be used to assign plain text to a cell. For instance: 
cell.setFormula("hello");     // put "hello" text in the cell 
Calc differentiates between ordinary text and formulae by expecting a formula to 
begin with "=". </p>
<p>The XCell class diagram is shown in Figure 11. </p>
<p><img alt="" src="images/19-Calc_API_Overview-11.jpg" /></p>
<p>Figure 11. The XCell Class Diagram. </p>
<p>The documentation for XCell can be found using lodoc xcell. </p>
<h2 id="7-sheet-cell-ranges">7.  Sheet Cell Ranges<a class="headerlink" href="#7-sheet-cell-ranges" title="Permanent link">&para;</a></h2>
<p>A collection of cell ranges has its own service, SheetCellRanges, shown in Figure 12. </p>
<p><img alt="" src="images/19-Calc_API_Overview-12.png" /></p>
<p>Figure 12. The SheetCellRanges Services and Interfaces. </p>
<p>SheetCellRanges doesn't turn up much when programming since it's easy to access 
multiple cell ranges by accessing them one at a time inside a loop. </p>
<p>One major use for SheetCellRanges are in sheet searches which return the matching 
cell ranges in a XSheetCellRangeContainer object. I'll give examples in Chapter 26. </p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="19%20Part%204%20Calc.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Part 4 Calc" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Part 4 Calc
            </div>
          </div>
        </a>
      
      
        
        <a href="20-Spreadsheet_Manipulation.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 20. Spreadsheet Displaying and Creation" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 20. Spreadsheet Displaying and Creation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>