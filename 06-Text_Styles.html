
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 6. Text Styles - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-6-text-styles" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 6. Text Styles
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 6. Text Styles
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="06-Text_Styles.html" class="md-nav__link md-nav__link--active">
        Chapter 6. Text Styles
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-what-properties-are-in-a-propertyset" class="md-nav__link">
    1.  What Properties are in a PropertySet?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-listing-styles-information" class="md-nav__link">
    2.  Listing Styles Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-creating-a-new-style" class="md-nav__link">
    3.  Creating a New Style
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-applying-styles-to-paragraphs-and-characters" class="md-nav__link">
    4.  Applying Styles to Paragraphs (and Characters)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-cursors-and-text-ranges" class="md-nav__link">
    5.  Cursors and Text Ranges
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-building-a-story-document" class="md-nav__link">
    6.  Building a Story Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-style-changes-to-words-and-phrases" class="md-nav__link">
    7.  Style Changes to Words and Phrases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-hyperlink-styling" class="md-nav__link">
    8.  Hyperlink Styling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-text-numbering" class="md-nav__link">
    9.  Text Numbering
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-other-style-changes" class="md-nav__link">
    10.  Other Style Changes
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-what-properties-are-in-a-propertyset" class="md-nav__link">
    1.  What Properties are in a PropertySet?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-listing-styles-information" class="md-nav__link">
    2.  Listing Styles Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-creating-a-new-style" class="md-nav__link">
    3.  Creating a New Style
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-applying-styles-to-paragraphs-and-characters" class="md-nav__link">
    4.  Applying Styles to Paragraphs (and Characters)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-cursors-and-text-ranges" class="md-nav__link">
    5.  Cursors and Text Ranges
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-building-a-story-document" class="md-nav__link">
    6.  Building a Story Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-style-changes-to-words-and-phrases" class="md-nav__link">
    7.  Style Changes to Words and Phrases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-hyperlink-styling" class="md-nav__link">
    8.  Hyperlink Styling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-text-numbering" class="md-nav__link">
    9.  Text Numbering
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-other-style-changes" class="md-nav__link">
    10.  Other Style Changes
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/06-Text_Styles.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-6-text-styles">Chapter 6. Text Styles<a class="headerlink" href="#chapter-6-text-styles" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Five Style
Families; Properties;
Listing Styles;  Creating
a Style; Applying Styles;
Paragraph/Word Styles;
Hyperlink Styling; Text
Numbering; Headers and
Footers</p>
<p>Example folders: "Text
Tests" and "Utils"</p>
</div>
<p>This chapter focuses on how text documents styles can be
examined and manipulated. This revolves around the
XStyleFamiliesSupplier interface in
GenericTextDocument, which is highlighted in Figure 1 (a
repeat of Figure 2 in Chapter 5).</p>
<p><img alt="" src="images/06-Text_Styles-1.png" /></p>
<p>Figure 1. The Text Document Services, and some Interfaces.</p>
<p>XStyleFamiliesSupplier has a getStyleFamilies() method for returning text style
families. All these families are stored in an XNameAccess object, as depicted in
Figure 2.</p>
<p>XNameAccess is one of Office's collection types, and employed when the objects in a
collection have names. There's also an XIndexAccess for collections in index order.</p>
<p>XNameContainer and XIndexContainer add the ability to insert and remove objects
from a collection.</p>
<p><img alt="" src="images/06-Text_Styles-2.png" /></p>
<p>Figure 2. Style Families and their Property Sets.</p>
<p>Five style family names are used by text documents: "CharacterStyles",
"FrameStyles", "NumberingStyles", "PageStyles", and "ParagraphStyles". The
XNameAccess families collection can be accessed with one of those names, and
returns a style family. A style family is a modifiable collection of PropertySet objects,
stored in an XNameContainer object.</p>
<p>Figure 2 shows that if the "ParagraphStyles" family is retrieved, it contains property
sets labelled "Header", "List", "Standard", and quite a few more. Each property set
can format a paragraph, change the text's font, size, and many other attributes. These
property sets are called styles.</p>
<p>The "CharacterStyles" family is a container of property sets (styles) which affect
selected sentences, words, or characters in the document. The "FrameStyles"
container holds property sets (styles) for formatting graphic and text frames. The
"NumberingStyles" family is for adding numbers or bullets to paragraphs. The
"PageStyles" family is for formatting pages.</p>
<p>The names of the property sets (styles) in the style families can be listed using
LibreOffice's GUI. If you create a new text document in Writer, a "Styles and
Formatting" dialog window appears when you press F11 (or click on the brown
spanner icon in the "Formatting" toolbar). Within the window you can switch between
five icons representing the five style families. Figure 3 shows the list of property set
(style) names for the paragraph styles family. They corresponds to the property set
names shown in Figure 2.</p>
<p><img alt="" src="images/06-Text_Styles-3.png" /></p>
<p>Figure 3. Styles and Formatting Window in Writer.</p>
<p>The names listed in the window are the same as the names used in the API, except in
two cases: the "Default Style" name that appears in the GUI window for "Paragraph
Styles" and "Page Styles" is changed to "Standard" in the API. Strangely, the "Default
Style" name for "Character Styles" in the GUI is called "Default Style" in the API.</p>
<p>Accessing a style (a property set) is a three-step process, shown below. First the style
families, then the style family (e.g. "ParagraphStyle"), and then the style (e.g.</p>
<p>"Standard"):</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 1. get the style families</span>
<span class="n">XStyleFamiliesSupplier</span> <span class="n">xSupplier</span> <span class="o">=</span>
                       <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XStyleFamiliesSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
<span class="n">XNameAccess</span> <span class="n">nameAcc</span> <span class="o">=</span> <span class="n">xSupplier</span><span class="p">.</span><span class="na">getStyleFamilies</span><span class="p">();</span>

<span class="c1">// 2. get the paragraph style family</span>
<span class="n">XNameContainer</span> <span class="n">paraStyleCon</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XNameContainer</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                          <span class="n">nameAcc</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="s">&quot;ParagraphStyles&quot;</span><span class="p">));</span>

<span class="c1">// 3. get the &#39;standard&#39; style (property set)</span>
<span class="n">XPropertySet</span> <span class="n">standardProps</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                          <span class="n">paraStyleCon</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="s">&quot;Standard&quot;</span><span class="p">));</span>
</code></pre></div>
<p>The code that implements this process in the Write utility class is a bit more
complicated since the calls to getByName() may raise exceptions if their string
arguments are incorrect.</p>
<p>The calls to Lo.qi() cast the object returned from a collection into the correct type.</p>
<h2 id="1-what-properties-are-in-a-propertyset">1.  What Properties are in a PropertySet?<a class="headerlink" href="#1-what-properties-are-in-a-propertyset" title="Permanent link">&para;</a></h2>
<p>The "Standard" name in the "ParagraphStyles" style family refers to a property set
(style). Each set is a collection of name=value pairs, and there are get and set methods
using a name to get/set its value. This is simple enough, but what names should the
programmer use?
Each property set (style) in the same style family contain the same properties, but
with different values. For instance, in Figure 2 the "Header", "Title", "Standard",
"List", and "Table" sets contain the same named properties.</p>
<p>The names of the properties used by the sets in a style family can be found in the
documentation for their "XXXStyle" service. Table 1 summarizes the mapping.</p>
<table>
<thead>
<tr>
<th>Style Family Name</th>
<th>Service where Properties are Defined</th>
</tr>
</thead>
<tbody>
<tr>
<td>"CharacterStyles"</td>
<td>CharacterStyle</td>
</tr>
<tr>
<td>"FrameStyles"</td>
<td>FrameStyle (??)</td>
</tr>
<tr>
<td>"NumberingStyles"</td>
<td>NumberingStyle</td>
</tr>
<tr>
<td>"PageStyles"</td>
<td>PageStyle</td>
</tr>
<tr>
<td>"ParagraphStyles"</td>
<td>ParagraphStyle</td>
</tr>
</tbody>
</table>
<p>Table 1. Properties Information for Each Style Family.</p>
<p>The easiest way of finding Office documentation for the services in the second
column of Table 1 is with lodoc.bat. For example, the page about CharacterStyle
can be found with <code>lodoc CharacterStyle service</code>.</p>
<p>The FrameStyle service (full name: com.sun.star.style.FrameStyle) has a "??" against
it since there's no online documentation for that service, although such a service
exists.</p>
<p>A style's properties are usually defined across several classes in an inheritance
hierarchy. The hierarchies for the five styles are summarized in Figure 4.</p>
<p><img alt="" src="images/06-Text_Styles-4.png" /></p>
<p>Figure 4. The Inheritance Hierarchies for the Style Services.</p>
<p>Figure 4 shows the hierarchies for the five style services: CharacterStyle, FrameStyle,
NumberingStyle, PageStyle, and ParagraphStyle. There's clearly a lot of similarities
between them, so I'll focus on CharacterStyle.</p>
<p>There are three services containing character style properties: CharacterStyle, Style,
and CharacterProperties. If you visit the online documentation for CharacterStyle, the
properties are listed under the heading "Public Attributes", which is shown in Figure
5.</p>
<p><img alt="" src="images/06-Text_Styles-5.png" /></p>
<p>Figure 5. Part of the Online Documentation for CharacterStyle.</p>
<p>CharacterStyle defines six properties itself, but there are many more inherited from
the Style and CharacterProperties services. If you click on the triangles next to the
"Public Attributes inherited from" lines, the documentation expands to display those
properties.</p>
<p>Figure 4 contains two "(??)" strings – one is to indicate that there's no documentation
for FrameStyle, so I'm guessing about its inheritance hierarchy.</p>
<p>The other "(??)" is in the ParagraphStyle hierarchy. The documentation for
ParagraphStyle, and the information in the developers guide, indicate that
ParagraphStyle inherits only Style and ParagraphCharacter. I believe this to be
incorrect, based on my coding with ParagraphStyle (some of which you'll see in the
next sections). ParagraphStyle appears to inherits three services: Style,
ParagraphCharacter, and CharacterStyle, as indicated in Figure 6.</p>
<p><img alt="" src="images/06-Text_Styles-6.png" /></p>
<p>Figure 6. The Paragraph Service and its Superclasses.</p>
<p>For more information of the styles API, start in the development guide in the "Overall
Document Features" section, online at: <a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Overall_Document_Features">https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Overall_Document_Features</a>
or type <code>loGuide "Overall Document Features"</code></p>
<p>The character and paragraph style properties are explained in the "Formatting"
section:
<a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Formatting">https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Formatting</a>
or type  <code>loGuide writer Formatting</code></p>
<h2 id="2-listing-styles-information">2.  Listing Styles Information<a class="headerlink" href="#2-listing-styles-information" title="Permanent link">&para;</a></h2>
<p>My StylesInfo.java example illustrates some of the Writer and Info utility functions
for examining style families and their property sets. The main() function starts by
listing the style families names:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">openDoc</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>

<span class="c1">// get all the style families for this document</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">styleFamilies</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">getStyleFamilyNames</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No. of Style Family Names: &quot;</span> <span class="o">+</span>
                                  <span class="n">styleFamilies</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
<span class="k">for</span><span class="p">(</span><span class="n">String</span> <span class="n">styleFamily</span> <span class="p">:</span> <span class="n">styleFamilies</span><span class="p">)</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">styleFamily</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
</code></pre></div>
<p>The output lists the five family names:</p>
<div class="highlight"><pre><span></span><code>No. of Style Family Names: 5
  CharacterStyles
  FrameStyles
  NumberingStyles
  PageStyles
  ParagraphStyles
</code></pre></div>
<p>Info.getStyleFamilyNames() starts by casting the document to an
XStyleFamiliesSupplier interface. Then the style families XNameAccess collection is
obtained by calling XStyleFamiliesSupplier.getStyleFamilies().The family names in
that collection are extracted with XNameAccess.getElementName():</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">getStyleFamilyNames</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">)</span>
<span class="c1">// in the Info class</span>
<span class="p">{</span>
  <span class="n">XStyleFamiliesSupplier</span> <span class="n">xSupplier</span> <span class="o">=</span>  <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span>
                            <span class="n">XStyleFamiliesSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="n">XNameAccess</span> <span class="n">nameAcc</span> <span class="o">=</span> <span class="n">xSupplier</span><span class="p">.</span><span class="na">getStyleFamilies</span><span class="p">();</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">names</span> <span class="o">=</span> <span class="n">nameAcc</span><span class="p">.</span><span class="na">getElementNames</span><span class="p">();</span>
  <span class="n">Arrays</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">names</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">names</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getStyleFamilyNames()</span>
</code></pre></div>
<p>Back in StylesInfo.java, the main() function continues by looping through the list of
style family names, printing all the style (property set) names in each family:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// list all the style names for each style family</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">styleFamilies</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">String</span> <span class="n">styleFamily</span> <span class="o">=</span> <span class="n">styleFamilies</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;. \&quot;&quot;</span> <span class="o">+</span> <span class="n">styleFamily</span> <span class="o">+</span>
                               <span class="s">&quot;\&quot; Style Family contains:&quot;</span><span class="p">);</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">styleNames</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">getStyleNames</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">styleFamily</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">printNames</span><span class="p">(</span><span class="n">styleNames</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>The output is lengthy, but informative:</p>
<div class="highlight"><pre><span></span><code>## 1. &quot;CharacterStyles&quot; Style Family contains:
  &quot;Bullet Symbols&quot;  &quot;Caption characters&quot;  &quot;Citation&quot;  &quot;Default Style&quot;
  &quot;Definition&quot;  &quot;Drop Caps&quot;  &quot;Emphasis&quot;  &quot;Endnote Symbol&quot;
  &quot;Endnote anchor&quot;  &quot;Example&quot;  &quot;Footnote Symbol&quot;  &quot;Footnote anchor&quot;
  &quot;Index Link&quot;  &quot;Internet link&quot;  &quot;Line numbering&quot;  &quot;Main index entry&quot;
  &quot;Numbering Symbols&quot;  &quot;Page Number&quot;  &quot;Placeholder&quot;  &quot;Rubies&quot;
  &quot;Source Text&quot;  &quot;Strong Emphasis&quot;  &quot;Teletype&quot;  &quot;User Entry&quot;
  &quot;Variable&quot;  &quot;Vertical Numbering Symbols&quot;  &quot;Visited Internet Link&quot;

## 2. &quot;FrameStyles&quot; Style Family contains containers:
  &quot;Formula&quot;  &quot;Frame&quot;  &quot;Graphics&quot;  &quot;Labels&quot;
  &quot;Marginalia&quot;  &quot;OLE&quot;  &quot;Watermark&quot;

## 3. &quot;NumberingStyles&quot; Style Family contains containers:
  &quot;List 1&quot;  &quot;List 2&quot;  &quot;List 3&quot;  &quot;List 4&quot;
  &quot;List 5&quot;  &quot;Numbering 1&quot;  &quot;Numbering 2&quot;  &quot;Numbering 3&quot;
  &quot;Numbering 4&quot;  &quot;Numbering 5&quot;

## 4. &quot;PageStyles&quot; Style Family contains containers:
  &quot;Endnote&quot;  &quot;Envelope&quot;  &quot;First Page&quot;  &quot;Footnote&quot;
  &quot;HTML&quot;  &quot;Index&quot;  &quot;Landscape&quot;  &quot;Left Page&quot;
  &quot;Right Page&quot;  &quot;Standard&quot;

## 5. &quot;ParagraphStyles&quot; Style Family contains containers:
  &quot;Addressee&quot;  &quot;Bibliography 1&quot;  &quot;Bibliography Heading&quot;  &quot;Caption&quot;
  &quot;Contents 1&quot;  &quot;Contents 10&quot;  &quot;Contents 2&quot;  &quot;Contents 3&quot;
  &quot;Contents 4&quot;  &quot;Contents 5&quot;  &quot;Contents 6&quot;  &quot;Contents 7&quot;
  &quot;Contents 8&quot;  &quot;Contents 9&quot;  &quot;Contents Heading&quot;  &quot;Drawing&quot;
  &quot;Endnote&quot;  &quot;First line indent&quot;  &quot;Footer&quot;  &quot;Footer left&quot;
  &quot;Footer right&quot;  &quot;Footnote&quot;  &quot;Frame contents&quot;  &quot;Hanging indent&quot;
  &quot;Header&quot;  &quot;Header left&quot;  &quot;Header right&quot;  &quot;Heading&quot;
  &quot;Heading 1&quot;  &quot;Heading 10&quot;  &quot;Heading 2&quot;  &quot;Heading 3&quot;
  &quot;Heading 4&quot;  &quot;Heading 5&quot;  &quot;Heading 6&quot;  &quot;Heading 7&quot;
  &quot;Heading 8&quot;  &quot;Heading 9&quot;  &quot;Horizontal Line&quot;  &quot;Illustration&quot;
  &quot;Illustration Index 1&quot;  &quot;Illustration Index Heading&quot;  &quot;Index&quot;
&quot;Index 1&quot;
  &quot;Index 2&quot;  &quot;Index 3&quot;  &quot;Index Heading&quot;  &quot;Index Separator&quot;
  &quot;List&quot;  &quot;List 1&quot;  &quot;List 1 Cont.&quot;  &quot;List 1 End&quot;
  &quot;List 1 Start&quot;  &quot;List 2&quot;  &quot;List 2 Cont.&quot;  &quot;List 2 End&quot;
  &quot;List 2 Start&quot;  &quot;List 3&quot;  &quot;List 3 Cont.&quot;  &quot;List 3 End&quot;
  &quot;List 3 Start&quot;  &quot;List 4&quot;  &quot;List 4 Cont.&quot;  &quot;List 4 End&quot;
  &quot;List 4 Start&quot;  &quot;List 5&quot;  &quot;List 5 Cont.&quot;  &quot;List 5 End&quot;
  &quot;List 5 Start&quot;  &quot;List Contents&quot;  &quot;List Heading&quot;  &quot;List Indent&quot;
  &quot;Marginalia&quot;  &quot;Numbering 1&quot;  &quot;Numbering 1 Cont.&quot;  &quot;Numbering 1 End&quot;
  &quot;Numbering 1 Start&quot;  &quot;Numbering 2&quot;  &quot;Numbering 2 Cont.&quot;  &quot;Numbering
2 End&quot;
  &quot;Numbering 2 Start&quot;  &quot;Numbering 3&quot;  &quot;Numbering 3 Cont.&quot;  &quot;Numbering
3 End&quot;
  &quot;Numbering 3 Start&quot;  &quot;Numbering 4&quot;  &quot;Numbering 4 Cont.&quot;  &quot;Numbering
4 End&quot;
  &quot;Numbering 4 Start&quot;  &quot;Numbering 5&quot;  &quot;Numbering 5 Cont.&quot;  &quot;Numbering
5 End&quot;
  &quot;Numbering 5 Start&quot;  &quot;Object index 1&quot;  &quot;Object index heading&quot;
&quot;Preformatted
  &quot;Quotations&quot;  &quot;Salutation&quot;  &quot;Sender&quot;  &quot;Signature&quot;
  &quot;Standard&quot;  &quot;Subtitle&quot;  &quot;Table&quot;  &quot;Table Contents&quot;
  &quot;Table Heading&quot;  &quot;Table index 1&quot;  &quot;Table index heading&quot;  &quot;Text&quot;
  &quot;Text body&quot;  &quot;Text body indent&quot;  &quot;Title&quot;  &quot;User Index 1&quot;
  &quot;User Index 10&quot;  &quot;User Index 2&quot;  &quot;User Index 3&quot;  &quot;User Index 4&quot;
  &quot;User Index 5&quot;  &quot;User Index 6&quot;  &quot;User Index 7&quot;  &quot;User Index 8&quot;
  &quot;User Index 9&quot;  &quot;User Index Heading&quot;
</code></pre></div>
<p>Info.getStyleNames() retrieves the XNameContainer object for each style family, and
extracts its style (property set) names using getElementNames():</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">getStyleNames</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">,</span>
                                <span class="n">String</span> <span class="n">familyStyleName</span><span class="p">)</span>
<span class="c1">// in Info.java</span>
<span class="p">{</span> <span class="n">XNameContainer</span> <span class="n">styleContainer</span> <span class="o">=</span>
                <span class="n">getStyleContainer</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">familyStyleName</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">styleContainer</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">names</span> <span class="o">=</span> <span class="n">styleContainer</span><span class="p">.</span><span class="na">getElementNames</span><span class="p">();</span>
    <span class="n">Arrays</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">names</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">names</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getStyleNames()</span>
</code></pre></div>
<p>The last part of StylesInfo.java lists the properties for a specific property set.
Info.getStyleProps() does that:</p>
<div class="highlight"><pre><span></span><code><span class="n">XPropertySet</span> <span class="nf">getStyleProps</span><span class="p">(</span><span class="n">XComponent</span> <span class="n">doc</span><span class="p">,</span>
                     <span class="n">String</span> <span class="n">familyStyleName</span><span class="p">,</span> <span class="n">String</span> <span class="n">propSetNm</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XNameContainer</span> <span class="n">styleContainer</span> <span class="o">=</span>
           <span class="n">getStyleContainer</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">familyStyleName</span><span class="p">);</span>
           <span class="c1">// container is a collection of named property sets</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">styleContainer</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">XPropertySet</span> <span class="n">nameProps</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">nameProps</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span> <span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                    <span class="n">styleContainer</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="n">propSetNm</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
    <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access style: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span>  <span class="p">}</span>
    <span class="k">return</span> <span class="n">nameProps</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getStyleProps()</span>
</code></pre></div>
<p>Its arguments are the document, the style family name, and style (property set) name.</p>
<p>A reference to the property set is returned. Accessing the "Standard" style (property
set) of the "ParagraphStyle" family would require:</p>
<div class="highlight"><pre><span></span><code><span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span>
       <span class="n">Info</span><span class="p">.</span><span class="na">getStyleProps</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;ParagraphStyles&quot;</span><span class="p">,</span> <span class="s">&quot;Standard&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The property set can be nicely printed by calling Props.showProps():</p>
<div class="highlight"><pre><span></span><code><span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;ParagraphStyles \&quot;Standard\&quot;&quot;</span><span class="p">,</span> <span class="n">props</span> <span class="p">);</span>
</code></pre></div>
<p>The output is long, but begins and ends like so:</p>
<div class="highlight"><pre><span></span><code>ParagraphStyles &quot;Standard&quot; Properties
  BorderDistance == 0
  BottomBorder == com.sun.star.table.BorderLine2@1a8a1dc
  BottomBorderDistance == 0
  BreakType == com.sun.star.style.BreakType@18e5cde
  Category == 0
  CharAutoKerning == true
  CharBackColor == -1
  CharBackTransparent == true
       :
  Rsid == Any[Type[unsigned long], 0]
  SnapToGrid == true
  StyleInteropGrabBag == [Lcom.sun.star.beans.PropertyValue;@1701da1
  TopBorder == com.sun.star.table.BorderLine2@6f3b58
  TopBorderDistance == 0
  WritingMode == 0
</code></pre></div>
<p>This listing, and in fact any listing of a style from "ParagraphStyles", shows that the
properties are a mixture of those defined in the Style, ParagraphProperties, and
CharacterProperties services.</p>
<h2 id="3-creating-a-new-style">3.  Creating a New Style<a class="headerlink" href="#3-creating-a-new-style" title="Permanent link">&para;</a></h2>
<p>My StoryCreator.java example adds a new style to the paragraph style family, and
uses it to format the document's paragraphs.</p>
<p>The new ParagraphStyle service is referenced using one of its interfaces, the usual one
being XStyle since all the different style services support it (as shown in Figure 4).</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// create a new paragraph style</span>
<span class="n">XStyle</span> <span class="n">paraStyle</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XStyle</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                       <span class="s">&quot;com.sun.star.style.ParagraphStyle&quot;</span><span class="p">);</span>
</code></pre></div>
<p>Lo.createInstanceMSF()'s second argument is the full name of the service, and the
first argument is the interface. All the style services are located in the
"com.sun.star.style" package.</p>
<p>Since I want to change property in this new style, I cast the XStyle interface to
XPropertySet:</p>
<div class="highlight"><pre><span></span><code><span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">paraStyle</span><span class="p">);</span>
</code></pre></div>
<p>A property is modified using setPropertyValue().</p>
<div class="highlight"><pre><span></span><code><span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;ParaBottomMargin&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
<span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CharFontName&quot;</span><span class="p">,</span> <span class="s">&quot;Times New Roman&quot;</span><span class="p">);</span>
<span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CharHeight&quot;</span><span class="p">,</span> <span class="mf">12.0f</span><span class="p">);</span>
</code></pre></div>
<p>These three properties are defined in one of the 'Properties' classes inherited by
ParagraphStyle (as shown in Figure 4). "ParaBottomMargin" appears in
ParagraphProperties, while "CharFontName" and "CharHeight" come from
CharacterProperties.</p>
<p>After setting the style's properties, the new style added to the document's paragraph
style family:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// access the paragraph style family</span>
<span class="n">XNameContainer</span> <span class="n">paraStyles</span> <span class="o">=</span>
           <span class="n">Info</span><span class="p">.</span><span class="na">getStyleContainer</span><span class="p">(</span><span class="n">textDoc</span><span class="p">,</span> <span class="s">&quot;ParagraphStyles&quot;</span><span class="p">);</span>

<span class="c1">// store the style in the style family with the name &quot;Foo&quot;</span>
<span class="n">paraStyles</span><span class="p">.</span><span class="na">insertByName</span><span class="p">(</span><span class="s">&quot;Foo&quot;</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
</code></pre></div>
<p>The style is stored with the name "Foo", but any unique name would be good (perhaps
one a little more descriptive than "Foo" would be better).</p>
<p>The style creation code in StoryCreator.java is located in createParaStyle() and
follows the  code fragment sequence described above:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">createParaStyle</span><span class="p">(</span><span class="n">XTextDocument</span> <span class="n">textDoc</span><span class="p">,</span>
                                               <span class="n">String</span> <span class="n">styleName</span><span class="p">)</span>
<span class="c1">// create a new paragraph container/style called styleName</span>
<span class="p">{</span>
  <span class="n">XNameContainer</span> <span class="n">paraStyles</span> <span class="o">=</span>
        <span class="n">Info</span><span class="p">.</span><span class="na">getStyleContainer</span><span class="p">(</span><span class="n">textDoc</span><span class="p">,</span> <span class="s">&quot;ParagraphStyles&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">paraStyles</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// create new paragraph style properties set</span>
    <span class="n">XStyle</span> <span class="n">paraStyle</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span>
                 <span class="n">XStyle</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="s">&quot;com.sun.star.style.ParagraphStyle&quot;</span><span class="p">);</span>
    <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">paraStyle</span><span class="p">);</span>

    <span class="c1">// set some properties</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CharFontName&quot;</span><span class="p">,</span> <span class="s">&quot;Times New Roman&quot;</span><span class="p">);</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CharHeight&quot;</span><span class="p">,</span> <span class="mf">12.0f</span><span class="p">);</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;ParaBottomMargin&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
                                   <span class="c1">//  4mm, in 100th mm units</span>

    <span class="c1">// set paragraph line spacing to 6mm</span>
    <span class="n">LineSpacing</span> <span class="n">lineSpacing</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LineSpacing</span><span class="p">();</span>
      <span class="n">lineSpacing</span><span class="p">.</span><span class="na">Mode</span> <span class="o">=</span> <span class="n">LineSpacingMode</span><span class="p">.</span><span class="na">FIX</span><span class="p">;</span>
      <span class="n">lineSpacing</span><span class="p">.</span><span class="na">Height</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
      <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;ParaLineSpacing&quot;</span><span class="p">,</span> <span class="n">lineSpacing</span><span class="p">);</span>

    <span class="c1">// some more common properties; not all used here</span>
    <span class="cm">/* props.setPropertyValue(&quot;CharWeight&quot;,</span>
<span class="cm">                               com.sun.star.awt.FontWeight.BOLD);</span>
<span class="cm">       props.setPropertyValue(&quot;CharAutoKerning&quot;, true);</span>
<span class="cm">       props.setPropertyValue(&quot;ParaAdjust&quot;,</span>
<span class="cm">                              ParagraphAdjust.CENTER_value);</span>
<span class="cm">       props.setPropertyValue(&quot;ParaFirstLineIndent&quot;, 0);</span>
<span class="cm">       props.setPropertyValue(&quot;BreakType&quot;, BreakType.PAGE_AFTER);</span>
<span class="cm">    */</span>
      <span class="c1">// store those properties in a container called styleName</span>
      <span class="n">paraStyles</span><span class="p">.</span><span class="na">insertByName</span><span class="p">(</span><span class="n">styleName</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">uno</span><span class="p">.</span><span class="na">Exception</span> <span class="n">e</span><span class="p">)</span>
    <span class="p">{</span> <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not set paragraph style&quot;</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>  <span class="c1">// end of createParaStyle()</span>
</code></pre></div>
<p>The "ParaLineSpacing" property is a little more complex than the others since its
value isn't a basic type, but a LineSpacing object.</p>
<p>The ParagraphProperties documentation for "ParaLineSpacing" is shown in Figure 7.</p>
<p><img alt="" src="images/06-Text_Styles-7.png" /></p>
<p>Figure 7. The ParaLineSpacing Property in the ParagraphProperties Documentation.</p>
<p>Clicking on the "com::sun:<img alt="⭐" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2b50.svg" title=":star:" />:style::LineSpacing" return type will load the
LineSpacing documentation page  into the browser.</p>
<p>In StoryCreator.java, createParaStyle() is called like so:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">createDoc</span><span class="p">(</span><span class="n">loader</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">createParaStyle</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;adParagraph&quot;</span><span class="p">)){</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not create new paragraph style&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>A new style called "adParagraph" is added to the paragraph style family. It uses
Times New Roman 12pt font, and leaves a 6mm space between paragraphs.</p>
<h2 id="4-applying-styles-to-paragraphs-and-characters">4.  Applying Styles to Paragraphs (and Characters)<a class="headerlink" href="#4-applying-styles-to-paragraphs-and-characters" title="Permanent link">&para;</a></h2>
<p>I've added an "adParagraph" style to the paragraph style family, but how do I apply
that style to some paragraphs in the document?
The easiest way is through the document's XTextRange interface. XTextRange is
supported by the TextRange service, which inherits ParagraphProperties and
CharacterProperties (and several other property classes), as illustrated in Figure 8.</p>
<p><img alt="" src="images/06-Text_Styles-8.png" /></p>
<p>Figure 8. The TextRange Service.</p>
<p>XTextRange can be cast to XPropertySet to make the properties in
ParagraphProperties and CharacterProperties accessible. An existing (or new)
paragraph style is applied to a text range by setting its "ParaStyleName" property:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextRange</span> <span class="n">xTextRange</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="na">getText</span><span class="p">().</span><span class="na">getStart</span><span class="p">();</span>
<span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xTextRange</span><span class="p">);</span>
<span class="n">props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="s">&quot;ParaStyleName&quot;</span><span class="p">,</span> <span class="s">&quot;adParagraph&quot;</span><span class="p">);</span>
</code></pre></div>
<p>Using Props.setProperty(), simplifies this to:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextRange</span> <span class="n">xTextRange</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="na">getText</span><span class="p">().</span><span class="na">getStart</span><span class="p">();</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">xTextRange</span><span class="p">,</span> <span class="s">&quot;ParaStyleName&quot;</span><span class="p">,</span> <span class="s">&quot;adParagraph&quot;</span><span class="p">);</span>
</code></pre></div>
<p>The code above obtains the text range at the start of the document, and set its
paragraph style to "adParagraph". Any text added from this position onwards will use
that style.</p>
<p>This approach is used in StoryCreator.java: the style is set first, then text is added.</p>
<h2 id="5-cursors-and-text-ranges">5.  Cursors and Text Ranges<a class="headerlink" href="#5-cursors-and-text-ranges" title="Permanent link">&para;</a></h2>
<p>Another technique for applying styles uses a cursor to select a text range. Then the
text's properties are accessed through the cursor.</p>
<p>All the different kinds of model and view cursor belong to the TextCursor service,
and this inherits TextRange. This allows us to extend Figure 8 to become Figure 9.</p>
<p><img alt="" src="images/06-Text_Styles-9.png" /></p>
<p>Figure 9. Cursor Access to Text Properties.</p>
<p>This hierarchy means that a cursor can access the TextRange service and its text
properties. The following code fragment demonstrates the idea:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getCursor</span><span class="p">(</span><span class="n">textDoc</span><span class="p">);</span>
<span class="n">cursor</span><span class="p">.</span><span class="na">gotoEnd</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>   <span class="c1">// select the entire document</span>

<span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cursor</span><span class="p">);</span>
<span class="n">props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="s">&quot;ParaStyleName&quot;</span><span class="p">,</span> <span class="s">&quot;adParagraph&quot;</span><span class="p">);</span>
</code></pre></div>
<p>Using Props.setProperty(), simplifies this to:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getCursor</span><span class="p">(</span><span class="n">textDoc</span><span class="p">);</span>
<span class="n">cursor</span><span class="p">.</span><span class="na">gotoEnd</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;ParaStyleName&quot;</span><span class="p">,</span> <span class="s">&quot;adParagraph&quot;</span><span class="p">);</span>
</code></pre></div>
<p>This approach is employed in StoryCreator.java when some paragraphs (such as
section headers) need to use a paragraph style other than "adParagraph". I'll supply
details in a moment.</p>
<h2 id="6-building-a-story-document">6.  Building a Story Document<a class="headerlink" href="#6-building-a-story-document" title="Permanent link">&para;</a></h2>
<p>StoryCreator.java starts by setting the "adParagraph" style, then employs readText()
to read text from a file and add it to the document:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextRange</span> <span class="n">xTextRange</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="na">getText</span><span class="p">().</span><span class="na">getStart</span><span class="p">();</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">xTextRange</span><span class="p">,</span> <span class="s">&quot;ParaStyleName&quot;</span><span class="p">,</span> <span class="s">&quot;adParagraph&quot;</span><span class="p">);</span>

<span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">readText</span><span class="p">(</span><span class="s">&quot;scandal.txt&quot;</span><span class="p">,</span> <span class="n">cursor</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">endParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
</code></pre></div>
<p>readText() assumes the text file has a certain format. For example, "scandal.txt"
begins like so:</p>
<div class="highlight"><pre><span></span><code>Title: A Scandal in Bohemia
Author: Sir Arthur Conan Doyle

Part I.


To Sherlock Holmes she is always THE woman. I have seldom heard
him mention her under any other name. In his eyes she eclipses
and predominates the whole of her sex.


It was not that he felt any emotion akin to love for Irene Adler.

All emotions, and that one particularly, were abhorrent to his
cold, precise but admirably balanced mind.
</code></pre></div>
<p>A paragraph is a series of text lines followed by a blank line. But there are exceptions:
lines that starts with "Title: ", "Author: " or "Part " are treated as headings, and styled
differently. When the text above is processed, the resulting document looks like
Figure 10.</p>
<p><img alt="" src="images/06-Text_Styles-10.png" /></p>
<p>Figure 10. The Output of StoryCreator.java.</p>
<p>readText() is implemented using Java's FileReader and BufferedReader:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">readText</span><span class="p">(</span><span class="n">String</span> <span class="n">fnm</span><span class="p">,</span> <span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">)</span>
<span class="cm">/* Write the text in fnm into a Office document.</span>

<span class="cm">   Use current paragraph styling unless the line starts</span>
<span class="cm">   with &quot;Title: &quot;, &quot;Author: &quot;, or &quot;Part &quot;.</span>

<span class="cm">*/</span>
<span class="p">{</span>
  <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">fnm</span><span class="p">));</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Reading text from: &quot;</span> <span class="o">+</span> <span class="n">fnm</span><span class="p">);</span>

    <span class="n">String</span> <span class="n">line</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// System.out.println(&quot;&lt;&quot; + line + &quot;&gt;&quot;);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">length</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sb</span><span class="p">.</span><span class="na">length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
          <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">sb</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
        <span class="n">sb</span><span class="p">.</span><span class="na">setLength</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;Title: &quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">line</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="mi">7</span><span class="p">));</span>
        <span class="n">Write</span><span class="p">.</span><span class="na">stylePrevParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Title&quot;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;Author: &quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">line</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="mi">8</span><span class="p">));</span>
        <span class="n">Write</span><span class="p">.</span><span class="na">stylePrevParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Subtitle&quot;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;Part &quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
        <span class="n">Write</span><span class="p">.</span><span class="na">stylePrevParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Heading&quot;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s">&quot; &quot;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sb</span><span class="p">.</span><span class="na">length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">sb</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">FileNotFoundException</span> <span class="n">ex</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not open: &quot;</span> <span class="o">+</span> <span class="n">fnm</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Read error: &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">br</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
        <span class="n">br</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="p">)</span>
    <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Problem closing &quot;</span> <span class="o">+</span> <span class="n">fnm</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of readText()</span>
</code></pre></div>
<p>The interesting bits are the calls to Write.appendPara() and
Write.stylePrevParagraph() which add a paragraph to the document and apply a style
to it. For instance:</p>
<div class="highlight"><pre><span></span><code><span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;Author: &quot;</span><span class="p">))</span> <span class="p">{</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">line</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="mi">8</span><span class="p">));</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">stylePrevParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Subtitle&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Write.appendPara() writes the string into the document as a paragraph (the input line
without the "Author: " substring). Write.stylePrevParagraph() changes the paragraph
style from "adParagraph" to "Subtitle".</p>
<p>The hard part of Write.stylePrevParagraph() is making sure that the style change only
affects the previous paragraph. Text appended after this line should use "adParagraph"
styling.</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">stylePrevParagraph</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span>
                                      <span class="n">Object</span> <span class="n">propVal</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">stylePrevParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;ParaStyleName&quot;</span><span class="p">,</span> <span class="n">propVal</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">stylePrevParagraph</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span>
                             <span class="n">String</span> <span class="n">propName</span><span class="p">,</span> <span class="n">Object</span> <span class="n">propVal</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// save current property</span>
  <span class="n">Object</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">propName</span><span class="p">);</span>

  <span class="c1">// apply property change to previous paragraph</span>
  <span class="n">XParagraphCursor</span> <span class="n">paraCursor</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span>
                                <span class="n">XParagraphCursor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cursor</span><span class="p">);</span>
  <span class="n">paraCursor</span><span class="p">.</span><span class="na">gotoPreviousParagraph</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>   <span class="c1">// select prev para</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">paraCursor</span><span class="p">,</span> <span class="n">propName</span><span class="p">,</span> <span class="n">propVal</span><span class="p">);</span>

  <span class="c1">// reset the cursor and property</span>
  <span class="n">paraCursor</span><span class="p">.</span><span class="na">gotoNextParagraph</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">propName</span><span class="p">,</span> <span class="n">oldValue</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of stylePrevParagraph()</span>
</code></pre></div>
<p>The current "ParaStyleName" value is stored before changing its value in the selected
range. Afterwards, that style name is applied back to the cursor.</p>
<p>stylePrevParagraph() changes the XTextCursor into a paragraph cursor so that it's
easier to move around across paragraphs.</p>
<p>readText() calls Write.stylePrevParagraph() with three style names ("Title",
"Subtitle", and "Heading"). I obtained those names from looking at the "Paragraph
Styles" dialog window in Figure 3.</p>
<h2 id="7-style-changes-to-words-and-phrases">7.  Style Changes to Words and Phrases<a class="headerlink" href="#7-style-changes-to-words-and-phrases" title="Permanent link">&para;</a></h2>
<p>Aside from changing paragraph styles, it's useful to apply style changes to words or
strings inside a paragraph. For example, to highlight a word in bold, or write several
words in red italics for emphasis.</p>
<p>This is implemented by Write.styleLeft() using a similar approach to
Write.stylePrevParagraph(). styleLeft() is passed an integer position which lies to the
left of the current cursor position. Character style changes are applied to the text range
defined by that distance:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">styleLeft</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span>
                   <span class="kt">int</span> <span class="n">pos</span><span class="p">,</span> <span class="n">String</span> <span class="n">propName</span><span class="p">,</span> <span class="n">Object</span> <span class="n">propVal</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// save current property</span>
  <span class="n">Object</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">propName</span><span class="p">);</span>

  <span class="c1">// apply property change to the left of cursor</span>
  <span class="kt">int</span> <span class="n">currPos</span> <span class="o">=</span> <span class="n">getPosition</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
  <span class="n">cursor</span><span class="p">.</span><span class="na">goLeft</span><span class="p">((</span><span class="kt">short</span><span class="p">)(</span><span class="n">currPos</span><span class="o">-</span><span class="n">pos</span><span class="p">),</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">propName</span><span class="p">,</span> <span class="n">propVal</span><span class="p">);</span>

  <span class="c1">// reset the cursor and property</span>
  <span class="n">cursor</span><span class="p">.</span><span class="na">goRight</span><span class="p">((</span><span class="kt">short</span><span class="p">)(</span><span class="n">currPos</span><span class="o">-</span><span class="n">pos</span><span class="p">),</span> <span class="kc">false</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">propName</span><span class="p">,</span> <span class="n">oldValue</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of styleLeft()</span>
</code></pre></div>
<p>An XTextCursor is used to select the range, and the new style is set. Then the cursor
is moved back to its old position, and the previous style reapplied.</p>
<p>The Write class contain a few support functions that set common styles using
styleLeft():</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">styleLeftBold</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pos</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">styleLeft</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&quot;CharWeight&quot;</span><span class="p">,</span>
                           <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">FontWeight</span><span class="p">.</span><span class="na">BOLD</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">styleLeftItalic</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pos</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">styleLeft</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&quot;CharPosture&quot;</span><span class="p">,</span>
                           <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">FontSlant</span><span class="p">.</span><span class="na">ITALIC</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">styleLeftColor</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span>
                                   <span class="kt">int</span> <span class="n">pos</span><span class="p">,</span> <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span> <span class="n">col</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">styleLeft</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&quot;CharColor&quot;</span><span class="p">,</span> <span class="n">Lo</span><span class="p">.</span><span class="na">getColorInt</span><span class="p">(</span><span class="n">col</span><span class="p">));</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">styleLeftCode</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pos</span><span class="p">)</span>
<span class="c1">// code is text in 10pt Courier New</span>
<span class="p">{</span>  <span class="n">styleLeft</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&quot;CharFontName&quot;</span><span class="p">,</span> <span class="s">&quot;Courier New&quot;</span><span class="p">);</span>
   <span class="n">styleLeft</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&quot;CharHeight&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>The position (the pos value) passed to styleLeft() can be obtained from
Write.getPosition(), or as the result of the Write.append() methods.</p>
<p>My BuildDoc.java example contains several examples of how to use
Write.styleLeft():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// code fragment from BuildDoc.java</span>
<span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Some examples of simple text &quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;styles.\n&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">styleLeftBold</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">);</span>  <span class="c1">// bold text back to pos</span>

<span class="n">pos</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getPosition</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;This line is written in red italics.&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">styleLeftColor</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="na">RED</span><span class="p">);</span>   <span class="c1">// red</span>
<span class="n">Write</span><span class="p">.</span><span class="na">styleLeftItalic</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">);</span>             <span class="c1">// italics</span>

<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Back to old style\n&quot;</span><span class="p">);</span>
</code></pre></div>
<p>The resulting text in the document looks like Figure 11.</p>
<p><img alt="" src="images/06-Text_Styles-11.png" /></p>
<p>Figure 11. Styled Text.</p>
<p>The following fragment from BuildDoc.java applies a 'code' styling to several lines:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// code fragment from BuildDoc.java</span>
<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Here&#39;s some code:&quot;</span><span class="p">);</span>

<span class="n">pos</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getPosition</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;\npublic class Hello\n&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;{\n&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;  public static void main(String args[]\n&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot; { System.out.println(\&quot;Hello Andrew\&quot;); }\n&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;}  // end of Hello class\n&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">styleLeftCode</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">);</span>
</code></pre></div>
<p>Figure 12 shows the generated document text.</p>
<p><img alt="" src="images/06-Text_Styles-12.png" /></p>
<p>Figure 12. Text with Code Styling.</p>
<p>Unfortunately, styleLeft() depend on integer character positions, which are calculated
using Write.getPosition(). As I've mentioned before, this method could fail if asked to
generate too large a string, and this would cause styleLeft() to die.</p>
<h2 id="8-hyperlink-styling">8.  Hyperlink Styling<a class="headerlink" href="#8-hyperlink-styling" title="Permanent link">&para;</a></h2>
<p>Text hyperlinks are implemented as styles, using "HyperLinkURL", and perhaps
"HyperLinkName", and "HyperLinkTarget". BuildDoc.java shows how the
"HyperLinkURL" property is set:</p>
<div class="highlight"><pre><span></span><code><span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;A link to my JLOP website:&quot;</span><span class="p">);</span>
<span class="n">String</span> <span class="n">urlStr</span> <span class="o">=</span> <span class="s">&quot;http://fivedots.coe.psu.ac.th/~ad/jlop/&quot;</span><span class="p">;</span>

<span class="n">pos</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getPosition</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">urlStr</span><span class="p">);</span>

<span class="n">Write</span><span class="p">.</span><span class="na">styleLeft</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&quot;HyperLinkURL&quot;</span><span class="p">,</span> <span class="n">urlStr</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">endParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
</code></pre></div>
<p>When the document is viewed, the text is drawn as a link as in Figure 13.</p>
<p><img alt="" src="images/06-Text_Styles-13.png" /></p>
<p>Figure 13. Text Containing a Hypertext Link.</p>
<p>If the user control-clicks on the link, then the URL value of "HyperLinkURL" will be
loaded into the browser.</p>
<p>The "HyperLinkName" property specifies a link name, which can be used when
searching a document. "HyperLinkTarget" corresponds to the HTML hypertext target
attribute, and has a default value of "_self".</p>
<h2 id="9-text-numbering">9.  Text Numbering<a class="headerlink" href="#9-text-numbering" title="Permanent link">&para;</a></h2>
<p>It's straightforward to number paragraphs by using Write.styleLeft() and the
"NumberingStyleName" property. The following code from BuildDoc.java, numbers
three paragraphs:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// code fragment from BuildDoc.java</span>
<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;The following points are important:&quot;</span><span class="p">);</span>

<span class="n">pos</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Have a good breakfast&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Have a good lunch&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Have a good dinner\n&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">styleLeft</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&quot;NumberingStyleName&quot;</span><span class="p">,</span> <span class="s">&quot;Numbering 1&quot;</span><span class="p">);</span>
</code></pre></div>
<p>The result is shown in Figure 14.</p>
<p><img alt="" src="images/06-Text_Styles-14.png" /></p>
<p>Figure 14. Numbered Paragraphs.</p>
<p>"NumberingStyleName" is a property in ParagraphProperties, and the "Numbering 1"
style is from the "Paragraph Styles" dialog window in Figure 3.</p>
<p>Bullets are drawn instead of numbers by changing the style name to "List 1" (see
Figure 15).</p>
<p><img alt="" src="images/06-Text_Styles-15.png" /></p>
<p>Figure 15. Bulleted Paragraphs.</p>
<p>One issue with numbered paragraphs is that their default behavior retains the current
count when numbering another group of text. For example, a second group of
numbered paragraphs appearing in the document after Figure 14 would start at '4'.
This is fixed by setting the "ParaIsNumberingRestart" property to true:</p>
<div class="highlight"><pre><span></span><code><span class="n">Write</span><span class="p">.</span><span class="na">styleLeft</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&quot;ParaIsNumberingRestart&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</code></pre></div>
<p>One large topic I won’t be looking at is document numbering. This includes the
numbering of chapter headings and lines. Chapter and line numbering are dealt with
differently from most document styles. Instead of being accessed via
XStyleFamiliesSupplier, they employ XChapterNumberingSupplier and
XNumberFormatsSupplier.</p>
<p>For more details, see the development guide:
<a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Line_Numbering_an">https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Line_Numbering_an</a>
d_Outline_Numbering
or type <code>loGuide "Line Numbering"</code>.</p>
<h2 id="10-other-style-changes">10.  Other Style Changes<a class="headerlink" href="#10-other-style-changes" title="Permanent link">&para;</a></h2>
<p>StoryCreator.java illustrates three other styling effects: the creation of a header,
setting the page to A4 format, and employing page numbers in the footer. The
relevant calls are:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// code fragment in StoryCreator.java</span>
<span class="n">Write</span><span class="p">.</span><span class="na">setHeader</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;From: &quot;</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">setA4PageFormat</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">setPageNumbers</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
</code></pre></div>
<p>Write.setA4PageFormat() sets the page formatting. Write.setPageNumbers() utilizes
text fields, which I'll examine in the "Text Fields" section in Chapter 7.</p>
<p>Changing the header in Write.setHeader() requires the setting of the "HeaderIsOn"
boolean in the "Standard" page style. Adding text to the header is done via an XText
reference. The code for Write.setHeader():</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setHeader</span><span class="p">(</span><span class="n">XTextDocument</span> <span class="n">textDoc</span><span class="p">,</span> <span class="n">String</span> <span class="n">hText</span><span class="p">)</span>
<span class="cm">/* Modify the header via the page style for the document.</span>

<span class="cm">   Put the text on the right hand side in the header in</span>
<span class="cm">   Times New Roman, 10pt */</span>
<span class="p">{</span>
  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span>
         <span class="n">Info</span><span class="p">.</span><span class="na">getStyleProps</span><span class="p">(</span><span class="n">textDoc</span><span class="p">,</span> <span class="s">&quot;PageStyles&quot;</span><span class="p">,</span> <span class="s">&quot;Standard&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">props</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access standard page style&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;HeaderIsOn&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                 <span class="c1">// header is turned on in the document</span>

    <span class="c1">// access the header&#39;s XText and cursor</span>
    <span class="n">XText</span> <span class="n">headerText</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                         <span class="n">props</span><span class="p">.</span><span class="na">getPropertyValue</span><span class="p">(</span><span class="s">&quot;HeaderText&quot;</span><span class="p">));</span>
    <span class="n">XTextCursor</span> <span class="n">headerCursor</span> <span class="o">=</span> <span class="n">headerText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>
    <span class="n">headerCursor</span><span class="p">.</span><span class="na">gotoEnd</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

    <span class="c1">// header is on the rhs and in Times New Roman, 10pt</span>
    <span class="n">XPropertySet</span> <span class="n">headerProps</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span>
                                <span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">headerCursor</span><span class="p">);</span>
    <span class="n">headerProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CharFontName&quot;</span><span class="p">,</span><span class="s">&quot;Times New Roman&quot;</span><span class="p">);</span>
    <span class="n">headerProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CharHeight&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
    <span class="n">headerProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;ParaAdjust&quot;</span><span class="p">,</span><span class="n">ParagraphAdjust</span><span class="p">.</span><span class="na">RIGHT</span><span class="p">);</span>

    <span class="n">headerText</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">hText</span> <span class="o">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span> <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setHeader()</span>
</code></pre></div>
<p>The header's XText reference is retrieved via the page style's "HeaderText" property,
and a cursor is created local to the header:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextCursor</span> <span class="n">headerCursor</span> <span class="o">=</span> <span class="n">headerText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>
</code></pre></div>
<p>This cursor can only move around inside the header not the entire document.</p>
<p>The properties of the header's XText are changed using the cursor, and then the text is
added.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="05-Text_API_Overview.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 5. Text API Overview" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 5. Text API Overview
            </div>
          </div>
        </a>
      
      
        
        <a href="07-Non-text_Content.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 7. Text Content Other than Strings" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 7. Text Content Other than Strings
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>