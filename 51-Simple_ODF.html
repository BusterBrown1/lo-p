
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 51. Simple ODF - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-51-simple-odf" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 51. Simple ODF
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 51. Simple ODF
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="51-Simple_ODF.html" class="md-nav__link md-nav__link--active">
        Chapter 51. Simple ODF
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-opendocument-format" class="md-nav__link">
    1.  The OpenDocument Format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-document-information" class="md-nav__link">
    2.  Document Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-unzipping-an-odf-document" class="md-nav__link">
    3.  Unzipping an ODF Document
  </a>
  
    <nav class="md-nav" aria-label="3.  Unzipping an ODF Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-listing-the-contents-of-a-zipped-folder" class="md-nav__link">
    3.1.  Listing the Contents of a Zipped Folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-extracting-a-mime-type" class="md-nav__link">
    3.2.  Extracting a MIME-type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-extracting-a-zipped-file" class="md-nav__link">
    3.3.  Extracting a Zipped File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-higher-level-manipulation-of-odf" class="md-nav__link">
    4.  Higher-level Manipulation of ODF
  </a>
  
    <nav class="md-nav" aria-label="4.  Higher-level Manipulation of ODF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-building-simple-documents" class="md-nav__link">
    4.1.  Building Simple Documents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-moving-a-slide" class="md-nav__link">
    4.2.  Moving a Slide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-combining-two-documents" class="md-nav__link">
    4.3.  Combining Two Documents
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-opendocument-format" class="md-nav__link">
    1.  The OpenDocument Format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-document-information" class="md-nav__link">
    2.  Document Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-unzipping-an-odf-document" class="md-nav__link">
    3.  Unzipping an ODF Document
  </a>
  
    <nav class="md-nav" aria-label="3.  Unzipping an ODF Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-listing-the-contents-of-a-zipped-folder" class="md-nav__link">
    3.1.  Listing the Contents of a Zipped Folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-extracting-a-mime-type" class="md-nav__link">
    3.2.  Extracting a MIME-type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-extracting-a-zipped-file" class="md-nav__link">
    3.3.  Extracting a Zipped File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-higher-level-manipulation-of-odf" class="md-nav__link">
    4.  Higher-level Manipulation of ODF
  </a>
  
    <nav class="md-nav" aria-label="4.  Higher-level Manipulation of ODF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-building-simple-documents" class="md-nav__link">
    4.1.  Building Simple Documents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-moving-a-slide" class="md-nav__link">
    4.2.  Moving a Slide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-combining-two-documents" class="md-nav__link">
    4.3.  Combining Two Documents
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/51-Simple_ODF.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-51-simple-odf">Chapter 51. Simple ODF</h1>
<p>An OpenDocument Format (ODF) document is a zipped 
folder containing an assortment of XML files, images, and 
other resources. This makes it possible to manipulate using 
zip/unzip and XML features, but that isn't a good idea due 
to the complexity of the formats. This chapter looks at a 
few of these lower-level techniques, but is mainly about the 
Simple API for ODF, a sub-project of the Apache ODF 
Toolkit (http://incubator.apache.org/odftoolkit/simple/). It's 
a small Java API for creating, modifying and extracting 
data from ODF documents, built on top of the ODFDOM<br />
library (http://incubator.apache.org/odftoolkit/odfdom/). Rather surprisingly, its 
support for the concatenation of documents is better than that in the Office API. </p>
<h2 id="1-the-opendocument-format">1.  The OpenDocument Format</h2>
<p>The contents of an ODF document (i.e. the zipped folder) depend on its type (e.g. </p>
<p>does it contain a spreadsheet, presentation, or text?), but several files always appear 
inside the folder: 
 content.xml: the document's textual contents, but not binary data such as 
images; 
 meta.xml: the document's meta information, such as the author's name and the 
last modification date. The data is most easily viewed through Office's File &gt; 
Properties menu item; 
 styles.xml: the styles used for the document's pages, paragraphs, text formats, 
and others, which are usually set via the Styles and Formatting dialogs in 
Office; 
 settings.xml: information specific to the application and document's display, 
such as the window's size/position, printer settings, and whether headers and 
footers are visible; 
 manifest.xml: this lists the content of the zipped folder, and is stored in the 
META-INF/ subdirectory; 
 mimetype: a one-line file listing the document's MIME-type. </p>
<p>The easiest way of viewing these files and folders is to unzip the ODF file using a 
utility such as 7-Zip, as in Figure 1. </p>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>The </p>
</div>
<p>OpenDocument Format; 
Doc Information; 
Unzipping an ODF Doc; 
the Simple Java API for 
ODF (Apache ODF 
Toolkit): making docs 
(text, sheet, and slides), 
slide movement, doc 
concatenation (text, 
sheet, and slides) 
Example folders: 
"ODFToolkit Tests" and 
"Utils" </p>
<p><img alt="" src="images/51-Simple_ODF-1.png" /></p>
<p>Figure 1. An Unzipped View of algs.odp. </p>
<p>Figure 1's Configurations2/ folder stores localization information for the Office GUI; 
Pictures/ stores the images used in the document; Thumbnails/ holds a small 128x128 
picture of the document in thumbnail.png. </p>
<p>The wikipedia page about ODF is quite informative 
(https://en.wikipedia.org/wiki/OpenDocument), as is its entry for the OpenDocument 
technical specification 
(https://en.wikipedia.org/wiki/OpenDocument_technical_specification). There's a 
quick summary of the OpenDocument Format (ODF) at 
https://help.libreoffice.org/Common/XML_File_Formats.  </p>
<p>The ODF standard was developed by the Organization for the Advancement of 
Structured Information Standards (OASIS) consortium  (https://www.oasis-
open.org/), whose website hosts a lot of information. A related community site is 
http://opendocument.xml.org/ 
The most complete textbook on ODF is: 
OASIS OpenDocument Essentials 
J. David Eisenberg, 2005 
http:// books.evc-cit.info/ 
The associated website has a free draft of the book, and all the examples and support 
code. The site often seems to be offline, but the book can be found at other locations. </p>
<p>A recent version can be purchased at Lulu: http://www.lulu.com/shop/j-david-
eisenberg/oasis-opendocument-essentials/paperback/product-392512.html </p>
<h2 id="2-document-information">2.  Document Information</h2>
<p>There's little need to directly manipulate a document's XML files since the Office API 
offers high-level techniques for accessing most of their information.  </p>
<p>For example, part of meta.xml for algs.odp is: </p>
<p><office:meta> 
  <dc:title>PowerPoint Presentation</dc:title> 
  <dc:date>2017-01-06T16:53:58.639000000</dc:date> 
  <meta:editing-cycles>4</meta:editing-cycles> 
  <meta:editing-duration>PT1M52S</meta:editing-duration> 
  <meta:generator>LibreOffice/5.1.0.3$ 
      Windows_x86LibreOffice_project/ 
      5e3e00a007d9b3b6efb6797a8b8e57b51ab1f737</meta:generator> 
  <meta:document-statistic meta:object-count="92"/> 
  <meta:user-defined meta:name="Secret">Made in<br />
                            Thailand</meta:user-defined> 
</office:meta> </p>
<p>This data is displayed in the General tab of the  File &gt; Properties window in Figure 2. </p>
<p><img alt="" src="images/51-Simple_ODF-2.png" /></p>
<p>Figure 2. File &gt; Properties Window. </p>
<p>Rather than attempting to extract and parse meta.xml, this information is reachable 
through the XDocumentProperties interface which I described back in Chapter 3, 
section 2.  </p>
<p>The following DocInfo.java example uses Info.printDocProperties() to print document 
details: </p>
<p>// in DocInfo.java 
public class DocInfo 
{ 
  public static void main(String args[]) 
  { 
    if (args.length &lt; 1) { 
      System.out.println("Usage: run DocInfo <fnm>"); 
      return; 
    } </p>
<pre><code>XComponentLoader loader = Lo.loadOffice(); 
XComponent doc = Lo.openDoc(args[0], loader); 
if (doc == null) { 
  System.out.println("Could not open " + args[0]); 
  Lo.closeOffice(); 
  return; 
}

System.out.println(); 
Props.showObjProps("Document", doc); 
Info.printDocProperties(doc);

Lo.closeDoc(doc); 
Lo.closeOffice();
</code></pre>
<p>}  // end of main() </p>
<p>}  // end of DocInfo class </p>
<p>When DocInfo is passed algs.odp, some of the output is: </p>
<p>Document Properties Info 
  Author: 
  Title: PowerPoint Presentation 
  Subject: 
  Description: 
  Generator: LibreOffice/5.1.0.3$Windows_x86 LibreOffice_project/ 
                     5e3e00a007d9b3b6efb6797a8b8e57b51ab1f737 
     : 
  Modification Date: Jan 06, 2017 16:53 
     : 
  Secret == Made in Thailand </p>
<p>Info.printDocProperties() calls many XDocumentProperties.getXXX() methods to 
obtain these details: </p>
<p>// in the Info class 
public static void printDocProperties(Object doc) 
{ 
  XDocumentPropertiesSupplier docPropsSupp = 
           Lo.qi(XDocumentPropertiesSupplier.class, doc); 
  XDocumentProperties dps = docPropsSupp.getDocumentProperties(); 
  printDocProps(dps); </p>
<p>XPropertyContainer udProps = dps.getUserDefinedProperties(); 
  Props.showObjProps("UserDefined Info", udProps); 
}  // end of printDocProperties() </p>
<p>public static void printDocProps(XDocumentProperties dps) 
{ 
  System.out.println("Document Properties Info"); </p>
<p>System.out.println("  Author: " + dps.getAuthor()); 
  System.out.println("  Title: " + dps.getTitle()); 
  System.out.println("  Subject: " + dps.getSubject()); 
     :  // many more prints 
}  // end of printDocProps() </p>
<p>XDocumentProperties replaces the deprecated XDocumentInfo interface, which has 
been removed from LibreOffice (although it's still in OpenOffice). The two classes 
manipulate almost the same information, but the older XDocumentInfo can retrieve 
the document's MIME-type, which is absent from XDocumentProperties. One way of 
obtaining this would be to access the mimetype file zipped inside the document, as 
shown next. </p>
<h2 id="3-unzipping-an-odf-document">3.  Unzipping an ODF Document</h2>
<p>My DocUnzip.java example shows how it's possible to list the zipped contents of a 
document, access its MIME-type, and extract a zipped file: </p>
<p>// in DocUnzip.java 
public class DocUnzip 
{ 
  public static void main(String args[]) 
  { 
    if ((args.length &lt; 1) || (args.length &gt; 2)) { 
      System.out.println("Usage: run DocUnzip <fnm> [<ExtractFnm>]"); 
      return; 
    } 
    XComponentLoader loader = Lo.loadOffice(); </p>
<pre><code>FileIO.zipList(args[0]); 
// FileIO.zipListUno(args[0]);   // only names listed

// get zip access to the document 
XZipFileAccess zfa = FileIO.zipAccess(args[0]);

String mimeType = FileIO.getMimeType(zfa); 
System.out.println("MIME type: " + mimeType); 
System.out.println("Other MIME type approach: " +  
                            Info.getMIMEType(args[0]));

// convert MIME-type too other forms 
int docType = Info.mimeDocType(mimeType); 
System.out.println("Doc Type: " + docType + "; " +  
                             Lo.docTypeStr(docType));

if (args.length == 2)   // extract the named file 
  FileIO.unzipFile(zfa, args[1]);

Lo.closeOffice();
</code></pre>
<p>}  // end of main() 
}  // end of DocUnzip class </p>
<p>The program can be called like so: 
run DocUnzip algs.odp content.xml 
content.xml will be unzipped from algs.odp and saved as contentCopy.xml in the 
local directory. </p>
<p>The rest of the output is: </p>
<p>Listing of algs.odp: 
Raw Size    Size     Date        Time         Name 
--------  -------  -------      -------      -------- 
47        47       Jan 6, 2017  9:54:00 AM   mimetype 
0         0        Jan 6, 2017  9:54:00 AM   Configurations2/popupmenu/ 
0         0        Jan 6, 2017  9:54:00 AM   Configurations2/floater/ 
0         0        Jan 6, 2017  9:54:00 AM   Configurations2/images/Bitmaps/ 
0         2        Jan 6, 2017  9:54:00 AM <br />
Configurations2/accelerator/current.xml 
0         0        Jan 6, 2017  9:54:00 AM   Configurations2/menubar/ 
0         0        Jan 6, 2017  9:54:00 AM   Configurations2/progressbar/ 
0         0        Jan 6, 2017  9:54:00 AM   Configurations2/toolbar/ 
0         0        Jan 6, 2017  9:54:00 AM   Configurations2/statusbar/ 
0         0        Jan 6, 2017  9:54:00 AM   Configurations2/toolpanel/ 
83608     6501     Jan 6, 2017  9:54:00 AM   styles.xml 
4364      4364     Jan 6, 2017  9:54:00 AM <br />
Pictures/100000000000004600000035E6F1CB2181A9ACF1.png 
16977     16977    Jan 6, 2017  9:54:00 AM <br />
Pictures/10000000000003080000002A0A348B9039C3652D.png 
20480     20480    Jan 6, 2017  9:54:00 AM <br />
Pictures/10000000000001F4000001F4E2E69E1D.jpg 
45056     45056    Jan 6, 2017  9:54:00 AM <br />
Pictures/10000000000000C8000000EEB0A3D2D2.jpg 
8192      8192     Jan 6, 2017  9:54:00 AM <br />
Pictures/10000000000000E1000000E1B343DD04.jpg 
40960     40960    Jan 6, 2017  9:54:00 AM <br />
Pictures/10000000000000E60000015E784CAA37.jpg 
69632     69632    Jan 6, 2017  9:54:00 AM <br />
Pictures/10000000000000DC000000FF9A43DBBF.jpg 
28672     28672    Jan 6, 2017  9:54:00 AM <br />
Pictures/100000000000011800000160792BAA16.jpg 
12288     12288    Jan 6, 2017  9:54:00 AM <br />
Pictures/10000000000000DC0000014B7CFE8C49.jpg 
11901     11901    Jan 6, 2017  9:54:00 AM <br />
Pictures/10000000000000BC0000010DD7ECB1F7.jpg 
18238     18238    Jan 6, 2017  9:54:02 AM   Thumbnails/thumbnail.png 
86313     8040     Jan 6, 2017  9:54:02 AM   content.xml 
6037      913      Jan 6, 2017  9:54:02 AM   settings.xml 
1141      491      Jan 6, 2017  9:54:02 AM   meta.xml 
2248      452      Jan 6, 2017  9:54:02 AM   META-INF/manifest.xml </p>
<p>MIME type: application/vnd.oasis.opendocument.presentation 
Other MIME type approach: application/vnd.oasis.opendocument.presentation 
Doc Type: 5; simpress </p>
<p>Extracting content.xml 
Saving to contentCopy.xml </p>
<p>Most of the output is a detailed listing of the zipped contents of algs.odp. </p>
<h3 id="31-listing-the-contents-of-a-zipped-folder">3.1.  Listing the Contents of a Zipped Folder</h3>
<p>There are two "zipList" functions in the FileIO utility class. FileIO.zipListUno() is 
simpler since only file and folder names are printed: </p>
<p>// in the FileIO class 
public static void zipListUno(String fnm) 
{ 
  XZipFileAccess zfa = zipAccess(fnm); 
  XNameAccess nmAccess = Lo.qi(XNameAccess.class, zfa); 
  String[] names = nmAccess.getElementNames(); </p>
<p>System.out.println("\nZipped Contents of " + fnm); 
  Lo.printNames(names, 1); 
}  // end of zipListUno() </p>
<p>public static XZipFileAccess zipAccess(String fnm) 
// get zip access to the document using Office API 
{ 
  return Lo.createInstanceMCF(XZipFileAccess.class, 
                         "com.sun.star.packages.zip.ZipFileAccess", 
                         new Object[]{ fnmToURL(fnm) }); 
} </p>
<p>XZipFileAccess is created by instantiating the ZipFileAccess service with the 
document's filename. The interface is cast to XNameAccess which allows the names 
of the zipped files to be retrieved as an array of strings. Figure 3 shows the 
relationships between the service and interfaces. </p>
<p><img alt="" src="images/51-Simple_ODF-3.png" /></p>
<p>Figure 3. The ZipFileAccess Service. </p>
<p>The ZipFileAccess service and interfaces are in the com.sun.star.packages.zip 
module, which includes a ZipEntry class for holding information about each zipped 
file (e.g. its compressed size). I was unable to find a way of creating ZipEntry objects, 
but Java contains a complete zip API. By using Java rather than Office, I was able to 
implement a more fancy "zipList": </p>
<p>// in the FileIO class 
public static void zipList(String fnm) 
// using the Java API 
{ 
  DateFormat df= DateFormat.getDateInstance();   // date format 
  DateFormat tf= DateFormat.getTimeInstance();   // time format 
  tf.setTimeZone( TimeZone.getDefault() ); 
  try { 
    ZipFile zfile = new ZipFile(fnm); 
    System.out.println("Listing of " + zfile.getName() + ":"); 
    System.out.println("Raw  Size  Size  Date   Time   Name"); 
    System.out.println("---  ----  ----  ----   ----   ----"); 
    Enumeration&lt;? extends java.util.zip.ZipEntry&gt; zfs =<br />
                                            zfile.entries(); 
    while (zfs.hasMoreElements()) { 
      java.util.zip.ZipEntry entry =<br />
              (java.util.zip.ZipEntry) zfs.nextElement(); 
      Date d = new Date(entry.getTime()); 
      System.out.print( padSpaces(entry.getSize(), 9) + " "); 
      System.out.print( padSpaces(entry.getCompressedSize(),7)+ " "); 
      System.out.print(" " + df.format(d) + " "); 
      System.out.print(" " + tf.format(d) + "  "); 
      System.out.println(" " + entry.getName()); 
    } 
    System.out.println(); 
  } 
  catch (java.io.IOException e)<br />
  {  System.out.println(e); } 
}  // end of zipList() </p>
<p>Another advantage of switching to Java are the large number of online examples of 
zip manipulation; my zipList() function is closely based on one at<br />
http://www.drdobbs.com/jvm/java-and-the-zip-file-format/184410339. </p>
<h3 id="32-extracting-a-mime-type">3.2.  Extracting a MIME-type</h3>
<p>FileIO.getMimeType() employs XZipFileAccess.getStreamByPattern() to access the 
zipped mimetype file as an input stream. </p>
<p>// in the FileIO class 
public static String getMimeType(XZipFileAccess zfa) 
{ 
  try { 
    XInputStream inStream = zfa.getStreamByPattern("mimetype"); 
    String[] lines = FileIO.readLines(inStream); 
    if (lines != null) 
      return lines[0].trim(); 
  } 
  catch (com.sun.star.uno.Exception e) 
  {  System.out.println(e);  } </p>
<p>System.out.println("No mimetype found"); 
  return null; 
}  // end of getMimeType() </p>
<p>There's an alternative approach which looks up the file's MIME-type  using the Java 
API class MimetypesFileTypeMap: </p>
<p>// in the Info class 
// global 
private static final String MIME_FNM = "mime.types"; </p>
<p>public static String getMIMEType(String fnm) 
{ 
  try { 
    MimetypesFileTypeMap mftMap = new MimetypesFileTypeMap( 
                         FileIO.getUtilsFolder() + MIME_FNM); 
    return mftMap.getContentType(new File(fnm)); 
  } 
  catch(java.lang.Exception e) 
  {  System.out.println("Could not find " + MIME_FNM); <br />
     return "application/octet-stream";   // better than nothing 
  } 
}  // end of getMIMEType() </p>
<p>The MimetypesFileTypeMap() constructor examines a list of MIME-types loaded 
from the utility classes folder. </p>
<p>Most of my utility functions use document 'types' coded as integers rather than as 
MIME-type strings; the values are defined at the start of the Lo utility class: </p>
<p>// in the Lo class 
public static final int UNKNOWN = 0; 
public static final int WRITER = 1; 
public static final int BASE = 2; 
public static final int CALC = 3; 
public static final int DRAW = 4; 
public static final int IMPRESS = 5; 
public static final int MATH = 6; </p>
<p>Info.mimeDocType() maps ODF MIME-type strings to one of these integers: </p>
<p>// in the Info class 
public static int mimeDocType(String mimeType) 
{ 
  if (mimeType == null)<br />
    return Lo.UNKNOWN; </p>
<p>if (mimeType.contains("vnd.oasis.opendocument.text")) 
    return Lo.WRITER; 
  else if (mimeType.contains("vnd.oasis.opendocument.base")) 
    return Lo.BASE; 
  else if (mimeType.contains("vnd.oasis.opendocument.spreadsheet")) 
    return Lo.CALC; 
  else if (mimeType.contains("vnd.oasis.opendocument.graphics") || 
           mimeType.contains("vnd.oasis.opendocument.image") || 
           mimeType.contains("vnd.oasis.opendocument.chart")) 
    return Lo.DRAW; 
  else if (mimeType.contains("vnd.oasis.opendocument.presentation")) 
    return Lo.IMPRESS; 
  else if (mimeType.contains("vnd.oasis.opendocument.formula")) 
    return Lo.MATH; 
  else return Lo.UNKNOWN; 
}  // end of mimeDocType() </p>
<p>Some of my functions also utilize short document type strings, which are also defined 
in the Lo class: </p>
<p>// in the Lo class 
// docType strings 
public static final String UNKNOWN_STR = "unknown"; 
public static final String WRITER_STR = "swriter"; 
public static final String BASE_STR = "sbase"; 
public static final String CALC_STR = "scalc"; 
public static final String DRAW_STR = "sdraw"; 
public static final String IMPRESS_STR = "simpress"; 
public static final String MATH_STR = "smath"; </p>
<p>Lo.docTypeStr() maps document type integers to these strings. </p>
<h3 id="33-extracting-a-zipped-file">3.3.  Extracting a Zipped File</h3>
<p>The XZipFileAccess.getStreamByPattern() method used in FileIO.getMimeType() is 
also employed by FileIO.unzipFile() to extract a zipped file: </p>
<p>// in FileIO class 
public static void unzipFile(XZipFileAccess zfa, String fnm) 
{ 
  String fileName = Info.getName(fnm); 
  String ext = Info.getExt(fnm); 
  try { 
    System.out.println("Extracting " + fnm); 
    XInputStream inStream = zfa.getStreamByPattern("*" + fnm); </p>
<pre><code>XSimpleFileAccess3 fileAcc =  
      Lo.createInstanceMCF(XSimpleFileAccess3.class, 
                "com.sun.star.ucb.SimpleFileAccess");

String copyFnm =  (ext == null) ? (fileName + "Copy") : 
                                  (fileName + "Copy." + ext); 
System.out.println("Saving to " + copyFnm); 
fileAcc.writeFile(FileIO.fnmToURL(copyFnm), inStream);
</code></pre>
<p>} 
  catch (com.sun.star.uno.Exception e) 
  {  System.out.println(e);  } 
}  // end of unzipFile() </p>
<p>The XZipFileAccess.getStreamByPattern() call includes the wildcard character "*" so 
the filename will be found even if prefixed by a directory path, as in the case of an 
ODF document's manifest.xml which is stored in "META-INF/manifest.xml". </p>
<p>I utilize Office's IO interface, XSimpleFileAccess3, which supports writeFile() to 
directly connect an XInputStream  to a file. The filename of the extracted data is 
constructed from the zipped filename with the addition of "Copy". </p>
<h2 id="4-higher-level-manipulation-of-odf">4.  Higher-level Manipulation of ODF</h2>
<p>Manipulating an ODF document as zipped files and XML is a recipe for highly 
complex (and probably bug-ridden) code. And why bother when the Office API offers 
all the necessary functionality in a higher-level framework? 
"Maslow's hammer" maxim comes to mind; it states: "if all you have is a hammer, 
then everything looks like a nail". In other words, it's useful to know about ODF APIs 
other than Office's since they might offer better, easier ways of doing some tasks. </p>
<p>As a consequence, I'm going to spend the rest of the chapter looking at the Simple 
Java API for ODF, a sub-project of Apache ODF Toolkit 
(http://incubator.apache.org/odftoolkit/simple/). It's a relatively small Java API for 
creating, modifying and extracting data from ODF documents, built on top of the 
ODFDOM  library (http://incubator.apache.org/odftoolkit/odfdom/).  </p>
<p>Its best features are the cookbook pages at 
http://incubator.apache.org/odftoolkit/simple/document/cookbook/, the Getting 
Started Guide (http://incubator.apache.org/odftoolkit/simple/gettingstartguide.html), 
and its demo pages (http://incubator.apache.org/odftoolkit/simple/demo/).  </p>
<p>The cookbook contains examples for manipulating text documents, presentations, 
tables in text documents and spreadsheets, charts, style handling, text navigation, text 
extraction, text fields, text forms, and document metadata. The API documentation is 
at http://incubator.apache.org/odftoolkit/mvn-site/0.8-incubating/simple-odf/apidocs/, 
and a mail archive at http://mail-archives.apache.org/mod_mbox/incubator-odf-users/ 
By far the worst feature of the API is the large number of libraries that must be 
installed before even a lowly "Hello World" example will work. Fortunately, I've 
included copies of those libraries at this chapter's website at 
http://fivedots.coe.psu.ac.th/~ad/jlop/. </p>
<p>The Simple API doesn't have the depth of features of Office, so it's best suited for the 
creation of simple text documents, spreadsheets, and presentations. However, it has 
better support for combining documents (e.g. concatenating two slide decks into a 
single one), and can move/copy slides in a presentation much more easily than Office; 
look back at Chapter 17, sections 4 and 5 for my complaints about that. </p>
<h3 id="41-building-simple-documents">4.1.  Building Simple Documents</h3>
<p>This subsection looks at how the Simple API can be used to create text, spreadsheet, 
and slide documents. </p>
<p>Make a Text Document 
My MakeTextDoc.java example creates a text document containing an image, some 
text, a list, and a table.; the result is shown in Figure 4. </p>
<p><img alt="" src="images/51-Simple_ODF-4.png" /></p>
<p>Figure 4. The Output of MakeTextDoc.java. </p>
<p>This isn't quite what the output looks like in the "Getting Started Guide", where the 
program is called HelloWorld.java – in the guide the first paragraph is beneath the 
image rather than to one side. </p>
<p>The MakeTextDoc.java code: </p>
<p>public class MakeTextDoc 
{ 
  public static void main(String[] args) 
  { 
    try { 
      TextDocument doc = TextDocument.newTextDocument(); 
      doc.newImage(new URI("odf-logo.png")); </p>
<pre><code>  // add paragraphs and list 
  doc.addParagraph("Hello World, Hello Simple ODF!"); 
  doc.addParagraph("The following is a list."); 
  List list = doc.addList(); 
  String[] items = {"item1", "item2", "item3"}; 
  list.addItems(items);

  // add table 
  Table table = doc.addTable(2, 2); 
  Cell cell = table.getCellByPosition(0, 0); 
  cell.setStringValue("Hello World!");

  System.out.println("Creating MakeTextDoc.odt"); 
  doc.save("MakeTextDoc.odt"); 
} 
catch (Exception e) { 
  System.out.println(e); 
}
</code></pre>
<p>}  // end of main() </p>
<p>} // end of MakeTextDoc class </p>
<p>I was unable to find a way of changing the image's text wrap property to affect the 
paragraph's position. It's probably do-able using the lower-level ODFDOM  library, 
but the programming information for that part of ODF Toolkit is mostly limited to its 
API documentation. However, there's a good introductory tutorial at 
http://www.langintro.com/odfdom_tutorials/. </p>
<p>Make a Spreadsheet 
The MakeSheet.java example creates a spreadsheet with a single sheet, and a few 
cells of data, as in Figure 5. </p>
<p><img alt="" src="images/51-Simple_ODF-5.png" /></p>
<p>Figure 5. The Output of MakeSheet.java. </p>
<p>The program: </p>
<p>public class MakeSheet<br />
{ 
  public static void main(String[] args)<br />
  { 
    try { 
      SpreadsheetDocument doc =<br />
             SpreadsheetDocument.newSpreadsheetDocument(); 
      Table sheet = doc.getSheetByIndex(0); 
      sheet.getCellByPosition(0, 0).setStringValue("Hello"); 
      for (int row = 0; row &lt; 5; row++) 
        sheet.getCellByPosition(1, row).setDoubleValue(row*2.0); </p>
<pre><code>  System.out.println("Saving document to makeSheet.ods"); 
  doc.save("makeSheet.ods"); 
}  
catch (Exception e)  
{  System.out.println(e); }
</code></pre>
<p>}  // end of main() </p>
<p>}  // end of MakeSheet class </p>
<p>Make a Slide Deck 
The MakeSlides.java example creates a slide deck. The first slide contains a title, the 
second some bulleted text and a picture, and the third slide is blank, as in Figure 6. </p>
<p><img alt="" src="images/51-Simple_ODF-6.png" /></p>
<p>Figure 6. The Output of MakeSlides.java. </p>
<p>The program: </p>
<p>public class MakeSlides 
{ 
  public static void main(String[] args) 
  { 
    try { 
      PresentationDocument doc =<br />
                PresentationDocument.newPresentationDocument(); </p>
<pre><code>  // a title slide 
  Slide slide1 = doc.newSlide(0, "slide1",  
                               SlideLayout.TITLE_ONLY); 
  Textbox titleBox = slide1.getTextboxByUsage( 
                         PresentationClass.TITLE).get(0); 
  titleBox.setTextContent("Important Slide Presentation");

  // a slide with text bullets and a picture 
  Slide slide2 = doc.newSlide(1, "slide2",  
                             SlideLayout.TITLE_OUTLINE); 
  titleBox = slide2.getTextboxByUsage( 
                         PresentationClass.TITLE).get(0); 
  titleBox.setTextContent("Overview");

  Textbox outline = slide2.getTextboxByUsage( 
                         PresentationClass.OUTLINE).get(0); 
  List txtList = outline.addList();   // two bullets 
  txtList.addItem("Item 1"); 
  txtList.addItem("Item 2");

  Image image = Image.newImage(slide2, new URI("skinner.png")); 
  FrameRectangle rect = image.getRectangle(); 
  rect.setX(8);     // position the image 
  rect.setY(4); 
  image.setRectangle(rect);

  System.out.println("Saving document to makeSlides.odp"); 
  doc.save("makeSlides.odp"); 
} 
catch (Exception e) 
{ System.out.println(e);  }
</code></pre>
<p>}  // end of main() </p>
<p>}  // end of MakeSlides class </p>
<p>Programming with this part of the API is a littlie tricky since slide elements are 
represented by different types of boxes. I also found it hard to determine the position 
of the image, except by trial-and-error. </p>
<h3 id="42-moving-a-slide">4.2.  Moving a Slide</h3>
<p>Back in Chapter 17, section 4, I had to use copy and paste dispatch commands in the 
slide-sorter view to rearrange a deck. Moving a slide in the Simple API is much 
easier, as shown in MoveSlide.java, which moves the first slide of the deck to its end: </p>
<p>public class MoveSlide<br />
{ 
  public static void main(String[] args)<br />
  { 
    try { 
      PresentationDocument doc =<br />
             PresentationDocument.loadDocument("algs.odp"); 
      int numSlides = doc.getSlideCount(); 
      System.out.println("Moving first slide to the end"); 
      doc.moveSlide(0, numSlides);   // why not numSlides-1? </p>
<pre><code>  System.out.println("Saving document to algsMoved.odp"); 
  doc.save("algsMoved.odp"); 
  doc.close(); 
}  
catch (Exception e)  
{  System.out.println(e); }
</code></pre>
<p>}  // end of main() </p>
<p>}  // end of MoveSlide class </p>
<p>PresentationDocument.moveSlide() works without a hitch, although I'm confused 
why I need to supply numSlides as the second numerical argument rather than 
numSlides-1.  </p>
<p>There's also a PresentationDocument.copySlide() method for copying. </p>
<h3 id="43-combining-two-documents">4.3.  Combining Two Documents</h3>
<p>This subsection presents three short programs that combine two text documents, 
appends the sheets of two spreadsheets, and concatenates two slide decks. These 
examples are much simpler to program than equivalent ones using the Office API. </p>
<p>Combining Text Documents 
CombineTexts.java adds the contents of doc2.odt to the end of the contents of 
doc1.odt, separating them with a page break. The result is saved to combined.odt: </p>
<p>public class CombineTexts<br />
{ 
  public static void main(String[] args)<br />
  { 
    try { 
      TextDocument doc1 = TextDocument.loadDocument("doc1.odt"); 
      TextDocument doc2 = TextDocument.loadDocument("doc2.odt"); </p>
<pre><code>  doc1.addPageBreak(); 
  Paragraph lastPara = doc1.getParagraphByReverseIndex(0, false);

  // insert contents at end and copy styles 
  doc1.insertContentFromDocumentAfter(doc2, lastPara, true);

  System.out.println("Saving combination to combined.odt"); 
  doc1.save("combined.odt"); 
  doc1.close(); 
  doc2.close(); 
}  
catch (Exception e)  
{  System.out.println(e); }
</code></pre>
<p>}  // end of main() </p>
<p>}  // end of CombineTexts class </p>
<p>The crucial method is TextDocument.insertContentFromDocumentAfter(). </p>
<p>Combining Spreadsheets 
CombineSheets.java places the sheets in ss2.odt after the sheets in ss1.odt, and saves 
the result in combined.ods: </p>
<p>public class CombineSheets<br />
{ 
  public static void main(String[] args)<br />
  { 
    try { 
      SpreadsheetDocument doc1 =<br />
              SpreadsheetDocument.loadDocument("ss1.ods"); 
      SpreadsheetDocument doc2 =<br />
              SpreadsheetDocument.loadDocument("ss2.ods"); 
      int numSheets2 = doc2.getSheetCount(); </p>
<pre><code>  // add sheets of second document to end of first doc 
  for(int i=0; i &lt; numSheets2; i++) { 
    Table t = doc2.getSheetByIndex(i); 
    doc1.appendSheet(t, t.getTableName()); 
  } 
  System.out.println("Saving combination to combined.ods"); 
  doc1.save("combined.ods"); 
  doc1.close(); 
  doc2.close(); 
}  
catch (Exception e)  
{  System.out.println(e); }
</code></pre>
<p>}  // end of main() </p>
<p>}  // end of CombineSheets class </p>
<p>Sadly there isn't a single method that appends tables. Instead  I've used a loop to 
append each sheet from ss2.ods after the sheets in ss1.ods. </p>
<p>Combining Slide Decks 
CombineDecks.java adds the slides in deck2.odp after the slides in deck1.odp, saving 
the result in combined.odp: </p>
<p>public class CombineDecks<br />
{ 
  public static void main(String[] args)<br />
  { 
    try { 
      PresentationDocument doc1 =<br />
              PresentationDocument.loadDocument("deck1.odp"); 
      PresentationDocument doc2 =<br />
              PresentationDocument.loadDocument("deck2.odp"); 
      doc1.appendPresentation(doc2); 
      System.out.println("Saving combination to combined.odp"); 
      doc1.save("combined.odp"); 
      doc1.close(); 
      doc2.close(); 
    }<br />
    catch (Exception e)<br />
    {  System.out.println(e); } 
  }  // end of main() </p>
<p>}  // end of CombineDecks class </p>
<p>The PresentationDocument.appendPresentation() method does all the work, and 
should be compared to my hacky Office solution in Chapter 17, section 5. </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="50-Importing_XML.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 50. Importing XML
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>