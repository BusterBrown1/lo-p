
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 7. Text Content Other than Strings - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-7-text-content-other-than-strings" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 7. Text Content Other than Strings
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 7. Text Content Other than Strings
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="07-Non-text_Content.html" class="md-nav__link md-nav__link--active">
        Chapter 7. Text Content Other than Strings
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-how-to-access-text-content" class="md-nav__link">
    1.  How to Access Text Content
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-adding-a-text-frame-to-a-document" class="md-nav__link">
    2.  Adding a Text Frame to a Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-adding-a-text-embedded-object-to-a-document" class="md-nav__link">
    3.  Adding a Text Embedded Object to a Document
  </a>
  
    <nav class="md-nav" aria-label="3.  Adding a Text Embedded Object to a Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-whats-a-formula-string" class="md-nav__link">
    3.1.  What's a Formula String?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-building-formulae" class="md-nav__link">
    3.2.  Building Formulae
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-text-fields" class="md-nav__link">
    4.  Text Fields
  </a>
  
    <nav class="md-nav" aria-label="4.  Text Fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-the-datetime-textfield" class="md-nav__link">
    4.1.  The DateTime TextField
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-the-pagenumber-and-pagecount-text-fields" class="md-nav__link">
    4.2.  The PageNumber and PageCount Text Fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adding-a-text-table-to-a-document" class="md-nav__link">
    5.  Adding a Text Table to a Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-adding-a-bookmark-to-the-document" class="md-nav__link">
    6.  Adding a Bookmark to the Document
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-how-to-access-text-content" class="md-nav__link">
    1.  How to Access Text Content
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-adding-a-text-frame-to-a-document" class="md-nav__link">
    2.  Adding a Text Frame to a Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-adding-a-text-embedded-object-to-a-document" class="md-nav__link">
    3.  Adding a Text Embedded Object to a Document
  </a>
  
    <nav class="md-nav" aria-label="3.  Adding a Text Embedded Object to a Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-whats-a-formula-string" class="md-nav__link">
    3.1.  What's a Formula String?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-building-formulae" class="md-nav__link">
    3.2.  Building Formulae
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-text-fields" class="md-nav__link">
    4.  Text Fields
  </a>
  
    <nav class="md-nav" aria-label="4.  Text Fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-the-datetime-textfield" class="md-nav__link">
    4.1.  The DateTime TextField
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-the-pagenumber-and-pagecount-text-fields" class="md-nav__link">
    4.2.  The PageNumber and PageCount Text Fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adding-a-text-table-to-a-document" class="md-nav__link">
    5.  Adding a Text Table to a Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-adding-a-bookmark-to-the-document" class="md-nav__link">
    6.  Adding a Bookmark to the Document
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/07-Non-text_Content.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-7-text-content-other-than-strings">Chapter 7. Text Content Other than Strings</h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Accessing Text
Content; Text  Frames;
Embedded Objects
(Math Formulae); Text
Fields; Text Tables;
Bookmarks</p>
<p>Example folders: "Text
Tests" and "Utils"</p>
</div>
<p>Chapter 5 looked at using text cursors to move around
inside text documents, adding or extracting text strings.</p>
<p>That chapter utilized the XText inheritance hierarchy,
which is shown again in Figure 1.</p>
<p><img alt="" src="images/07-Non-text_Content-1.png" /></p>
<p>Figure 1. XText and its Superclasses.</p>
<p>The documents manipulated in Chapter 5 only contained character-based text, but can
be a lot more varied, including text frames, embedded objects, graphics, shapes, text
fields, tables, bookmarks, text sections, footnotes and endnotes, and more.</p>
<p>From the XText service its possible to access the XTextContent interface (see Figure
1), which belongs to the TextContent service. As Figure 2 indicates, that service is the
parent of many subclasses which represent different kinds of text document content.</p>
<p><img alt="" src="images/07-Non-text_Content-2.png" /></p>
<p>Figure 2. The TextContent Service and Some Subclasses.</p>
<p>A more complete hierarchy can be found in the documentation for TextContent
(<code>lodoc TextContent service</code>).</p>
<p>The two services highlighted in orange relate to graphical content, which is explained
in the next chapter.</p>
<p>Table 1 summarizes content types in terms of their services and access methods. Most
of the methods are in Supplier interfaces which are part of the GenericTextDocument
or OfficeDocument services in Figure 2 of Chapter 5.</p>
<p>If the service text is in bold then there's an example of how to manipulate its content
later in this chapter.</p>
<table>
<thead>
<tr>
<th>Content Name</th>
<th>Service for Creating Content</th>
<th>Access Method in Supplier</th>
</tr>
</thead>
<tbody>
<tr>
<td>Text Frame</td>
<td>TextFrame</td>
<td>XNameAccess XTextFrameSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getTextFrames()</td>
</tr>
<tr>
<td>Embedded Object</td>
<td>TextEmbeddedObject</td>
<td>XComponent XTextEmbeddedObjectSupplier2.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getEmbeddedObject()</td>
</tr>
<tr>
<td>Graphic Object</td>
<td>TextGraphicObject;</td>
<td>XNameAccess XTextGraphicObjectsSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getGraphicObjects()</td>
</tr>
<tr>
<td>Shape</td>
<td>text.Shape, drawing.Shape</td>
<td>XDrawPage XDrawPageSupplier.</td>
</tr>
<tr>
<td></td>
<td>or a subclass</td>
<td>getDrawPage()</td>
</tr>
<tr>
<td>Text Field</td>
<td>TextField</td>
<td>XEnumerationAccess XTextFieldsSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getTextFields()</td>
</tr>
<tr>
<td>Text Table</td>
<td>TextTable</td>
<td>XNameAccess XTextTablesSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getTextTables()</td>
</tr>
<tr>
<td>Bookmark</td>
<td>Bookmark</td>
<td>XNameAccess XBookmarksSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getBookmarks()</td>
</tr>
<tr>
<td>Paragraph</td>
<td>Paragraph</td>
<td>XEnumerationAccess on XText</td>
</tr>
<tr>
<td>Text Section</td>
<td>TextSection</td>
<td>XNameAccess XTextSectionsSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getTextSections()</td>
</tr>
<tr>
<td>Footnote</td>
<td>Footnote</td>
<td>XIndexAccess XFootnotesSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getFootnotes()</td>
</tr>
<tr>
<td>End Note</td>
<td>Endnote</td>
<td>XIndexAccess XEndnotesSupplier.getEndnotes()</td>
</tr>
<tr>
<td>Reference Mark</td>
<td>ReferenceMark</td>
<td>XNameAccess XReferenceMarksSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getReferenceMarks()</td>
</tr>
<tr>
<td>Index</td>
<td>DocumentIndex</td>
<td>XIndexAccess XDocumentIndexesSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getDocumentIndexes()</td>
</tr>
<tr>
<td>Link Target</td>
<td>LinkTarget</td>
<td>XNameAccess XLinkTargetSupplier.getLinks()</td>
</tr>
<tr>
<td>Redline</td>
<td>RedlinePortion</td>
<td>XEnumerationAccess XRedlinesSupplier.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>getRedlines()</td>
</tr>
<tr>
<td>Content Metadata</td>
<td>InContentMetaData</td>
<td>XDocumentMetadataAccess</td>
</tr>
</tbody>
</table>
<p>Table 1. Creating and Accessing Text Content.</p>
<p>Rows 3 and 4 are highlighted to indicate that graphical content is discussed in the next
chapter.</p>
<h2 id="1-how-to-access-text-content">1.  How to Access Text Content</h2>
<p>Most of the examples in this chapter create text document content rather than access
it. This is mainly because the different access functions work in a similar way, so you
don’t need many examples to get the general idea.</p>
<p>First the document is converted into a supplier, then its getXXX() method is called
(see column 3 of Table 1). For example, accessing the graphic objects in a document
(see row 3 of Table 1) requires:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// get the graphic objects supplier</span>
<span class="n">XTextGraphicObjectsSupplier</span> <span class="n">imsSupplier</span> <span class="o">=</span>
               <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTextGraphicObjectsSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>

<span class="c1">// access the graphic objects collection</span>
<span class="n">XNameAccess</span> <span class="n">xNameAccess</span> <span class="o">=</span> <span class="n">imsSupplier</span><span class="p">.</span><span class="na">getGraphicObjects</span><span class="p">();</span>
</code></pre></div>
<p>The names associated with the graphic objects in XNameAccess can be extracted with
XNameAccess.getElementNames(), and printed:</p>
<div class="highlight"><pre><span></span><code><span class="n">String</span><span class="o">[]</span> <span class="n">names</span> <span class="o">=</span> <span class="n">xNameAccess</span><span class="p">.</span><span class="na">getElementNames</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Number of graphic names: &quot;</span> <span class="o">+</span> <span class="n">names</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
<span class="n">Arrays</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">names</span><span class="p">);</span>       <span class="c1">// sort them, if you want</span>
<span class="n">Lo</span><span class="p">.</span><span class="na">printNames</span><span class="p">(</span><span class="n">names</span><span class="p">);</span>     <span class="c1">// useful for printing long lists</span>
</code></pre></div>
<p>A particular object in an XNameAccess collection is retrieved with getByName():</p>
<div class="highlight"><pre><span></span><code><span class="n">XInterface</span> <span class="n">oGraphic</span> <span class="o">=</span> <span class="n">xNameAccess</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">);</span>
                    <span class="c1">// get graphic object called &quot;foo&quot;</span>
</code></pre></div>
<p>XInterface is the Office equivalent of Java's Object: every interface subclasses
XInterface.</p>
<p>A common next step is to convert the object into a property set, which makes it
possible to lookup the properties stored in the object's service. For instance, the
graphic object’s filename or URL can be retrieved using:</p>
<div class="highlight"><pre><span></span><code><span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span>  <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">oGraphic</span><span class="p">);</span>
<span class="n">String</span> <span class="n">fnm</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span> <span class="n">props</span><span class="p">.</span><span class="na">getPropertyValue</span><span class="p">(</span><span class="s">&quot;GraphicURL&quot;</span><span class="p">);</span>
</code></pre></div>
<p>I know the graphic object's URL is stored in the "GraphicURL" property from looking
at the documentation for the TextGraphicObject service. It can be (almost) directly
accessed by typing <code>lodoc TextGraphicObject service;</code> unfortunately
DuckDuckGo chooses the TextGraphicObjects service, and you need to click on the
"TextGraphicObject" link below the title to get to the required page.</p>
<p>It's possible to call setPropertyValue() to change a property:
<code>props.setPropertyValue("Transparency", (short)50);</code></p>
<p><strong>What About the Text Content I Don't Cover?</strong></p>
<p>Table 1 has many rows without bold entries, which means I won't be looking at them.</p>
<p>except for the very brief descriptions here; for more please consult the Developer's
Guide at
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Working_with_Text_
Documents (or type <code>loGuide "Working with Text Documents"</code>). All the examples
in that section are in TextDocuments.java at
http://api.libreoffice.org/examples/DevelopersGuide/examples.html#Text.</p>
<p><strong>Text Sections.</strong> A text section is a grouping of paragraphs which can be assigned their
own style settings. More usefully, a section may be located in another file, which is
the mechanism underlying master documents. See:
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Text_Sections (or
type <code>loGuide "Text Sections"</code>).</p>
<p><strong>Footnotes and Endnotes.</strong> Footnotes and endnotes are blocks of text that appear in the
page footers and at the end of a document. They can be treated as XText objects, so
manipulated using the same techniques as the main document text. See:
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Footnotes_and_Endn
otes (or type <code>loGuide Footnotes</code>).</p>
<p><strong>Reference Marks.</strong> Reference marks can be inserted throughout a document, and then
jumped to via GetReference text fields:
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Reference_Marks (or
type <code>loGuide "Reference Marks"</code>).</p>
<p><strong>Indexes and Index Marks.</strong> Index marks, like reference marks, can be inserted
anywhere in a document, but are used to generate indices (collections of information)
inside the document. There are several types of index marks used for generating lists
of chapter headings (i.e. a book's index), lists of key words, illustrations, tables, and a
bibliography. For details see:
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Indexes_and_Index_
Marks (or type <code>loGuide Indexes</code>).</p>
<p><strong>Link Targets.</strong> A link target (sometimes called a jump mark) labels a location inside a
document. These labels can be included as part of a filename so that the document can
be opened at that position. For information, see:
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Link_Targets (or
type <code>loGuide "Link Targets"</code>).</p>
<p><strong>Redlines.</strong> Redlines are the changes recorded when a user edits a document with track
changes turned on. Each of the changes is saved as a text fragment (also called a text
portion) inside a redline object. See:
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Redline (or type
<code>loGuide Redline</code>).</p>
<h2 id="2-adding-a-text-frame-to-a-document">2.  Adding a Text Frame to a Document</h2>
<p>The TextFrame service inherits many of its properties and interfaces, so its
inheritance hierarchy is shown in detail in Figure 3.</p>
<p><img alt="" src="images/07-Non-text_Content-3.png" /></p>
<p>Figure 3. The TextFrame Service Hierarchy.</p>
<p>Figure 3 includes two sibling services of TextFrame: TextEmbeddedObject and
TextGraphicObject, which I'll discuss a bit later; infact, I'll only get around to
TextGraphicObject in the next chapter.</p>
<p>The BaseFrameProperties service contains most of the frame size and positional
properties, such as "Width", "Height", and margin and border distance settings.</p>
<p>A TextFrame interface can be converted into a text content (i.e. XTextContent) or a
shape (i.e. XShape). Typically, the former is used when adding text to the frame, the
latter when manipulating the shape of the frame.</p>
<p>In my BuildDoc.java example, text frame creation is done by Write.addTextFrame(),
with BuildDoc supplying the frame's y-axis coordinate position for its anchor:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// code fragment in BuildDoc.java</span>
<span class="n">XTextViewCursor</span> <span class="n">tvc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getViewCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">yPos</span> <span class="o">=</span> <span class="n">tvc</span><span class="p">.</span><span class="na">getPosition</span><span class="p">().</span><span class="na">Y</span><span class="p">;</span>   <span class="c1">// y-axis anchor position</span>

        <span class="p">:</span>  <span class="c1">// other unrelated code</span>

<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;A text frame&quot;</span><span class="p">);</span>

<span class="n">Write</span><span class="p">.</span><span class="na">addTextFrame</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">yPos</span><span class="p">,</span>
       <span class="s">&quot;This is a newly created text frame.\n</span>
<span class="s">        Which is over on the right of the page, next to the code.&quot;</span><span class="p">,</span>
            <span class="mi">4000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">);</span>   <span class="c1">// width x height of frame</span>
</code></pre></div>
<p>An anchor specifies how the text content is positioned relative to the ordinary text
around it. Anchoring can be relative to a character, paragraph, page, or another frame.</p>
<p>Write.addTextFrame() uses page anchoring, which means that BuildDoc must obtain
a view cursor, so that an on-screen page position can be calculated. As Figure 4
shows, the text frame is located on the right of the page, with its top edge level with
the start of the code listing.</p>
<p><img alt="" src="images/07-Non-text_Content-4.png" /></p>
<p>Figure 4. Text Frame Position in the Document.</p>
<p>In the code fragment above, Write.getViewCursor() creates the view cursor, and
XTextViewCursor.getPosition() returns its (x, y) coordinate on the page. The y-
coordinate is stored in yPos until after the code listing has been inserted into the
document, and then passed to Write.addTextFrame().</p>
<p>Write.addTextFrame() is defined as:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addTextFrame</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span> <span class="kt">int</span> <span class="n">yPos</span><span class="p">,</span>
                           <span class="n">String</span> <span class="n">text</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">XTextFrame</span> <span class="n">xFrame</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XTextFrame</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                            <span class="s">&quot;com.sun.star.text.TextFrame&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xFrame</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not create a text frame&quot;</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// convert frame to a shape interface; set size</span>
    <span class="n">XShape</span> <span class="n">tfShape</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XShape</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xFrame</span><span class="p">);</span>
    <span class="n">tfShape</span><span class="p">.</span><span class="na">setSize</span><span class="p">(</span><span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">));</span>

    <span class="c1">// get properties of the frame</span>
    <span class="n">XPropertySet</span> <span class="n">frameProps</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xFrame</span><span class="p">);</span>

    <span class="c1">// anchor the text frame to the page</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;AnchorType&quot;</span><span class="p">,</span>
                          <span class="n">TextContentAnchorType</span><span class="p">.</span><span class="na">AT_PAGE</span><span class="p">);</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FrameIsAutomaticHeight&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                                      <span class="c1">// will grow if necessary</span>

    <span class="c1">// add a red border around all 4 sides</span>
    <span class="n">BorderLine</span> <span class="n">border</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BorderLine</span><span class="p">();</span>
    <span class="n">border</span><span class="p">.</span><span class="na">OuterLineWidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">border</span><span class="p">.</span><span class="na">Color</span> <span class="o">=</span> <span class="mh">0xFF0000</span><span class="p">;</span>  <span class="c1">// red</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;TopBorder&quot;</span><span class="p">,</span> <span class="n">border</span><span class="p">);</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;BottomBorder&quot;</span><span class="p">,</span> <span class="n">border</span><span class="p">);</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;LeftBorder&quot;</span><span class="p">,</span> <span class="n">border</span><span class="p">);</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;RightBorder&quot;</span><span class="p">,</span> <span class="n">border</span><span class="p">);</span>

    <span class="c1">// make the text frame blue</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;BackTransparent&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
                                           <span class="c1">// not transparent</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;BackColor&quot;</span><span class="p">,</span> <span class="mh">0xCCCCFF</span><span class="p">);</span>   <span class="c1">// blue</span>

    <span class="c1">// set the horizontal and vertical position</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;HoriOrient&quot;</span><span class="p">,</span>
                                <span class="n">HoriOrientation</span><span class="p">.</span><span class="na">RIGHT</span><span class="p">);</span>

    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;VertOrient&quot;</span><span class="p">,</span>
                                <span class="n">VertOrientation</span><span class="p">.</span><span class="na">NONE</span><span class="p">);</span>
    <span class="n">frameProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;VertOrientPosition&quot;</span><span class="p">,</span> <span class="n">yPos</span><span class="p">);</span>
                                                 <span class="c1">// down from top</span>

    <span class="c1">// insert empty text frame into document</span>
    <span class="n">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">xFrame</span><span class="p">);</span>
    <span class="n">endParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>

    <span class="c1">// add text to the text frame</span>
    <span class="n">XText</span> <span class="n">xFrameText</span> <span class="o">=</span> <span class="n">xFrame</span><span class="p">.</span><span class="na">getText</span><span class="p">();</span>
    <span class="n">XTextCursor</span> <span class="n">xFrameCursor</span> <span class="o">=</span> <span class="n">xFrameText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>
    <span class="n">xFrameText</span><span class="p">.</span><span class="na">insertString</span><span class="p">(</span><span class="n">xFrameCursor</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Insertion of text frame failed: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of addTextFrame()</span>
</code></pre></div>
<p>addTextFrame() starts by creating a TextFrame service, and accessing its XTextFrame
interface:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextFrame</span> <span class="n">xFrame</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XTextFrame</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                                <span class="s">&quot;com.sun.star.text.TextFrame&quot;</span><span class="p">);</span>
</code></pre></div>
<p>The service name for a text frame is listed as "TextFrame" in row 1 of Table 1, but
Lo.createInstanceMSF() requires a fully qualified name. Almost all the text content
services, including TextFrame, are in the com.sun.star.text package.</p>
<p>The XTextFrame interface is converted into XShape so the frame's dimensions can be
set. The interface is also cast to XPropertySet so that various frame properties can be
initialized; these properties are defined in the TextFrame and BaseFrameProperties
services (see Figure 3).</p>
<p>The "AnchorType" property uses the AT_PAGE anchor constant to tie the frame to
the page. There are five anchor constants: AT_PARAGRAPH, AT_CHARACTER,
AS_CHARACTER, AT_PAGE, and AT_FRAME, which are defined in the
TextContentAnchorType enumeration.</p>
<p>The difference between AT_CHARACTER and AS_CHARACTER relates to how
the surrounding text is wrapped around the text content. "AS" means that the text
content is treated as a single (perhaps very large) character inside the text, while "AT"
means that the text frame's upper-left corner is positioned at that character location.</p>
<p>The frame's page position is dealt with a few lines later by the "HoriOrient" and
"VertOrient" properties. The HoriOrientation and VertOrientation constants are a
convenient way of positioning a frame at the corners or edges of the page. However, I
use "VertOrientPosition" to set the vertical position using the yPos coordinate, and
switch off the "VertOrient" vertical orientation.</p>
<p>Towards the end of Write.addTextFrame(), the frame is added to the document by
calling a version of Write.append() that expects an XTextContent object:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Write class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">append</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span>
                                 <span class="n">XTextContent</span> <span class="n">textContent</span><span class="p">)</span>
<span class="c1">// append text content such as a text frame, table, text field</span>
<span class="p">{</span>
  <span class="n">XText</span> <span class="n">xText</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="na">getText</span><span class="p">();</span>
  <span class="n">xText</span><span class="p">.</span><span class="na">insertTextContent</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">textContent</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
  <span class="n">cursor</span><span class="p">.</span><span class="na">gotoEnd</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">getPosition</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>It utilizes the XText.insertTextContent() method.</p>
<p>The last task of Write.addTextFrame(), is to insert some text into the frame.</p>
<p>XTextFrame inherits XTextContent, and so has access to the getText() method (see
Figure 3). This means that all the text manipulations possible in a document are also
possible inside a frame.</p>
<p>The ordering of the tasks at the end of addTextFrame() is important. Office prefers
that an empty text content be added to the document, and the data inserted afterwards.</p>
<h2 id="3-adding-a-text-embedded-object-to-a-document">3.  Adding a Text Embedded Object to a Document</h2>
<p>Text embedded object content support OLE (Microsoft's Object Linking and
Embedding), and is typically used to create a frame linked to an external Office
document. Probably, its most popular use is to link to a chart, but I'll delay looking at
that until Chapter 33.</p>
<p>The best way of getting an idea of what OLE objects are available is to go to the
Writer application's Insert menu, Object, "OLE Object" dialog. In my version of
Office, it lists Office spreadsheet, chart, drawing, presentation, and formula
documents, and a range of Microsoft and PDF types.</p>
<p>Note that text embedded objects aren't utilized for adding graphics to a document.</p>
<p>That's easier to do using the TextGraphicObject or GraphicObjectShape services,
which I'll describe next.</p>
<p>In this section I'll explain how to insert mathematical formulae into a text document.</p>
<p>The example code is in MathQuestions.java, but most of the formula embedding is
performed by Write.addFormula():</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addFormula</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">String</span> <span class="n">formula</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">XTextContent</span> <span class="n">embedContent</span> <span class="o">=</span>
              <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XTextContent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                      <span class="s">&quot;com.sun.star.text.TextEmbeddedObject&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">embedContent</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not create a formula&quot;</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// get property set for the embedded object</span>
    <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span>  <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">embedContent</span><span class="p">);</span>

    <span class="c1">// set class ID (type) for object</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CLSID&quot;</span><span class="p">,</span> <span class="n">Lo</span><span class="p">.</span><span class="na">MATH_CLSID</span><span class="p">);</span>

    <span class="c1">// anchor object as a character</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;AnchorType&quot;</span><span class="p">,</span>
                            <span class="n">TextContentAnchorType</span><span class="p">.</span><span class="na">AS_CHARACTER</span><span class="p">);</span>

    <span class="c1">// insert empty object into document</span>
    <span class="n">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">embedContent</span><span class="p">);</span>
    <span class="n">endLine</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>

    <span class="c1">// access object&#39;s model</span>
    <span class="n">XEmbeddedObjectSupplier2</span> <span class="n">supp</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span>
                 <span class="n">XEmbeddedObjectSupplier2</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">embedContent</span><span class="p">);</span>
    <span class="n">XComponent</span> <span class="n">oEmbed</span> <span class="o">=</span> <span class="n">supp</span><span class="p">.</span><span class="na">getEmbeddedObject</span><span class="p">();</span>

    <span class="c1">// insert formula into the object</span>
    <span class="n">XPropertySet</span> <span class="n">formulaProps</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">oEmbed</span><span class="p">);</span>
    <span class="n">formulaProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;Formula&quot;</span><span class="p">,</span> <span class="n">formula</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="n">formula</span> <span class="o">+</span> <span class="s">&quot;\&quot; failed: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of addFormula()</span>
</code></pre></div>
<p>A math formula is passed to addFormula() as a string in a format I'll explain shortly.</p>
<p>The method begins by creating a TextEmbeddedObject service, and referring to it
using the XTextContent interface:</p>
<div class="highlight"><pre><span></span><code><span class="n">XTextContent</span> <span class="n">embedContent</span> <span class="o">=</span>
     <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XTextContent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                   <span class="s">&quot;com.sun.star.text.TextEmbeddedObject&quot;</span><span class="p">);</span>
</code></pre></div>
<p>Details about embedded objects are given in row 2 of Table 1.</p>
<p>Unlike TextFrame which has an XTextFrame interface, there's no
XTextEmbeddedObject interface for TextEmbeddedObject. This can be confirmed by
looking at the TextFrame inheritance hierarchy in Figure 3. There is an
XEmbeddedObjectSuppler, but that's for accessing objects, not creating them. Instead
I've utilized the XTextContent interface in Lo.createInstanceMSF() because it's the
most specific interface available.</p>
<p>The XTextContent interface is converted to XPropertySet so the "CLSID" and
"AnchorType" properties can be set. "CLSID" is specific to TextEmbeddedObject –
its value is the OLE class ID for the embedded document. The Lo.java utility contains
the class ID constants for Office's documents:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Lo class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">WRITER_CLSID</span> <span class="o">=</span>
                     <span class="s">&quot;8BC6B165-B1B2-4EDD-aa47-dae2ee689dd6&quot;</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">CALC_CLSID</span> <span class="o">=</span>
                     <span class="s">&quot;47BBB4CB-CE4C-4E80-a591-42d9ae74950f&quot;</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">DRAW_CLSID</span> <span class="o">=</span>
                     <span class="s">&quot;4BAB8970-8A3B-45B3-991c-cbeeac6bd5e3&quot;</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">IMPRESS_CLSID</span> <span class="o">=</span>
                     <span class="s">&quot;9176E48A-637A-4D1F-803b-99d9bfac1047&quot;</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">MATH_CLSID</span> <span class="o">=</span>
                     <span class="s">&quot;078B7ABA-54FC-457F-8551-6147e776a997&quot;</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">CHART_CLSID</span> <span class="o">=</span>
                     <span class="s">&quot;12DCAE26-281F-416F-a234-c3086127382e&quot;</span><span class="p">;</span>
</code></pre></div>
<p>The "AnchorType" property is set to AS_CHARACTER so the formula string will be
anchored in the document in the same way as a string of characters.</p>
<p>As with the text frame in Write.addTextFrame(), an empty text content is added to the
document first, then filled with the formula.</p>
<p>The embedded object's content is accessed via the XEmbeddedObjectSupplier2
interface which has a get method for obtaining the object:</p>
<div class="highlight"><pre><span></span><code><span class="n">XEmbeddedObjectSupplier2</span> <span class="n">supp</span> <span class="o">=</span>
       <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XEmbeddedObjectSupplier2</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">embedContent</span><span class="p">);</span>
<span class="n">XComponent</span> <span class="n">oEmbed</span> <span class="o">=</span> <span class="n">supp</span><span class="p">.</span><span class="na">getEmbeddedObject</span><span class="p">();</span>
</code></pre></div>
<p>The properties for this empty object (oEmbed) are accessed, and the formula string is
assigned to the "Formula" property:</p>
<p>XPropertySet formulaProps = Lo.qi(XPropertySet.class, oEmbed);
formulaProps.setPropertyValue("Formula", formula);</p>
<h3 id="31-whats-a-formula-string">3.1.  What's a Formula String?</h3>
<p>Although I've explained the working of Write.addFormula(), I haven't explained the
format of the formula string that's passed to it. There's a good overview of the
notation in the "Commands Reference" appendix of Office's "Math Guide", available
at https://www.libreoffice.org/get-help/documentation/
For example, the formula string:
"1 {5}over{9} + 3 {5}over{9} = 5 {1}over{9}"
is rendered as:</p>
<p>[<strong><em> Formula did not render in MarkDown </em></strong>]</p>
<h3 id="32-building-formulae">3.2.  Building Formulae</h3>
<p>MathQuestions.java is mainly a for-loop for randomly generating numbers and
constructing simple formulae strings. Ten formulae are added to the document, which
is saved as "mathQuestions.pdf". The main() function:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XTextDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">createDoc</span><span class="p">(</span><span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Writer doc creation failed&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Math Questions&quot;</span><span class="p">);</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">stylePrevParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Heading 1&quot;</span><span class="p">);</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Solve the formulae for x:\n&quot;</span><span class="p">);</span>

  <span class="n">Random</span> <span class="n">r</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="p">();</span>
  <span class="n">String</span> <span class="n">formula</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// generate 10 formulae</span>
    <span class="kt">int</span> <span class="n">iA</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>     <span class="c1">// generate some integers</span>
    <span class="kt">int</span> <span class="n">iB</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">iC</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">iD</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">iE</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">iF1</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="c1">// decide between 3 formulae</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">choice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">formula</span> <span class="o">=</span> <span class="s">&quot;{{{sqrt{&quot;</span> <span class="o">+</span> <span class="n">iA</span> <span class="o">+</span> <span class="s">&quot;x}} over &quot;</span> <span class="o">+</span> <span class="n">iB</span> <span class="o">+</span> <span class="s">&quot;} +</span>
<span class="s">                  {&quot;</span> <span class="o">+</span> <span class="n">iC</span> <span class="o">+</span> <span class="s">&quot; over &quot;</span> <span class="o">+</span> <span class="n">iD</span> <span class="o">+</span>
                   <span class="s">&quot;}={&quot;</span> <span class="o">+</span> <span class="n">iE</span> <span class="o">+</span> <span class="s">&quot; over &quot;</span> <span class="o">+</span> <span class="n">iF1</span> <span class="o">+</span> <span class="s">&quot;}}&quot;</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">choice</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">formula</span> <span class="o">=</span> <span class="s">&quot;{{{&quot;</span> <span class="o">+</span> <span class="n">iA</span> <span class="o">+</span> <span class="s">&quot;x} over &quot;</span> <span class="o">+</span> <span class="n">iB</span> <span class="o">+</span> <span class="s">&quot;} +</span>
<span class="s">                  {&quot;</span> <span class="o">+</span> <span class="n">iC</span> <span class="o">+</span> <span class="s">&quot; over &quot;</span> <span class="o">+</span> <span class="n">iD</span> <span class="o">+</span>
                  <span class="s">&quot;}={&quot;</span> <span class="o">+</span> <span class="n">iE</span> <span class="o">+</span> <span class="s">&quot; over &quot;</span> <span class="o">+</span> <span class="n">iF1</span> <span class="o">+</span> <span class="s">&quot;}}&quot;</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="n">formula</span> <span class="o">=</span> <span class="s">&quot;{&quot;</span> <span class="o">+</span> <span class="n">iA</span> <span class="o">+</span> <span class="s">&quot;x + &quot;</span> <span class="o">+</span> <span class="n">iB</span> <span class="o">+</span> <span class="s">&quot; =&quot;</span> <span class="o">+</span> <span class="n">iC</span> <span class="o">+</span> <span class="s">&quot;}&quot;</span><span class="p">;</span>

    <span class="n">Write</span><span class="p">.</span><span class="na">addFormula</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">formula</span><span class="p">);</span>
    <span class="n">Write</span><span class="p">.</span><span class="na">endParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Timestamp: &quot;</span> <span class="o">+</span> <span class="n">Lo</span><span class="p">.</span><span class="na">getTimeStamp</span><span class="p">()</span>  <span class="o">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">saveDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;mathQuestions.pdf&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span> <span class="c1">// end of main()</span>
</code></pre></div>
<p>Figure 5 shows a screenshot of part of mathQuestions.pdf.</p>
<p><img alt="" src="images/07-Non-text_Content-5.png" /></p>
<p>Figure 5. Math Formulae in a Text Document.</p>
<h2 id="4-text-fields">4.  Text Fields</h2>
<p>A text field differs from other text content in that its data is generated dynamically by
the document, or by an external source such as a database . Document-generated text
fields include text showing the current date, the page number, the total number of
pages in the document, and cross-references to other areas in the text. I'll look at three
examples: the DateTime, PageNumber, and PageCount text fields.</p>
<p>When a text field depends on an external source, there are two fields to initialize: the
master field representing the external source, and the dependent field for the data used
in the document; only the dependent field is visible. I won't be giving any
dependent/master field examples, but there's one in the Development Guide section
on text fields, at:
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Text/Text_Fields (or type
<code>loGuide "Text Fields"</code>).</p>
<p>It utilizes the User master field, which allows the external source to be user-defined
data. The code appears in the TextDocuments.java example at
http://api.libreoffice.org/examples/DevelopersGuide/examples.html#Text.</p>
<p>Different  kinds of text field are implemented as subclasses of the TextField service.
You can see the complete hierarchy in the online documentation for TextField
(<code>lodoc TextField service</code>). Figure 6 presents a simplified version.</p>
<p><img alt="" src="images/07-Non-text_Content-6.png" /></p>
<p>Figure 6. Simplified Hierarchy for the TextField Service.</p>
<h3 id="41-the-datetime-textfield">4.1.  The DateTime TextField</h3>
<p>The BuildDoc.java example ends with a few lines that appear to do the same thing
twice:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// code fragment from BuildDoc.java</span>
<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;\nTimestamp: &quot;</span> <span class="o">+</span> <span class="n">Lo</span><span class="p">.</span><span class="na">getTimeStamp</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;\n&quot;</span><span class="p">);</span>

<span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Time (according to office): &quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">appendDateTime</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">endParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
</code></pre></div>
<p>Lo.getTimeStamp() inserts a timestamp (which includes the date and time), and then
Write.appendDateTime() inserts the date and time. Although these may seem to be the
same, getTimeStamp() adds a string while appendDateTime() creates a text field. The
difference becomes apparent if you open the file some time after it was created.</p>
<p>Figure 7 shows two screenshots of the time-stamped parts of the document taken after
it was first generated, and nearly 50 minutes later.</p>
<p><img alt="" src="images/07-Non-text_Content-7.png" /></p>
<p>Figure 7. Screenshots of the Timestamps.</p>
<p>The text field timestamp is updated each time the file is opened in edit mode (which is
the default in Writer).</p>
<p>This dynamic updating occurs in all text fields. For example, if you add some pages to
a document, all the places in the document that use the PageCount text field will be
updated to show the new length.</p>
<p>Write.appendDateTime() creates a DateTime service, and returns its XTextField
interface (see Figure 6). The TextField service only contains two properties, with
most being in the subclass (DateTime in this case).</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">appendDateTime</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XTextField</span> <span class="n">dtField</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XTextField</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                 <span class="s">&quot;com.sun.star.text.TextField.DateTime&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dtField</span><span class="p">,</span> <span class="s">&quot;IsDate&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                      <span class="c1">// so date is reported</span>
  <span class="n">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">dtField</span><span class="p">);</span>
  <span class="n">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;; &quot;</span><span class="p">);</span>

  <span class="n">dtField</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XTextField</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                 <span class="s">&quot;com.sun.star.text.TextField.DateTime&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dtField</span><span class="p">,</span> <span class="s">&quot;IsDate&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
                      <span class="c1">// so time is reported</span>
  <span class="k">return</span> <span class="n">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">dtField</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of appendDateTime()</span>
</code></pre></div>
<p>The method adds two DateTime text fields to the document. The first has its "IsDate"
property set to true, so that the current date is inserted; the second sets "IsDate" to
false so the current time is shown.</p>
<h3 id="42-the-pagenumber-and-pagecount-text-fields">4.2.  The PageNumber and PageCount Text Fields</h3>
<p>I discussed most of StoryCreator.java in Chapter 6 on styles, but skipped over how
page numbers were added to the document's page footer. The footer is shown in
Figure 8.</p>
<p><img alt="" src="images/07-Non-text_Content-8.png" /></p>
<p>Figure 8. Page Footer using Text Fields.</p>
<p>Write.setPageNumbers() inserts the PageNumber and PageCount text fields into the
footer's text area:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Write class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setPageNumbers</span><span class="p">(</span><span class="n">XTextDocument</span> <span class="n">textDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// get &#39;standard&#39; style for page style family</span>
  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">getStyleProps</span><span class="p">(</span><span class="n">textDoc</span><span class="p">,</span>
                                    <span class="s">&quot;PageStyles&quot;</span><span class="p">,</span> <span class="s">&quot;Standard&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">props</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access standard page style&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FooterIsOn&quot;</span><span class="p">,</span> <span class="n">Boolean</span><span class="p">.</span><span class="na">TRUE</span><span class="p">);</span>
                  <span class="c1">// footer must be turned on in the document</span>

    <span class="c1">// access the footer as XText</span>
    <span class="n">XText</span> <span class="n">footerText</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                           <span class="n">props</span><span class="p">.</span><span class="na">getPropertyValue</span><span class="p">(</span><span class="s">&quot;FooterText&quot;</span><span class="p">));</span>
    <span class="n">XTextCursor</span> <span class="n">footerCursor</span> <span class="o">=</span> <span class="n">footerText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>

    <span class="cm">/* set footer text properties via its cursor:</span>
<span class="cm">       font, font size, paragraph orientation    */</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="s">&quot;CharFontName&quot;</span><span class="p">,</span>
                                    <span class="s">&quot;Times New Roman&quot;</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="s">&quot;CharHeight&quot;</span><span class="p">,</span> <span class="mf">12.0f</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="s">&quot;ParaAdjust&quot;</span><span class="p">,</span>
                                    <span class="n">ParagraphAdjust</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span>

    <span class="c1">// add text fields to the footer</span>
    <span class="n">append</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="n">getPageNumber</span><span class="p">());</span>
    <span class="n">append</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="s">&quot; of &quot;</span><span class="p">);</span>
    <span class="n">append</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="n">getPageCount</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span> <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setPageNumbers()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XTextField</span> <span class="nf">getPageNumber</span><span class="p">()</span>
<span class="c1">// return Arabic style number showing current page value</span>
<span class="p">{</span>
  <span class="n">XTextField</span> <span class="n">numField</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XTextField</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                           <span class="s">&quot;com.sun.star.text.TextField.PageNumber&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">numField</span><span class="p">,</span> <span class="s">&quot;NumberingType&quot;</span><span class="p">,</span>
                               <span class="n">NumberingType</span><span class="p">.</span><span class="na">ARABIC</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">numField</span><span class="p">,</span> <span class="s">&quot;SubType&quot;</span><span class="p">,</span> <span class="n">PageNumberType</span><span class="p">.</span><span class="na">CURRENT</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">numField</span><span class="p">;</span>
<span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XTextField</span> <span class="nf">getPageCount</span><span class="p">()</span>
<span class="c1">// return Arabic style number showing current page count</span>
<span class="p">{</span>
  <span class="n">XTextField</span> <span class="n">pcField</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XTextField</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                          <span class="s">&quot;com.sun.star.text.TextField.PageCount&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">pcField</span><span class="p">,</span> <span class="s">&quot;NumberingType&quot;</span><span class="p">,</span>
                              <span class="n">NumberingType</span><span class="p">.</span><span class="na">ARABIC</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">pcField</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Write.setPageNumbers() starts by accessing the "Standard" property set (style) for the
page style family. Via its properties, the method turns on footer functionality and
accesses the footer text area as an XText object.</p>
<p>An XTextCursor is created for the footer text area, and properties are configured:</p>
<div class="highlight"><pre><span></span><code><span class="n">XText</span> <span class="n">footerText</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                      <span class="n">props</span><span class="p">.</span><span class="na">getPropertyValue</span><span class="p">(</span><span class="s">&quot;FooterText&quot;</span><span class="p">));</span>

<span class="n">XTextCursor</span> <span class="n">footerCursor</span> <span class="o">=</span> <span class="n">footerText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>

<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="s">&quot;CharFontName&quot;</span><span class="p">,</span> <span class="s">&quot;Times New Roman&quot;</span><span class="p">);</span>
</code></pre></div>
<p>These properties will be applied to the text and text fields added afterwards:</p>
<div class="highlight"><pre><span></span><code><span class="n">append</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="n">getPageNumber</span><span class="p">());</span>
<span class="n">append</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="s">&quot; of &quot;</span><span class="p">);</span>
<span class="n">append</span><span class="p">(</span><span class="n">footerCursor</span><span class="p">,</span> <span class="n">getPageCount</span><span class="p">());</span>
</code></pre></div>
<p>getPageNumber() and getPageCount() deal with the properties for the PageNumber
and PageCount fields.</p>
<p>I found out about them by looking at the documentation for their services  (e.g. use
<code>lodoc TextField.PageNumber</code> service; "TextField." is needed due to PageNumber
being a common word).</p>
<h2 id="5-adding-a-text-table-to-a-document">5.  Adding a Text Table to a Document</h2>
<p>The MakeTable.java example reads in data about James Bond movies from
"bondMovies.txt" and stores it as a text table in "table.odt". The first few rows are
shown in Figure 9.</p>
<p><img alt="" src="images/07-Non-text_Content-9.png" /></p>
<p>Figure 9. A Bond Movies Table.</p>
<p>The "bondMovies.txt" file is read by readTable() utilizing standard Java file
processing. It returns a list of String arrays:</p>
<div class="highlight"><pre><span></span><code><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">[]&gt;</span> <span class="n">rowsList</span> <span class="o">=</span> <span class="n">readTable</span><span class="p">(</span><span class="s">&quot;bondMovies.txt&quot;</span><span class="p">);</span>
</code></pre></div>
<p>Each line in "bondMovies.txt" is converted into a string array by pulling out the
substrings delimited by tab characters.</p>
<p>readTable() ignores blank lines in the file, and lines beginning with "//". Also, I
assume that the first row in the list contains the table's header text.</p>
<p>The first few lines of "bondMovies.txt" are:</p>
<div class="highlight"><pre><span></span><code>// http://en.wikipedia.org/wiki/James_Bond#Ian_Fleming_novels

Title  Year  Actor  Director

Dr. No  1962  Sean Connery  Terence Young
From Russia with Love  1963  Sean Connery  Terence Young
Goldfinger  1964  Sean Connery  Guy Hamilton
Thunderball  1965  Sean Connery  Terence Young
You Only Live Twice  1967  Sean Connery  Lewis Gilbert
On Her Majesty&#39;s Secret Service 1969 George Lazenby  Peter R. Hunt
Diamonds Are Forever  1971  Sean Connery  Guy Hamilton
Live and Let Die  1973  Roger Moore  Guy Hamilton
The Man with the Golden Gun  1974  Roger Moore  Guy Hamilton
     :
</code></pre></div>
<p>The main() function for MakeTable.java is:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>

  <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">[]&gt;</span> <span class="n">rowsList</span> <span class="o">=</span> <span class="n">readTable</span><span class="p">(</span><span class="s">&quot;bondMovies.txt&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">rowsList</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No data read from bondMovies.txt&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XTextDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">createDoc</span><span class="p">(</span><span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Writer doc creation failed&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Table of Bond Movies&quot;</span><span class="p">);</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">stylePrevParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Heading 1&quot;</span><span class="p">);</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span>
     <span class="s">&quot;The following table comes from \&quot;bondMovies.txt\&quot;:\n&quot;</span><span class="p">);</span>

  <span class="n">Write</span><span class="p">.</span><span class="na">addTable</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">rowsList</span><span class="p">);</span>

  <span class="n">Write</span><span class="p">.</span><span class="na">endParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
  <span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Timestamp: &quot;</span> <span class="o">+</span> <span class="n">Lo</span><span class="p">.</span><span class="na">getTimeStamp</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">saveDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;table.odt&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span> <span class="c1">// end of main()</span>
</code></pre></div>
<p>Write.addTable() does the work of converting the list of rows into a text table.</p>
<p>Figure 10 shows the hierarchy for the TextTable service: it's a subclass of
TextContent and supports the XTextTable interface.</p>
<p><img alt="" src="images/07-Non-text_Content-10.png" /></p>
<p>Figure 10. The TextTable Hierarchy.</p>
<p>XTextTable contains methods for accessing a table in terms of its rows, columns, and
cells. The cells are referred to using names, based on letters for columns and integers
for rows, as in Figure 11.</p>
<p><img alt="" src="images/07-Non-text_Content-11.png" /></p>
<p>Figure 11. The Cell Names in a Table.</p>
<p>Write.addTable() uses this naming scheme in the XTextTable.getCellByName()
method to assign data to cells:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addTable</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span>
                                 <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">[]&gt;</span> <span class="n">rowsList</span><span class="p">)</span>
<span class="c1">// part of the Write utility class</span>
<span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// create a text table</span>
    <span class="n">XTextTable</span> <span class="n">table</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XTextTable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                                  <span class="s">&quot;com.sun.star.text.TextTable&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">table</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not create a text table&quot;</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// initialize table dimensions</span>
    <span class="kt">int</span> <span class="n">numRows</span> <span class="o">=</span> <span class="n">rowsList</span><span class="p">.</span><span class="na">size</span><span class="p">();</span>
    <span class="kt">int</span> <span class="n">numCols</span> <span class="o">=</span> <span class="p">(</span><span class="n">rowsList</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)).</span><span class="na">length</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">numCols</span> <span class="o">&gt;</span> <span class="mi">26</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// column labelling goes from &#39;A&#39; to &#39;Z&#39;</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Too many columns: &quot;</span> <span class="o">+</span> <span class="n">numCols</span> <span class="o">+</span>
                                        <span class="s">&quot;; using first 26&quot;</span><span class="p">);</span>
      <span class="n">numCols</span> <span class="o">=</span> <span class="mi">26</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">table</span><span class="p">.</span><span class="na">initialize</span><span class="p">(</span><span class="n">numRows</span><span class="p">,</span> <span class="n">numCols</span><span class="p">);</span>

    <span class="c1">// add the table to the document</span>
    <span class="n">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">table</span><span class="p">);</span>
    <span class="n">endParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>

    <span class="c1">// set table properties</span>
    <span class="n">XPropertySet</span> <span class="n">tableProps</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">table</span><span class="p">);</span>
    <span class="n">tableProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;BackTransparent&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
                                         <span class="c1">// not transparent</span>
    <span class="n">tableProps</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;BackColor&quot;</span><span class="p">,</span> <span class="mh">0xCCCCFF</span><span class="p">);</span>
                                         <span class="c1">// light blue</span>

    <span class="c1">// set color of first row (i.e. the header) to dark blue</span>
    <span class="n">XTableRows</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="na">getRows</span><span class="p">();</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">rows</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">&quot;BackColor&quot;</span><span class="p">,</span> <span class="mh">0x666694</span><span class="p">);</span>
                                         <span class="c1">// dark blue</span>
    <span class="c1">// write table header</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">rowData</span> <span class="o">=</span> <span class="n">rowsList</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">numCols</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span>
      <span class="n">setCellHeader</span><span class="p">(</span> <span class="n">mkCellName</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">rowData</span><span class="o">[</span><span class="n">x</span><span class="o">]</span><span class="p">,</span> <span class="n">table</span><span class="p">);</span>
                         <span class="c1">// e.g. &quot;A1&quot;, &quot;B1&quot;, &quot;C1&quot;, etc.</span>


    <span class="c1">// insert table body</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">numRows</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">// start in 2nd row of list</span>
      <span class="n">rowData</span> <span class="o">=</span> <span class="n">rowsList</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">numCols</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span>
        <span class="n">setCellText</span><span class="p">(</span> <span class="n">mkCellName</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">rowData</span><span class="o">[</span><span class="n">x</span><span class="o">]</span><span class="p">,</span> <span class="n">table</span><span class="p">);</span>
                         <span class="c1">// e.g. &quot;A2&quot;, &quot;B5&quot;, &quot;C3&quot;, etc.</span>

    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Table insertion failed:&quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span>  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of addTable()</span>
</code></pre></div>
<p>A TextTable service with an XTableText interface is created at the start of
addTable(). Then the required number of rows and columns is calculated so that
XTextTable.initialize() can be called to specify the table's dimensions.</p>
<p>Table-wide properties are set (properties are listed in the TextTable documentation).
Note that if "BackTransparent" isn't set to false then Office crashes when the program
tries to save the document.</p>
<p>The color property of the header row is set to dark blue. This requires a call to
XTextTable.getRows() to return an XTableRows object representing all the rows.
This object inherits XIndexAccess, so the first row is accessed with index 0.</p>
<p>The filling of the table with data is performed by two loops. The first deals with
adding text to the header row, the second deals with all the other rows.</p>
<p>mkCellName() converts an (x, y) integer pair into a cell name like those in Figure 11:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">mkCellName</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="s">&quot;&quot;</span> <span class="o">+</span> <span class="p">((</span><span class="kt">char</span><span class="p">)(</span><span class="sc">&#39;A&#39;</span> <span class="o">+</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">y</span><span class="p">;</span>  <span class="p">}</span>
</code></pre></div>
<p>Write.setCellHeader() uses TextTable.getCellByName() to access a cell, which is of
type XCell. We'll study XCell in Part 4 because it's used for representing cells in a
spreadsheet.</p>
<p>The Cell service supports both the XCell and XText interfaces, as in Figure 12.</p>
<p><img alt="" src="images/07-Non-text_Content-12.png" /></p>
<p>Figure 12. The Cell Service.</p>
<p>This means that Lo.qi() can convert an XCell instance into XText, which makes the
cell's text and properties accessible to a text cursor. Write.setCellHeader() implements
these features:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setCellHeader</span><span class="p">(</span><span class="n">String</span> <span class="n">cellName</span><span class="p">,</span>
                               <span class="n">String</span> <span class="n">data</span><span class="p">,</span> <span class="n">XTextTable</span> <span class="n">table</span><span class="p">)</span>
<span class="c1">// puts text into the named cell of the table, colored white</span>
<span class="p">{</span>
  <span class="c1">// convert XCell to XText</span>
  <span class="n">XText</span> <span class="n">cellText</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                         <span class="n">table</span><span class="p">.</span><span class="na">getCellByName</span><span class="p">(</span><span class="n">cellName</span><span class="p">));</span>

  <span class="c1">// create  a cursor inside the cell</span>
  <span class="n">XTextCursor</span> <span class="n">textCursor</span> <span class="o">=</span> <span class="n">cellText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>

  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">textCursor</span><span class="p">,</span> <span class="s">&quot;CharColor&quot;</span><span class="p">,</span> <span class="mh">0xFFFFFF</span><span class="p">);</span>
                                         <span class="c1">// use white text</span>
  <span class="n">cellText</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of setCellHeader()</span>
</code></pre></div>
<p>The cell's "CharColor" property is changed so the inserted text in the header row is
white, as in Figure 9.</p>
<p>Write.setCellText() is shorter than setCellHeader() because there's no need to change
the text's color:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setCellText</span><span class="p">(</span><span class="n">String</span> <span class="n">cellName</span><span class="p">,</span>
                            <span class="n">String</span> <span class="n">data</span><span class="p">,</span> <span class="n">XTextTable</span> <span class="n">table</span><span class="p">)</span>
<span class="c1">// puts text into the named cell of the table</span>
<span class="p">{</span>
  <span class="n">XText</span> <span class="n">cellText</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                         <span class="n">table</span><span class="p">.</span><span class="na">getCellByName</span><span class="p">(</span><span class="n">cellName</span><span class="p">));</span>
  <span class="n">cellText</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of setCellText()</span>
</code></pre></div>
<h2 id="6-adding-a-bookmark-to-the-document">6.  Adding a Bookmark to the Document</h2>
<p>Write.addBookmark() adds a named bookmark at the current cursor position:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addBookmark</span><span class="p">(</span><span class="n">XTextCursor</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XTextContent</span> <span class="n">bmkContent</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span>
                                <span class="n">XTextContent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                                <span class="s">&quot;com.sun.star.text.Bookmark&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">bmkContent</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not create a bookmark&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// convert bookmark content to a named collection</span>
  <span class="n">XNamed</span> <span class="n">bmksNamed</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XNamed</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">bmkContent</span><span class="p">);</span>
  <span class="n">bmksNamed</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>

  <span class="n">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">bmkContent</span><span class="p">);</span>
  <span class="n">endParagraph</span><span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of addBookmark()</span>
</code></pre></div>
<p>The Bookmark service doesn't have a specific interface (such as XBookmark), so
Lo.createInstanceMSF() returns an XTextContent interface. These services and
interfaces are summarized by Figure 13.</p>
<p><img alt="" src="images/07-Non-text_Content-13.png" /></p>
<p>Figure 13. The Bookmark Service and Interfaces.</p>
<p>Bookmark supports XNamed, which allows it to be viewed as a named collection of
bookmarks (note the plural). This is useful when searching for a bookmark or adding
one, as in the BuildDoc.java example. It calls Write.addBookmark() to add a
bookmark called "ad-Bookmark" to the document:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// code fragment from BuildDoc.java</span>
<span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;This line ends with a bookmark&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">addBookmark</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;ad-bookmark&quot;</span><span class="p">);</span>
</code></pre></div>
<p>Bookmarks, such as "ad-bookmark", are not rendered when the document is opened,
which means that nothing appears after the "The line ends with a bookmark." string in
"build.odt".</p>
<p>However, bookmarks are listed in Writer's "Navigator" window (press F5), as in
Figure 14.</p>
<p><img alt="" src="images/07-Non-text_Content-14.png" /></p>
<p>Figure 14. The Writer Navigator Window.</p>
<p>Clicking on the bookmark causes Writer to jump to its location in the document.</p>
<p>Using Bookmarks
One programming use of bookmarks is for moving a cursor around a document. Just
as with real-world bookmarks, you can add one at some important location in a
document and jump to that position at a later time.</p>
<p>Write.findBookmark() finds a bookmark by name, returning it as an XTextContent
instance:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">XTextContent</span> <span class="nf">findBookmark</span><span class="p">(</span><span class="n">XTextDocument</span> <span class="n">doc</span><span class="p">,</span>
                                                <span class="n">String</span> <span class="n">bmName</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XBookmarksSupplier</span> <span class="n">supplier</span> <span class="o">=</span>
                       <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XBookmarksSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">supplier</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Bookmark supplier could not be created&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">XNameAccess</span> <span class="n">namedBookmarks</span> <span class="o">=</span> <span class="n">supplier</span><span class="p">.</span><span class="na">getBookmarks</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">namedBookmarks</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>  <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Name access to bookmarks not possible&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">namedBookmarks</span><span class="p">.</span><span class="na">hasElements</span><span class="p">())</span>  <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No bookmarks found&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// find the specified bookmark</span>
  <span class="n">Object</span> <span class="n">oBookmark</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">oBookmark</span> <span class="o">=</span> <span class="n">namedBookmarks</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="n">bmName</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">uno</span><span class="p">.</span><span class="na">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">oBookmark</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Bookmark \&quot;&quot;</span> <span class="o">+</span> <span class="n">bmName</span> <span class="o">+</span> <span class="s">&quot;\&quot; not found&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// there&#39;s no XBookmark, so return XTextContent</span>
  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTextContent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">oBookmark</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of findBookmark()</span>
</code></pre></div>
<p>findBookmark() can't return an XBookmark object since there's no such interface (see
Figure 13), but XTextContent is a good alternative. XTextContent has a getAnchor()
method which returns an XTextRange that can be used for positioning a cursor. The
following code fragment from BuildDoc.java illustrates the idea:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// code fragment from BuildDoc.java</span>
<span class="n">XTextContent</span> <span class="n">bookmark</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">findBookmark</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;ad-bookmark&quot;</span><span class="p">);</span>
<span class="n">XTextRange</span> <span class="n">bmRange</span> <span class="o">=</span> <span class="n">bookmark</span><span class="p">.</span><span class="na">getAnchor</span><span class="p">();</span>

<span class="n">XTextViewCursor</span> <span class="n">viewCursor</span> <span class="o">=</span> <span class="n">Write</span><span class="p">.</span><span class="na">getViewCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">viewCursor</span><span class="p">.</span><span class="na">gotoRange</span><span class="p">(</span><span class="n">bmRange</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</code></pre></div>
<p>The call to gotoRange() moves the view cursor to the "ad-bookmark" position, which
causes an on-screen change. gotoRange() can be employed with any type of cursor.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="06-Text_Styles.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 6. Text Styles
            </div>
          </div>
        </a>
      
      
        <a href="08-Graphic_Content.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 8. Graphic Content
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>