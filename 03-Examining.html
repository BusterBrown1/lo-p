
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 3. Examining - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-3-examining" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 3. Examining
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 3. Examining
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="03-Examining.html" class="md-nav__link md-nav__link--active">
        Chapter 3. Examining
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-examining-office" class="md-nav__link">
    1.  Examining Office
  </a>
  
    <nav class="md-nav" aria-label="1.  Examining Office">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#12-examining-path-settings" class="md-nav__link">
    1.2.  Examining Path Settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-getting-and-setting-document-properties" class="md-nav__link">
    2.  Getting and Setting Document Properties
  </a>
  
    <nav class="md-nav" aria-label="2.  Getting and Setting Document Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-reporting-os-file-properties" class="md-nav__link">
    2.1.  Reporting OS File Properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-setting-document-properties" class="md-nav__link">
    2.2.  Setting Document Properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-examining-a-document-for-api-information" class="md-nav__link">
    3.  Examining a Document for API Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-for-the-service-im-using-at-the-moment-what-are-its-properties" class="md-nav__link">
    1.  For the service I'm using at the moment, what are its properties?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-when-i-need-to-do-something-to-a-document-eg-close-an-xcomponent" class="md-nav__link">
    2.  When I need to do something to a document (e.g. close an XComponent
  </a>
  
    <nav class="md-nav" aria-label="2.  When I need to do something to a document (e.g. close an XComponent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-printing-programming-details-about-a-document" class="md-nav__link">
    3.1.  Printing Programming Details about a Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-examining-a-document-using-extensions" class="md-nav__link">
    3.2.  Examining a Document Using Extensions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-examining-office" class="md-nav__link">
    1.  Examining Office
  </a>
  
    <nav class="md-nav" aria-label="1.  Examining Office">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#12-examining-path-settings" class="md-nav__link">
    1.2.  Examining Path Settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-getting-and-setting-document-properties" class="md-nav__link">
    2.  Getting and Setting Document Properties
  </a>
  
    <nav class="md-nav" aria-label="2.  Getting and Setting Document Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-reporting-os-file-properties" class="md-nav__link">
    2.1.  Reporting OS File Properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-setting-document-properties" class="md-nav__link">
    2.2.  Setting Document Properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-examining-a-document-for-api-information" class="md-nav__link">
    3.  Examining a Document for API Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-for-the-service-im-using-at-the-moment-what-are-its-properties" class="md-nav__link">
    1.  For the service I'm using at the moment, what are its properties?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-when-i-need-to-do-something-to-a-document-eg-close-an-xcomponent" class="md-nav__link">
    2.  When I need to do something to a document (e.g. close an XComponent
  </a>
  
    <nav class="md-nav" aria-label="2.  When I need to do something to a document (e.g. close an XComponent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-printing-programming-details-about-a-document" class="md-nav__link">
    3.1.  Printing Programming Details about a Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-examining-a-document-using-extensions" class="md-nav__link">
    3.2.  Examining a Document Using Extensions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/03-Examining.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-3-examining">Chapter 3. Examining</h1>
<p>This chapter looks at ways to examine the state of the 
Office application and a document. A document will be 
examined in three different ways: the first retrieves 
properties about the file, such as its author, keywords, and 
when it was last modified. The second and third 
approaches extract API details, such as what services and 
interfaces it uses. This can be done by calling functions in 
my Utils class or by utilizing the MRI extension added to Office. </p>
<p>Once again all the examples come from the "Office Tests" directory in the code 
download associated with this book, and make liberal use of the classes in the "Utils" 
directory. For details please visit http://fivedots.coe.psu.ac.th/~ad/jlop/. </p>
<h2 id="1-examining-office">1.  Examining Office</h2>
<p>It's sometimes necessary to examine the state of the Office application, for example to 
determine its version number or installation directory. There are two main ways of 
finding this information, using configuration properties and path settings. </p>
<p>1.1 Examining Configuration Properties 
Configuration management is a complex area, which is explained reasonably well in 
chapter 15 of the developer's guide and online at 
https://wiki.openoffice.org/wiki/Documentation/DevGuide/Config/Configuration_Ma
nagement; I'll only explain the basics here. The easiest way of accessing the relevant 
online section is by typing: 
loguide "Configuration Management" 
Office stores a large assortment of XML configuration data as ".xcd" files in the 
<OFFICE>\share\registry directory. They can be programatically accessed in three 
steps: first a ConfigurationProvider service is created, which represents the 
configuration database tree. The tree is examined with a ConfigurationAccess service 
which is supplied with the path to the node of interest. Configuration properties can 
be accessed by name with the XNameAccess interface.  </p>
<p>These steps are hidden inside Info.getConfig() which requires at most two arguments 
– the path to the required node, and the name of the property inside that node.  </p>
<p>The two most useful paths seem to be "/org.openoffice.Setup/Product" and 
"/org.openoffice.Setup/L10N", which are hardwired as constants in the Info class. The 
simplest version of getConfig() looks along both paths by default so the programmer 
only has to supply a property name when calling the method. This is illustrated in the 
OfficeInfo.java example in the "Office Tests/" folder: </p>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Examining </p>
</div>
<p>Office; Getting and 
Setting Document<br />
Properties; Examining a 
Document for API 
Details; Examining a 
Document Using MRI<br />
Example folders: "Office 
Tests" and "Utils" </p>
<p>// in OfficeInfo.java 
XComponentLoader loader = Lo.loadOffice(); </p>
<p>// look up 5 Office properties 
System.out.println("Office name: " + Info.getConfig("ooName")); 
System.out.println("Office version (long): " +<br />
                         Info.getConfig("ooSetupVersionAboutBox")); 
System.out.println("Office version (short): " +<br />
                         Info.getConfig("ooSetupVersion")); 
System.out.println("Office language location: " +<br />
                         Info.getConfig("ooLocale")); 
System.out.println("System language location: \"" +<br />
                       Info.getConfig("ooSetupSystemLocale") + "\""); </p>
<p>On one of my test machines, the following is printed: </p>
<p>Office name: LibreOffice 
Office version (long): 5.1.0.3 
Office version (short): 5.1 
Office language location: en-US 
System language location: "" </p>
<p>Many other property names, which don't seem that useful, are documented in my Info 
class. One way of finding the most current list is to browse main.xcd in 
<OFFICE>\share\registry. </p>
<h3 id="12-examining-path-settings">1.2.  Examining Path Settings</h3>
<p>Path settings store directory locations for parts of the Office installation, such as the 
whereabouts of the gallery and spellchecker files. A partial list of predefined paths is 
accessible from within LibreOffice, via the Tools menu: Tools &gt; Options &gt; 
LibreOffice &gt; Paths. But the best source of information is the developer's guide, in the 
"Path Organization" section of chapter 6, or at 
https://wiki.openoffice.org/wiki/Documentation/DevGuide/OfficeDev/Path_Organizat
ion, which can be accessed using: 
loguide "Path Organization" 
One issue is that path settings comes in two forms: a string holding a single directory 
path, or a string made up of a ";'-separated paths. Additionally, the directories are 
returned in URI format (i.e. they start with "file:///"). </p>
<p>Info.getPaths() hides the creation of a PathSettings service, and the accessing of its 
properties.  </p>
<p>Probably the most common Office forum question about paths is how to determine 
Office's installation directory. Unfortunately, that isn't one of the paths stored in the 
PathSettings service, but the information is accessible via one of the other paths. It's 
possible to retrieve the path for AddIns (which is <OFFICE>/program/addin), and 
move up the directory hierarchy two levels. This trick is implemented by 
Info.getOfficeDir(). </p>
<p>Examples of using Info.getOfficeDir() and Info.getPaths() appear in OfficeInfo.java: </p>
<p>// in OfficeInfo.java 
System.out.println("Office Dir: " + Info.getOfficeDir()); </p>
<p>System.out.println("Working Dir: " + Info.getPaths("Work")); 
System.out.println("Addin Dir: " + Info.getPaths("Addin")); 
System.out.println("Filters Dir: " + Info.getPaths("Filter")); 
System.out.println("Templates Dirs: " + Info.getPaths("Template")); 
System.out.println("Gallery Dir: " + Info.getPaths("Gallery")); </p>
<h2 id="2-getting-and-setting-document-properties">2.  Getting and Setting Document Properties</h2>
<p>Document properties is the information that's displayed when you right-click on a file 
icon, and select "Properties" from the menu, as in Figure 1. </p>
<p><img alt="" src="images/03-Examining-1.png" /></p>
<p>Figure 1. A Properties Dialog in Windows 7 for "algs.odp". </p>
<p>If you select the "Details" tab, a list of properties appears like those in Figure 2. </p>
<p><img alt="" src="images/03-Examining-2.png" /></p>
<p>Figure 2. Details Properties List for "algs.odp". </p>
<p>An issue with document properties is that the Office API for manipulating them has 
changed. The old interfaces were XDocumentInfoSupplier and XDocumentInfo, but 
these have been deprecated, and replaced by XDocumentPropertiesSupplier and 
XDocumentProperties. This wouldn't really matter except that while OpenOffice 
retains those deprecated interfaces, LibreOffice has removed them.  </p>
<h3 id="21-reporting-os-file-properties">2.1.  Reporting OS File Properties</h3>
<p>My DocProps.java example prints the document properties by calling: 
Info.printDocProperties(doc); 
printDocProperties() converts the document to an XDocumentPropertiesSupplier 
interface, and extracts the XDocumentProperties object: </p>
<p>public static void printDocProperties(XComponent doc) 
{ 
  XDocumentPropertiesSupplier docPropsSupp =<br />
            UnoRuntime.queryInterface( 
                   XDocumentPropertiesSupplier.class, doc); 
  XDocumentProperties dps = docPropsSupp.getDocumentProperties(); </p>
<p>printDocProps(dps); 
  XPropertyContainer udProps = dps.getUserDefinedProperties();<br />
  Props.showObjProps("UserDefined Info", udProps); 
 }  // end of printDocProperties() </p>
<p>Although the XDocumentProperties interface belongs to a DocumentProperties 
service, that service does not contain any properties/attributes. Instead its data is 
stored inside XDocumentProperties and accessed and changed with get/set methods 
based on the attribute names. For example, the Author attribute is obtained by calling 
XDocumentProperties.getAuthor().  </p>
<p>As a consequence, my printDocProps() consists of a long list of get method calls 
inside print statements: </p>
<p>public static void printDocProps(XDocumentProperties dps) 
{ 
  System.out.println("Document Properties Info"); 
  System.out.println("Author: " + dps.getAuthor()); <br />
  System.out.println("Title: " + dps.getTitle()); 
  System.out.println("Subject: " + dps.getSubject()); 
  System.out.println("Description: " + dps.getDescription()); 
  System.out.println("Generator: " + dps.getGenerator()); 
     :  // more of the same 
} </p>
<p>Howevere, user-defined file properties are accessed with an XPropertyContainer, as 
can be seen back in printDocProperties(). </p>
<h3 id="22-setting-document-properties">2.2.  Setting Document Properties</h3>
<p>The setting of document properties is done with set methods, as in Info.setDocProps() 
which sets the file's subject, title, and author properties: </p>
<p>// in the Info class 
public static void setDocProps(XComponent doc,<br />
                 String subject, String title, String author) 
{ 
  XDocumentPropertiesSupplier dpSupplier =<br />
           UnoRuntime.queryInterface( 
                 XDocumentPropertiesSupplier.class, doc); 
  XDocumentProperties docProps =<br />
                 dpSupplier.getDocumentProperties(); 
  docProps.setSubject(subject); 
  docProps.setTitle(title); 
  docProps.setAuthor(author); 
}  // end setDocProps() </p>
<p>This method is called at the end of DocProps.java: </p>
<p>// code fragment from DocProps.java 
Info.setDocProps(doc, "Example", "Examples", "Andrew Davison"); 
Lo.save(doc);     // must save or the props are lost </p>
<p>Aftre the properties are changed, the document must be saved otherwise the changes 
will be lost when the document is closed. </p>
<p>The changed properties appear in the "Document Statistics" list shown in Figure 3. </p>
<p><img alt="" src="images/03-Examining-3.png" /></p>
<p>Figure 3. "Document Statistics" Properties List for "algs.odp". </p>
<h2 id="3-examining-a-document-for-api-information">3.  Examining a Document for API Information</h2>
<p>After programming with the Office API for a while, you may start to notice that two 
coding questions keep coming up. They are: </p>
<h2 id="1-for-the-service-im-using-at-the-moment-what-are-its-properties">1.  For the service I'm using at the moment, what are its properties?</h2>
<h2 id="2-when-i-need-to-do-something-to-a-document-eg-close-an-xcomponent">2.  When I need to do something to a document (e.g. close an XComponent</h2>
<p>instance), which interface should I cast XComponent to by calling Lo.qi? 
The first question arose in Chapter 2 when I needed to set properties in 
loadComponentFromURL() and storeToURL(). Unfortunately the LibreOffice 
documentation for OfficeDocument doesn't list all the properties associated with the 
service. Have a look for yourself by typing lodoc OfficeDocument service, which 
takes you to its IDL Page unfortunately. You'll then need to click on the 
"OfficeDocument" link in the "Classes" section to reach the documentation. </p>
<p>OfficeDocument's "Public Attributes" section only lists four properties. </p>
<p>The second problem is also only partly addressed by the LibreOffice documentation. </p>
<p>The pages helpfully includes inheritance tree diagrams that can be clicked on to jump 
to the documentation about other services and interfaces. But the diagrams don't make 
a distinction between “contains” relationships (for interfaces in a service) and the two 
kinds of inheritance (for services and for interfaces). </p>
<p>I'm not the first person to notice these problems; in fact, similar complaints have 
appeared frequently in the Office forums. Two approaches for easing matters are 
often suggested. One is to write code to print out details about a loaded document, 
which is my approach in the next subsection. A second technique is to install an 
Office extension for browsing a document's structure. I'll look at one such extension, 
MRI, in section 2.2. </p>
<h3 id="31-printing-programming-details-about-a-document">3.1.  Printing Programming Details about a Document</h3>
<p>I've hidden the messy job of collecting service, interface, property, and method 
information about a document inside the Info and Props utility classes. The five main 
methods for retrieving details can be understood by considering their position in 
Figure 4's Service and Interface Relationship diagram. </p>
<p><img alt="" src="images/03-Examining-4.png" /></p>
<p>Figure 4. Methods to Investigate the Service and Interface<br />
Relationships and Hierarchies. </p>
<p>The methods are shown in action in the DocProps.java example, which loads a 
document and prints information about its services, interfaces, methods, and 
properties. The relevant code fragment: </p>
<p>// part of DocProps.java 
XComponent doc = Lo.openDoc(args[0], loader); </p>
<p>System.out.println("\n------ Services for this document: -------"); 
for(String service : Info.getServices(doc)) 
  System.out.println("  " + service); </p>
<p>System.out.println("\n--- Available Services for this doc: ---"); 
int count = 0; 
for(String service : Info.getAvailableServices(doc)) { 
  System.out.println("  " + service); 
  count++; 
} 
System.out.println("No. available services: " + count); </p>
<p>System.out.println("\n------ Interfaces for this document: -------"); 
count = 0; 
for(String intfs : Info.getInterfaces(doc)) { 
  System.out.println("  " + intfs); 
  count++; 
} 
System.out.println("No. interfaces: " + count); </p>
<p>String interfaceName = "com.sun.star.text.XTextDocument"; 
System.out.println("\n------ Methods for interface " +<br />
                                    interfaceName + ": ------"); 
String[] methods = Info.getMethods(interfaceName); 
for(String methodName : methods) 
  System.out.println("  " + methodName + "();"); 
System.out.println("No. methods: " + methods.length); </p>
<p>System.out.println("\n---- Properties for this document: ----"); 
count = 0; 
for(Property p : Props.getProperties(doc)) { 
  System.out.println("  " + Props.showProperty(p)); 
  count++; 
} 
System.out.println("No. properties: " + count); </p>
<p>When I examined a Word file with this program, only three services were found: 
OfficeDocument, GenericTextDocument, and TextDocument, which correspond to 
the text document part of the hierarchy in Chapter 1, Figure 9. That doesn't seem so 
bad until you look at the output from the other Info.getXXX() methods: the document 
can call 206 other available services, 69 interfaces, and manipulate 40 properties.  </p>
<p>In the code above only the methods available to XTextDocument are printed: </p>
<p>String interfaceName = "com.sun.star.text.XTextDocument"; 
String[] methods = Info.getMethods(interfaceName); </p>
<p>Sixteen methods are listed, collectively inherited from the interfaces in 
XTextDocument 's inheritance hierarchy shown in Figure 5.  </p>
<p><img alt="" src="images/03-Examining-5.png" /></p>
<p>Figure 5. Inheritance Hierarchy for XTextDocument. </p>
<p>A similar diagram appears on the XTextDocument documentation webpage (lodoc 
XTextDocument), but is complicated by also including the inheritance hierarchy for 
the TextDocument service. Note, the interface hierarchy is also textually represented 
in the "Public Member Functions" section of the documentation.  </p>
<p>The last part of the code fragment prints all the document's property names and types 
by calling Props.showProperty(). If you only want to know about one specific 
property then use Props.getProperty(), which requires a reference to the document and 
the property name: </p>
<p>String propName = "CharacterCount"; 
System.out.println("Value of " + propName + ": " + 
                         Props.getProperty(doc, propName) ); </p>
<p>File Types 
Another group of utility methods let a programmer investigate a file's document type. </p>
<p>The DocProps.java example also shows these methods in action: </p>
<p>// part of DocProps.java 
XComponentLoader loader = Lo.loadOffice(); </p>
<p>String ext = Info.getExt(args[0]); 
if (ext != null) { 
  System.out.println("\nFile Extension: " + ext); 
  System.out.println("Extension format: " + Lo.ext2Format(ext)); 
} </p>
<p>// get document type 
String docType = Info.getDocType(args[0]); 
if (docType != null) { 
  System.out.println("Doc type: " + docType + "\n"); 
  Props.showDocTypeProps(docType); 
} </p>
<p>One advantage of these functions is that they can be called before the file's document 
is loaded with Lo.openDoc(). </p>
<p>The data printed for the Word file, "story.doc", is: </p>
<p>File Extension: doc 
Extension format: MS Word 97 
Doc type: writer_MS_Word_97 </p>
<p>Properties for "writer_MS_Word_97": 
  Mandatory: false 
  Finalized: false 
  MediaType: application/msword 
  Preferred: true 
  UIName: Microsoft Word 97/2000/XP/2003 
  Extensions: [doc] 
  DetectService: com.sun.star.text.FormatDetector 
  UINames: [     = Microsoft Word 97/2000/XP/2003  ] 
  PreferredFilter: MS Word 97 
  ClipboardFormat: MSWordDoc 
  URLPattern: [] 
  Name: writer_MS_Word_97 </p>
<p>Lo.ext2Format() print's the Office filter name ("MS Word 97") associated with the 
file's extension (".doc"). Info.getDocType() returns the type of the document once the 
file has been loaded (e.g. "writer_MS_Word_97"). Props.showDocTypeProps() prints 
the properties associated with that type. Probably the most useful is the 
"PreferredFilter" which is the best filter name to use when saving the document. </p>
<h3 id="32-examining-a-document-using-extensions">3.2.  Examining a Document Using Extensions</h3>
<p>It's hardly surprising that Office developers have wanted to make the investigation of 
services, interfaces, and properties associated with documents and other objects 
easier. There are several extension which do this, and I tried three of them: MRI, 
XRayTool (http://bernard.marcelly.perso.sfr.fr/Files_en/XrayTool60_en.odt), and 
Object Inspector (https://wiki.openoffice.org/wiki/Object_Inspector). Probably the 
best in terms of functionality and documentation is MRI, which I'll describe here. </p>
<p>MRI can be downloaded from 
http://extensions.services.openoffice.org/en/project/mri-uno-object-inspection-tool, 
depositing an OXT file (probably called "MRI-1.3.3.oxt") on your machine. </p>
<p>Installing an extension is done through the Tools &gt; Extension Manager menu item. </p>
<p>Click on the "Add" button and select the OXT file. Or you may be able to simply 
double click on the file to start the installation. </p>
<p>One (perhaps temporary) problem is that I was unable to install the versions of MRI 
available at the LibreOffice extensions site (v.1.1.2 or the pre-release v.1.1.4 at 
http://extensions.libreoffice.org/extension-center). However, the newer edition, 
v.1.2.4, at OpenOffice's extension's website 
(http://extensions.services.openoffice.org/en/project/mri-uno-object-inspection-tool) 
did install successfully.  </p>
<p>Once installed, MRI can be accessed through Office's GUI via the Tools &gt; Add-ons 
menu item, or programmatically as in my ExamineDoc.java example: </p>
<p>// part of ExamineDoc.java 
XComponentLoader loader = Lo.loadOffice(); <br />
XComponent doc = Lo.openDoc(args[0], loader); <br />
Lo.mriInspect(doc);   </p>
<p>A window appears, like the one in Figure 6. </p>
<p><img alt="" src="images/03-Examining-6.png" /></p>
<p>Figure 6. MRI Examination of a Document. </p>
<p>The tabs along the top of the large window allow you to switch between information 
about the document's properties, methods, interfaces, and services. Unlike my earlier 
print methods, it's possible to move around the window's data, looking inside property 
objects.  </p>
<p>One enormously useful feature is automatic code generation, which is possible in a 
variety of different languages, including Java. The code type is set through the Tools </p>
<blockquote>
<p>Code menu item, and the code appears in a window which is initially of size 0. It's 
hidden below the large window and above the status bar; drag the large window's 
lower border upwards to make the code window visible. </p>
</blockquote>
<p>A click on a method or property will cause code to be generated which utilizes the 
method or property. For example, when I clicked on the CharacterCount property 
(shown at the bottom of Figure 6), the following code fragment was produced: </p>
<p>public static void snippet(XComponentContext xComponentContext,<br />
                               Object oInitialTarget) <br />
{ try { <br />
    XPropertySet xPropSet = UnoRuntime.queryInterface( <br />
                              XPropertySet.class, oInitialTarget); <br />
    int nCharacterCount = AnyConverter.toInt( 
                 xPropSet.getPropertyValue("CharacterCount")); <br />
  } <br />
  catch (UnknownPropertyException e1) <br />
  { e1.printStackTrace(); } <br />
  catch (IllegalArgumentException e2) <br />
  { e2.printStackTrace(); } <br />
  catch (WrappedTargetException e3) <br />
  { e3.printStackTrace(); } <br />
}   </p>
<p>The snippet() function is passed the component context and initial target object (the 
text document). UnoRuntime.queryInterface() casts the document to the XPropertySet 
interface, and getPropertyValue() looks up the CharacterCount value. (Recall that 
Office's UnoRuntime.queryInterface() is my Lo.qi().) 
The Office AnyConverter class converts Office types to Java types, but could actually 
be left out in this case. The exception handling could also be shortened. </p>
<p>One benefit of using MRI is the large amount of excellent documentation. The 
extension includes a "Help" menu item, and a configurable link to online Office 
documentation. MRI has its own wiki, at https://github.com/hanya/MRI/wiki, and 
there are several forum posts about using it for code generation (e.g. </p>
<p>https://forum.openoffice.org/en/forum/viewtopic.php?f=74&amp;t=49294) and for 
navigating MRI's object hierarchy 
(https://forum.openoffice.org/en/forum/download/file.php?id=17368&amp;sid=373c5d782
40f4093fb3721fe4264dd20). </p>
<p>Some Quirks of Using MRI 
Lo.mriInspect() executes the following code, which I lifted from the "Run MRI" 
section of the MRI wiki: </p>
<p>// in Lo.java 
public static void mriInspect(Object obj) <br />
{ <br />
  XIntrospection xi =<br />
        createInstanceMCF(XIntrospection.class, "mytools.Mri"); 
  if (xi == null) { <br />
    System.out.println("MRI Inspector Service could not 
                        be instantiated"); <br />
    return; <br />
  } <br />
  System.out.println("MRI Inspector Service instantiated"); <br />
  xi.inspect(obj); <br />
}  // end of mriInspect()   </p>
<p>"mytools.Mri" is the name of the service added to Office when MRI is installed. </p>
<p>createInstanceMCF() creates an instance of the service, and accesses its 
XIntrospection interface, so that the XIntrospection.inspect() method can be called. </p>
<p>One drawback is that inspect() returns immediately after spawning the MRI GUI (i.e. </p>
<p>the window in Figure 3), allowing ExamineDoc.java to continue. It would be better if 
the program paused, which can be achieved by calling Lo.waitEnter(): </p>
<p>// part of ExamineDoc.java 
XComponentLoader loader = Lo.loadOffice();<br />
XComponent doc = Lo.openDoc(args[0], loader);<br />
Lo.mriInspect(doc); </p>
<p>Lo.waitEnter(); </p>
<p>Another issue is that when the MRI window is closed by the user, the link to Office is 
broken (the UNO bridge is deleted). But this doesn't happen if the document is visible 
on-screen when the MRI window is closed. </p>
<p>In general, it turns out to be quite useful to display the document, especially during 
program debugging and development. A visible document allows the coder to see 
incremental changes as they occur. </p>
<p>The simplest way of making a document visible is by employing the FCM 
relationship mentioned in Chapter 1. Starting from the document, it's easy to switch to 
the XModel interface, and from there go to the container window. Its XWindow 
interface has a setVisible() method that can make the document visible (or hide it). </p>
<p>The corresponding code fragment is: </p>
<p>XModel model = Lo.qi(XModel.class, doc); 
XFrame frame = model.getCurrentController().getFrame(); 
XWindow xWindow = frame.getContainerWindow(); 
xWindow.setVisible(true);   // or false to hide 
xWindow.setFocus(); </p>
<p>This code is packaged up in the GUI utility class, and called with GUI.setVisible(). </p>
<p>The code in ExpandDoc becomes: </p>
<p>// part of ExamineDoc.java 
XComponentLoader loader = Lo.loadOffice(); <br />
XComponent doc = Lo.openDoc(args[0], loader); </p>
<p>GUI.setVisible(doc, true);   // needed so that close of MRI doesn't 
                             // cause the UNO bridge to be disposed 
Lo.mriInspect(doc); 
Lo.waitEnter(); </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="02-Starting_and_Stopping.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 2. Starting and Stopping
            </div>
          </div>
        </a>
      
      
        <a href="04-Listening.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 4. Listening, and Other Techniques
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>