
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/22-Styles.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 22. Styles - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-22-styles" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 22. Styles
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 22. Styles
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="22-Styles.html" class="md-nav__link md-nav__link--active">
        Chapter 22. Styles
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-obtaining-style-information" class="md-nav__link">
    1.  Obtaining Style Information
  </a>
  
    <nav class="md-nav" aria-label="1.  Obtaining Style Information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finding-style-information" class="md-nav__link">
    Finding Style Information
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-creating-and-using-new-styles" class="md-nav__link">
    2.  Creating and Using New Styles
  </a>
  
    <nav class="md-nav" aria-label="2.  Creating and Using New Styles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-creating-a-new-style" class="md-nav__link">
    2.1.  Creating a New Style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-applying-a-new-style" class="md-nav__link">
    2.2.  Applying a New Style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-adding-borders" class="md-nav__link">
    2.3.  Adding Borders
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-obtaining-style-information" class="md-nav__link">
    1.  Obtaining Style Information
  </a>
  
    <nav class="md-nav" aria-label="1.  Obtaining Style Information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finding-style-information" class="md-nav__link">
    Finding Style Information
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-creating-and-using-new-styles" class="md-nav__link">
    2.  Creating and Using New Styles
  </a>
  
    <nav class="md-nav" aria-label="2.  Creating and Using New Styles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-creating-a-new-style" class="md-nav__link">
    2.1.  Creating a New Style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-applying-a-new-style" class="md-nav__link">
    2.2.  Applying a New Style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-adding-borders" class="md-nav__link">
    2.3.  Adding Borders
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/main/docs/22-Styles.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-22-styles">Chapter 22. Styles<a class="headerlink" href="#chapter-22-styles" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Obtaining Style
Information:  the
TableCellStyle and
TablePageStyle
Services;  Creating and
Using a New Style;
Adding Borders</p>
<p>Example folders: "Calc
Tests" and "Utils"</p>
</div>
<p>This chapter looks at how spreadsheet styles are stored,
how they can be examined, and how new styles can be
instantiated and used.</p>
<h2 id="1-obtaining-style-information">1.  Obtaining Style Information<a class="headerlink" href="#1-obtaining-style-information" title="Permanent link">&para;</a></h2>
<p>Calc uses the same style API as Writer, Draw, and Impress documents. Figure 1
shows its structure.</p>
<p><img alt="" src="images/22-Styles-1.png" /></p>
<p>Figure 1. Calc Style Families and their Property Sets.</p>
<p>The Calc API only has two style families, CellStyles and PageStyles. A cell style can
be applied to a cell, a cell range, or a spreadsheet (which is a very big cell range). A
page style can be applied only to a spreadsheet.</p>
<p>Each style family consists of styles, which are collection of property sets. The default
cell style is called "Default", as is the default page style.</p>
<p>The StylesAllInfo.java example prints out the style family names and the style names
associated with the input document:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in StylesAllInfo.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Usage: run StylesAllInfo &lt;fnm&gt;&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XComponent</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">openDoc</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not open &quot;</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// get all the style families for this document</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">styleFamilies</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">getStyleFamilyNames</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Style Family Names (&quot;</span> <span class="o">+</span>
                             <span class="n">styleFamilies</span><span class="p">.</span><span class="na">length</span> <span class="o">+</span> <span class="s">&quot;): &quot;</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">String</span> <span class="n">styleFamily</span> <span class="p">:</span> <span class="n">styleFamilies</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">styleFamily</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>

  <span class="c1">// list all the style names for each style family</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">styleFamilies</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">styleFamily</span> <span class="o">=</span> <span class="n">styleFamilies</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;. \&quot;&quot;</span> <span class="o">+</span> <span class="n">styleFamily</span> <span class="o">+</span>
                                         <span class="s">&quot;\&quot; Family styles:&quot;</span><span class="p">);</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">styleNames</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">getStyleNames</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">styleFamily</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">printNames</span><span class="p">(</span><span class="n">styleNames</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
<p>This code uses the Info.getStyleFamilyNames() and Info.getStyleNames() functions
which I utilized in earlier chapters, so I won't explain their implementation again. The
output for a simple spreadsheet is:</p>
<div class="highlight"><pre><span></span><code>Style Family Names (2):
  CellStyles
  PageStyles

1.  &quot;CellStyles&quot; Family styles:

No. of names: 5
  &quot;Default&quot;  &quot;Heading&quot;  &quot;Heading1&quot;  &quot;Result&quot;
  &quot;Result2&quot;


2.  &quot;PageStyles&quot; Family styles:

No. of names: 2
  &quot;Default&quot;  &quot;Report&quot;
</code></pre></div>
<h4 id="finding-style-information">Finding Style Information<a class="headerlink" href="#finding-style-information" title="Permanent link">&para;</a></h4>
<p>From a programming point of view, the main difficult with styles is finding
documentation about their properties, so that a value can be correctly read or changed.</p>
<p>One approach is to use my Info.getStyleProps() method to list the properties for a
given style family and style name. For example, the following displays all the
properties for the default cell and page styles:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// commented out code in StylesAllInfo.java</span>
<span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;CellStyles Default&quot;</span><span class="p">,</span>
                  <span class="n">Info</span><span class="p">.</span><span class="na">getStyleProps</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;CellStyles&quot;</span><span class="p">,</span> <span class="s">&quot;Default&quot;</span><span class="p">)</span> <span class="p">);</span>

<span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;PageStyles Default&quot;</span><span class="p">,</span>
                 <span class="n">Info</span><span class="p">.</span><span class="na">getStyleProps</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;PageStyles&quot;</span><span class="p">,</span> <span class="s">&quot;Default&quot;</span><span class="p">)</span> <span class="p">);</span>
</code></pre></div>
<p>The problem is that the output is extremely long, and some property names are less
descriptive/understandable than others.</p>
<p>It's probably better to search the online documentation for properties. Cell styles are
managed by the TableCellStyle service (see Figure 22) and page styles by the
TablePageStyle service (Figure 23). Use <code>lodoc TableCellStyle</code> and
<code>lodoc TablePageStyle</code> to access the online information.</p>
<p>The properties managed by TableCellStyle are inherited from a number of places, as
summarized by Figure 2.</p>
<p><img alt="" src="images/22-Styles-2.png" /></p>
<p>Figure 2. The TableCellStyle Service.</p>
<p>By far the most important source of cell style properties is the CellProperties class in
the table module (use <code>lodoc cellproperties service</code>). However, if a property
relates to the text in a cell then it's more likely to originate from the
CharacterProperties or ParagraphProperties classes in the style module (e.g. use
<code>lodoc characterproperties service</code>).</p>
<p>The properties managed by TablePageStyle are also inherited from a few places, as
summarized by Figure 3.</p>
<p><img alt="" src="images/22-Styles-3.png" /></p>
<p>Figure 3. The TablePageStyle Service.</p>
<p>The main place to look for page properties is the PageProperties class in the style
module (e.g. use <code>lodoc pageproperties service</code>). The properties relate to things
such as page margins, headers, and footers, which become important when printing a
sheet.</p>
<h2 id="2-creating-and-using-new-styles">2.  Creating and Using New Styles<a class="headerlink" href="#2-creating-and-using-new-styles" title="Permanent link">&para;</a></h2>
<p>The steps required in creating and using a new style are illustrated by
BuildTables.java, in createStyles() and applyStyles():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in BuildTables.java</span>
<span class="c1">// globals</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">HEADER_STYLE_NAME</span> <span class="o">=</span> <span class="s">&quot;My HeaderStyle&quot;</span><span class="p">;</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">DATA_STYLE_NAME</span> <span class="o">=</span> <span class="s">&quot;My DataStyle&quot;</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XSpreadsheetDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">createDoc</span><span class="p">(</span><span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Document creation failed&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">XSpreadsheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheet</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="n">buildArray</span><span class="p">(</span><span class="n">sheet</span><span class="p">);</span>
  <span class="n">createStyles</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">applyStyles</span><span class="p">(</span><span class="n">sheet</span><span class="p">);</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">saveDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;buildTable.ods&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">waitEnter</span><span class="p">();</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
<p>createStyles() creates two cell styles called "My HeaderStyle" and "My DataStyle",
which are applied to the spreadsheet by applyStyles(). The result is shown in Figure 4.</p>
<p><img alt="" src="images/22-Styles-4.png" /></p>
<p>Figure 4. Styled Spreadsheet Cells.</p>
<p>The "My HeaderStyle" style is applied to the top row and the first column: the cells
are colored blue, and the text made white and centered. The "My DataStyle" is used
for the numerical data and formulae cells: the background color is made a light blue,
and the text is right-justified. applyStyles() also changes the border properties of the
bottom edges of the cells in the last row to be thick and blue.</p>
<p>The resulting spreadsheet is saved in "buildTable.ods". If this document is examined
by the StylesAllInfo.java program, it lists the new styles in the "CellStyles" family:</p>
<div class="highlight"><pre><span></span><code>&gt; run StylesAllInfo buildTable.ods
Loading Office...

Opening buildTable.ods
Style Family Names (2):
  CellStyles
  PageStyles


1.  &quot;CellStyles&quot; Family styles:

No. of names: 7
  &quot;Default&quot;  &quot;Heading&quot;  &quot;Heading1&quot;  &quot;My DataStyle&quot;
  &quot;My HeaderStyle&quot;  &quot;Result&quot;  &quot;Result2&quot;


2.  &quot;PageStyles&quot; Family styles:

No. of names: 2
  &quot;Default&quot;  &quot;Report&quot;

Closing the document
Closing Office
Office terminated
</code></pre></div>
<h3 id="21-creating-a-new-style">2.1.  Creating a New Style<a class="headerlink" href="#21-creating-a-new-style" title="Permanent link">&para;</a></h3>
<p>BuildTables.java calls createStyles() to create two styles:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in BuildTables.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">createStyles</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">)</span>
<span class="c1">// create HEADER_STYLE_NAME and</span>
<span class="c1">// DATA_STYLE_NAME cell styles</span>
<span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">XStyle</span> <span class="n">style1</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">createCellStyle</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">HEADER_STYLE_NAME</span><span class="p">);</span>

    <span class="n">XPropertySet</span> <span class="n">props1</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">style1</span><span class="p">);</span>
    <span class="n">props1</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;IsCellBackgroundTransparent&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="n">props1</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CellBackColor&quot;</span><span class="p">,</span> <span class="mh">0x6699FF</span><span class="p">);</span>   <span class="c1">//dark blue</span>
    <span class="n">props1</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CharColor&quot;</span><span class="p">,</span> <span class="mh">0xFFFFFF</span><span class="p">);</span>       <span class="c1">// white</span>

    <span class="c1">// Center cell content horizontally and vertically in the cell</span>
    <span class="n">props1</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;HoriJustify&quot;</span><span class="p">,</span> <span class="n">CellHoriJustify</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span>
    <span class="n">props1</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;VertJustify&quot;</span><span class="p">,</span> <span class="n">CellVertJustify</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span>


    <span class="n">XStyle</span> <span class="n">style2</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">createCellStyle</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">DATA_STYLE_NAME</span><span class="p">);</span>

    <span class="n">XPropertySet</span> <span class="n">props2</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">style2</span><span class="p">);</span>
    <span class="n">props2</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;IsCellBackgroundTransparent&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="n">props2</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;CellBackColor&quot;</span><span class="p">,</span> <span class="mh">0xC2EBFF</span><span class="p">);</span> <span class="c1">//light blue</span>
    <span class="n">props2</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;ParaRightMargin&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
                                      <span class="c1">// move away from right edge</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">uno</span><span class="p">.</span><span class="na">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of createStyles()</span>
</code></pre></div>
<p>The styles are created by two calls to Calc.createCellStyle(), which stores them in the
"CellStyles" family:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XStyle</span> <span class="nf">createCellStyle</span><span class="p">(</span><span class="n">XSpreadsheetDocument</span> <span class="n">doc</span><span class="p">,</span>
                                           <span class="n">String</span> <span class="n">styleName</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// access the &quot;CellStyles&quot; family</span>
  <span class="n">XComponent</span> <span class="n">compDoc</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XComponent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="n">XNameContainer</span> <span class="n">styleFamilies</span> <span class="o">=</span>
              <span class="n">Info</span><span class="p">.</span><span class="na">getStyleContainer</span><span class="p">(</span><span class="n">compDoc</span><span class="p">,</span> <span class="s">&quot;CellStyles&quot;</span><span class="p">);</span>

  <span class="c1">// create a new style</span>
  <span class="n">XStyle</span> <span class="n">style</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XStyle</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                          <span class="s">&quot;com.sun.star.style.CellStyle&quot;</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">styleFamilies</span><span class="p">.</span><span class="na">insertByName</span><span class="p">(</span><span class="n">styleName</span><span class="p">,</span> <span class="n">style</span><span class="p">);</span>  <span class="c1">// add to family</span>
    <span class="k">return</span> <span class="n">style</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unable to create style: &quot;</span> <span class="o">+</span> <span class="n">styleName</span><span class="p">);</span>
     <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of createCellStyle()</span>
</code></pre></div>
<p>Calc.createCellStyle() calls Info.getStyleContainer() to return a reference to the
"CellStyles" family as an XNameContainer. A new cell style is created by calling
Lo.createInstanceMSF(), and referred to using the XStyle interface. This style is
added to the family by calling XNameContainer.insertByName() with the name
passed to the function.</p>
<p>A new style is automatically derived from the "Default" style, so the rest of the
createStyles() method involves the changing of properties. Five are adjusted in the
"My HeaderStyle" style, and three in "My DataStyle".</p>
<p>The header properties are "IsCellBackgroundTransparent", "CellBackColor",
"CharColor", "HoriJustify", and "VertJustify", which are all defined in the
CellProperties class (see Figure 2).</p>
<p>The data properties are "IsCellBackgroundTransparent", "CellBackColor", and
"ParaRightMargin". Although "IsCellBackgroundTransparent" and "CellBackColor"
are from the CellProperties class, "ParaRightMargin" is inherited from the
ParagraphProperties class in the style module (also in Figure 2).</p>
<h3 id="22-applying-a-new-style">2.2.  Applying a New Style<a class="headerlink" href="#22-applying-a-new-style" title="Permanent link">&para;</a></h3>
<p>The new styles, "My HeaderStyle" and "My DataStyle", are applied to the spreadsheet
by the BuildTable.java method applyStyles():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in BuildTable.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">applyStyles</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// apply cell styles</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">changeStyle</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;B1:N1&quot;</span><span class="p">,</span> <span class="n">HEADER_STYLE_NAME</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">changeStyle</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A2:A4&quot;</span><span class="p">,</span> <span class="n">HEADER_STYLE_NAME</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">changeStyle</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;B2:N4&quot;</span><span class="p">,</span> <span class="n">DATA_STYLE_NAME</span><span class="p">);</span>

  <span class="c1">// change borders for the cell ranges</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">addBorder</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A4:N4&quot;</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">BOTTOM_BORDER</span><span class="p">,</span> <span class="mh">0x6699FF</span><span class="p">);</span>
                                  <span class="c1">//dark blue bottom edge</span>

  <span class="n">Calc</span><span class="p">.</span><span class="na">addBorder</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;N1:N4&quot;</span><span class="p">,</span>
               <span class="n">Calc</span><span class="p">.</span><span class="na">LEFT_BORDER</span> <span class="o">|</span> <span class="n">Calc</span><span class="p">.</span><span class="na">RIGHT_BORDER</span><span class="p">,</span> <span class="mh">0x6699FF</span><span class="p">);</span>
                                  <span class="c1">// dark blue left and right edges</span>
<span class="p">}</span>  <span class="c1">// end of applyStyles()</span>
</code></pre></div>
<p>The header style is applied to two cell ranges: B1:N1 is the top row containing the
months (see Figure 4), and A2:A4 is the first column. The data style is applied to
B2:N4 which spans the numerical data and formulae.</p>
<p>Calc.changeStyle() is defined as:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">changeStyle</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                          <span class="n">String</span> <span class="n">rangeName</span><span class="p">,</span> <span class="n">String</span> <span class="n">styleName</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XCellRange</span> <span class="n">cellRange</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">rangeName</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cellRange</span><span class="p">,</span> <span class="s">&quot;CellStyle&quot;</span><span class="p">,</span> <span class="n">styleName</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Calc.changeStyles() manipulates the styles via the cell range. The cellRange variable
refers to a SheetCellRange service which inherits many properties, including those
from CellProperties. Its "CellStyle" property holds the style name used by that cell
range.</p>
<h3 id="23-adding-borders">2.3.  Adding Borders<a class="headerlink" href="#23-adding-borders" title="Permanent link">&para;</a></h3>
<p>The Calc.addBorder() method highlights borders for a given range of cells. The two
calls in applyStyles() draw a blue line along the bottom edge of the A4:N4 cell range,
and two lines on either side of the "SUM" column (the N1:N4 range), as shown in
Figure 5.</p>
<p><img alt="" src="images/22-Styles-5.png" /></p>
<p>Figure 5. Borders around the Data.</p>
<p>Four border constants are defined in Calc.java:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="c1">// for border decoration (bitwise composition is possible)</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">TOP_BORDER</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">BOTTOM_BORDER</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LEFT_BORDER</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">RIGHT_BORDER</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
</code></pre></div>
<p>Calc.addBorder() highlights a border or borders for a cell range in three steps. First it
creates a border line style, by instantiating a BorderLine2 object. That line style is
used to create a border style represented by a TableBorder2 object. Finally, the border
style is applied to the cell range by setting its "TableBorder2" property.</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addBorder</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span> <span class="n">String</span> <span class="n">rangeName</span><span class="p">,</span>
                                     <span class="kt">int</span> <span class="n">borderVals</span><span class="p">,</span> <span class="kt">int</span> <span class="n">color</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// create a border line style</span>
  <span class="n">BorderLine2</span> <span class="n">line</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BorderLine2</span><span class="p">();</span>
  <span class="n">line</span><span class="p">.</span><span class="na">Color</span> <span class="o">=</span> <span class="n">color</span><span class="p">;</span>
  <span class="n">line</span><span class="p">.</span><span class="na">InnerLineWidth</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="na">LineDistance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">line</span><span class="p">.</span><span class="na">OuterLineWidth</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

  <span class="c1">// use the line style to set border styles</span>
  <span class="n">TableBorder2</span> <span class="n">border</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TableBorder2</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">((</span><span class="n">borderVals</span> <span class="o">&amp;</span> <span class="n">Calc</span><span class="p">.</span><span class="na">TOP_BORDER</span><span class="p">)</span> <span class="o">==</span> <span class="n">Calc</span><span class="p">.</span><span class="na">TOP_BORDER</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">border</span><span class="p">.</span><span class="na">TopLine</span> <span class="o">=</span> <span class="n">line</span><span class="p">;</span>
    <span class="n">border</span><span class="p">.</span><span class="na">IsTopLineValid</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">((</span><span class="n">borderVals</span> <span class="o">&amp;</span> <span class="n">Calc</span><span class="p">.</span><span class="na">BOTTOM_BORDER</span><span class="p">)</span> <span class="o">==</span> <span class="n">Calc</span><span class="p">.</span><span class="na">BOTTOM_BORDER</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">border</span><span class="p">.</span><span class="na">BottomLine</span> <span class="o">=</span> <span class="n">line</span><span class="p">;</span>
    <span class="n">border</span><span class="p">.</span><span class="na">IsBottomLineValid</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">((</span><span class="n">borderVals</span> <span class="o">&amp;</span> <span class="n">Calc</span><span class="p">.</span><span class="na">LEFT_BORDER</span><span class="p">)</span> <span class="o">==</span> <span class="n">Calc</span><span class="p">.</span><span class="na">LEFT_BORDER</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">border</span><span class="p">.</span><span class="na">LeftLine</span> <span class="o">=</span> <span class="n">line</span><span class="p">;</span>
    <span class="n">border</span><span class="p">.</span><span class="na">IsLeftLineValid</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">((</span><span class="n">borderVals</span> <span class="o">&amp;</span> <span class="n">Calc</span><span class="p">.</span><span class="na">RIGHT_BORDER</span><span class="p">)</span> <span class="o">==</span> <span class="n">Calc</span><span class="p">.</span><span class="na">RIGHT_BORDER</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">border</span><span class="p">.</span><span class="na">RightLine</span> <span class="o">=</span> <span class="n">line</span><span class="p">;</span>
    <span class="n">border</span><span class="p">.</span><span class="na">IsRightLineValid</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// store the border style in the cell range</span>
  <span class="n">XCellRange</span> <span class="n">cellRange</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">.</span><span class="na">getCellRangeByName</span><span class="p">(</span><span class="n">rangeName</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cellRange</span><span class="p">,</span> <span class="s">&quot;TableBorder2&quot;</span><span class="p">,</span> <span class="n">border</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of addBorder()</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="21-Extracting_Data.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 21. Extracting Data" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 21. Extracting Data
            </div>
          </div>
        </a>
      
      
        
        <a href="23-Garlic_Secrets.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 23. Garlic Secrets" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 23. Garlic Secrets
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>