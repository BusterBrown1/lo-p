
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 22. Styles - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-22-styles" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 22. Styles
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 22. Styles
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="22-Styles.html" class="md-nav__link md-nav__link--active">
        Chapter 22. Styles
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-obtaining-style-information" class="md-nav__link">
    1.  Obtaining Style Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-cellstyles-family-styles" class="md-nav__link">
    1.  "CellStyles" Family styles:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-pagestyles-family-styles" class="md-nav__link">
    2.  "PageStyles" Family styles:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-creating-and-using-new-styles" class="md-nav__link">
    2.  Creating and Using New Styles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-cellstyles-family-styles_1" class="md-nav__link">
    1.  "CellStyles" Family styles:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-pagestyles-family-styles_1" class="md-nav__link">
    2.  "PageStyles" Family styles:
  </a>
  
    <nav class="md-nav" aria-label="2.  "PageStyles" Family styles:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-creating-a-new-style" class="md-nav__link">
    2.1.  Creating a New Style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-applying-a-new-style" class="md-nav__link">
    2.2.  Applying a New Style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-adding-borders" class="md-nav__link">
    2.3.  Adding Borders
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-obtaining-style-information" class="md-nav__link">
    1.  Obtaining Style Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-cellstyles-family-styles" class="md-nav__link">
    1.  "CellStyles" Family styles:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-pagestyles-family-styles" class="md-nav__link">
    2.  "PageStyles" Family styles:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-creating-and-using-new-styles" class="md-nav__link">
    2.  Creating and Using New Styles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-cellstyles-family-styles_1" class="md-nav__link">
    1.  "CellStyles" Family styles:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-pagestyles-family-styles_1" class="md-nav__link">
    2.  "PageStyles" Family styles:
  </a>
  
    <nav class="md-nav" aria-label="2.  "PageStyles" Family styles:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-creating-a-new-style" class="md-nav__link">
    2.1.  Creating a New Style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-applying-a-new-style" class="md-nav__link">
    2.2.  Applying a New Style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-adding-borders" class="md-nav__link">
    2.3.  Adding Borders
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/22-Styles.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-22-styles">Chapter 22. Styles</h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Obtaining Style 
Information:  the 
TableCellStyle and 
TablePageStyle 
Services;  Creating and 
Using a New Style; 
Adding Borders </p>
<p>Example folders: "Calc 
Tests" and "Utils" </p>
</div>
<p>This chapter looks at how spreadsheet styles are stored, 
how they can be examined, and how new styles can be 
instantiated and used. </p>
<h2 id="1-obtaining-style-information">1.  Obtaining Style Information</h2>
<p>Calc uses the same style API as Writer, Draw, and Impress documents. Figure 1 
shows its structure. </p>
<p><img alt="" src="images/22-Styles-1.png" /></p>
<p>Figure 1. Calc Style Families and their Property Sets. </p>
<p>The Calc API only has two style families, CellStyles and PageStyles. A cell style can 
be applied to a cell, a cell range, or a spreadsheet (which is a very big cell range). A 
page style can be applied only to a spreadsheet. </p>
<p>Each style family consists of styles, which are collection of property sets. The default 
cell style is called "Default", as is the default page style. </p>
<p>The StylesAllInfo.java example prints out the style family names and the style names 
associated with the input document: </p>
<p>// in StylesAllInfo.java 
public static void main(String args[]) 
{ 
  if (args.length &lt; 1) { 
    System.out.println("Usage: run StylesAllInfo <fnm>"); 
    return; 
  } </p>
<p>XComponentLoader loader = Lo.loadOffice(); 
  XComponent doc = Lo.openDoc(args[0], loader); 
  if (doc == null) { 
    System.out.println("Could not open " + args[0]); 
    Lo.closeOffice(); 
    return; 
  } </p>
<p>// get all the style families for this document 
  String[] styleFamilies = Info.getStyleFamilyNames(doc); 
  System.out.println("Style Family Names (" +<br />
                             styleFamilies.length + "): "); 
  for(String styleFamily : styleFamilies) 
    System.out.println("  " + styleFamily); 
  System.out.println(); </p>
<p>// list all the style names for each style family 
  for(int i=0; i &lt; styleFamilies.length; i++) { 
    String styleFamily = styleFamilies[i]; 
    System.out.println((i+1) + ". \"" + styleFamily +<br />
                                         "\" Family styles:"); 
    String[] styleNames = Info.getStyleNames(doc, styleFamily); 
    Lo.printNames(styleNames); 
  } </p>
<p>Lo.closeDoc(doc); 
  Lo.closeOffice(); 
}  // end of main() </p>
<p>This code uses the Info.getStyleFamilyNames() and Info.getStyleNames() functions 
which I utilized in earlier chapters, so I won't explain their implementation again. The 
output for a simple spreadsheet is: </p>
<p>Style Family Names (2): 
  CellStyles 
  PageStyles </p>
<h2 id="1-cellstyles-family-styles">1.  "CellStyles" Family styles:</h2>
<p>No. of names: 5 
  "Default"  "Heading"  "Heading1"  "Result" 
  "Result2" </p>
<h2 id="2-pagestyles-family-styles">2.  "PageStyles" Family styles:</h2>
<p>No. of names: 2 
  "Default"  "Report" </p>
<p>Finding Style Information 
From a programming point of view, the main difficult with styles is finding 
documentation about their properties, so that a value can be correctly read or changed.  </p>
<p>One approach is to use my Info.getStyleProps() method to list the properties for a 
given style family and style name. For example, the following displays all the 
properties for the default cell and page styles: </p>
<p>// commented out code in StylesAllInfo.java 
Props.showProps("CellStyles Default",<br />
                  Info.getStyleProps(doc, "CellStyles", "Default") ); </p>
<p>Props.showProps("PageStyles Default",<br />
                 Info.getStyleProps(doc, "PageStyles", "Default") ); </p>
<p>The problem is that the output is extremely long, and some property names are less 
descriptive/understandable than others.  </p>
<p>It's probably better to search the online documentation for properties. Cell styles are 
managed by the TableCellStyle service (see Figure 22) and page styles by the 
TablePageStyle service (Figure 23). Use lodoc TableCellStyle and lodoc 
TablePageStyle to access the online information. </p>
<p>The properties managed by TableCellStyle are inherited from a number of places, as 
summarized by Figure 2. </p>
<p><img alt="" src="images/22-Styles-2.png" /></p>
<p>Figure 2. The TableCellStyle Service. </p>
<p>By far the most important source of cell style properties is the CellProperties class in 
the table module (use lodoc cellproperties service). However, if a property 
relates to the text in a cell then it's more likely to originate from the 
CharacterProperties or ParagraphProperties classes in the style module (e.g. use 
lodoc characterproperties service). </p>
<p>The properties managed by TablePageStyle are also inherited from a few places, as 
summarized by Figure 3. </p>
<p><img alt="" src="images/22-Styles-3.png" /></p>
<p>Figure 3. The TablePageStyle Service. </p>
<p>The main place to look for page properties is the PageProperties class in the style 
module (e.g. use lodoc pageproperties service). The properties relate to things 
such as page margins, headers, and footers, which become important when printing a 
sheet. </p>
<h2 id="2-creating-and-using-new-styles">2.  Creating and Using New Styles</h2>
<p>The steps required in creating and using a new style are illustrated by 
BuildTables.java, in createStyles() and applyStyles(): </p>
<p>// in BuildTables.java 
// globals 
private static String HEADER_STYLE_NAME = "My HeaderStyle"; 
private static String DATA_STYLE_NAME = "My DataStyle"; </p>
<p>public static void main(String args[]) 
{ 
  XComponentLoader loader = Lo.loadOffice(); 
  XSpreadsheetDocument doc = Calc.createDoc(loader); 
  if (doc == null) { 
    System.out.println("Document creation failed"); 
    Lo.closeOffice(); 
    return; 
  } 
  GUI.setVisible(doc, true); 
  XSpreadsheet sheet = Calc.getSheet(doc, 0); </p>
<p>buildArray(sheet); 
  createStyles(doc); 
  applyStyles(sheet); </p>
<p>Lo.saveDoc(doc, "buildTable.ods"); 
  Lo.waitEnter(); 
  Lo.closeDoc(doc); 
  Lo.closeOffice(); 
}  // end of main() </p>
<p>createStyles() creates two cell styles called "My HeaderStyle" and "My DataStyle", 
which are applied to the spreadsheet by applyStyles(). The result is shown in Figure 4. </p>
<p><img alt="" src="images/22-Styles-4.png" /></p>
<p>Figure 4. Styled Spreadsheet Cells. </p>
<p>The "My HeaderStyle" style is applied to the top row and the first column: the cells 
are colored blue, and the text made white and centered. The "My DataStyle" is used 
for the numerical data and formulae cells: the background color is made a light blue, 
and the text is right-justified. applyStyles() also changes the border properties of the 
bottom edges of the cells in the last row to be thick and blue.  </p>
<p>The resulting spreadsheet is saved in "buildTable.ods". If this document is examined 
by the StylesAllInfo.java program, it lists the new styles in the "CellStyles" family: </p>
<blockquote>
<p>run StylesAllInfo buildTable.ods 
Loading Office... </p>
</blockquote>
<p>Opening buildTable.ods 
Style Family Names (2): 
  CellStyles 
  PageStyles </p>
<h2 id="1-cellstyles-family-styles_1">1.  "CellStyles" Family styles:</h2>
<p>No. of names: 7 
  "Default"  "Heading"  "Heading1"  "My DataStyle" 
  "My HeaderStyle"  "Result"  "Result2" </p>
<h2 id="2-pagestyles-family-styles_1">2.  "PageStyles" Family styles:</h2>
<p>No. of names: 2 
  "Default"  "Report" </p>
<p>Closing the document 
Closing Office 
Office terminated </p>
<h3 id="21-creating-a-new-style">2.1.  Creating a New Style</h3>
<p>BuildTables.java calls createStyles() to create two styles: </p>
<p>// in BuildTables.java 
public static void createStyles(XSpreadsheetDocument doc) 
// create HEADER_STYLE_NAME and<br />
// DATA_STYLE_NAME cell styles 
{ 
  try { 
    XStyle style1 = Calc.createCellStyle(doc, HEADER_STYLE_NAME); </p>
<pre><code>XPropertySet props1 = Lo.qi(XPropertySet.class, style1); 
props1.setPropertyValue("IsCellBackgroundTransparent", false); 
props1.setPropertyValue("CellBackColor", 0x6699FF);   //dark blue 
props1.setPropertyValue("CharColor", 0xFFFFFF);       // white

// Center cell content horizontally and vertically in the cell 
props1.setPropertyValue("HoriJustify", CellHoriJustify.CENTER);  
props1.setPropertyValue("VertJustify", CellVertJustify.CENTER);


XStyle style2 = Calc.createCellStyle(doc, DATA_STYLE_NAME);

XPropertySet props2 = Lo.qi(XPropertySet.class, style2); 
props2.setPropertyValue("IsCellBackgroundTransparent", false); 
props2.setPropertyValue("CellBackColor", 0xC2EBFF); //light blue 
props2.setPropertyValue("ParaRightMargin", 500);   
                                  // move away from right edge
</code></pre>
<p>} 
  catch (com.sun.star.uno.Exception e) { 
    System.out.println(e); 
  } 
}  // end of createStyles() </p>
<p>The styles are created by two calls to Calc.createCellStyle(), which stores them in the 
"CellStyles" family: </p>
<p>// in the Calc class 
public static XStyle createCellStyle(XSpreadsheetDocument doc,<br />
                                           String styleName) 
{ 
  // access the "CellStyles" family 
  XComponent compDoc = Lo.qi(XComponent.class, doc); 
  XNameContainer styleFamilies =<br />
              Info.getStyleContainer(compDoc, "CellStyles"); </p>
<p>// create a new style 
  XStyle style = Lo.createInstanceMSF(XStyle.class,<br />
                          "com.sun.star.style.CellStyle"); 
  try { 
    styleFamilies.insertByName(styleName, style);  // add to family 
    return style; 
  } 
  catch(Exception e) 
  {  System.out.println("Unable to create style: " + styleName); 
     return null; 
  } 
}  // end of createCellStyle() </p>
<p>Calc.createCellStyle() calls Info.getStyleContainer() to return a reference to the 
"CellStyles" family as an XNameContainer. A new cell style is created by calling 
Lo.createInstanceMSF(), and referred to using the XStyle interface. This style is 
added to the family by calling XNameContainer.insertByName() with the name 
passed to the function. </p>
<p>A new style is automatically derived from the "Default" style, so the rest of the 
createStyles() method involves the changing of properties. Five are adjusted in the 
"My HeaderStyle" style, and three in "My DataStyle". </p>
<p>The header properties are "IsCellBackgroundTransparent", "CellBackColor", 
"CharColor", "HoriJustify", and "VertJustify", which are all defined in the 
CellProperties class (see Figure 2).   </p>
<p>The data properties are "IsCellBackgroundTransparent", "CellBackColor", and 
"ParaRightMargin". Although "IsCellBackgroundTransparent" and "CellBackColor" 
are from the CellProperties class, "ParaRightMargin" is inherited from the 
ParagraphProperties class in the style module (also in Figure 2). </p>
<h3 id="22-applying-a-new-style">2.2.  Applying a New Style</h3>
<p>The new styles, "My HeaderStyle" and "My DataStyle", are applied to the spreadsheet 
by the BuildTable.java method applyStyles(): </p>
<p>// in BuildTable.java 
private static void applyStyles(XSpreadsheet sheet) 
{ 
  // apply cell styles 
  Calc.changeStyle(sheet, "B1:N1", HEADER_STYLE_NAME);  <br />
  Calc.changeStyle(sheet, "A2:A4", HEADER_STYLE_NAME); <br />
  Calc.changeStyle(sheet, "B2:N4", DATA_STYLE_NAME);  </p>
<p>// change borders for the cell ranges 
  Calc.addBorder(sheet, "A4:N4", Calc.BOTTOM_BORDER, 0x6699FF);<br />
                                  //dark blue bottom edge </p>
<p>Calc.addBorder(sheet, "N1:N4",<br />
               Calc.LEFT_BORDER | Calc.RIGHT_BORDER, 0x6699FF); 
                                  // dark blue left and right edges 
}  // end of applyStyles() </p>
<p>The header style is applied to two cell ranges: B1:N1 is the top row containing the 
months (see Figure 4), and A2:A4 is the first column. The data style is applied to 
B2:N4 which spans the numerical data and formulae. </p>
<p>Calc.changeStyle() is defined as: </p>
<p>// in the Calc class 
public static void changeStyle(XSpreadsheet sheet,<br />
                          String rangeName, String styleName) 
{ XCellRange cellRange = Calc.getCellRange(sheet, rangeName); 
  Props.setProperty(cellRange, "CellStyle", styleName); 
}  </p>
<p>Calc.changeStyles() manipulates the styles via the cell range. The cellRange variable 
refers to a SheetCellRange service which inherits many properties, including those 
from CellProperties. Its "CellStyle" property holds the style name used by that cell 
range. </p>
<h3 id="23-adding-borders">2.3.  Adding Borders</h3>
<p>The Calc.addBorder() method highlights borders for a given range of cells. The two 
calls in applyStyles() draw a blue line along the bottom edge of the A4:N4 cell range, 
and two lines on either side of the "SUM" column (the N1:N4 range), as shown in </p>
<p><img alt="" src="images/22-Styles-5.png" /></p>
<p>Figure 5. </p>
<p><img alt="" src="images/22-Styles-5.png" /></p>
<p>Figure 5. Borders around the Data. </p>
<p>Four border constants are defined in Calc.java: </p>
<p>// in the Calc class 
// for border decoration (bitwise composition is possible) 
public static final int TOP_BORDER = 0x01; 
public static final int BOTTOM_BORDER = 0x02; 
public static final int LEFT_BORDER = 0x04; 
public static final int RIGHT_BORDER = 0x08; </p>
<p>Calc.addBorder() highlights a border or borders for a cell range in three steps. First it 
creates a border line style, by instantiating a BorderLine2 object. That line style is 
used to create a border style represented by a TableBorder2 object. Finally, the border 
style is applied to the cell range by setting its "TableBorder2" property. </p>
<p>// in the Calc class 
public static void addBorder(XSpreadsheet sheet, String rangeName,<br />
                                     int borderVals, int color) 
{ 
  // create a border line style 
  BorderLine2 line = new BorderLine2(); <br />
  line.Color = color;<br />
  line.InnerLineWidth = line.LineDistance = 0; 
  line.OuterLineWidth = 100; </p>
<p>// use the line style to set border styles 
  TableBorder2 border = new TableBorder2(); </p>
<p>if ((borderVals &amp; Calc.TOP_BORDER) == Calc.TOP_BORDER) { 
    border.TopLine = line; 
    border.IsTopLineValid = true; 
  } </p>
<p>if ((borderVals &amp; Calc.BOTTOM_BORDER) == Calc.BOTTOM_BORDER) { 
    border.BottomLine = line; 
    border.IsBottomLineValid = true; 
  } </p>
<p>if ((borderVals &amp; Calc.LEFT_BORDER) == Calc.LEFT_BORDER) { 
    border.LeftLine = line; 
    border.IsLeftLineValid = true; 
  } </p>
<p>if ((borderVals &amp; Calc.RIGHT_BORDER) == Calc.RIGHT_BORDER) { 
    border.RightLine = line; 
    border.IsRightLineValid = true; 
  } </p>
<p>// store the border style in the cell range 
  XCellRange cellRange = sheet.getCellRangeByName(rangeName); 
  Props.setProperty(cellRange, "TableBorder2", border); 
}  // end of addBorder() </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="21-Extracting_Data.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 21. Extracting Data
            </div>
          </div>
        </a>
      
      
        <a href="23-Garlic_Secrets.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 23. Garlic Secrets
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>