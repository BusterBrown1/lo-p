
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 24. Complex Data Manipulation - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-24-complex-data-manipulation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 24. Complex Data Manipulation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 24. Complex Data Manipulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link md-nav__link--active">
        Chapter 24. Complex Data Manipulation
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-sorting-data" class="md-nav__link">
    1.  Sorting Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-obtain-an-xsortable-interface-for-the-cell-range" class="md-nav__link">
    1.  Obtain an XSortable interface for the cell range;
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-specify-the-sorting-criteria-as-a-tablesortfield-array" class="md-nav__link">
    2.  Specify the sorting criteria as a TableSortField array;
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-create-a-sort-descriptor" class="md-nav__link">
    3.  Create a sort descriptor;
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-execute-the-sort" class="md-nav__link">
    4.  Execute the sort.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-generating-data" class="md-nav__link">
    2.  Generating Data
  </a>
  
    <nav class="md-nav" aria-label="2.  Generating Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-using-the-linear-mode" class="md-nav__link">
    2.1.  Using the LINEAR Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-using-the-date-mode" class="md-nav__link">
    2.2.  Using the DATE Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-using-the-growth-mode" class="md-nav__link">
    2.3.  Using the GROWTH Mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-cells-with-fancy-text" class="md-nav__link">
    3.  Cells with Fancy Text
  </a>
  
    <nav class="md-nav" aria-label="3.  Cells with Fancy Text">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-creating-a-border-and-headline" class="md-nav__link">
    3.1.  Creating a Border and Headline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-adding-hyperlink-text" class="md-nav__link">
    3.2.  Adding Hyperlink Text
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-printing-the-cells-text" class="md-nav__link">
    3.3.  Printing the Cell's Text
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-adding-an-annotation" class="md-nav__link">
    3.4.  Adding an Annotation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-sorting-data" class="md-nav__link">
    1.  Sorting Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-obtain-an-xsortable-interface-for-the-cell-range" class="md-nav__link">
    1.  Obtain an XSortable interface for the cell range;
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-specify-the-sorting-criteria-as-a-tablesortfield-array" class="md-nav__link">
    2.  Specify the sorting criteria as a TableSortField array;
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-create-a-sort-descriptor" class="md-nav__link">
    3.  Create a sort descriptor;
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-execute-the-sort" class="md-nav__link">
    4.  Execute the sort.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-generating-data" class="md-nav__link">
    2.  Generating Data
  </a>
  
    <nav class="md-nav" aria-label="2.  Generating Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-using-the-linear-mode" class="md-nav__link">
    2.1.  Using the LINEAR Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-using-the-date-mode" class="md-nav__link">
    2.2.  Using the DATE Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-using-the-growth-mode" class="md-nav__link">
    2.3.  Using the GROWTH Mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-cells-with-fancy-text" class="md-nav__link">
    3.  Cells with Fancy Text
  </a>
  
    <nav class="md-nav" aria-label="3.  Cells with Fancy Text">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-creating-a-border-and-headline" class="md-nav__link">
    3.1.  Creating a Border and Headline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-adding-hyperlink-text" class="md-nav__link">
    3.2.  Adding Hyperlink Text
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-printing-the-cells-text" class="md-nav__link">
    3.3.  Printing the Cell's Text
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-adding-an-annotation" class="md-nav__link">
    3.4.  Adding an Annotation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/24-Complex_Data_Manipulation.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-24-complex-data-manipulation">Chapter 24. Complex Data Manipulation<a class="headerlink" href="#chapter-24-complex-data-manipulation" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Sorting Data; 
Generating Data: 
Automatic, LINEAR 
Mode, DATE Mode, 
GROWTH Mode; Fancy 
Text: borders, headlines, 
hyperlinks, annotations </p>
<p>Example folders: "Calc 
Tests" and "Utils"  </p>
</div>
<p>This chapter looks at a variety of less common text 
manipulation techniques, including the sorting of data, 
generating data based on examples, and the use of borders, 
headlines, hyperlinks, and annotations in cells. </p>
<h2 id="1-sorting-data">1.  Sorting Data<a class="headerlink" href="#1-sorting-data" title="Permanent link">&para;</a></h2>
<p>Sorting is available through SheetCellRange's XSortable interface. There are four 
basic steps required for sorting a block of cells: </p>
<h2 id="1-obtain-an-xsortable-interface-for-the-cell-range">1.  Obtain an XSortable interface for the cell range;<a class="headerlink" href="#1-obtain-an-xsortable-interface-for-the-cell-range" title="Permanent link">&para;</a></h2>
<h2 id="2-specify-the-sorting-criteria-as-a-tablesortfield-array">2.  Specify the sorting criteria as a TableSortField array;<a class="headerlink" href="#2-specify-the-sorting-criteria-as-a-tablesortfield-array" title="Permanent link">&para;</a></h2>
<h2 id="3-create-a-sort-descriptor">3.  Create a sort descriptor;<a class="headerlink" href="#3-create-a-sort-descriptor" title="Permanent link">&para;</a></h2>
<h2 id="4-execute-the-sort">4.  Execute the sort.<a class="headerlink" href="#4-execute-the-sort" title="Permanent link">&para;</a></h2>
<p>These steps are illustrated by the DataSort.java example, which begins by building a 
small table: </p>
<p>// in DataSort.java 
public static void main(String args[]) 
{ 
  XComponentLoader loader = Lo.loadOffice(); 
  XSpreadsheetDocument doc = Calc.createDoc(loader); 
  if (doc == null) { 
    System.out.println("Document creation failed"); 
    Lo.closeOffice(); 
    return; 
  } 
  GUI.setVisible(doc, true); 
  XSpreadsheet sheet = Calc.getSheet(doc, 0); </p>
<p>// create a table that needs sorting 
  Object[][] vals = { 
    { "Level", "Code", "No.", "Team", "Name" }, 
    { "BS", 20, 4, "B", "Elle" },<br />
    { "BS", 20, 6, "C", "Sweet" }, 
    { "BS", 20, 2, "A", "Chcomic" },<br />
    { "CS", 30, 5, "A", "Ally" }, 
    { "MS", 10, 1, "A", "Joker" },<br />
    { "MS", 10, 3, "B", "Kevin" }, 
    { "CS", 30, 7, "C", "Tom" } }; 
  Calc.setArray(sheet, "A1:E8", vals);    // or just "A1" </p>
<div class="highlight"><pre><span></span><code> : // sorting code; explained below
</code></pre></div>
<p>Lo.saveDoc(doc, "dataSort.ods"); 
  Lo.waitEnter(); 
  Lo.closeDoc(doc); 
  Lo.closeOffice(); </p>
<p>}  // end of main() </p>
<p>The unsorted table is shown in Figure 1.  </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-1.png" /></p>
<p>Figure 1. An Unsorted Table. </p>
<p>The table is sorted so that its rows are in ascending order depending on their "Code" 
column values. When two rows have the same code number then the sort uses the 
"No." column. Figure 2 shows the result of applying these two sorting criteria: </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-2.png" /></p>
<p>Figure 2. The Sorted Table, Using Two Sort Criteria. </p>
<p>The four sorting steps mentioned above are implemented like so: </p>
<p>// in DataSort.java 
    : 
// 1. obtain an XSortable interface for the cell range 
XCellRange sourceRange = Calc.getCellRange(sheet, "A1:E8"); 
XSortable xSort = Lo.qi(XSortable.class, sourceRange); </p>
<p>// 2. specify the two sorting criteria as a TableSortField array 
TableSortField[] sortFields = new TableSortField[2]; 
sortFields[0] = makeSortAsc(1, true);     // sort by "B" col 
sortFields[1] = makeSortAsc(2, true);     // then sort by "C" col </p>
<p>// 3. define a sort descriptor 
PropertyValue[] props = Props.makeProps("SortFields", sortFields, 
                                        "ContainsHeader", true); 
Lo.wait(2000); <br />
   //wait a bit so user can see original table before it's sorted </p>
<p>System.out.println("Sorting...");<br />
xSort.sort(props);   // 4. do the sort 
    : </p>
<p>The "A1:E8" cell range referenced using the XCellRange interface is converted to 
XSortable. This interface is defined in Office's util module, not in sheet or table, 
probably because it's also used in text documents for sorting tables. You can find its 
documentation by calling lodoc xsortable. </p>
<p>The two sorting criteria are represented by two TableSortField objects in an array. </p>
<p>The makeSortAsc() function is defined in DataSort.java as: </p>
<p>// in DataSort.java 
private static TableSortField makeSortAsc(int index,<br />
                                          boolean isAscending) 
// make a TableSortField object 
{ TableSortField sf = new TableSortField(); 
  sf.Field = index; 
  sf.IsAscending = isAscending;  // ascending or descending 
  sf.IsCaseSensitive = false; 
  return sf; 
}  // end of makeSortAsc() </p>
<p>A sort descriptor is an array of PropertyValue objects which affect how 
XSortable.sort() executes. The most commonly used properties are "SortFields" and 
"ContainsHeader". "SortFields" is assigned the sorting criteria (i.e. the TableSortField 
array), and the "ContainsHeader" boolean specifies whether  the sort should exclude 
the first row because it contains header text. </p>
<p>The sort descriptor properties are defined in a number of classes (SortDescriptor2, 
TableSortDescriptor2, and TextSortDescriptor2), which are most easily accessed from 
the XSortable documentation page.  </p>
<h2 id="2-generating-data">2.  Generating Data<a class="headerlink" href="#2-generating-data" title="Permanent link">&para;</a></h2>
<p>Cell data is generated by supplying numbers to a function which treats them as the 
initial values in a arithmetic (or geometric) series. The function employs the series to 
churn out as many more numbers as are needed to fill a given cell range.  </p>
<p>A series is created by the XCellSeries interface, which is part of the SheetCellRange 
service (see Figure 3).  </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-3.png" /></p>
<p>Figure 3. The Cell Range Services. </p>
<p>Several examples of how to use XCellSeries' two methods, fillAuto() and fillSeries(), 
are contained in the Filler.java example described next. </p>
<p>Filler.java starts by filling a blank sheet with an assortment of data, which will be 
used by the XCellSeries methods to initialize several series. The original sheet is 
shown in Figure 4. </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-4.png" /></p>
<p>Figure 4. The Filler.java Sheet before Data Generation. </p>
<p>The simpler of the two XCellSeries methods, XCellSeries.fillAuto(), requires a cell 
range, fill direction, and how many cells should be examined as 'seeds'. For example, 
rows 7, 8, and 9 of Figure 4 are filled using: </p>
<dl>
<dt>// in fillSeries() in Filler.java</dt>
<dd>// store two values in three rows... </dd>
</dl>
<p>// ascending integers: 1, 2 
Calc.setVal(sheet, "A7", 1);<br />
Calc.setVal(sheet, "B7", 2); </p>
<p>// dates, decreasing by month 
Calc.setDate(sheet, "A8", 28, 2, 2015); 
Calc.setDate(sheet, "B8", 28, 1, 2015); </p>
<p>// descending integers: 6, 4 
Calc.setVal(sheet, "A9", 6); 
Calc.setVal(sheet, "B9", 4); </p>
<p>// get cell range series 
XCellSeries series = Calc.getCellSeries(sheet, "A7:G9"); </p>
<p>// use first 2 cells for series, and fill to the right 
series.fillAuto(FillDirection.TO_RIGHT, 2); </p>
<p>The supplied cell range (A7:G9) includes the seed values, and the cells to be filled. </p>
<p>It's converted into an XCellSeries interface by Calc.getCellSeries(), which is defined 
as: </p>
<p>// in the Calc class 
public static XCellSeries getCellSeries(XSpreadsheet sheet,<br />
                                                String rangeName) 
{ XCellRange cellRange = sheet.getCellRangeByName(rangeName); 
  return Lo.qi(XCellSeries.class, cellRange); 
} </p>
<p>XCellSeries.fillAuto() can be supplied with four possible fill directions 
(TO_BOTTOM, TO_RIGHT, TO_TOP, and TO_LEFT) which also dictate which 
cells are examined for seeds. By setting the direction to be TO_RIGHT, seed cells in 
the left-hand parts of the rows are examined. The numerical argument (2) in the call to 
fillAuto() shown above specifies how many of those cells will be considered in order 
to automatically determine the series used for the generated cell values. </p>
<p>Figure 5 shows the result of filling rows 7, 8, and 9. </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-5.png" /></p>
<p>Figure 5.  Row Filling Using XCellSeries.fillAuto(). </p>
<p>If XCellSeries.fillAuto() doesn't guess the correct series for the data generation, then 
XCellSeries.fillSeries() offers finer control over the process. It supports five modes: 
SIMPLE, LINEAR , GROWTH, DATE, and AUTO.  </p>
<p>SIMPLE switches off the series generator, and the seed data is copied unchanged to 
the other blank cells. AUTO makes Office generate its data series automatically, so 
performs in the same way as fillAuto(). LINEAR , GROWTH, and DATE give more 
control to the programmer. </p>
<h3 id="21-using-the-linear-mode">2.1.  Using the LINEAR Mode<a class="headerlink" href="#21-using-the-linear-mode" title="Permanent link">&para;</a></h3>
<p>Rows 2 and 3 of the spreadsheet contain the numbers 1 and 4 (see Figure 4). By using 
the LINEAR mode, a step, and a stopping value, it's possible to specify an arithmetic 
series. For example: </p>
<dl>
<dt>// in fillSeries() in Filler.java</dt>
<dd>Calc.setVal(sheet, "A2", 1); 
Calc.setVal(sheet, "A3", 4); </dd>
</dl>
<p>/* Fill 2 rows; the 2<sup>nd</sup> row is not filled completely since 
   the end value is reached */ 
series = Calc.getCellSeries(sheet, "A2:E3"); 
series.fillSeries(FillDirection.TO_RIGHT, FillMode.LINEAR, 
                                                Calc.NO_DATE, 2, 9); 
                      // ignore date mode; step == 2; end at 9 </p>
<p>The Calc.NO_DATE argument means that dates are not being generated. The '2' value 
is the step, and '9' is the maximum. The resulting rows 2 and 3 are shown in Figure 6. </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-6.png" /></p>
<p>Figure 6. Data Generation Using the LINEAR Mode. </p>
<p>Note that the second row is incomplete since the generated values for those cells (10 
and 12) exceeded the stopping value.  </p>
<p>If no stopping value is required, then the last argument can be replaced with 
Calc.MAX_VALUE. </p>
<h3 id="22-using-the-date-mode">2.2.  Using the DATE Mode<a class="headerlink" href="#22-using-the-date-mode" title="Permanent link">&para;</a></h3>
<p>If XCellSeries.fillSeries() is called using the DATE mode then it's possible to specify 
whether the day, weekday, month, or year parts of the seed date are changed by the 
series. For example, the seed date at the start of row 4 (20<sup>th</sup> Nov. 2015) can be 
incremented one month at a time with the code: </p>
<dl>
<dt>// in fillSeries() in Filler.java</dt>
<dd>Calc.setDate(sheet, "A4", 20, 11, 2015);    // day, month, year </dd>
</dl>
<p>// fill by adding one month to date 
series = Calc.getCellSeries(sheet, "A4:E4"); 
series.fillSeries(FillDirection.TO_RIGHT, FillMode.DATE, 
                  FillDateMode.FILL_DATE_MONTH, 1, Calc.MAX_VALUE); </p>
<p>The result is shown in Figure 7. </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-7.png" /></p>
<p>Figure 7. Data Generation Using the DATE Mode. </p>
<p>When the month is incremented past 12, it resets to 1, and the year is incremented. </p>
<h3 id="23-using-the-growth-mode">2.3.  Using the GROWTH Mode<a class="headerlink" href="#23-using-the-growth-mode" title="Permanent link">&para;</a></h3>
<p>Whereas the LINEAR mode is for creating arithmetic series (i.e. ones incrementing or 
decrementing in steps), GROWTH mode is for geometric progressions where the 
'step' value is repeatedly multiplied to the seed. </p>
<p>In the following example, the seed in "G6" (10; see Figure 7) is used in a geometric 
progression using multiples of 2. The series is placed in cells going up the sheet 
starting from "G6". The code: </p>
<p>// in fillSeries() in Filler.java 
    : 
Calc.setVal(sheet, "G6", 10);  </p>
<p>// Fill from  bottom to top with a geometric series (*2) 
series = Calc.getCellSeries(sheet, "G2:G6"); 
series.fillSeries(FillDirection.TO_TOP, FillMode.GROWTH, 
                            Calc.NO_DATE, 2, Calc.MAX_VALUE); </p>
<p>The resulting sheet is shown in Figure 8. </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-8.png" /></p>
<p>Figure 8. Data Generation Using the GROWTH Mode. </p>
<h2 id="3-cells-with-fancy-text">3.  Cells with Fancy Text<a class="headerlink" href="#3-cells-with-fancy-text" title="Permanent link">&para;</a></h2>
<p>The CellsText.java example brings together a few techniques for manipulating text in 
cells, namely the addition of borders, headlines, hyperlinks, and annotations. The 
sheet ends up looking like Figure 9. </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-9.png" /></p>
<p>Figure 9. Text manipulation in a Sheet. </p>
<h3 id="31-creating-a-border-and-headline">3.1.  Creating a Border and Headline<a class="headerlink" href="#31-creating-a-border-and-headline" title="Permanent link">&para;</a></h3>
<p>CellTexts.java draws a decorative border and headline by calling: </p>
<p>// in CellTexts.java 
Calc.highlightRange(sheet, "A2:C7", "Cells and Cell Ranges"); </p>
<p>Calc.highlightRange() adds a light blue border around the specified cell range 
(A2:C7), and the string argument is added to the top-left cell of the range. It's 
intended to be a headline, so is drawn in dark blue, and the entire top row is made 
light blue to match the border. The method is implemented as: </p>
<p>// in the Calc class 
// some hex values for commonly used colors 
public static final int DARK_BLUE = 0x003399; 
public static final int LIGHT_BLUE = 0x99CCFF; </p>
<p>public static void highlightRange(XSpreadsheet sheet,<br />
                      String rangeName, String headline) 
{ 
  Calc.addBorder(sheet, rangeName, LIGHT_BLUE);  </p>
<p>// color the headline row 
  CellRangeAddress addr = Calc.getAddress(sheet, rangeName); 
  XCellRange headerRange = getCellRange(sheet,<br />
                       addr.StartColumn, addr.StartRow, 
                       addr.EndColumn, addr.StartRow); 
  Props.setProperty(headerRange, "CellBackColor", LIGHT_BLUE); </p>
<p>// add headline text to the first cell of the row 
  XCell firstCell = getCell(headerRange, 0, 0); <br />
                                 // location is relative to range 
  setVal(firstCell, headline); </p>
<p>// make text dark blue and bold 
  Props.setProperty(firstCell, "CharColor", DARK_BLUE); 
  Props.setProperty(firstCell, "CharWeight",<br />
                        com.sun.star.awt.FontWeight.BOLD); 
}  // end of highlightRange() </p>
<p>The three-argument addBorder() method calls the four-argument version which was 
described back in Chapter 22, section 2.3. It passes it a bitwise composition of all the 
border constants: </p>
<p>// in the Calc class 
public static void addBorder(XSpreadsheet sheet,<br />
                                   String rangeName, int color) 
{ addBorder(sheet, rangeName,<br />
                 Calc.LEFT_BORDER | Calc.RIGHT_BORDER | 
                 Calc.TOP_BORDER | Calc.BOTTOM_BORDER, color); 
}   </p>
<p>The cell range for the top row is extracted from the larger range supplied to 
Calc.highlightRange(). The easiest way of doing this is to get the address of the larger 
range as a CellRangeAddress object, and use its row and column positions. The 
header cell range uses the same row index for its starting and finishing rows: </p>
<dl>
<dt>// part of Calc.highlightRange()</dt>
<dd>CellRangeAddress addr = Calc.getAddress(sheet, rangeName); 
XCellRange headerRange = getCellRange(sheet,<br />
                 addr.StartColumn, addr.StartRow, 
                 addr.EndColumn, addr.StartRow); 
  // header row uses same start and end row from addr </dd>
</dl>
<p>Perhaps the most confusing part of Calc.highlightRange() is how the first cell of the 
header range is referenced: 
XCell firstCell = getCell(headerRange, 0, 0); 
This is a somewhat different use of getCell() than previous examples, which have 
always found a cell within a sheet. For instance: 
XCell cell = Calc.getCell(sheet, 0, 0); 
The definition for this version of getCell() is: </p>
<p>// in the Calc class 
public static XCell getCell(XCellRange cellRange,<br />
                                    int column, int row) 
{ try { 
    return cellRange.getCellByPosition(column, row); 
  } 
  catch (Exception e) { 
    System.out.println("Could not access cell in at: " +<br />
                                     column + " - " + row); 
    return null; 
  } 
}  // end of getCell() </p>
<p>A position in a cell range (e.g. a (column, row) coordinate)  is defined relative to the 
cell range. This means that the call: <br />
XCell firstCell = getCell(headerRange, 0, 0); <br />
is requesting the top-left cell in headerRange. Since the headerRange covers A2:C2, 
(0, 0) means the "A2" cell. </p>
<h3 id="32-adding-hyperlink-text">3.2.  Adding Hyperlink Text<a class="headerlink" href="#32-adding-hyperlink-text" title="Permanent link">&para;</a></h3>
<p>Figure 9 shows that the "B4" cell contains two paragraphs. The second ends with a 
hyperlink, which means that if the user control-clicks on the "hypertext" text, then the 
URL "<a href="http://fivedots.coe.psu.ac.th/~ad/jlop/">http://fivedots.coe.psu.ac.th/~ad/jlop/</a>" is opened in the OSes default web 
browser. </p>
<p>The SheetCell service inherits the Cell service which allows a cell to be manipulated 
with the XCell or the XText interfaces (see Figure 10).  </p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-10.png" /></p>
<p>Figure 10. The SheetCell Services and Interfaces. </p>
<p>Once the cell is converted into XText, many of my Writer support methods can be 
utilized. For example: </p>
<p>// in CellTexts.java 
     : 
// Insert two text paragraphs and a hyperlink into the cell 
XText xText = Lo.qi(XText.class, xCell);  // cell  text 
XTextCursor cursor = xText.createTextCursor(); </p>
<p>Write.appendPara(cursor, "Text in first line."); 
Write.append(cursor, "And a "); 
Write.addHyperlink(cursor, "hyperlink",<br />
         "<a href="http://fivedots.coe.psu.ac.th/~ad/jlop/">http://fivedots.coe.psu.ac.th/~ad/jlop/</a>"); </p>
<p>A text cursor is created for the cell, and used to add the two paragraphs and the 
hyperlink. </p>
<p>Cell formatting is done through its properties. As Figure 10 shows, the SheetCell 
service inherits the CharacterProperties and ParagraphProperties classes, which 
contain the properties related to cell text: </p>
<p>// in CellTexts.java 
     : 
// beautify the cell with big, blue, indented text 
// properties from CharacterProperties 
Props.setProperty(xCell, "CharHeight", 20.0); 
Props.setProperty(xCell, "CharColor", Calc.DARK_BLUE); </p>
<p>// property from ParagraphProperties 
Props.setProperty(xCell, "ParaLeftMargin", 500); </p>
<h3 id="33-printing-the-cells-text">3.3.  Printing the Cell's Text<a class="headerlink" href="#33-printing-the-cells-text" title="Permanent link">&para;</a></h3>
<p>The cell's text is accessed via its XText interface: </p>
<p>// in CellTexts.java 
private static void printCellText(XCell xCell) 
{ 
  XText xText = Lo.qi(XText.class, xCell); 
  System.out.println("Cell Text: \"" + xText.getString() + "\""); 
         : // more code, explained below 
} </p>
<p>The call to XText.getString() returns all the text, which is printed as: </p>
<p>Cell Text: "Text in first line. </p>
<p>And a hypertext" </p>
<p>The text can also be examined by moving a text cursor through it: 
XTextCursor cursor = xText.createTextCursor(); 
However, I was surprised to discover that this text cursor can not be converted into a 
sentence or paragraph cursor. Both the following calls return null: </p>
<p>XSentenceCursor sentCursor = Lo.qi(XSentenceCursor.class, cursor); 
XParagraphCursor paraCursor = Lo.qi(XParagraphCursor.class, cursor); </p>
<h3 id="34-adding-an-annotation">3.4.  Adding an Annotation<a class="headerlink" href="#34-adding-an-annotation" title="Permanent link">&para;</a></h3>
<p>Cells can be annotated, which causes a little yellow text box to appear near the cell, 
linked to the cell by an arrow (as in Figure 9). Creating a new annotation is a two-step 
process: the XSheetAnnotationsSupplier interface is used to access the collection of 
existing annotations, and a new one is added by supplying the annotation text and the 
address of the cell where its arrow will point. These steps are performed by the first 
half of Calc.addAnnotation(): </p>
<p>// in the Calc class 
public static void addAnnotation(XSpreadsheet sheet,<br />
                                String cellName, String msg) 
{<br />
  // get the existing annotations 
  CellAddress addr = getCellAddress(sheet, cellName); 
  XSheetAnnotationsSupplier annsSupp = 
                     Lo.qi(XSheetAnnotationsSupplier.class, sheet); 
  XSheetAnnotations anns = annsSupp.getAnnotations(); </p>
<p>anns.insertNew(addr, msg); // add the new annotation </p>
<p>// get a reference to the new annotation 
  XCell xCell = getCell(sheet, cellName); 
  XSheetAnnotationAnchor annAnchor =<br />
               Lo.qi(XSheetAnnotationAnchor.class, xCell); 
  XSheetAnnotation ann = annAnchor.getAnnotation(); </p>
<p>ann.setIsVisible(true);  // make annotation visible 
} // end of addAnnotation() </p>
<p>Annotation creation doesn't return a reference to the new annotation object. For that 
it's necessary to examine the cell pointed to by the annotation. XCell is converted into 
a XSheetAnnotationAnchor, which has a getAnnotation() method for returning the 
annotation (if one exists). </p>
<p>XSheetAnnotation has several methods for obtaining information about the position, 
author, and modification date of the annotation. setIsVisible() allows its visibility to 
be switched on and off. </p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="23-Garlic_Secrets.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 23. Garlic Secrets" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 23. Garlic Secrets
            </div>
          </div>
        </a>
      
      
        
        <a href="25-Monitoring_Sheets.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 25. Monitoring Sheets" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 25. Monitoring Sheets
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>