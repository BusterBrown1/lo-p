
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/24-Complex_Data_Manipulation.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>Chapter 24. Complex Data Manipulation - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-24-complex-data-manipulation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 24. Complex Data Manipulation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 24. Complex Data Manipulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link md-nav__link--active">
        Chapter 24. Complex Data Manipulation
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-sorting-data" class="md-nav__link">
    1.  Sorting Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-generating-data" class="md-nav__link">
    2.  Generating Data
  </a>
  
    <nav class="md-nav" aria-label="2.  Generating Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-using-the-linear-mode" class="md-nav__link">
    2.1.  Using the LINEAR Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-using-the-date-mode" class="md-nav__link">
    2.2.  Using the DATE Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-using-the-growth-mode" class="md-nav__link">
    2.3.  Using the GROWTH Mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-cells-with-fancy-text" class="md-nav__link">
    3.  Cells with Fancy Text
  </a>
  
    <nav class="md-nav" aria-label="3.  Cells with Fancy Text">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-creating-a-border-and-headline" class="md-nav__link">
    3.1.  Creating a Border and Headline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-adding-hyperlink-text" class="md-nav__link">
    3.2.  Adding Hyperlink Text
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-printing-the-cells-text" class="md-nav__link">
    3.3.  Printing the Cell's Text
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-adding-an-annotation" class="md-nav__link">
    3.4.  Adding an Annotation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-sorting-data" class="md-nav__link">
    1.  Sorting Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-generating-data" class="md-nav__link">
    2.  Generating Data
  </a>
  
    <nav class="md-nav" aria-label="2.  Generating Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-using-the-linear-mode" class="md-nav__link">
    2.1.  Using the LINEAR Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-using-the-date-mode" class="md-nav__link">
    2.2.  Using the DATE Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-using-the-growth-mode" class="md-nav__link">
    2.3.  Using the GROWTH Mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-cells-with-fancy-text" class="md-nav__link">
    3.  Cells with Fancy Text
  </a>
  
    <nav class="md-nav" aria-label="3.  Cells with Fancy Text">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-creating-a-border-and-headline" class="md-nav__link">
    3.1.  Creating a Border and Headline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-adding-hyperlink-text" class="md-nav__link">
    3.2.  Adding Hyperlink Text
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-printing-the-cells-text" class="md-nav__link">
    3.3.  Printing the Cell's Text
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-adding-an-annotation" class="md-nav__link">
    3.4.  Adding an Annotation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/flywire/lo-p/edit/main/docs/24-Complex_Data_Manipulation.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="chapter-24-complex-data-manipulation">Chapter 24. Complex Data Manipulation<a class="headerlink" href="#chapter-24-complex-data-manipulation" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Sorting Data;
Generating Data:
Automatic, LINEAR
Mode, DATE Mode,
GROWTH Mode; Fancy
Text: borders, headlines,
hyperlinks, annotations</p>
<p>Example folders: "Calc
Tests" and "Utils"</p>
</div>
<p>This chapter looks at a variety of less common text
manipulation techniques, including the sorting of data,
generating data based on examples, and the use of borders,
headlines, hyperlinks, and annotations in cells.</p>
<h2 id="1-sorting-data">1.  Sorting Data<a class="headerlink" href="#1-sorting-data" title="Permanent link">&para;</a></h2>
<p>Sorting is available through SheetCellRange's XSortable interface. There are four
basic steps required for sorting a block of cells:</p>
<ol>
<li>Obtain an XSortable interface for the cell range;</li>
<li>Specify the sorting criteria as a TableSortField array;</li>
<li>Create a sort descriptor;</li>
<li>Execute the sort.</li>
</ol>
<p>These steps are illustrated by the DataSort.java example, which begins by building a
small table:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in DataSort.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XSpreadsheetDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">createDoc</span><span class="p">(</span><span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Document creation failed&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">XSpreadsheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheet</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="c1">// create a table that needs sorting</span>
  <span class="n">Object</span><span class="o">[][]</span> <span class="n">vals</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">{</span> <span class="s">&quot;Level&quot;</span><span class="p">,</span> <span class="s">&quot;Code&quot;</span><span class="p">,</span> <span class="s">&quot;No.&quot;</span><span class="p">,</span> <span class="s">&quot;Team&quot;</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s">&quot;BS&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;B&quot;</span><span class="p">,</span> <span class="s">&quot;Elle&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s">&quot;BS&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">,</span> <span class="s">&quot;Sweet&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s">&quot;BS&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="s">&quot;Chcomic&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s">&quot;CS&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="s">&quot;Ally&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s">&quot;MS&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="s">&quot;Joker&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s">&quot;MS&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&quot;B&quot;</span><span class="p">,</span> <span class="s">&quot;Kevin&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s">&quot;CS&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">,</span> <span class="s">&quot;Tom&quot;</span> <span class="p">}</span> <span class="p">};</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">setArray</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A1:E8&quot;</span><span class="p">,</span> <span class="n">vals</span><span class="p">);</span>    <span class="c1">// or just &quot;A1&quot;</span>

     <span class="p">:</span> <span class="c1">// sorting code; explained below</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">saveDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;dataSort.ods&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">waitEnter</span><span class="p">();</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>

<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The unsorted table is shown in Figure 1.</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-1.png" /></p>
<p>Figure 1. An Unsorted Table.</p>
<p>The table is sorted so that its rows are in ascending order depending on their "Code"
column values. When two rows have the same code number then the sort uses the
"No." column. Figure 2 shows the result of applying these two sorting criteria:</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-2.png" /></p>
<p>Figure 2. The Sorted Table, Using Two Sort Criteria.</p>
<p>The four sorting steps mentioned above are implemented like so:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in DataSort.java</span>
    <span class="p">:</span>
<span class="c1">// 1. obtain an XSortable interface for the cell range</span>
<span class="n">XCellRange</span> <span class="n">sourceRange</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A1:E8&quot;</span><span class="p">);</span>
<span class="n">XSortable</span> <span class="n">xSort</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XSortable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sourceRange</span><span class="p">);</span>

<span class="c1">// 2. specify the two sorting criteria as a TableSortField array</span>
<span class="n">TableSortField</span><span class="o">[]</span> <span class="n">sortFields</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TableSortField</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>
<span class="n">sortFields</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">makeSortAsc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>     <span class="c1">// sort by &quot;B&quot; col</span>
<span class="n">sortFields</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">makeSortAsc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>     <span class="c1">// then sort by &quot;C&quot; col</span>

<span class="c1">// 3. define a sort descriptor</span>
<span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;SortFields&quot;</span><span class="p">,</span> <span class="n">sortFields</span><span class="p">,</span>
                                        <span class="s">&quot;ContainsHeader&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="n">Lo</span><span class="p">.</span><span class="na">wait</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
   <span class="c1">//wait a bit so user can see original table before it&#39;s sorted</span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Sorting...&quot;</span><span class="p">);</span>
<span class="n">xSort</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>   <span class="c1">// 4. do the sort</span>
    <span class="p">:</span>
</code></pre></div>
</div>
</div>
</div>
<p>The "A1:E8" cell range referenced using the XCellRange interface is converted to
XSortable. This interface is defined in Office's util module, not in sheet or table,
probably because it's also used in text documents for sorting tables. You can find its
documentation by calling <code>lodoc xsortable</code>.</p>
<p>The two sorting criteria are represented by two TableSortField objects in an array.
The makeSortAsc() function is defined in DataSort.java as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in DataSort.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">TableSortField</span> <span class="nf">makeSortAsc</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">,</span>
                                          <span class="kt">boolean</span> <span class="n">isAscending</span><span class="p">)</span>
<span class="c1">// make a TableSortField object</span>
<span class="p">{</span> <span class="n">TableSortField</span> <span class="n">sf</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TableSortField</span><span class="p">();</span>
  <span class="n">sf</span><span class="p">.</span><span class="na">Field</span> <span class="o">=</span> <span class="n">index</span><span class="p">;</span>
  <span class="n">sf</span><span class="p">.</span><span class="na">IsAscending</span> <span class="o">=</span> <span class="n">isAscending</span><span class="p">;</span>  <span class="c1">// ascending or descending</span>
  <span class="n">sf</span><span class="p">.</span><span class="na">IsCaseSensitive</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">sf</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of makeSortAsc()</span>
</code></pre></div>
</div>
</div>
</div>
<p>A sort descriptor is an array of PropertyValue objects which affect how
XSortable.sort() executes. The most commonly used properties are "SortFields" and
"ContainsHeader". "SortFields" is assigned the sorting criteria (i.e. the TableSortField
array), and the "ContainsHeader" boolean specifies whether  the sort should exclude
the first row because it contains header text.</p>
<p>The sort descriptor properties are defined in a number of classes (SortDescriptor2,
TableSortDescriptor2, and TextSortDescriptor2), which are most easily accessed from
the XSortable documentation page.</p>
<h2 id="2-generating-data">2.  Generating Data<a class="headerlink" href="#2-generating-data" title="Permanent link">&para;</a></h2>
<p>Cell data is generated by supplying numbers to a function which treats them as the
initial values in a arithmetic (or geometric) series. The function employs the series to
churn out as many more numbers as are needed to fill a given cell range.</p>
<p>A series is created by the XCellSeries interface, which is part of the SheetCellRange
service (see Figure 3).</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-3.png" /></p>
<p>Figure 3. The Cell Range Services.</p>
<p>Several examples of how to use XCellSeries' two methods, fillAuto() and fillSeries(),
are contained in the Filler.java example described next.</p>
<p>Filler.java starts by filling a blank sheet with an assortment of data, which will be
used by the XCellSeries methods to initialize several series. The original sheet is
shown in Figure 4.</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-4.png" /></p>
<p>Figure 4. The Filler.java Sheet before Data Generation.</p>
<p>The simpler of the two XCellSeries methods, XCellSeries.fillAuto(), requires a cell
range, fill direction, and how many cells should be examined as 'seeds'. For example,
rows 7, 8, and 9 of Figure 4 are filled using:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in fillSeries() in Filler.java</span>
  <span class="p">:</span>
<span class="c1">// store two values in three rows...</span>


<span class="c1">// ascending integers: 1, 2</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setVal</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A7&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setVal</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;B7&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="c1">// dates, decreasing by month</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setDate</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A8&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2015</span><span class="p">);</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setDate</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;B8&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2015</span><span class="p">);</span>

<span class="c1">// descending integers: 6, 4</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setVal</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A9&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setVal</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;B9&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

<span class="c1">// get cell range series</span>
<span class="n">XCellSeries</span> <span class="n">series</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellSeries</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A7:G9&quot;</span><span class="p">);</span>

<span class="c1">// use first 2 cells for series, and fill to the right</span>
<span class="n">series</span><span class="p">.</span><span class="na">fillAuto</span><span class="p">(</span><span class="n">FillDirection</span><span class="p">.</span><span class="na">TO_RIGHT</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The supplied cell range (A7:G9) includes the seed values, and the cells to be filled.</p>
<p>It's converted into an XCellSeries interface by Calc.getCellSeries(), which is defined
as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XCellSeries</span> <span class="nf">getCellSeries</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                                                <span class="n">String</span> <span class="n">rangeName</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XCellRange</span> <span class="n">cellRange</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">.</span><span class="na">getCellRangeByName</span><span class="p">(</span><span class="n">rangeName</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XCellSeries</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cellRange</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>XCellSeries.fillAuto() can be supplied with four possible fill directions
(TO_BOTTOM, TO_RIGHT, TO_TOP, and TO_LEFT) which also dictate which
cells are examined for seeds. By setting the direction to be TO_RIGHT, seed cells in
the left-hand parts of the rows are examined. The numerical argument (2) in the call to
fillAuto() shown above specifies how many of those cells will be considered in order
to automatically determine the series used for the generated cell values.</p>
<p>Figure 5 shows the result of filling rows 7, 8, and 9.</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-5.png" /></p>
<p>Figure 5.  Row Filling Using XCellSeries.fillAuto().</p>
<p>If XCellSeries.fillAuto() doesn't guess the correct series for the data generation, then
XCellSeries.fillSeries() offers finer control over the process. It supports five modes:
SIMPLE, LINEAR , GROWTH, DATE, and AUTO.</p>
<p>SIMPLE switches off the series generator, and the seed data is copied unchanged to
the other blank cells. AUTO makes Office generate its data series automatically, so
performs in the same way as fillAuto(). LINEAR , GROWTH, and DATE give more
control to the programmer.</p>
<h3 id="21-using-the-linear-mode">2.1.  Using the LINEAR Mode<a class="headerlink" href="#21-using-the-linear-mode" title="Permanent link">&para;</a></h3>
<p>Rows 2 and 3 of the spreadsheet contain the numbers 1 and 4 (see Figure 4). By using
the LINEAR mode, a step, and a stopping value, it's possible to specify an arithmetic
series. For example:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in fillSeries() in Filler.java</span>
   <span class="p">:</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setVal</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setVal</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A3&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

<span class="cm">/* Fill 2 rows; the 2nd row is not filled completely since</span>
<span class="cm">   the end value is reached */</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellSeries</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A2:E3&quot;</span><span class="p">);</span>
<span class="n">series</span><span class="p">.</span><span class="na">fillSeries</span><span class="p">(</span><span class="n">FillDirection</span><span class="p">.</span><span class="na">TO_RIGHT</span><span class="p">,</span> <span class="n">FillMode</span><span class="p">.</span><span class="na">LINEAR</span><span class="p">,</span>
                                                <span class="n">Calc</span><span class="p">.</span><span class="na">NO_DATE</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
                      <span class="c1">// ignore date mode; step == 2; end at 9</span>
</code></pre></div>
</div>
</div>
</div>
<p>The Calc.NO_DATE argument means that dates are not being generated. The '2' value
is the step, and '9' is the maximum. The resulting rows 2 and 3 are shown in Figure 6.</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-6.png" /></p>
<p>Figure 6. Data Generation Using the LINEAR Mode.</p>
<p>Note that the second row is incomplete since the generated values for those cells (10
and 12) exceeded the stopping value.</p>
<p>If no stopping value is required, then the last argument can be replaced with
Calc.MAX_VALUE.</p>
<h3 id="22-using-the-date-mode">2.2.  Using the DATE Mode<a class="headerlink" href="#22-using-the-date-mode" title="Permanent link">&para;</a></h3>
<p>If XCellSeries.fillSeries() is called using the DATE mode then it's possible to specify
whether the day, weekday, month, or year parts of the seed date are changed by the
series. For example, the seed date at the start of row 4 (20<sup>th</sup> Nov. 2015) can be
incremented one month at a time with the code:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in fillSeries() in Filler.java</span>
   <span class="p">:</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setDate</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A4&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2015</span><span class="p">);</span>    <span class="c1">// day, month, year</span>

<span class="c1">// fill by adding one month to date</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellSeries</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A4:E4&quot;</span><span class="p">);</span>
<span class="n">series</span><span class="p">.</span><span class="na">fillSeries</span><span class="p">(</span><span class="n">FillDirection</span><span class="p">.</span><span class="na">TO_RIGHT</span><span class="p">,</span> <span class="n">FillMode</span><span class="p">.</span><span class="na">DATE</span><span class="p">,</span>
                  <span class="n">FillDateMode</span><span class="p">.</span><span class="na">FILL_DATE_MONTH</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">MAX_VALUE</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The result is shown in Figure 7.</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-7.png" /></p>
<p>Figure 7. Data Generation Using the DATE Mode.</p>
<p>When the month is incremented past 12, it resets to 1, and the year is incremented.</p>
<h3 id="23-using-the-growth-mode">2.3.  Using the GROWTH Mode<a class="headerlink" href="#23-using-the-growth-mode" title="Permanent link">&para;</a></h3>
<p>Whereas the LINEAR mode is for creating arithmetic series (i.e. ones incrementing or
decrementing in steps), GROWTH mode is for geometric progressions where the
'step' value is repeatedly multiplied to the seed.</p>
<p>In the following example, the seed in "G6" (10; see Figure 7) is used in a geometric
progression using multiples of 2. The series is placed in cells going up the sheet
starting from "G6". The code:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in fillSeries() in Filler.java</span>
    <span class="p">:</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">setVal</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;G6&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

<span class="c1">// Fill from  bottom to top with a geometric series (*2)</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellSeries</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;G2:G6&quot;</span><span class="p">);</span>
<span class="n">series</span><span class="p">.</span><span class="na">fillSeries</span><span class="p">(</span><span class="n">FillDirection</span><span class="p">.</span><span class="na">TO_TOP</span><span class="p">,</span> <span class="n">FillMode</span><span class="p">.</span><span class="na">GROWTH</span><span class="p">,</span>
                            <span class="n">Calc</span><span class="p">.</span><span class="na">NO_DATE</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">MAX_VALUE</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The resulting sheet is shown in Figure 8.</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-8.png" /></p>
<p>Figure 8. Data Generation Using the GROWTH Mode.</p>
<h2 id="3-cells-with-fancy-text">3.  Cells with Fancy Text<a class="headerlink" href="#3-cells-with-fancy-text" title="Permanent link">&para;</a></h2>
<p>The CellsText.java example brings together a few techniques for manipulating text in
cells, namely the addition of borders, headlines, hyperlinks, and annotations. The
sheet ends up looking like Figure 9.</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-9.png" /></p>
<p>Figure 9. Text manipulation in a Sheet.</p>
<h3 id="31-creating-a-border-and-headline">3.1.  Creating a Border and Headline<a class="headerlink" href="#31-creating-a-border-and-headline" title="Permanent link">&para;</a></h3>
<p>CellTexts.java draws a decorative border and headline by calling:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in CellTexts.java</span>
<span class="n">Calc</span><span class="p">.</span><span class="na">highlightRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;A2:C7&quot;</span><span class="p">,</span> <span class="s">&quot;Cells and Cell Ranges&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Calc.highlightRange() adds a light blue border around the specified cell range
(A2:C7), and the string argument is added to the top-left cell of the range. It's
intended to be a headline, so is drawn in dark blue, and the entire top row is made
light blue to match the border. The method is implemented as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="c1">// some hex values for commonly used colors</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DARK_BLUE</span> <span class="o">=</span> <span class="mh">0x003399</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LIGHT_BLUE</span> <span class="o">=</span> <span class="mh">0x99CCFF</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">highlightRange</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                      <span class="n">String</span> <span class="n">rangeName</span><span class="p">,</span> <span class="n">String</span> <span class="n">headline</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">addBorder</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">rangeName</span><span class="p">,</span> <span class="n">LIGHT_BLUE</span><span class="p">);</span>

  <span class="c1">// color the headline row</span>
  <span class="n">CellRangeAddress</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">rangeName</span><span class="p">);</span>
  <span class="n">XCellRange</span> <span class="n">headerRange</span> <span class="o">=</span> <span class="n">getCellRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span>
                       <span class="n">addr</span><span class="p">.</span><span class="na">StartColumn</span><span class="p">,</span> <span class="n">addr</span><span class="p">.</span><span class="na">StartRow</span><span class="p">,</span>
                       <span class="n">addr</span><span class="p">.</span><span class="na">EndColumn</span><span class="p">,</span> <span class="n">addr</span><span class="p">.</span><span class="na">StartRow</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">headerRange</span><span class="p">,</span> <span class="s">&quot;CellBackColor&quot;</span><span class="p">,</span> <span class="n">LIGHT_BLUE</span><span class="p">);</span>

  <span class="c1">// add headline text to the first cell of the row</span>
  <span class="n">XCell</span> <span class="n">firstCell</span> <span class="o">=</span> <span class="n">getCell</span><span class="p">(</span><span class="n">headerRange</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
                                 <span class="c1">// location is relative to range</span>
  <span class="n">setVal</span><span class="p">(</span><span class="n">firstCell</span><span class="p">,</span> <span class="n">headline</span><span class="p">);</span>

  <span class="c1">// make text dark blue and bold</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">firstCell</span><span class="p">,</span> <span class="s">&quot;CharColor&quot;</span><span class="p">,</span> <span class="n">DARK_BLUE</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">firstCell</span><span class="p">,</span> <span class="s">&quot;CharWeight&quot;</span><span class="p">,</span>
                        <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">FontWeight</span><span class="p">.</span><span class="na">BOLD</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of highlightRange()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The three-argument addBorder() method calls the four-argument version which was
described back in Chapter 22, section 2.3. It passes it a bitwise composition of all the
border constants:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:1"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addBorder</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                                   <span class="n">String</span> <span class="n">rangeName</span><span class="p">,</span> <span class="kt">int</span> <span class="n">color</span><span class="p">)</span>
<span class="p">{</span> <span class="n">addBorder</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">rangeName</span><span class="p">,</span>
                 <span class="n">Calc</span><span class="p">.</span><span class="na">LEFT_BORDER</span> <span class="o">|</span> <span class="n">Calc</span><span class="p">.</span><span class="na">RIGHT_BORDER</span> <span class="o">|</span>
                 <span class="n">Calc</span><span class="p">.</span><span class="na">TOP_BORDER</span> <span class="o">|</span> <span class="n">Calc</span><span class="p">.</span><span class="na">BOTTOM_BORDER</span><span class="p">,</span> <span class="n">color</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>The cell range for the top row is extracted from the larger range supplied to
Calc.highlightRange(). The easiest way of doing this is to get the address of the larger
range as a CellRangeAddress object, and use its row and column positions. The
header cell range uses the same row index for its starting and finishing rows:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:1"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// part of Calc.highlightRange()</span>
   <span class="p">:</span>
<span class="n">CellRangeAddress</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">rangeName</span><span class="p">);</span>
<span class="n">XCellRange</span> <span class="n">headerRange</span> <span class="o">=</span> <span class="n">getCellRange</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span>
                 <span class="n">addr</span><span class="p">.</span><span class="na">StartColumn</span><span class="p">,</span> <span class="n">addr</span><span class="p">.</span><span class="na">StartRow</span><span class="p">,</span>
                 <span class="n">addr</span><span class="p">.</span><span class="na">EndColumn</span><span class="p">,</span> <span class="n">addr</span><span class="p">.</span><span class="na">StartRow</span><span class="p">);</span>
  <span class="c1">// header row uses same start and end row from addr</span>
</code></pre></div>
</div>
</div>
</div>
<p>Perhaps the most confusing part of Calc.highlightRange() is how the first cell of the
header range is referenced:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XCell</span> <span class="n">firstCell</span> <span class="o">=</span> <span class="n">getCell</span><span class="p">(</span><span class="n">headerRange</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>This is a somewhat different use of getCell() than previous examples, which have
always found a cell within a sheet. For instance:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XCell</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCell</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The definition for this version of getCell() is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:1"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XCell</span> <span class="nf">getCell</span><span class="p">(</span><span class="n">XCellRange</span> <span class="n">cellRange</span><span class="p">,</span>
                                    <span class="kt">int</span> <span class="n">column</span><span class="p">,</span> <span class="kt">int</span> <span class="n">row</span><span class="p">)</span>
<span class="p">{</span> <span class="k">try</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">cellRange</span><span class="p">.</span><span class="na">getCellByPosition</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">row</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access cell in at: &quot;</span> <span class="o">+</span>
                                     <span class="n">column</span> <span class="o">+</span> <span class="s">&quot; - &quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getCell()</span>
</code></pre></div>
</div>
</div>
</div>
<p>A position in a cell range (e.g. a (column, row) coordinate)  is defined relative to the
cell range. This means that the call:
XCell firstCell = getCell(headerRange, 0, 0);
is requesting the top-left cell in headerRange. Since the headerRange covers A2:C2,
(0, 0) means the "A2" cell.</p>
<h3 id="32-adding-hyperlink-text">3.2.  Adding Hyperlink Text<a class="headerlink" href="#32-adding-hyperlink-text" title="Permanent link">&para;</a></h3>
<p>Figure 9 shows that the "B4" cell contains two paragraphs. The second ends with a
hyperlink, which means that if the user control-clicks on the "hypertext" text, then the
URL "<a href="https://fivedots.coe.psu.ac.th/~ad/jlop/">https://fivedots.coe.psu.ac.th/~ad/jlop/</a>" is opened in the OSes default web
browser.</p>
<p>The SheetCell service inherits the Cell service which allows a cell to be manipulated
with the XCell or the XText interfaces (see Figure 10).</p>
<p><img alt="" src="images/24-Complex_Data_Manipulation-10.png" /></p>
<p>Figure 10. The SheetCell Services and Interfaces.</p>
<p>Once the cell is converted into XText, many of my Writer support methods can be
utilized. For example:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:1"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in CellTexts.java</span>
     <span class="p">:</span>
<span class="c1">// Insert two text paragraphs and a hyperlink into the cell</span>
<span class="n">XText</span> <span class="n">xText</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xCell</span><span class="p">);</span>  <span class="c1">// cell  text</span>
<span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">xText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>

<span class="n">Write</span><span class="p">.</span><span class="na">appendPara</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;Text in first line.&quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;And a &quot;</span><span class="p">);</span>
<span class="n">Write</span><span class="p">.</span><span class="na">addHyperlink</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;hyperlink&quot;</span><span class="p">,</span>
         <span class="s">&quot;https://fivedots.coe.psu.ac.th/~ad/jlop/&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>A text cursor is created for the cell, and used to add the two paragraphs and the
hyperlink.</p>
<p>Cell formatting is done through its properties. As Figure 10 shows, the SheetCell
service inherits the CharacterProperties and ParagraphProperties classes, which
contain the properties related to cell text:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:1"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in CellTexts.java</span>
     <span class="p">:</span>
<span class="c1">// beautify the cell with big, blue, indented text</span>
<span class="c1">// properties from CharacterProperties</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">xCell</span><span class="p">,</span> <span class="s">&quot;CharHeight&quot;</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">xCell</span><span class="p">,</span> <span class="s">&quot;CharColor&quot;</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">DARK_BLUE</span><span class="p">);</span>

<span class="c1">// property from ParagraphProperties</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">xCell</span><span class="p">,</span> <span class="s">&quot;ParaLeftMargin&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="33-printing-the-cells-text">3.3.  Printing the Cell's Text<a class="headerlink" href="#33-printing-the-cells-text" title="Permanent link">&para;</a></h3>
<p>The cell's text is accessed via its XText interface:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:1"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in CellTexts.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printCellText</span><span class="p">(</span><span class="n">XCell</span> <span class="n">xCell</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XText</span> <span class="n">xText</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xCell</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Cell Text: \&quot;&quot;</span> <span class="o">+</span> <span class="n">xText</span><span class="p">.</span><span class="na">getString</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
         <span class="p">:</span> <span class="c1">// more code, explained below</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>The call to XText.getString() returns all the text, which is printed as:</p>
<div class="highlight"><pre><span></span><code>Cell Text: &quot;Text in first line.
And a hypertext&quot;
</code></pre></div>
<p>The text can also be examined by moving a text cursor through it:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:1"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">xText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>
</code></pre></div>
</div>
</div>
</div>
<p>However, I was surprised to discover that this text cursor can not be converted into a
sentence or paragraph cursor. Both the following calls return null:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:1"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XSentenceCursor</span> <span class="n">sentCursor</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XSentenceCursor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cursor</span><span class="p">);</span>
<span class="n">XParagraphCursor</span> <span class="n">paraCursor</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XParagraphCursor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cursor</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="34-adding-an-annotation">3.4.  Adding an Annotation<a class="headerlink" href="#34-adding-an-annotation" title="Permanent link">&para;</a></h3>
<p>Cells can be annotated, which causes a little yellow text box to appear near the cell,
linked to the cell by an arrow (as in Figure 9). Creating a new annotation is a two-step
process: the XSheetAnnotationsSupplier interface is used to access the collection of
existing annotations, and a new one is added by supplying the annotation text and the
address of the cell where its arrow will point. These steps are performed by the first
half of Calc.addAnnotation():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:1"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addAnnotation</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                                <span class="n">String</span> <span class="n">cellName</span><span class="p">,</span> <span class="n">String</span> <span class="n">msg</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// get the existing annotations</span>
  <span class="n">CellAddress</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">getCellAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">cellName</span><span class="p">);</span>
  <span class="n">XSheetAnnotationsSupplier</span> <span class="n">annsSupp</span> <span class="o">=</span>
                     <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XSheetAnnotationsSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
  <span class="n">XSheetAnnotations</span> <span class="n">anns</span> <span class="o">=</span> <span class="n">annsSupp</span><span class="p">.</span><span class="na">getAnnotations</span><span class="p">();</span>

  <span class="n">anns</span><span class="p">.</span><span class="na">insertNew</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">msg</span><span class="p">);</span> <span class="c1">// add the new annotation</span>

  <span class="c1">// get a reference to the new annotation</span>
  <span class="n">XCell</span> <span class="n">xCell</span> <span class="o">=</span> <span class="n">getCell</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">cellName</span><span class="p">);</span>
  <span class="n">XSheetAnnotationAnchor</span> <span class="n">annAnchor</span> <span class="o">=</span>
               <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XSheetAnnotationAnchor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xCell</span><span class="p">);</span>
  <span class="n">XSheetAnnotation</span> <span class="n">ann</span> <span class="o">=</span> <span class="n">annAnchor</span><span class="p">.</span><span class="na">getAnnotation</span><span class="p">();</span>

  <span class="n">ann</span><span class="p">.</span><span class="na">setIsVisible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>  <span class="c1">// make annotation visible</span>
<span class="p">}</span> <span class="c1">// end of addAnnotation()</span>
</code></pre></div>
</div>
</div>
</div>
<p>Annotation creation doesn't return a reference to the new annotation object. For that
it's necessary to examine the cell pointed to by the annotation. XCell is converted into
a XSheetAnnotationAnchor, which has a getAnnotation() method for returning the
annotation (if one exists).</p>
<p>XSheetAnnotation has several methods for obtaining information about the position,
author, and modification date of the annotation. setIsVisible() allows its visibility to
be switched on and off.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="23-Garlic_Secrets.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 23. Garlic Secrets" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 23. Garlic Secrets
            </div>
          </div>
        </a>
      
      
        
        <a href="25-Monitoring_Sheets.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 25. Monitoring Sheets" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 25. Monitoring Sheets
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>