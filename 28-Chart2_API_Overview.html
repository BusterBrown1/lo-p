
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 28. Chart2 API Overview - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-28-chart2-api-overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 28. Chart2 API Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 28. Chart2 API Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="28-Chart2_API_Overview.html" class="md-nav__link md-nav__link--active">
        Chapter 28. Chart2 API Overview
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-charting-elements" class="md-nav__link">
    1.  Charting Elements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-chart-creation" class="md-nav__link">
    2.  Chart Creation
  </a>
  
    <nav class="md-nav" aria-label="2.  Chart Creation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-creating-a-table-chart" class="md-nav__link">
    2.1.  Creating a Table Chart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-accessing-the-chart-document" class="md-nav__link">
    2.2.  Accessing the Chart Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-initializing-the-chart-document" class="md-nav__link">
    2.3.  Initializing the Chart Document
  </a>
  
    <nav class="md-nav" aria-label="2.3.  Initializing the Chart Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-the-diagram" class="md-nav__link">
    Get the Diagram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-template" class="md-nav__link">
    Creating a Template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-data-source" class="md-nav__link">
    Get the Data Source
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linking-the-template-diagram-and-data-source" class="md-nav__link">
    Linking the template, diagram, and data source
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-accessing-and-modifying-chart-elements" class="md-nav__link">
    3.  Accessing and Modifying Chart Elements
  </a>
  
    <nav class="md-nav" aria-label="3.  Accessing and Modifying Chart Elements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-accessing-the-diagram" class="md-nav__link">
    3.1.  Accessing the Diagram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-accessing-the-coordinate-system" class="md-nav__link">
    3.2.  Accessing the Coordinate System
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-accessing-the-chart-type" class="md-nav__link">
    3.3.  Accessing the Chart Type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-accessing-the-data-series" class="md-nav__link">
    3.4.  Accessing the Data Series
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-charting-elements" class="md-nav__link">
    1.  Charting Elements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-chart-creation" class="md-nav__link">
    2.  Chart Creation
  </a>
  
    <nav class="md-nav" aria-label="2.  Chart Creation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-creating-a-table-chart" class="md-nav__link">
    2.1.  Creating a Table Chart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-accessing-the-chart-document" class="md-nav__link">
    2.2.  Accessing the Chart Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-initializing-the-chart-document" class="md-nav__link">
    2.3.  Initializing the Chart Document
  </a>
  
    <nav class="md-nav" aria-label="2.3.  Initializing the Chart Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-the-diagram" class="md-nav__link">
    Get the Diagram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-template" class="md-nav__link">
    Creating a Template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-data-source" class="md-nav__link">
    Get the Data Source
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linking-the-template-diagram-and-data-source" class="md-nav__link">
    Linking the template, diagram, and data source
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-accessing-and-modifying-chart-elements" class="md-nav__link">
    3.  Accessing and Modifying Chart Elements
  </a>
  
    <nav class="md-nav" aria-label="3.  Accessing and Modifying Chart Elements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-accessing-the-diagram" class="md-nav__link">
    3.1.  Accessing the Diagram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-accessing-the-coordinate-system" class="md-nav__link">
    3.2.  Accessing the Coordinate System
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-accessing-the-chart-type" class="md-nav__link">
    3.3.  Accessing the Chart Type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-accessing-the-data-series" class="md-nav__link">
    3.4.  Accessing the Data Series
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/28-Chart2_API_Overview.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-28-chart2-api-overview">Chapter 28. Chart2 API Overview<a class="headerlink" href="#chapter-28-chart2-api-overview" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Charting
Elements; Chart
Creation: TableChart,
ChartDocument, linking
template, diagram, and
data source; Modifying
Chart Elements:
diagram, coordinate
system, chart type, data
series</p>
<p>Example folders:
"Chart2 Tests" and
"Utils"</p>
</div>
<p>At over 1,600 pages the OpenOffice Developer's Guide
isn't a quick read, but you might expect it to cover all the
major parts of the Office API. That's mostly true, except
for one omission – there's no mention of the <code>chart2</code>
charting module. It's absent from the guide, the online
examples, and only makes a brief appearance in the Wiki,
at <a href="https://wiki.openoffice.org/wiki/Chart">https://wiki.openoffice.org/wiki/Chart</a>.</p>
<p>That's not to say that chart creation isn't explained in the
guide; chapter 10 is all about that topic, but using the older
charting module, called <code>chart</code> (as you might guess). One
source of confusion is that both modules have a similar
top-level interface to Calc via XTableChart and XChartDocument, but they rapidly
diverge as you progress further into the APIs. A sure way to make code crash is to
mix services and interfaces from the two modules.</p>
<p>Since newer is obviously better, the question arises as to why the Developer's Guide
skips <code>chart2</code>? The reason seems to be historical – the guide was written for
OpenOffice version 3.1, which dates from the middle of 2009. The chart2 module was
released two years before, in September 2007, for version 2.3. That release came with
dire warnings in the Wiki about the API being unstable and subject to change,
comments that are still there. I'm sure those warnings were valid back in 2007, but
chart2 underwent a lot of development over the next three years before LibreOffice
was forked off in September 2010. After that the pace of change slowed, mainly
because the module was stable. For example, Calc's charting wizard is implemented
using chart2.</p>
<p>Since the developer's guide hasn't been updated in six years, the chart2 module hasn't
received much notice. I'll be rectifying that by concentrating solely on chart2
programming; I won't be using the old chart API.</p>
<p>The primary source of online information about chart2 is its API documentation at
<a href="http://api.libreoffice.org/docs/idl/ref/namespacecom_1_1sun_1_1star_1_1chart2.html">http://api.libreoffice.org/docs/idl/ref/namespacecom_1_1sun_1_1star_1_1chart2.html</a>,
or you can access it with <code>lodoc chart2</code>.</p>
<p>The only extensive programming resource I've found on chart2 is a Japanese site
(<a href="http://hermione.s41.xrea.com/pukiwiki/index.php?OOoBasic%2FCalc%2Fchart2">http://hermione.s41.xrea.com/pukiwiki/index.php?OOoBasic%2FCalc%2Fchart2</a>)
which uses the OOoBasic version of the API. It's a great site, but often offline; one
partly remedy is to use Google's cached copies of some of its pages.</p>
<p>One problem with searching the Web for examples is that programs using the chart2
and chart modules look similar. The crucial difference for Java is that most of the
chart2 services and interfaces are inside the "com.sun.star.chart2" package whereas
the older chart services and interfaces are inside "com.sun.star.chart" (no "2").</p>
<p>Another way to distinguish between examples, especially for programs written in
Basic, is to look at the names of the chart services. The old chart names end with the
word "Diagram" (e.g. BarDiagram, DonutDiagram, LineDiagram) whereas the chart2
names either end with the word "ChartType" (e.g. BarChartType, PieChartType,
LineChartType), or with no special word (e.g. Bar, Donut, Line).</p>
<p>A good way to get a feel for chart2's functionality is to look at chapter 3 of Calc's user
guide, available from <a href="https://www.libreoffice.org/get-help/documentation/">https://www.libreoffice.org/get-help/documentation/</a>. It
describes the charting wizard, which acts as a very nice GUI for most of the chart2
API. The chapter also introduces a lot of charting terminology (e.g. chart types, data
ranges, data series) used in the API.</p>
<h2 id="1-charting-elements">1.  Charting Elements<a class="headerlink" href="#1-charting-elements" title="Permanent link">&para;</a></h2>
<p>Different chart types share many common elements, as illustrated in Figure 1.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-1.jpg" /></p>
<p>Figure 1. Typical Chart Elements.</p>
<p>Most of the labeled components in Figure 1 are automatically included when a chart
template is instantiated; the programmer typically only has to supply text and a few
property settings, such as the wall color and font size.</p>
<p>There are ten main chart types, which are listed when the "Chart Wizard" is started
via Calc's Insert, Chart menu item. Figures 2 shows the possibilities.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-2.png" /></p>
<p>Figure 2. Ten Chart Types.</p>
<p>Most of the types offer variants, which are displayed as icons to the right of the dialog
window. When you position the mouse over an icon, the name of the variant appears
briefly in a tooltip, as in Figure 3.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-3.png" /></p>
<p>Figure 3. A Column Chart Icon with its Tooltip Name.</p>
<p>When the checkboxes, buttons, or combo boxes are selected in the dialog, the icons
change to reflect changes in the variants.</p>
<p>The three most common variants are "3D", "Stacked" and "Percent". "Stacked" is
utilized when the chart displays multiple data sequences stacked on top of each other.
"Percent" is combined with "Stacked" to stack the sequences in terms of their
percentage contribution to the total. A lengthy discussion about chart variants can be
found in chapter 3 of the Calc User Guide, in the section "Gallery of Chart Types".</p>
<p>In the chart2 API, the variants are accessed via template names, which are listed in
Table 1.</p>
<table>
<thead>
<tr>
<th>Chart</th>
<th>Types</th>
<th>Template Names</th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Stacked</td>
<td>Column, StackedColumn, PercentStackedColumn,</td>
</tr>
<tr>
<td></td>
<td>Percent</td>
<td>ThreeDColumnDeep, ThreeDColumnFlat,</td>
</tr>
<tr>
<td></td>
<td>3D</td>
<td>StackedThreeDColumnFlat,</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PercentStackedThreeDColumnFlat</td>
</tr>
<tr>
<td>Bar</td>
<td>Stacked</td>
<td>Bar, StackedBar, PercentStackedBar,</td>
</tr>
<tr>
<td></td>
<td>Percent</td>
<td>ThreeDBarDeep, ThreeDBarFlat,</td>
</tr>
<tr>
<td></td>
<td>3D</td>
<td>StackedThreeDBarFlat,</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PercentStackedThreeDBarFlat</td>
</tr>
<tr>
<td>Pie</td>
<td>Donut</td>
<td>Pie, Donut,</td>
</tr>
<tr>
<td></td>
<td>Explode</td>
<td>PieAllExploded, DonutAllExploded,</td>
</tr>
<tr>
<td></td>
<td>3D</td>
<td>ThreeDPie, ThreeDPieAllExploded,</td>
</tr>
<tr>
<td></td>
<td></td>
<td>ThreeDDonut, ThreeDDonutAllExploded</td>
</tr>
<tr>
<td>Area</td>
<td>Stacked</td>
<td>Area, StackedArea, PercentStackedArea,</td>
</tr>
<tr>
<td></td>
<td>Percent</td>
<td>ThreeDArea, StackedThreeDArea,</td>
</tr>
<tr>
<td></td>
<td>3D</td>
<td>PercentStackedThreeDArea</td>
</tr>
<tr>
<td>Line</td>
<td>Symbol</td>
<td>Line, Symbol, LineSymbol,</td>
</tr>
<tr>
<td></td>
<td>Stacked</td>
<td>StackedLine, StackedSymbol, StackedLineSymbol,</td>
</tr>
<tr>
<td></td>
<td>Percent</td>
<td>PercentStackedLine, PercentStackedSymbol,</td>
</tr>
<tr>
<td></td>
<td>3D</td>
<td>PercentStackedLineSymbol,</td>
</tr>
<tr>
<td></td>
<td></td>
<td>ThreeDLine, ThreeDLineDeep,</td>
</tr>
<tr>
<td></td>
<td></td>
<td>StackedThreeDLine, PercentStackedThreeDLine</td>
</tr>
<tr>
<td>XY</td>
<td>Line</td>
<td>ScatterSymbol, ScatterLine, ScatterLineSymbol,</td>
</tr>
<tr>
<td>(Scatter)</td>
<td>3D</td>
<td>ThreeDScatter</td>
</tr>
<tr>
<td>Bubble</td>
<td></td>
<td>Bubble</td>
</tr>
<tr>
<td>Net</td>
<td>Line</td>
<td>Net, NetLine, NetSymbol, FilledNet,</td>
</tr>
<tr>
<td></td>
<td>Symbol</td>
<td>StackedNet, StackedNetLine,</td>
</tr>
<tr>
<td></td>
<td>Filled</td>
<td>StackedNetSymbol, StackedFilledNet,</td>
</tr>
<tr>
<td></td>
<td>Stacked</td>
<td>PercentStackedNet, PercentStackedNetLine,</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PercentStackedNetSymbol,</td>
</tr>
<tr>
<td></td>
<td>Percent</td>
<td>PercentStackedFilledNet</td>
</tr>
<tr>
<td>Stock</td>
<td>Open</td>
<td>StockLowHighClose,</td>
</tr>
<tr>
<td></td>
<td>Volume</td>
<td>StockOpenLowHighClose,</td>
</tr>
<tr>
<td></td>
<td></td>
<td>StockVolumeLowHighClose,</td>
</tr>
<tr>
<td></td>
<td></td>
<td>StockVolumeOpenLowHighClose</td>
</tr>
<tr>
<td>Column</td>
<td>Stacked</td>
<td>ColumnWithLine, StackedColumnWithLine</td>
</tr>
<tr>
<td>and Line</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Table 1. Chart Types and Template Names.</p>
<p>The templates I'll be using are highlighted in bold in Table 1.</p>
<p>The template names are closely related to the tooltip names in Calc's chart wizard. For
example, the tooltip name in Figure 3 corresponds to the "PercentStackedColumn"
template.</p>
<p>It's also possible to create a chart using a chart type name, which are listed in Table 2.</p>
<table>
<thead>
<tr>
<th>Chart</th>
<th>Chart Type Names</th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>ColumnChartType</td>
</tr>
<tr>
<td>Bar</td>
<td>BarChartType</td>
</tr>
<tr>
<td>Pie</td>
<td>PieChartType</td>
</tr>
<tr>
<td>Area</td>
<td>AreaChartType</td>
</tr>
<tr>
<td>Line</td>
<td>LineChartType</td>
</tr>
<tr>
<td>XY</td>
<td>(Scatter) ScatterChartType</td>
</tr>
<tr>
<td>Bubble</td>
<td>BubbleChartType</td>
</tr>
<tr>
<td>Net</td>
<td>NetChartType, FilledNetChartType</td>
</tr>
<tr>
<td>Stock</td>
<td>CandleStickChartType</td>
</tr>
</tbody>
</table>
<p>Table 2. Chart Type Names.</p>
<p>Note that a stock chart graph is drawn using a CandleStickChartType, and that there's
no type name for a column and line chart because it's implemented as a combination
of ColumnChartType and BarChartType.</p>
<p>Almost all my examples will use chart templates. I'll only use chart type names when
I want to add extra data to an existing chart (e.g. add a line graph to a stock chart).</p>
<p>The chart2 module is quite complex, so I've hidden a lot of details inside methods in
my Chart2.java class. It simplifies four kinds of operation:</p>
<ol>
<li>The creation of a new chart in a spreadsheet document, based on a template name.</li>
<li>The accessing and modification of elements inside a chart, such as the title,
legend, axes, and colors.</li>
<li>The addition of extra data to a chart, such as error bars or a second graph.</li>
<li>The embedding of a chart in a document other than a spreadsheet, namely in a text
document or slide presentation.</li>
</ol>
<p>Operations no. 1 (chart creation) and no. 2 (element modification) are used by all my
examples, so the rest of this chapter will give an overview of how the corresponding
Chart2.java methods work.</p>
<p>Programming details specific to particular charts will be discussed in subsequent
chapters:</p>
<ul>
<li>column: chapter 29;</li>
<li>bar, pie, area, line: chapter 30;</li>
<li>XY (scatter): chapter 31;</li>
<li>bubble, net, stock: chapter 32.</li>
</ul>
<h2 id="2-chart-creation">2.  Chart Creation<a class="headerlink" href="#2-chart-creation" title="Permanent link">&para;</a></h2>
<p>Chart creation can be divided into three steps:</p>
<ol>
<li>A TableChart service is created inside the spreadsheet.</li>
<li>The ChartDocument service is accessed inside the TableChart.</li>
<li>The ChartDocument is initialized by linking together a chart template, diagram,
and data source.</li>
</ol>
<p>The details are explained in the following sub-sections.</p>
<h3 id="21-creating-a-table-chart">2.1.  Creating a Table Chart<a class="headerlink" href="#21-creating-a-table-chart" title="Permanent link">&para;</a></h3>
<p>XTableCharts.addNewByName() adds a new TableChart to the TableCharts
collection in a spreadsheet. This is shown graphically in Figure 4, and is implemented
by Chart2.addTableChart().</p>
<p><img alt="" src="images/28-Chart2_API_Overview-4.png" /></p>
<p>Figure 4. Creating a new TableChart Service.</p>
<p>Chart2.addTableChart() is defined as:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addTableChart</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
               <span class="n">String</span> <span class="n">chartName</span><span class="p">,</span> <span class="n">CellRangeAddress</span> <span class="n">cellsRange</span><span class="p">,</span>
               <span class="n">String</span> <span class="n">cellName</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span>
<span class="c1">// create table chart at cell name and size width x height</span>
<span class="p">{</span>
  <span class="n">XTableChartsSupplier</span> <span class="n">chartsSupplier</span> <span class="o">=</span>
                   <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTableChartsSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
  <span class="n">XTableCharts</span> <span class="n">tableCharts</span> <span class="o">=</span> <span class="n">chartsSupplier</span><span class="p">.</span><span class="na">getCharts</span><span class="p">();</span>

  <span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Point</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getCellPos</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">cellName</span><span class="p">);</span>
  <span class="n">Rectangle</span> <span class="n">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">pos</span><span class="p">.</span><span class="na">X</span><span class="p">,</span> <span class="n">pos</span><span class="p">.</span><span class="na">Y</span><span class="p">,</span>
                                 <span class="n">width</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">*</span><span class="mi">1000</span><span class="p">);</span>

  <span class="n">CellRangeAddress</span><span class="o">[]</span> <span class="n">addrs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CellRangeAddress</span><span class="o">[]</span><span class="p">{</span> <span class="n">cellsRange</span> <span class="p">};</span>
  <span class="n">tableCharts</span><span class="p">.</span><span class="na">addNewByName</span><span class="p">(</span><span class="n">chartName</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">addrs</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of addTableChart()</span>
</code></pre></div>
<p>The arguments passed to Chart2.addTableChart() include the new chart's name, the
cell range used as a data source, and the chart's position and dimensions when drawn
in the Calc window.</p>
<p>The position is a cell name (e.g. "A1"), which becomes the location of the top-left
corner of the chart in the Calc window. The name is converted into a position by
calling Calc.getCellPos(). The size of the chart is supplied as millimeter width and
height arguments and converted into a Rectangle in 1/100mm units.</p>
<p>My methods assume that the data range has a specific format, which is illustrated by
Figure 5.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-5.png" /></p>
<p>Figure 5. Cell Range Data Format.</p>
<p>The data is organized into columns, the first for the x-axis categories, and the others
for the y-axis data displayed as graphs. The first row of the data range contains labels
for the x-axis and the graphs.</p>
<p>For example, the data range in Figure 5 is drawn as a Column chart in Figure 6.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-6.png" /></p>
<p>Figure 6. A Column Chart Using the Data in Figure 5.</p>
<p>The assumption that the first data column are x-axis categories doesn't apply to scatter
and bubble charts which use numerical x-axis values. I'll give examples of those in
later chapters.</p>
<p>The data format assumptions are used in the call to XTableCharts.addNewByName()
in Chart2.addTableChart() by setting its last two arguments to true. This specifies that
the top row and left column will be used as categories and/or labels. More specific
format information will be supplied later.</p>
<h3 id="22-accessing-the-chart-document">2.2.  Accessing the Chart Document<a class="headerlink" href="#22-accessing-the-chart-document" title="Permanent link">&para;</a></h3>
<p>Although Chart2.addTableChart() adds a table chart to the spreadsheet, it doesn't
return a reference to the new chart document. That's obtained by calling
Chart2.getChartDoc():</p>
<div class="highlight"><pre><span></span><code><span class="n">Chart2</span><span class="p">.</span><span class="na">addTableChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">chartName</span><span class="p">,</span> <span class="n">cellsRange</span><span class="p">,</span> <span class="n">cellName</span><span class="p">,</span>
                                                <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
<span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">getChartDoc</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">chartName</span><span class="p">);</span>
</code></pre></div>
<p>Chart2.getChartDoc() accesses the spreadsheet's collection of TableCharts, searching
for the one with the given name. The matching TableChart service is treated as an
XEmbeddedObjectSupplier interface, which lets its embedded chart document be
referenced. These steps are illustrated by Figure 7.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-7.png" /></p>
<p>Figure 7. Accessing a Chart Document.</p>
<p>Chart2.getChartDoc() implements Figure 7, using Chart2.getTableChart() to access
the named table chart:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XChartDocument</span> <span class="nf">getChartDoc</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                                         <span class="n">String</span> <span class="n">chartName</span><span class="p">)</span>
<span class="c1">// return the chart doc from the sheet</span>
<span class="p">{</span> <span class="c1">// get the named table chart</span>
  <span class="n">XTableChart</span> <span class="n">tableChart</span> <span class="o">=</span> <span class="n">getTableChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">chartName</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">tableChart</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>

  <span class="c1">// chart doc is embedded inside table chart</span>
  <span class="n">XEmbeddedObjectSupplier</span> <span class="n">eos</span> <span class="o">=</span>
              <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XEmbeddedObjectSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">tableChart</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XChartDocument</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">eos</span><span class="p">.</span><span class="na">getEmbeddedObject</span><span class="p">());</span>
<span class="p">}</span>  <span class="c1">// end of getChartDoc()</span>



<span class="kd">public</span> <span class="kd">static</span> <span class="n">XTableChart</span> <span class="nf">getTableChart</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                                        <span class="n">String</span> <span class="n">chartName</span><span class="p">)</span>
<span class="c1">// return the named table chart from the sheet</span>
<span class="p">{</span> <span class="c1">// get the supplier for the table charts</span>
  <span class="n">XTableChartsSupplier</span> <span class="n">chartsSupplier</span> <span class="o">=</span>
                       <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTableChartsSupplier</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
  <span class="n">XTableCharts</span> <span class="n">tableCharts</span> <span class="o">=</span> <span class="n">chartsSupplier</span><span class="p">.</span><span class="na">getCharts</span><span class="p">();</span>
  <span class="n">XNameAccess</span> <span class="n">tcAccess</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XNameAccess</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">tableCharts</span><span class="p">);</span>

  <span class="c1">// try to access the chart with the specified name</span>
  <span class="n">XTableChart</span> <span class="n">tableChart</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">tableChart</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTableChart</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                           <span class="n">tcAccess</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="n">chartName</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not access &quot;</span> <span class="o">+</span> <span class="n">chartName</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">return</span> <span class="n">tableChart</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getTableChart()</span>
</code></pre></div>
<h3 id="23-initializing-the-chart-document">2.3.  Initializing the Chart Document<a class="headerlink" href="#23-initializing-the-chart-document" title="Permanent link">&para;</a></h3>
<p>The chart document is initialized by linking three components: the chart template, the
chart's diagram, and a data source, as illustrated by Figure 8.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-8.png" /></p>
<p>Figure 8. Initializing a Chart Document.</p>
<p>The initialization steps in Figure 8, and the earlier calls to Chart2.addTableChart() and
Chart2.getChartDoc() are carried out by Chart2.insertChart(). A typical call to
insertChart() would be:</p>
<div class="highlight"><pre><span></span><code><span class="n">CellRangeAddress</span> <span class="n">rangeAddr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E15:G21&quot;</span><span class="p">);</span>
<span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span>
      <span class="n">Chart2</span><span class="p">.</span><span class="na">insertChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">rangeAddr</span><span class="p">,</span> <span class="s">&quot;A22&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="s">&quot;Column&quot;</span><span class="p">);</span>
</code></pre></div>
<p>The first line converts "E15:G21" into a data range (this corresponds to the cells
shown in Figure 5), which is passed to Chart2.insertChart(). The "A22" string and the
20x11 mm dimensions specify the position and size of the chart, and the last argument
("Column") is the desired chart template (see Table 1). The result is the column chart
shown in Figure 6.</p>
<p>Chart2.insertChart() is:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="c1">// globals</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">CHART_NAME</span> <span class="o">=</span> <span class="s">&quot;chart$$_&quot;</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XChartDocument</span> <span class="nf">insertChart</span><span class="p">(</span><span class="n">XSpreadsheet</span> <span class="n">sheet</span><span class="p">,</span>
                    <span class="n">CellRangeAddress</span> <span class="n">cellsRange</span><span class="p">,</span> <span class="n">String</span> <span class="n">cellName</span><span class="p">,</span>
                    <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">,</span> <span class="n">String</span> <span class="n">diagramName</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">String</span> <span class="n">chartName</span> <span class="o">=</span> <span class="n">CHART_NAME</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">Math</span><span class="p">.</span><span class="na">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10000</span><span class="p">);</span>
                     <span class="c1">// generate a random name</span>

  <span class="n">addTableChart</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">chartName</span><span class="p">,</span> <span class="n">cellsRange</span><span class="p">,</span> <span class="n">cellName</span><span class="p">,</span>
                                            <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
  <span class="c1">// get newly created (empty) chart</span>
  <span class="n">XChartDocument</span> <span class="n">chartDoc</span> <span class="o">=</span> <span class="n">getChartDoc</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">chartName</span><span class="p">);</span>

  <span class="c1">// assign chart template to the chart&#39;s diagram</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Using chart template: &quot;</span> <span class="o">+</span> <span class="n">diagramName</span><span class="p">);</span>
  <span class="n">XDiagram</span> <span class="n">diagram</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getFirstDiagram</span><span class="p">();</span>
  <span class="n">XChartTypeTemplate</span> <span class="n">ctTemplate</span> <span class="o">=</span>
               <span class="n">setTemplate</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">diagram</span><span class="p">,</span> <span class="n">diagramName</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">ctTemplate</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>

  <span class="kt">boolean</span> <span class="n">hasCats</span> <span class="o">=</span> <span class="n">hasCategories</span><span class="p">(</span><span class="n">diagramName</span><span class="p">);</span>

  <span class="c1">// initialize data source</span>
  <span class="n">XDataProvider</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getDataProvider</span><span class="p">();</span>
  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">aProps</span> <span class="o">=</span> <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span>
        <span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="p">{</span> <span class="s">&quot;CellRangeRepresentation&quot;</span><span class="p">,</span> <span class="s">&quot;DataRowSource&quot;</span><span class="p">,</span>
                       <span class="s">&quot;FirstCellAsLabel&quot;</span> <span class="p">,</span> <span class="s">&quot;HasCategories&quot;</span> <span class="p">},</span>
        <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getRangeStr</span><span class="p">(</span><span class="n">cellsRange</span><span class="p">,</span> <span class="n">sheet</span><span class="p">),</span>
                       <span class="n">ChartDataRowSource</span><span class="p">.</span><span class="na">COLUMNS</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="n">hasCats</span> <span class="p">});</span>
  <span class="n">XDataSource</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">dp</span><span class="p">.</span><span class="na">createDataSource</span><span class="p">(</span><span class="n">aProps</span><span class="p">);</span>

  <span class="c1">// add data source to chart template</span>
  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;HasCategories&quot;</span><span class="p">,</span> <span class="n">hasCats</span><span class="p">);</span>
  <span class="n">ctTemplate</span><span class="p">.</span><span class="na">changeDiagramData</span><span class="p">(</span><span class="n">diagram</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>

  <span class="c1">// apply style settings to chart doc</span>
  <span class="n">setBackgroundColors</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">PALE_BLUE</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">LIGHT_BLUE</span><span class="p">);</span>
                                <span class="c1">// background and wall colors</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">hasCats</span><span class="p">)</span>  <span class="c1">// charts using x-axis categories</span>
    <span class="n">setDataPointLabels</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">DP_NUMBER</span><span class="p">);</span>
                         <span class="c1">// show y-axis values</span>

  <span class="n">printChartTypes</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">chartDoc</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of insertChart()</span>
</code></pre></div>
<p>insertChart() creates a new chart document by calling addTableChart() and
getChartDoc(), and then proceeds to link the chart template, diagram, and data source.</p>
<h4 id="get-the-diagram">Get the Diagram<a class="headerlink" href="#get-the-diagram" title="Permanent link">&para;</a></h4>
<p>The chart diagram is the easiest to obtain, since it's directly accessible via the
XChartDocument reference:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.insertChart()...</span>
<span class="n">XDiagram</span> <span class="n">diagram</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getFirstDiagram</span><span class="p">();</span>
</code></pre></div>
<h4 id="creating-a-template">Creating a Template<a class="headerlink" href="#creating-a-template" title="Permanent link">&para;</a></h4>
<p>Creating a chart template is a few more steps. requiring the creation of a
XChartTypeManager interface inside Chart2.setTemplate():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XChartTypeTemplate</span> <span class="nf">setTemplate</span><span class="p">(</span>
              <span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
              <span class="n">XDiagram</span> <span class="n">diagram</span><span class="p">,</span> <span class="n">String</span> <span class="n">diagramName</span><span class="p">)</span>
<span class="c1">// set diagram to use the specified chart template</span>
<span class="p">{</span> <span class="k">try</span> <span class="p">{</span>
    <span class="n">XChartTypeManager</span> <span class="n">ctMan</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getChartTypeManager</span><span class="p">();</span>
    <span class="n">XMultiServiceFactory</span> <span class="n">msf</span> <span class="o">=</span>
           <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XMultiServiceFactory</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">ctMan</span><span class="p">);</span>
    <span class="n">String</span> <span class="n">templateNm</span> <span class="o">=</span> <span class="s">&quot;com.sun.star.chart2.template.&quot;</span> <span class="o">+</span>
                                               <span class="n">diagramName</span><span class="p">;</span>
    <span class="n">XChartTypeTemplate</span> <span class="n">ctTemplate</span> <span class="o">=</span>
          <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XChartTypeTemplate</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                      <span class="n">msf</span><span class="p">.</span><span class="na">createInstance</span><span class="p">(</span><span class="n">templateNm</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ctTemplate</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not create chart template \&quot;&quot;</span> <span class="o">+</span>
                 <span class="n">diagramName</span> <span class="o">+</span>  <span class="s">&quot;\&quot;; using a column chart&quot;</span><span class="p">);</span>
      <span class="n">ctTemplate</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XChartTypeTemplate</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                <span class="n">msf</span><span class="p">.</span><span class="na">createInstance</span><span class="p">(</span>
                  <span class="s">&quot;com.sun.star.chart2.template.Column&quot;</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">ctTemplate</span><span class="p">.</span><span class="na">changeDiagram</span><span class="p">(</span><span class="n">diagram</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">ctTemplate</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not set chart to &quot;</span><span class="o">+</span><span class="n">diagramName</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setTemplate()</span>
</code></pre></div>
<p>The diagramName value is one of the template names shown in Table 1 (e.g.
"Column"). The string "com.sun.star.chart2.template." is added to the front to create a
fully qualified service name, which is then instantiated. If the instance creation fails,
then the function falls back to creating an instance of the "Column" template.
setTemplate() ends by calling XChartTypeTemplate.changeDiagram() which links the
template to the chart's diagram.</p>
<h4 id="get-the-data-source">Get the Data Source<a class="headerlink" href="#get-the-data-source" title="Permanent link">&para;</a></h4>
<p>Back in Chart2.insertChart(), the right-most branch of Figure 8 involves the creation
of an XDataProvider instance:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.insertChart()...</span>
<span class="n">XDataProvider</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getDataProvider</span><span class="p">();</span>
</code></pre></div>
<p>This data provider converts the chart's data range into an XDataSource:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.insertChart()...</span>

<span class="kt">boolean</span> <span class="n">hasCats</span> <span class="o">=</span> <span class="n">hasCategories</span><span class="p">(</span><span class="n">diagramName</span><span class="p">);</span>

<span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">aProps</span> <span class="o">=</span> <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span>
      <span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="p">{</span> <span class="s">&quot;CellRangeRepresentation&quot;</span><span class="p">,</span> <span class="s">&quot;DataRowSource&quot;</span><span class="p">,</span>
                     <span class="s">&quot;FirstCellAsLabel&quot;</span> <span class="p">,</span> <span class="s">&quot;HasCategories&quot;</span> <span class="p">},</span>
      <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getRangeStr</span><span class="p">(</span><span class="n">cellsRange</span><span class="p">,</span> <span class="n">sheet</span><span class="p">),</span>
                     <span class="n">ChartDataRowSource</span><span class="p">.</span><span class="na">COLUMNS</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="n">hasCats</span> <span class="p">});</span>

<span class="n">XDataSource</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">dp</span><span class="p">.</span><span class="na">createDataSource</span><span class="p">(</span><span class="n">aProps</span><span class="p">);</span>
</code></pre></div>
<p>The properties passed to XDataProvider.createDataSource() specify more details
about the format of the data in Figure 5 – the data for each graph is organized into
columns with the first cell being the label for the graph. The "HasCategories" property
is set to true when the first column of the data is to be used as x-axis categories.</p>
<p>These properties passed to createDataSource() are described in the documentation for
the TabularDataProviderArguments service, which you can access using
<code>lodoc TabularDataProviderArguments</code>.</p>
<p>The hasCats boolean is set by examining the diagram name: if it's an XY scatter chart
or bubble chart then the first column of data will not be used as x-axis categories, so
the boolean is set to false:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">hasCategories</span><span class="p">(</span><span class="n">String</span> <span class="n">diagramName</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">diagramName</span><span class="p">.</span><span class="na">toLowerCase</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;scatter&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="n">name</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;bubble&quot;</span><span class="p">))</span>
     <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of hasCategories()</span>
</code></pre></div>
<h4 id="linking-the-template-diagram-and-data-source">Linking the template, diagram, and data source<a class="headerlink" href="#linking-the-template-diagram-and-data-source" title="Permanent link">&para;</a></h4>
<p>Now the data source can populate the diagram using the specified chart template
format:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.insertChart()...</span>
<span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;HasCategories&quot;</span><span class="p">,</span> <span class="n">hasCats</span><span class="p">);</span>
<span class="n">ctTemplate</span><span class="p">.</span><span class="na">changeDiagramData</span><span class="p">(</span><span class="n">diagram</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>
</code></pre></div>
<p>At this point the chart will be drawn in the Calc application window, and
Chart2.insertChart() could return. Instead my code modifies the appearance of the
chart in two ways:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.insertChart()...</span>
<span class="c1">// apply some style settings to chart doc</span>
<span class="n">setBackgroundColors</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">PALE_BLUE</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">LIGHT_BLUE</span><span class="p">);</span>
                 <span class="c1">// color the background and wall colors</span>

<span class="k">if</span> <span class="p">(</span><span class="n">hasCats</span><span class="p">)</span>     <span class="c1">// charts using x-axis categories</span>
  <span class="n">setDataPointLabels</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">DP_NUMBER</span><span class="p">);</span>
                 <span class="c1">// show y-axis values on the data points</span>
</code></pre></div>
<p>Chart2.setBackgroundColors() changes the background and wall colors of the chart
(see Figure 6). Chart2.setDataPointLabels() switches on the displaying of the y-axis
data points as numbers which appear just above the top of each column in a column
chart. I'll describe how these methods work in the next section.</p>
<p>The call to Chart2.printChartTypes() at the end of Chart2.insertChart() could be
commented out since it's a diagnostic check. It prints the names of the chart types
used by the template.</p>
<h2 id="3-accessing-and-modifying-chart-elements">3.  Accessing and Modifying Chart Elements<a class="headerlink" href="#3-accessing-and-modifying-chart-elements" title="Permanent link">&para;</a></h2>
<p>Almost every aspect of a chart can be adjusted, including such things as its color
scheme, the fonts, the scaling of the axes, the positioning of the legend, axis labels,
and titles. It's also possible to augment charts with regression line details, error bars,
and additional graphs.</p>
<p>These elements are located in a number of different places in the hierarchy of services
accessible through the ChartDocument service. A simplified version of this hierarchy
is shown in Figure 9.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-9.png" /></p>
<p>Figure 9. The Hierarchy of Services Below ChartDocument.</p>
<p>I'll supply more information about the Diagram, CoordinateSystem, ChartType, and
DataSeries services as this section progresses, but Figure 9 indicates that Diagram
manages the legend, floor and chart wall, CoordinateSystem is in charge of the axes,
and the data points are manipulated via DataSeries.</p>
<p>The "1" and "*" in the figure indicate that a diagram may utilize multiple coordinate
systems, that a single coordinate system may display multiple chart types, and a single
chart type can employ many data series. Fortunately, this generality isn't often needed
for the charts created by Chart2.insertChart(). In particular, the chart diagram only
uses a single coordinate system and a single chart type (most of the time).</p>
<h3 id="31-accessing-the-diagram">3.1.  Accessing the Diagram<a class="headerlink" href="#31-accessing-the-diagram" title="Permanent link">&para;</a></h3>
<p>A chart's Diagram service is easily reached by calling
ChartDocument.getFirstDiagram(), which returns a reference to the diagram's
XDiagram interface:</p>
<div class="highlight"><pre><span></span><code><span class="n">XDiagram</span> <span class="n">diagram</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getFirstDiagram</span><span class="p">();</span>
</code></pre></div>
<p>XDiagram contains several useful methods (e.g. getLegend(), getWall(), getFloor()),
and its services hold many properties (e.g. "StartingAngle" used in pie charts and
"RotationVertical" for 3D charts). This is summarized by Figure 10.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-10.png" /></p>
<p>Figure 10. The Diagram Service.</p>
<p>The easiest way to access the documentation for Diagram and XDiagram is via loDoc:</p>
<div class="highlight"><pre><span></span><code>&gt; loDoc chart2 diagram

&gt; loDoc xdiagram
</code></pre></div>
<p>Chart2.setBackgroundColors() changes the background and wall colors of the chart
through the ChartDocument and Diagram services:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setBackgroundColors</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                  <span class="kt">int</span> <span class="n">bgColor</span><span class="p">,</span> <span class="kt">int</span> <span class="n">wallColor</span><span class="p">)</span>
<span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">bgColor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">XPropertySet</span> <span class="n">bgProps</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getPageBackground</span><span class="p">();</span>
    <span class="c1">// Props.showProps(&quot;Background&quot;, bgProps);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">bgProps</span><span class="p">,</span> <span class="s">&quot;FillBackground&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">bgProps</span><span class="p">,</span> <span class="s">&quot;FillStyle&quot;</span><span class="p">,</span> <span class="n">FillStyle</span><span class="p">.</span><span class="na">SOLID</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">bgProps</span><span class="p">,</span> <span class="s">&quot;FillColor&quot;</span><span class="p">,</span> <span class="n">bgColor</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">wallColor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">XDiagram</span> <span class="n">diagram</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getFirstDiagram</span><span class="p">();</span>
    <span class="n">XPropertySet</span> <span class="n">wallProps</span> <span class="o">=</span> <span class="n">diagram</span><span class="p">.</span><span class="na">getWall</span><span class="p">();</span>
    <span class="c1">// Props.showProps(&quot;Wall&quot;, wallProps);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">wallProps</span><span class="p">,</span> <span class="s">&quot;FillBackground&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">wallProps</span><span class="p">,</span> <span class="s">&quot;FillStyle&quot;</span><span class="p">,</span> <span class="n">FillStyle</span><span class="p">.</span><span class="na">SOLID</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">wallProps</span><span class="p">,</span> <span class="s">&quot;FillColor&quot;</span><span class="p">,</span> <span class="n">wallColor</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setBackgroundColors()</span>
</code></pre></div>
<p>The chart background is manipulated with a property set accessible through
XChartDocument.getPageBackground(), while the wall is reached with
XDiagram.getWall().</p>
<p>The documentation for the getPageBackground() and getWall() methods doesn't list
the contents of their property sets, so the easiest way of finding out what's available is
by calling Props.showProps(). Two showProps() calls are commented out in the code
above.</p>
<p>Most chart services inherit a mix of four property classes:</p>
<ul>
<li>com.sun.star.style.CharacterProperties</li>
<li>com.sun.star.style.ParagraphProperties</li>
<li>com.sun.star.drawing.LineProperties</li>
<li>com.sun.star.drawing.FillProperties</li>
</ul>
<p>Since getWall() and getPageBackground() both deal with areas in the chart, their
properties come from the FillProperties class.</p>
<h3 id="32-accessing-the-coordinate-system">3.2.  Accessing the Coordinate System<a class="headerlink" href="#32-accessing-the-coordinate-system" title="Permanent link">&para;</a></h3>
<p>Figure 10 shows that the diagram's coordinate systems are reached through
XCoordinateSystemContainer.getCoordinateSystems(). Chart2.getCoordSystem()
assumes that the programmer only wants the first coordinate system:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XCoordinateSystem</span> <span class="nf">getCoordSystem</span><span class="p">(</span>
                                <span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XDiagram</span> <span class="n">diagram</span> <span class="o">=</span> <span class="n">chartDoc</span><span class="p">.</span><span class="na">getFirstDiagram</span><span class="p">();</span>
  <span class="n">XCoordinateSystemContainer</span> <span class="n">coordSysCon</span> <span class="o">=</span>
             <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XCoordinateSystemContainer</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">diagram</span><span class="p">);</span>
  <span class="n">XCoordinateSystem</span><span class="o">[]</span> <span class="n">coordSys</span> <span class="o">=</span>
                       <span class="n">coordSysCon</span><span class="p">.</span><span class="na">getCoordinateSystems</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">coordSys</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No of coord systems: &quot;</span> <span class="o">+</span> <span class="n">coordSys</span><span class="p">.</span><span class="na">length</span> <span class="o">+</span>
                                       <span class="s">&quot;; using first&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">coordSys</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>  <span class="c1">// return first</span>
<span class="p">}</span>  <span class="c1">// end of getCoordSystem()</span>
</code></pre></div>
<p>The CoordinateSystem service is employed to access the chart's axes and its chart
type (or types), as in Figure 11.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-11.png" /></p>
<p>Figure 11. The CoordinateSystem Service.</p>
<p>I'll describe the Axis service when I look at methods for adjusting axis properties. It
contains a lot of properties, which are documented online. The easiest way to access
the page is with <code>loDoc chart2 axis service</code>. The extra lodoc arguments help to
narrow the search since the word "axis" is used in multiple places in the chart2 and
chart modules.</p>
<h3 id="33-accessing-the-chart-type">3.3.  Accessing the Chart Type<a class="headerlink" href="#33-accessing-the-chart-type" title="Permanent link">&para;</a></h3>
<p>Figure 11 shows that the chart types in a coordinate system are reached through
XChartTypeContainer.getChartTypes(). Chart2.getChartType() assumes the
programmer only wants the first chart type in the array:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XChartType</span> <span class="nf">getChartType</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XChartType</span><span class="o">[]</span> <span class="n">chartTypes</span> <span class="o">=</span> <span class="n">getChartTypes</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">chartTypes</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>  <span class="c1">// get first</span>
<span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XChartType</span><span class="o">[]</span> <span class="nf">getChartTypes</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XCoordinateSystem</span> <span class="n">coordSys</span> <span class="o">=</span> <span class="n">getCoordSystem</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="n">XChartTypeContainer</span> <span class="n">ctCon</span> <span class="o">=</span>
      <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XChartTypeContainer</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">coordSys</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">ctCon</span><span class="p">.</span><span class="na">getChartTypes</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of getChartTypes()</span>
</code></pre></div>
<p>Figure 12 shows the main components of the ChartType service.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-12.png" /></p>
<p>Figure 12. The ChartType Service.</p>
<p>Somewhat surprisingly, the ChartType service isn't the home for chart type related
properties; instead XChartType contains methods for examining chart type "roles",
which I'll describe later. One useful features of XChartType is getChartType() which
returns the type as a string.</p>
<p>The CandleStickChartType service inherits ChartType, and contains properties related
to stock charts.</p>
<p>Use <code>loDoc chart2 charttype</code> to view the online documentation for ChartType.</p>
<h3 id="34-accessing-the-data-series">3.4.  Accessing the Data Series<a class="headerlink" href="#34-accessing-the-data-series" title="Permanent link">&para;</a></h3>
<p>Figure 12 shows that the data series for  a chart type is accessed via
XDataSeriesContainer.getDataSeries(). This is implemented by
Chart2.getDataSeries():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XDataSeries</span><span class="o">[]</span> <span class="nf">getDataSeries</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XChartType</span> <span class="n">xChartType</span> <span class="o">=</span> <span class="n">getChartType</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="n">XDataSeriesContainer</span> <span class="n">dsCon</span> <span class="o">=</span>
                   <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XDataSeriesContainer</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xChartType</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">dsCon</span><span class="p">.</span><span class="na">getDataSeries</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">//end of getDataSeries()</span>
</code></pre></div>
<p>The DataSeries service is one of the more complex parts of the Chart2 module
because of its support for several important interfaces. I won't explain all of them just
yet; Figure 13 focuses on the XDataSeries interface.</p>
<p><img alt="" src="images/28-Chart2_API_Overview-13.png" /></p>
<p>Figure 13. The DataSeries Service and XDataSeries Interface.</p>
<p>A DataSeries represents a series of data points in the chart. Changes to the look of
these data points (e.g. adding numbers next to the points, or changing their shape and
color) can be done in two ways. A data series as a whole maintains a set of properties,
most of which are inherited from the DataPointProperties class. Typical
DataPointProperies values are "Color", "Shape", "LineWidth". The online
documentation can be accessed by calling <code>lodoc DataPointProperties</code>.</p>
<p>It's also possible to adjust point properties on an individual basis by accessing a
particular data point by calling XDataSeries.getDataPointByIndex(). As the method
name suggests, this requires an index value for the point, which can be a little tricky
to determine.</p>
<p>I can now explain the second of the two chart changing methods called at the end of
Chart2.insertChart(): Chart2.setDataPointLabels(), which switches on the displaying
of the y-axis data points as numbers. The call is:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of Chart2.insertChart()...</span>
<span class="n">setDataPointLabels</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">,</span> <span class="n">Chart2</span><span class="p">.</span><span class="na">DP_NUMBER</span><span class="p">);</span>
</code></pre></div>
<p>Chart2.setDataPointLabels() uses Chart2.getDataSeries() described above, which
returns an array of all the data series used in the chart. setDataPointLabels() iterates
through the array and manipulates the "Label" property for each series. In other
words, it modifies each data series property without accessing each point. The code
for Chart2.setDataPointLabels():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Chart2 class</span>
<span class="c1">// data point label types</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DP_NUMBER</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DP_PERCENT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DP_CATEGORY</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DP_SYMBOL</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DP_NONE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setDataPointLabels</span><span class="p">(</span><span class="n">XChartDocument</span> <span class="n">chartDoc</span><span class="p">,</span>
                                            <span class="kt">int</span> <span class="n">labelType</span><span class="p">)</span>
<span class="c1">// change label type for all data series</span>
<span class="p">{</span>
  <span class="n">XDataSeries</span><span class="o">[]</span> <span class="n">dataSeriesArr</span> <span class="o">=</span> <span class="n">getDataSeries</span><span class="p">(</span><span class="n">chartDoc</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">XDataSeries</span> <span class="n">dataSeries</span> <span class="p">:</span> <span class="n">dataSeriesArr</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// visit every data series</span>
    <span class="n">DataPointLabel</span> <span class="n">dpLabel</span> <span class="o">=</span>
         <span class="p">(</span><span class="n">DataPointLabel</span><span class="p">)</span> <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">dataSeries</span><span class="p">,</span> <span class="s">&quot;Label&quot;</span><span class="p">);</span>
    <span class="n">dpLabel</span><span class="p">.</span><span class="na">ShowNumber</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>        <span class="c1">// reset show types</span>
    <span class="n">dpLabel</span><span class="p">.</span><span class="na">ShowCategoryName</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="n">dpLabel</span><span class="p">.</span><span class="na">ShowLegendSymbol</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">labelType</span> <span class="o">==</span> <span class="n">DP_NUMBER</span><span class="p">)</span>
      <span class="n">dpLabel</span><span class="p">.</span><span class="na">ShowNumber</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">labelType</span> <span class="o">==</span> <span class="n">DP_PERCENT</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">dpLabel</span><span class="p">.</span><span class="na">ShowNumber</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="n">dpLabel</span><span class="p">.</span><span class="na">ShowNumberInPercent</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">labelType</span> <span class="o">==</span> <span class="n">DP_CATEGORY</span><span class="p">)</span>
      <span class="n">dpLabel</span><span class="p">.</span><span class="na">ShowCategoryName</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">labelType</span> <span class="o">==</span> <span class="n">DP_SYMBOL</span><span class="p">)</span>
      <span class="n">dpLabel</span><span class="p">.</span><span class="na">ShowLegendSymbol</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">labelType</span> <span class="o">==</span> <span class="n">DP_NONE</span><span class="p">)</span> <span class="p">{}</span>  <span class="c1">// do nothing</span>
    <span class="k">else</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unrecognized label type&quot;</span><span class="p">);</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">dataSeries</span><span class="p">,</span> <span class="s">&quot;Label&quot;</span><span class="p">,</span> <span class="n">dataPointLabel</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setDataPointLabels()</span>
</code></pre></div>
<p>The "Label" DataSeries property is inherited from DataPointProperties (see
<code>lodoc DataPointProperties</code>). "Label" is of type DataPointLabel which maintains four
'show' booleans for displaying the number and other kinds of information next to the
data point. Depending on the labelType value passed to Chart2.setDataPointLabels(),
one or more of these booleans are set and the "Label" property updated.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="28%20Part%205%20Chart.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Part 5 Chart" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Part 5 Chart
            </div>
          </div>
        </a>
      
      
        
        <a href="29-Column_Charts.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 29. Column Charts" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 29. Column Charts
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>