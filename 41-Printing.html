
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/41-Printing.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 41. Printing - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-41-printing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 41. Printing
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 41. Printing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="41-Printing.html" class="md-nav__link md-nav__link--active">
        Chapter 41. Printing
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-java-print-service-jps" class="md-nav__link">
    1.  The Java Print Service (JPS)
  </a>
  
    <nav class="md-nav" aria-label="1.  The Java Print Service (JPS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-listing-the-printers" class="md-nav__link">
    1.1.  Listing the Printers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-discovering-print-services" class="md-nav__link">
    1.2.  Discovering Print Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-printing-using-java" class="md-nav__link">
    1.3.  Printing Using Java
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-more-information-on-javaxprint" class="md-nav__link">
    1.4.  More Information on javax.print
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-printing-in-office" class="md-nav__link">
    2.  Printing in Office
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-printing-any-document" class="md-nav__link">
    3.  Printing any Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-viewing-a-documents-print-properties" class="md-nav__link">
    4.  Viewing a Document's Print Properties
  </a>
  
    <nav class="md-nav" aria-label="4.  Viewing a Document's Print Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-additional-writer-print-properties" class="md-nav__link">
    4.1.  Additional Writer Print Properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-additional-calc-print-properties" class="md-nav__link">
    4.2.  Additional Calc Print Properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-specialized-printing" class="md-nav__link">
    5.  Specialized Printing
  </a>
  
    <nav class="md-nav" aria-label="5.  Specialized Printing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-printing-a-text-document" class="md-nav__link">
    5.1.  Printing a Text Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-printing-an-impress-document" class="md-nav__link">
    5.2.  Printing an Impress Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-printing-a-calc-document" class="md-nav__link">
    5.3.  Printing a Calc Document
  </a>
  
    <nav class="md-nav" aria-label="5.3.  Printing a Calc Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#headers-and-footers" class="md-nav__link">
    Headers and Footers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#print-areas" class="md-nav__link">
    Print Areas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-printing-a-single-sheet" class="md-nav__link">
    5.4.  Printing a Single Sheet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-a-bad-idea-hacking-the-gui" class="md-nav__link">
    6.  A Bad Idea: Hacking the GUI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-command-prompt-printing" class="md-nav__link">
    7.  Command Prompt Printing
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-the-java-print-service-jps" class="md-nav__link">
    1.  The Java Print Service (JPS)
  </a>
  
    <nav class="md-nav" aria-label="1.  The Java Print Service (JPS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-listing-the-printers" class="md-nav__link">
    1.1.  Listing the Printers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-discovering-print-services" class="md-nav__link">
    1.2.  Discovering Print Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-printing-using-java" class="md-nav__link">
    1.3.  Printing Using Java
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-more-information-on-javaxprint" class="md-nav__link">
    1.4.  More Information on javax.print
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-printing-in-office" class="md-nav__link">
    2.  Printing in Office
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-printing-any-document" class="md-nav__link">
    3.  Printing any Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-viewing-a-documents-print-properties" class="md-nav__link">
    4.  Viewing a Document's Print Properties
  </a>
  
    <nav class="md-nav" aria-label="4.  Viewing a Document's Print Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-additional-writer-print-properties" class="md-nav__link">
    4.1.  Additional Writer Print Properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-additional-calc-print-properties" class="md-nav__link">
    4.2.  Additional Calc Print Properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-specialized-printing" class="md-nav__link">
    5.  Specialized Printing
  </a>
  
    <nav class="md-nav" aria-label="5.  Specialized Printing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-printing-a-text-document" class="md-nav__link">
    5.1.  Printing a Text Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-printing-an-impress-document" class="md-nav__link">
    5.2.  Printing an Impress Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-printing-a-calc-document" class="md-nav__link">
    5.3.  Printing a Calc Document
  </a>
  
    <nav class="md-nav" aria-label="5.3.  Printing a Calc Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#headers-and-footers" class="md-nav__link">
    Headers and Footers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#print-areas" class="md-nav__link">
    Print Areas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-printing-a-single-sheet" class="md-nav__link">
    5.4.  Printing a Single Sheet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-a-bad-idea-hacking-the-gui" class="md-nav__link">
    6.  A Bad Idea: Hacking the GUI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-command-prompt-printing" class="md-nav__link">
    7.  Command Prompt Printing
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/main/docs/41-Printing.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-41-printing">Chapter 41. Printing<a class="headerlink" href="#chapter-41-printing" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>The Java Print
Service (JPS); Printing
in Office Writer,
Impress, Calc; Viewing
a Document's Print
Properties; Specialized
Printing: Writer,
Impress, Calc; Hacking
the GUI; Command
Prompt Printing</p>
<p>Example folders:
"Printing Tests" and
"Utils"</p>
</div>
<p>Java's Print Service (JPS) and Office's printing APIs
nicely compliment each other. For example, since Java 1.4
(February 2002), JPS has included printer discovery based
on document types and printer attributes. but Office's API
lacks such capabilities. JPS cannot easily print much
beyond text and images; binary data can be sent to a
printer, but it's left to the device to interpret and render it,
which is only possible in high-end printers, not ordinary
inkjets and laser printers. In contrast, Office can print a
very wide range of document formats, including ODF,
Microsoft, and PDF files.</p>
<p>This chapter starts by describing JPS's PrintService, which I'll use later to select a
printer for the Office API. Then there's an overview of the printing capabilities of the
Office API, with examples of how to print Writer, Impress, and Calc files.</p>
<p>The bad news is that Office's printing API has a few bugs and missing features. By
'missing' I mean parts of Office's printing GUI with no equivalents in the API. Also,
buggy features in the API, such as the printing of multiple pages/sheet and slide
handouts, work flawlessly in the GUI.</p>
<p>I'll finish with a short discussion of command line printing in Windows. The OS has
several print utilities that are a little hard to find and use. Also, Office can be started
from the command line in order to print documents.</p>
<h2 id="1-the-java-print-service-jps">1.  The Java Print Service (JPS)<a class="headerlink" href="#1-the-java-print-service-jps" title="Permanent link">&para;</a></h2>
<p>Java 1.4 saw the introduction of the Java Print service (JPS) API which allows a
printer to be selected based on document types and attributes such as color output,
paper sizes, and double-sided printing.</p>
<p>JPS printing passes through four stages:</p>
<ol>
<li>Selection of a print service (i.e. a printer or print driver), represented by a
PrintService instance. The programmer can supply document types and printer
attributes to limit the search.</li>
<li>Creation of a Doc object for the document that's to be printed.</li>
<li>Creation of a print job combining the Doc object and print request attributes. A
listener can be attached to monitor what's happening during the printing.</li>
<li>The printing is started, and performed asynchronously.</li>
</ol>
<p>Document types are encoded as DocFlavor objects which contain data source details
(e.g. whether the document comes from an input stream or a URL), and a MIME type
(e.g. image/gif, application/pdf). A common misconception about DocFlavor is that it
means that Java can print that kind of document. A DocFlavor is used to check
whether a printer supports a document type, and the answer may be "no".</p>
<p>The following code locates print services that support GIF documents sent from a file:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// stage 1: find print services for GIF files</span>
<span class="n">DocFlavor</span> <span class="n">gifFlavor</span> <span class="o">=</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">GIF</span><span class="p">;</span>
<span class="n">PrintService</span><span class="o">[]</span> <span class="n">services</span> <span class="o">=</span>
       <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="n">gifFlavor</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
</code></pre></div>
<p>The matching print services are returned in a PrintService[] array.</p>
<p>lookupPrintServices()'s second argument (which is null here) could be a set of print
request attributes (PRAs).</p>
<p>There are four kinds of print attributes. The first two are requests sent from a program
to the printer, which may be accepted or rejected:</p>
<ul>
<li>Print request attributes (PRA) ask for particular printing features, such as two-
sided output, or a paper size.</li>
<li>Doc attributes (DA) supply information about a document, such as its page size,
use of color, or page ranges for printing.</li>
</ul>
<p>The two other attributes types are used by the printer service to convey information
about the printer and job back to the program.</p>
<ul>
<li>Print service attributes (PSA) give information about the print service, such as the
printer's make and model or whether it is currently accepting jobs.</li>
<li>Print job attributes (PJA) give information about the status of a particular print
job, such as whether it has successfully finished.</li>
</ul>
<p>The following code fragment looks for printer services that can print on both sides of
A4 paper:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// stage 1 example using attributes</span>
<span class="n">AttributeSet</span> <span class="n">attrs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashAttributeSet</span><span class="p">();</span>
<span class="n">attrs</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">MediaSizeName</span><span class="p">.</span><span class="na">ISO_A4</span><span class="p">);</span>
<span class="n">attrs</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">Sides</span><span class="p">.</span><span class="na">DUPLEX</span><span class="p">);</span>
<span class="n">PrintService</span><span class="o">[]</span> <span class="n">services</span> <span class="o">=</span>
         <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="n">attrs</span><span class="p">);</span>
</code></pre></div>
<p>AttributeSet is an interface and HashAttributeSet an implementation which supports
the four kinds of attributes.</p>
<p>The easiest way to find out about particular attribute  is via the Attribute interface
documentation at
<a href="https://docs.oracle.com/javase/8/docs/api/index.html?java/util/jar/Attributes.html">https://docs.oracle.com/javase/8/docs/api/index.html?java/util/jar/Attributes.html</a>,
which lists the attribute subclasses, such as MediaSizeName and Sides used in the
example above.</p>
<p>The next fragment creates a Doc object for a GIF file, a stage 2 task in JPS printing:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// stage 2 : create a Doc object for a GIF file</span>
<span class="n">FileInputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">fileName</span><span class="p">);</span>
<span class="n">Doc</span> <span class="n">doc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDoc</span><span class="p">(</span><span class="n">in</span><span class="p">,</span> <span class="n">gifFlavor</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
</code></pre></div>
<p>The third argument of the SimpleDoc constructor can be a set of document attributes
(DAs).</p>
<p>JPS stage 3 involves the creation of a print job, and perhaps a listener:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// stage 3: print job creation</span>
<span class="n">DocPrintJob</span> <span class="n">job</span> <span class="o">=</span> <span class="n">service</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">.</span><span class="na">createPrintJob</span><span class="p">();</span>
<span class="n">job</span><span class="p">.</span><span class="na">addPrintJobListener</span><span class="p">(</span><span class="k">new</span> <span class="n">PrintJobAdapter</span><span class="p">()</span> <span class="p">{...}</span> <span class="p">);</span>
</code></pre></div>
<p>The listener will receive information about the print job's progress as print job
attributes (PJAs).</p>
<p>Stage 4 starts the printing:</p>
<div class="highlight"><pre><span></span><code><span class="n">job</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
</code></pre></div>
<p>The second argument of print() can be a set of print request attributes (PRAs).</p>
<h3 id="11-listing-the-printers">1.1.  Listing the Printers<a class="headerlink" href="#11-listing-the-printers" title="Permanent link">&para;</a></h3>
<p>The ListPrinters.java example in this section focuses on JPS stage 1. It prints short
details about all the available printers, fuller information about the default printer, and
a list of printer names. The main() function:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in ListPrinters.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="o">[]</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">JPrint</span><span class="p">.</span><span class="na">listServices</span><span class="p">();</span>         <span class="c1">// short info</span>
  <span class="c1">// JPrint.listServices(true);  // full info, but slow to generate</span>

  <span class="n">PrintService</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupDefaultPrintService</span><span class="p">();</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Default printer \&quot;&quot;</span> <span class="o">+</span> <span class="n">ps</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot;:&quot;</span><span class="p">);</span>
  <span class="n">JPrint</span><span class="p">.</span><span class="na">listService</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>  <span class="c1">// full info on default printer</span>

  <span class="n">String</span><span class="o">[]</span> <span class="n">pNames</span> <span class="o">=</span> <span class="n">JPrint</span><span class="p">.</span><span class="na">getPrinterNames</span><span class="p">();</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Printer names (&quot;</span> <span class="o">+</span> <span class="n">pNames</span><span class="p">.</span><span class="na">length</span> <span class="o">+</span> <span class="s">&quot;):&quot;</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">String</span> <span class="n">pName</span> <span class="p">:</span> <span class="n">pNames</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">pName</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
<p>Most of the functionality is implemented by the JPrint.java utility class.</p>
<p>JPrint.listServices() on one of my test machines prints the following:</p>
<div class="highlight"><pre><span></span><code>-------- Print services (16) ----------

1.  &quot;Send To OneNote 2010&quot;
  color-supported:supported
  printer-name:Send To OneNote 2010
  queued-job-count:0
  printer-is-accepting-jobs:accepting-jobs
  Supported doc types:  image/gif image/jpeg image/png
                        application/octet-stream

2.  &quot;Ricoh Aficio MP 2000 PCL(Black Office Room)&quot;
  color-supported:not-supported
  printer-name:Ricoh Aficio MP 2000 PCL(Black Office Room)
  queued-job-count:0
  printer-is-accepting-jobs:accepting-jobs
  Supported doc types:  image/gif image/jpeg image/png
                       application/octet-stream

  :
  :

16. &quot;CutePDF Writer&quot;
  color-supported:supported
  printer-name:CutePDF Writer
  queued-job-count:0
  printer-is-accepting-jobs:accepting-jobs
  Supported doc types:  image/gif image/jpeg image/png
           application/octet-stream application/postscript
</code></pre></div>
<p>The information for each printer consists of four attributes, including its name and the
MIME types that it can process. For example, the Ricoh Aficio MP 2000 printer can
deal with standard graphics formats and "application/octet-stream". This latter type
means that the printer will accept binary printer data, but doesn't mean that it can
correctly print it. For instance, it may be output as a mishmash of ASCII characters.</p>
<p>The service listing methods in JPrint.java:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the JPrint class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">listServices</span><span class="p">(</span><span class="kt">boolean</span> <span class="n">showAll</span><span class="p">)</span>
<span class="p">{</span> <span class="n">PrintService</span><span class="o">[]</span> <span class="n">psa</span> <span class="o">=</span>
      <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
  <span class="n">listServices</span><span class="p">(</span><span class="n">psa</span><span class="p">,</span> <span class="n">showAll</span><span class="p">);</span>
<span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">listServices</span><span class="p">(</span><span class="n">PrintService</span><span class="o">[]</span> <span class="n">psa</span><span class="p">,</span>
                                         <span class="kt">boolean</span> <span class="n">showAll</span><span class="p">)</span>
<span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">psa</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">psa</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\n-------- Print services (&quot;</span> <span class="o">+</span>
                           <span class="n">psa</span><span class="p">.</span><span class="na">length</span> <span class="o">+</span> <span class="s">&quot;) ----------\n&quot;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">psa</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;. \&quot;&quot;</span> <span class="o">+</span> <span class="n">psa</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
      <span class="n">listService</span><span class="p">(</span><span class="n">psa</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span> <span class="n">showAll</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;------------------\n&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No print services found&quot;</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of listServices()</span>



<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">listService</span><span class="p">(</span><span class="n">PrintService</span> <span class="n">ps</span><span class="p">,</span> <span class="kt">boolean</span> <span class="n">showAll</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// print basic attributes</span>
  <span class="n">Attribute</span><span class="o">[]</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">ps</span><span class="p">.</span><span class="na">getAttributes</span><span class="p">().</span><span class="na">toArray</span><span class="p">();</span>
  <span class="k">for</span><span class="p">(</span><span class="n">Attribute</span> <span class="n">attr</span> <span class="p">:</span> <span class="n">attrs</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">attr</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">attr</span><span class="p">);</span>

  <span class="c1">// print the supported MIME types</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;  Supported doc types: &quot;</span><span class="p">);</span>
  <span class="n">DocFlavor</span><span class="o">[]</span> <span class="n">flavors</span> <span class="o">=</span> <span class="n">ps</span><span class="p">.</span><span class="na">getSupportedDocFlavors</span><span class="p">();</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">flavors</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Filter out DocFlavors that have a representation class other</span>
    <span class="c1">// than java.io.InputStream.</span>

    <span class="n">String</span> <span class="n">repclass</span> <span class="o">=</span> <span class="n">flavors</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="na">getRepresentationClassName</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">repclass</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;java.io.InputStream&quot;</span><span class="p">))</span> <span class="c1">// restrict to files</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">flavors</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="na">getMimeType</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>

  <span class="c1">// print every printer attribute</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">showAll</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  ----&quot;</span><span class="p">);</span>
    <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">NamedAttribute</span><span class="o">&gt;</span> <span class="n">attrList</span> <span class="o">=</span> <span class="n">getAttributes</span><span class="p">(</span><span class="n">ps</span><span class="p">);</span>
    <span class="n">Collections</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">attrList</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">NamedAttribute</span> <span class="n">attr</span> <span class="p">:</span> <span class="n">attrList</span><span class="p">)</span>
      <span class="n">printAttr</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">attr</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of listService()</span>
</code></pre></div>
<p>The lookupPrintServices() call in listServices():</p>
<div class="highlight"><pre><span></span><code><span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">)</span>
</code></pre></div>
<p>has no DocFlavor or attribute arguments, so every printer service will be returned in
the array. listServices() iterates through each PrintService object, and prints its basic
attributes, the supported MIME types for files, and optionally a list of every printer
attribute.</p>
<p>The four attributes returned by PrintService.getAttributes() are the tip of a very large
iceberg. Java supports a multitude of attributes as seen if you look at the Java 8
Attribute documentation at
<a href="https://docs.oracle.com/javase/8/docs/api/javax/print/attribute/Attribute.html">https://docs.oracle.com/javase/8/docs/api/javax/print/attribute/Attribute.html</a>. Over 70
subclasses are listed, including PrinterName, Sides, and Chromacity. A taste of what
can be printed occurs when the default printer's details are listed:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in ListPrinters.java...</span>
<span class="n">PrintService</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupDefaultPrintService</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Default printer \&quot;&quot;</span> <span class="o">+</span> <span class="n">ps</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot;:&quot;</span><span class="p">);</span>
<span class="n">JPrint</span><span class="p">.</span><span class="na">listService</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>  <span class="c1">// full info</span>
</code></pre></div>
<p>The default printer for my test machine is an old laser printer. ListPrinter.java reports
the following:</p>
<div class="highlight"><pre><span></span><code>Default printer &quot;HP LaserJet 1200 Series PCL 6&quot;:
  color-supported:not-supported
  printer-name:HP LaserJet 1200 Series PCL 6
  queued-job-count:0
  printer-is-accepting-jobs:accepting-jobs
  Supported doc types:  image/gif image/jpeg image/png
application/octet-stream
  ----
  chromaticity: color
  copies-supported: null
  ipp-attribute-fidelity: false
  job-name: Java Printing
  media: iso-a4
  media-printable-area: (4.233,4.233)-&gt;(197.951,288.459)mm
  orientation-requested: portrait
  page-ranges: 1-2147483647
  printer-resolution: 60000x60000 dphi
  requesting-user-name: Ad
  sheet-collate: uncollated
  sides: one-sided
  spool-data-destination:
file:/C:/Users/Ad/Desktop/LibreOffice%20Tests/Printing%20Tests/o
ut.prn
  sun-alternate-media: null
</code></pre></div>
<p>The "chromacity" attribute states how color and monochrome documents are mapped
to each other. Probably the attribute the user really wants to examne is "color-
supported" which shows that this printer only offers grayscales.</p>
<p>The main drawback of printing all these attributes is the time required to collect them,
sort them, and remove duplicates; each printer may take several seconds to process.</p>
<h3 id="12-discovering-print-services">1.2.  Discovering Print Services<a class="headerlink" href="#12-discovering-print-services" title="Permanent link">&para;</a></h3>
<p>PrintServiceLookup.lookupPrintServices() should be called with DocFlavor and/or
print request attributes to narrow down the search. Some examples can be found in
Discovery.java. For instance, the following fragment looks for printers that can
process JPEG files:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Discovery.java...</span>
<span class="n">DocFlavor</span> <span class="n">flavor</span> <span class="o">=</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">JPEG</span><span class="p">;</span>
<span class="n">PrintService</span><span class="o">[]</span> <span class="n">psa</span> <span class="o">=</span>
         <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="n">flavor</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\nServices that support &quot;</span> <span class="o">+</span> <span class="n">flavor</span><span class="p">);</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">pNames</span> <span class="o">=</span> <span class="n">JPrint</span><span class="p">.</span><span class="na">getPrinterNames</span><span class="p">(</span><span class="n">psa</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">pNames</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">String</span> <span class="n">pName</span> <span class="p">:</span> <span class="n">pNames</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">pName</span><span class="p">);</span>
</code></pre></div>
<p>It's very likely that the printers listed by this search can also output PDF, Word,
PowerPoint and other file formats printable from Office, since Office delivers pages
to a printer rendered as images.</p>
<p>However, if a search is made for printers that can process PDF files:</p>
<div class="highlight"><pre><span></span><code><span class="n">DocFlavor</span> <span class="n">flavor</span> <span class="o">=</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">PDF</span><span class="p">;</span>
<span class="n">PrintService</span><span class="o">[]</span> <span class="n">psa</span> <span class="o">=</span>
         <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="n">flavor</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
</code></pre></div>
<p>then no matches are found. This means that none of the printers can process PDF by
themselves.</p>
<p>JPrint.findPrinterNames() lets printers be selected based on partial names. The
following call collects all the printers whose names include "HP":</p>
<div class="highlight"><pre><span></span><code>String[] pNames = JPrint.findPrinterNames(&quot;HP&quot;);
</code></pre></div>
<p>Multiple attributes can be used in a search. The following looks for all the "HP"
printer services that support color:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Discovery.java...</span>
<span class="n">AttributeSet</span> <span class="n">attrs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashAttributeSet</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\nHP Services that support color:&quot;</span><span class="p">);</span>
<span class="n">PrintService</span><span class="o">[]</span> <span class="n">psa</span><span class="p">;</span>

<span class="k">for</span> <span class="p">(</span><span class="n">String</span> <span class="n">pName</span> <span class="p">:</span> <span class="n">pNames</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">// from the &quot;HP&quot; search above</span>
  <span class="n">attrs</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
  <span class="n">attrs</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">PrinterName</span><span class="p">(</span><span class="n">pName</span><span class="p">,</span> <span class="kc">null</span><span class="p">));</span>   <span class="c1">// must be included</span>
  <span class="n">attrs</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ColorSupported</span><span class="p">.</span><span class="na">SUPPORTED</span><span class="p">);</span>
  <span class="n">psa</span> <span class="o">=</span> <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="n">attrs</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">psa</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">pName</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>It's possible to look for color printers with less code:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Discovery.java...</span>
<span class="n">AttributeSet</span> <span class="n">attrs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashAttributeSet</span><span class="p">();</span>
<span class="n">attrs</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ColorSupported</span><span class="p">.</span><span class="na">SUPPORTED</span><span class="p">);</span>
<span class="n">PrintService</span><span class="o">[]</span> <span class="n">psa</span> <span class="o">=</span>
    <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="n">attrs</span><span class="p">);</span>
</code></pre></div>
<p>Unfortunately the returned print services include non-color printers. It seems that the
printer name must be part of the attribute set to get a correct match.</p>
<p>DocFlavors and attributes can be combined, as in the following that looks for a printer
that supports JPEG and A4 paper:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Discovery.java...</span>
<span class="n">DocFlavor</span> <span class="n">flavor</span> <span class="o">=</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">JPEG</span><span class="p">;</span>
<span class="n">AttributeSet</span> <span class="n">attrs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashAttributeSet</span><span class="p">();</span>
<span class="n">attrs</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">MediaSizeName</span><span class="p">.</span><span class="na">ISO_A4</span><span class="p">);</span>
<span class="n">PrintService</span><span class="o">[]</span> <span class="n">psa</span> <span class="o">=</span>
    <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="n">flavor</span><span class="p">,</span> <span class="n">attrs</span><span class="p">);</span>
</code></pre></div>
<p>A quite different printer selection approach is to display a dialog box at run time to let
the user set the search criteria. Java offers ServiceUI.printDialog() for this, which I've
wrapped inside JPrint.dialogSelect():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the JPrint class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">PrintService</span> <span class="nf">dialogSelect</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">GUI</span><span class="p">.</span><span class="na">setLookFeel</span><span class="p">();</span>
  <span class="n">PrintService</span> <span class="n">psa</span><span class="o">[]</span> <span class="o">=</span>
              <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupPrintServices</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
  <span class="n">PrintService</span> <span class="n">defaultService</span> <span class="o">=</span>
              <span class="n">PrintServiceLookup</span><span class="p">.</span><span class="na">lookupDefaultPrintService</span><span class="p">();</span>
  <span class="n">PrintRequestAttributeSet</span> <span class="n">attrs</span> <span class="o">=</span>
              <span class="k">new</span> <span class="n">HashPrintRequestAttributeSet</span><span class="p">();</span>  <span class="c1">// none</span>

  <span class="n">PrintService</span> <span class="n">service</span> <span class="o">=</span> <span class="n">ServiceUI</span><span class="p">.</span><span class="na">printDialog</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span>
                               <span class="n">psa</span><span class="p">,</span> <span class="n">defaultService</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="n">attrs</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">service</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No print service selected&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">service</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of dialogSelect()</span>
</code></pre></div>
<p>dialogSelect() initializes ServiceUI.printDialog() with a list of printer services, the
default printer, and an empty print request attribute set.</p>
<p>In Discovery.java, JPrint.dialogSelect() is called like so:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in Discovery.java...</span>
<span class="n">PrintService</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">JPrint</span><span class="p">.</span><span class="na">dialogSelect</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="n">ps</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\nYou selected &quot;</span> <span class="o">+</span> <span class="n">ps</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
  <span class="n">JPrint</span><span class="p">.</span><span class="na">listService</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>  <span class="c1">// full info</span>
<span class="p">}</span>
</code></pre></div>
<p>The dialog looks like Figure 1.</p>
<p><img alt="" src="images/41-Printing-1.png" /></p>
<p>Figure 1. The ServiceUI.printDialog() Dialog.</p>
<p>Pressing the "Print" button returns a PrintService reference; pressing "Cancel" returns
null.</p>
<h3 id="13-printing-using-java">1.3.  Printing Using Java<a class="headerlink" href="#13-printing-using-java" title="Permanent link">&para;</a></h3>
<p>After a print service has been selected, JPS stages 2-4 involve instantiating a Doc
object, creating a print job, and starting the printing. These are managed by my
JPrint.printFile():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the JPrint class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printFile</span><span class="p">(</span><span class="n">PrintService</span> <span class="n">ps</span><span class="p">,</span> <span class="n">String</span> <span class="n">fnm</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">ps</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Print service is null&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">DocPrintJob</span> <span class="n">printJob</span> <span class="o">=</span> <span class="n">ps</span><span class="p">.</span><span class="na">createPrintJob</span><span class="p">();</span>   <span class="c1">// stage 2</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">fnm</span><span class="p">);</span>
    <span class="n">DocFlavor</span> <span class="n">flavor</span> <span class="o">=</span> <span class="n">getFlavor</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">fnm</span><span class="p">);</span>
    <span class="n">Doc</span> <span class="n">doc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDoc</span><span class="p">(</span><span class="n">is</span><span class="p">,</span> <span class="n">flavor</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>  <span class="c1">// stage 3</span>
    <span class="n">printJob</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>                  <span class="c1">// stage 4</span>
    <span class="n">is</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unable to print &quot;</span> <span class="o">+</span> <span class="n">fnm</span><span class="p">);</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of printFile()</span>
</code></pre></div>
<p>The user supplies a PrintService and a filename. A DocFlavor for the file is obtained
by JPrint.getFlavor():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the JPrint class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">DocFlavor</span> <span class="nf">getFlavor</span><span class="p">(</span><span class="n">PrintService</span> <span class="n">ps</span><span class="p">,</span> <span class="n">String</span> <span class="n">fnm</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">DocFlavor</span> <span class="n">flavor</span> <span class="o">=</span> <span class="n">getFlavorFromFnm</span><span class="p">(</span><span class="n">fnm</span><span class="p">);</span>
   <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;File-based DocFlavor: &quot;</span> <span class="o">+</span> <span class="n">flavor</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ps</span><span class="p">.</span><span class="na">isDocFlavorSupported</span><span class="p">(</span><span class="n">flavor</span><span class="p">))</span> <span class="p">{</span>
     <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Not supported by printer;</span>
<span class="s">                                      using autosense&quot;</span><span class="p">);</span>
     <span class="n">flavor</span> <span class="o">=</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">AUTOSENSE</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="n">flavor</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getFlavor()</span>



<span class="kd">public</span> <span class="kd">static</span> <span class="n">DocFlavor</span> <span class="nf">getFlavorFromFnm</span><span class="p">(</span><span class="n">String</span> <span class="n">fnm</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">String</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">fnm</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="n">fnm</span><span class="p">.</span><span class="na">lastIndexOf</span><span class="p">(</span><span class="sc">&#39;.&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">).</span>

                                      <span class="n">toLowerCase</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">ext</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;gif&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">GIF</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ext</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;jpeg&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">JPEG</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ext</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;jpg&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">JPEG</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ext</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;png&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">PNG</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ext</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;ps&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">POSTSCRIPT</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ext</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;pdf&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">PDF</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ext</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;txt&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">TEXT_PLAIN_HOST</span><span class="p">;</span>
  <span class="k">else</span>     <span class="c1">// try to determine flavor from file content</span>
    <span class="k">return</span> <span class="n">DocFlavor</span><span class="p">.</span><span class="na">INPUT_STREAM</span><span class="p">.</span><span class="na">AUTOSENSE</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getFlavorFromFnm</span>
</code></pre></div>
<p>getFlavorFromFnm() uses the file's extension to choose a
DocFlavor.INPUT_STREAM constant, which is checked by the print service in
PrintService.isDocFlavorSupported().</p>
<p>JPrint.printFile() is utilized in my JDocPrinter.java example:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in JDocPrinter.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Usage: java JDocPrinter &lt;filename&gt;</span>
<span class="s">                   [&lt;(partial)printer-name&gt;]&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">String</span> <span class="n">fnm</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
  <span class="n">String</span> <span class="n">pName</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">pNames</span> <span class="o">=</span> <span class="n">JPrint</span><span class="p">.</span><span class="na">findPrinterNames</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pNames</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Using first match: \&quot;&quot;</span> <span class="o">+</span> <span class="n">pNames</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
      <span class="n">pName</span> <span class="o">=</span> <span class="n">pNames</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">pName</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
    <span class="n">JPrint</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">pName</span><span class="p">,</span> <span class="n">fnm</span><span class="p">);</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">PrintService</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">JPrint</span><span class="p">.</span><span class="na">dialogSelect</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ps</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
      <span class="c1">// JPrint.printMonitorFile(ps, fnm);</span>
      <span class="n">JPrint</span><span class="p">.</span><span class="na">printFile</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">fnm</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
<p>JPrint.printMonitorFile() is fancier version of JPrint.printFile() which attaches a
PrintJobListener to the print job. The listener's methods are triggered as the job passes
through its printing states such as its delivery to the printer, completion, cancellation,
or printing error.</p>
<p>The lines in JPrint.printMonitorFile() that add the listener to the print job are:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in JPrint.printMonitorFile()...</span>
<span class="n">DocPrintJob</span> <span class="n">printJob</span> <span class="o">=</span> <span class="n">ps</span><span class="p">.</span><span class="na">createPrintJob</span><span class="p">();</span>
<span class="n">printJob</span><span class="p">.</span><span class="na">addPrintJobListener</span><span class="p">(</span><span class="k">new</span> <span class="n">PJWatcher</span><span class="p">());</span>
</code></pre></div>
<p>PJWatcher implements the PrintJobListener interface:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the JPrint class</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">PJWatcher</span> <span class="kd">implements</span> <span class="n">PrintJobListener</span>
<span class="p">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printDataTransferCompleted</span><span class="p">(</span><span class="n">PrintJobEvent</span> <span class="n">pje</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot; &gt;&gt; Data transferred to printer&quot;</span><span class="p">);</span> <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printJobCanceled</span><span class="p">(</span><span class="n">PrintJobEvent</span> <span class="n">pje</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot; &gt;&gt; Print job was cancelled&quot;</span><span class="p">);</span>  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printJobCompleted</span><span class="p">(</span><span class="n">PrintJobEvent</span> <span class="n">pje</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot; &gt;&gt; Print job completed successfully&quot;</span><span class="p">);</span>  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printJobFailed</span><span class="p">(</span><span class="n">PrintJobEvent</span> <span class="n">pje</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot; &gt;&gt; Print job failed&quot;</span><span class="p">);</span>  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printJobNoMoreEvents</span><span class="p">(</span><span class="n">PrintJobEvent</span> <span class="n">pje</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot; &gt;&gt; No more events will be delivered&quot;</span><span class="p">);</span>  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printJobRequiresAttention</span><span class="p">(</span><span class="n">PrintJobEvent</span> <span class="n">pje</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot; &gt;&gt; Print job needs attention&quot;</span><span class="p">);</span> <span class="p">}</span>

<span class="p">}</span>  <span class="c1">// end of PJWatcher class</span>
</code></pre></div>
<h3 id="14-more-information-on-javaxprint">1.4.  More Information on javax.print<a class="headerlink" href="#14-more-information-on-javaxprint" title="Permanent link">&para;</a></h3>
<p>Good sources of information on Java printing include the tutorial at
<a href="https://docs.oracle.com/javase/tutorial/2d/printing/">https://docs.oracle.com/javase/tutorial/2d/printing/</a> which covers JPS and the older
Java 2D printing API, and the JPS API user guide at
<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/jps/spec/JPSTOC.fm.html">https://docs.oracle.com/javase/8/docs/technotes/guides/jps/spec/JPSTOC.fm.html</a>.</p>
<p>Two books I've found useful:</p>
<ul>
<li>Core Java, Volume II -- Advanced Features
Cay S. Horstmann; Gary Cornell
Prentice Hall, 2016, 10<sup>th</sup> ed.</li>
</ul>
<p><a href="https://horstmann.com/corejava.html">https://horstmann.com/corejava.html</a>
Chapter 7 includes a section on printing, including a table of attributes.</p>
<ul>
<li>Pro Java 8 Programming
Terrill Brett Spell
Apress, 2015, 3<sup>rd</sup> ed.</li>
</ul>
<p><a href="https://apress.com/9781484206423/">https://apress.com/9781484206423/</a>
Chapter 11 is about printing.</p>
<h2 id="2-printing-in-office">2.  Printing in Office<a class="headerlink" href="#2-printing-in-office" title="Permanent link">&para;</a></h2>
<p>In this section I'll employ the print service search methods in JPrint.java to find a
printer for Office. The service name is passed to functions that use the Office API to
send a document to the printer.</p>
<p>Only a handful of Office methods are required to print a document; the real
complexity of the API is the multitude of properties which configure how the
document is output. Not surprisingly, these properties are spread across many
modules since different document types (i.e. Writer, Draw, Impress, and Calc) are
managed by different parts of the API.</p>
<p>Figure 2 shows the OfficeDocument services and their print-related interfaces. The
words in brackets are the modules where the services are located. The rounded
rectangles refer to print property tables explained later in this chapter.</p>
<p><img alt="" src="images/41-Printing-2.png" /></p>
<p>Figure 2. The OfficeDocument Interface and its Print-related Interfaces.</p>
<p>The XPrintable interface is used when printing Writer, Draw, Impress, or Calc
documents since their services all inherit OfficeDocument. Writer documents can also
employ XPagePrintable for printing. Note that it isn't possible to print databases using
XPrintable.</p>
<p>OfficeDocument also has XPrintJobBroadcaster and XPrintableBroadcaster interfaces
for attaching listeners to a print job. However, XPrintableBroadcaster is no longer
supported, having been superseded by XPrintJobBroadcaster .</p>
<p>The tricky aspects of XPrintable, XPrintJobBroadcaster, and XPagePrintable are the
properties used to configure how they work. XPrintable.getPrinter() and
XPrintable.setPrinter() utilize PrintDescriptor properties, the XPrintJobListener
created by XPrintJobBroadcaster uses PrintableState properties, XPrintable.print()
uses PrintOptions, and XPagePrintable employs PagePrintSettings. I'll be explaining
all of these in due course, with the aid of the tables referred to in Figure 2.</p>
<p>We're not finished with properties yet. There's also several "XXXSettings" services
which configure printing properties within a document. These are summarized by
Figure 3.</p>
<p><img alt="" src="images/41-Printing-3.png" /></p>
<p>Figure 3. The Setting Services.</p>
<p>The rounded rectangles refer to property tables described later in this chapter.</p>
<h2 id="3-printing-any-document">3.  Printing any Document<a class="headerlink" href="#3-printing-any-document" title="Permanent link">&para;</a></h2>
<p>At this point you may be thinking that Office printing is rather complex. In fact, if
you're happy to print a document using the default printing settings then it's fairly
simple. The DocPrinter.java example illustrates this by printing any Office document
supplied on its command line to the default printer or to the one named in the second
command line argument. The complete code:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in DocPrinter.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Usage: DocPrinter fnm</span>
<span class="s">                        [printer-name [no-of-pages]]&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">String</span> <span class="n">fnm</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
  <span class="n">String</span> <span class="n">pName</span> <span class="o">=</span> <span class="n">JPrint</span><span class="p">.</span><span class="na">getDefaultPrinterName</span><span class="p">();</span>  <span class="c1">// default</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">// 2 or 3 args</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">printerNames</span> <span class="o">=</span> <span class="n">JPrint</span><span class="p">.</span><span class="na">findPrinterNames</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">printerNames</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Using default printer: \&quot;&quot;</span> <span class="o">+</span>
                                            <span class="n">pName</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="n">pName</span> <span class="o">=</span> <span class="n">printerNames</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Using first matching printer: \&quot;&quot;</span> <span class="o">+</span>
                                              <span class="n">pName</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">String</span> <span class="n">pagesStr</span> <span class="o">=</span> <span class="s">&quot;1-&quot;</span><span class="p">;</span>   <span class="c1">// default is print all pages</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">pagesStr</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>

  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XComponent</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">openDoc</span><span class="p">(</span><span class="n">fnm</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not open &quot;</span> <span class="o">+</span> <span class="n">fnm</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">docType</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">reportDocType</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>

  <span class="n">XPrintable</span> <span class="n">xp</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPrintable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xp</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Cannot print; XPrintable is null&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Print</span><span class="p">.</span><span class="na">isPrintable</span><span class="p">(</span><span class="n">docType</span><span class="p">))</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Cannot print that document type&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">Print</span><span class="p">.</span><span class="na">usePrinter</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">pName</span><span class="p">);</span>
    <span class="n">Print</span><span class="p">.</span><span class="na">reportPrinterProps</span><span class="p">(</span><span class="n">xp</span><span class="p">);</span>
    <span class="n">Print</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">pagesStr</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
<p>An optional third command line argument is a page range, given in string form. For
instance, "2-4;6" will print pages 2 to 4 and 6 (with the page numbering starting at 1).</p>
<p>The printer name is obtained using methods from my JPrint.java class. The Office
API takes over after the document has been loaded, and utilizes support functions in
my Print.java class (note: no "J" in the name).</p>
<p>The document type is printed and returned by Info.reportDocType() as one of:
Lo.UNKNOWN, Lo.WRITER, Lo.BASE, Lo.CALC, Lo.DRAW, Lo.IMPRESS, or
Lo.MATH.</p>
<p>The loaded document is cast to XPrintable (see Figure 1), and Print.isPrintable() tests
for those document types that can be printed using XPrintable.print():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Print class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isPrintable</span><span class="p">(</span><span class="kt">int</span> <span class="n">docType</span><span class="p">)</span>
<span class="p">{</span> <span class="k">return</span> <span class="p">((</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">WRITER</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">CALC</span><span class="p">)</span> <span class="o">||</span>
          <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">DRAW</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">IMPRESS</span><span class="p">));</span>  <span class="p">}</span>

<span class="n">Print</span><span class="p">.</span><span class="na">usePrinter</span><span class="p">()</span> <span class="n">adds</span> <span class="n">the</span> <span class="n">printer</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">name</span> <span class="n">and</span> <span class="n">paper</span> <span class="n">format</span> <span class="n">to</span> <span class="n">the</span> <span class="n">XPrintable</span>
<span class="n">properties</span> <span class="n">by</span> <span class="n">calling</span> <span class="n">XPrintable</span><span class="p">.</span><span class="na">setPrinter</span><span class="p">()</span> <span class="n">with</span> <span class="n">an</span> <span class="n">array</span> <span class="n">of</span> <span class="n">PrintDescriptor</span>
<span class="nf">properties</span> <span class="p">(</span><span class="n">see</span> <span class="n">Figure</span> <span class="mi">1</span><span class="p">):</span>

<span class="c1">// in the Print.java class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">usePrinter</span><span class="p">(</span><span class="n">XPrintable</span> <span class="n">xp</span><span class="p">,</span> <span class="n">String</span> <span class="n">printer</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xp</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Cannot set printer XPrintable is null&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Using printer \&quot;&quot;</span> <span class="o">+</span> <span class="n">printer</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
  <span class="n">xp</span><span class="p">.</span><span class="na">setPrinter</span><span class="p">(</span> <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">printer</span><span class="p">,</span>
                                 <span class="s">&quot;PaperFormat&quot;</span><span class="p">,</span> <span class="n">PaperFormat</span><span class="p">.</span><span class="na">A4</span><span class="p">)</span> <span class="p">);</span>
  <span class="n">setListener</span><span class="p">(</span><span class="n">xp</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Table 1 lists the PrintDescriptor properties, or use my lodoc.bat script to access the
class' documentation online (type <code>lodoc PrinterDescriptor</code>).</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>Name of the printer.</td>
</tr>
<tr>
<td>PaperOrientation</td>
<td>Paper orientation</td>
</tr>
<tr>
<td></td>
<td>(com.sun.star.view.PaperOrientation:</td>
</tr>
<tr>
<td></td>
<td>PORTRAIT, LANDSCAPE)</td>
</tr>
<tr>
<td>PaperFormat</td>
<td>Paper size formats</td>
</tr>
<tr>
<td></td>
<td>(com.sun.star.view.PaperFormat: A3, A4,</td>
</tr>
<tr>
<td></td>
<td>A5, B4, B5, LETTER, LEGAL,</td>
</tr>
<tr>
<td></td>
<td>TABLOID, USER)</td>
</tr>
<tr>
<td>PaperSize</td>
<td>Paper size in 100<sup>th</sup> mm</td>
</tr>
<tr>
<td></td>
<td>(com.sun.star.awt.Size).</td>
</tr>
<tr>
<td>IsBusy</td>
<td>Is the printer busy?</td>
</tr>
<tr>
<td>CanSetPaperOrientation</td>
<td>Can the paper orientation be set?</td>
</tr>
<tr>
<td>CanSetPaperFormat</td>
<td>Are other paper formats supported?</td>
</tr>
<tr>
<td>CanSetPaperSize</td>
<td>Are other paper sizes supported?</td>
</tr>
</tbody>
</table>
<p>Table 1. Properties in com.sun.star.view.PrinterDescriptor.</p>
<p>Print.setListener() inside Print.usePrinter() attaches an XPrintJobListener listener to
the print job by casting XPrintable to XPrintJobBroadcaster (see Figure 1).</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Print class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setListener</span><span class="p">(</span><span class="n">XPrintable</span> <span class="n">xp</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xp</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Cannot set listener; XPrintable is null&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">XPrintJobBroadcaster</span> <span class="n">pb</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPrintJobBroadcaster</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xp</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">pb</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Cannot obtain print job broadcaster&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">pb</span><span class="p">.</span><span class="na">addPrintJobListener</span><span class="p">(</span> <span class="k">new</span> <span class="n">XPrintJobListener</span><span class="p">()</span>
  <span class="p">{</span>
     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printJobEvent</span><span class="p">(</span><span class="n">PrintJobEvent</span> <span class="n">e</span><span class="p">)</span>
     <span class="p">{</span> <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Print Job status: &quot;</span> <span class="o">+</span>
                              <span class="n">printableState</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">State</span><span class="p">));</span>  <span class="p">}</span>

     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">disposing</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">EventObject</span> <span class="n">e</span><span class="p">)</span>
     <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Disposing of print job: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span>  <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>  <span class="c1">// end of setListener()</span>
</code></pre></div>
<p>XPrintJobListener.printJobEvent() is called at different stages during the job's
execution, and Print.printableState() converts the retrieved PrintableState constant
into a more readable string:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Print class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">printableState</span><span class="p">(</span><span class="n">PrintableState</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">PrintableState</span><span class="p">.</span><span class="na">JOB_STARTED</span> <span class="p">)</span>
   <span class="k">return</span> <span class="s">&quot;JOB_STARTED&quot;</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">PrintableState</span><span class="p">.</span><span class="na">JOB_COMPLETED</span> <span class="p">)</span>
   <span class="k">return</span> <span class="s">&quot;JOB_COMPLETED&quot;</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">PrintableState</span><span class="p">.</span><span class="na">JOB_SPOOLED</span> <span class="p">)</span>
   <span class="k">return</span> <span class="s">&quot;JOB_SPOOLED&quot;</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">PrintableState</span><span class="p">.</span><span class="na">JOB_ABORTED</span> <span class="p">)</span>
   <span class="k">return</span> <span class="s">&quot;JOB_ABORTED&quot;</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">PrintableState</span><span class="p">.</span><span class="na">JOB_FAILED</span> <span class="p">)</span>
   <span class="k">return</span> <span class="s">&quot;JOB_FAILED&quot;</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">PrintableState</span><span class="p">.</span><span class="na">JOB_SPOOLING_FAILED</span> <span class="p">)</span>
   <span class="k">return</span> <span class="s">&quot;JOB_SPOOLING_FAILED&quot;</span><span class="p">;</span>
 <span class="k">else</span> <span class="p">{</span>
   <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unknown printable state&quot;</span><span class="p">);</span>
   <span class="k">return</span> <span class="s">&quot;??&quot;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of printableState()</span>
</code></pre></div>
<p>The PrintableState constants are summarized in Table 2.</p>
<table>
<thead>
<tr>
<th>Enumerator Constant</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>JOB_STARTED</td>
<td>Printing/rendering has begun.</td>
</tr>
<tr>
<td>JOB_COMPLETED</td>
<td>Printing/rendering has finished; spooling</td>
</tr>
<tr>
<td></td>
<td>has begun.</td>
</tr>
<tr>
<td>JOB_SPOOLED</td>
<td>Spooling has finished successfully. This</td>
</tr>
<tr>
<td></td>
<td>is the "success" state for a print job.</td>
</tr>
<tr>
<td>JOB_ABORTED</td>
<td>Printing was aborted (e.g., by the user)</td>
</tr>
<tr>
<td></td>
<td>during printing or spooling.</td>
</tr>
<tr>
<td>JOB_FAILED</td>
<td>The printing ran into an error.</td>
</tr>
<tr>
<td>JOB_SPOOLING_FAILED</td>
<td>The document could be printed but not</td>
</tr>
<tr>
<td></td>
<td>spooled.</td>
</tr>
</tbody>
</table>
<p>Table 2. Properties in com.sun.star.view.PrintableState enum.</p>
<p>Back in the main() function of DocPrinter.java, Print.reportPrinterProps() outputs the
printer's PrintDescriptor settings (listed in Table 1). It loops through the properties
array returned by XPrintable.getPrinter():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Print class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">reportPrinterProps</span><span class="p">(</span><span class="n">XPrintable</span> <span class="n">xp</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xp</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Cannot report printer props&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">printProps</span> <span class="o">=</span> <span class="n">xp</span><span class="p">.</span><span class="na">getPrinter</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">printProps</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No Printer properties found&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Printer properties:&quot;</span><span class="p">);</span>
    <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">PropertyValue</span> <span class="n">prop</span> <span class="p">:</span> <span class="n">printProps</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">name</span> <span class="o">=</span> <span class="n">prop</span><span class="p">.</span><span class="na">Name</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;PaperOrientation&quot;</span><span class="p">))</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span>
               <span class="n">paperOrientation</span><span class="p">((</span><span class="n">PaperOrientation</span><span class="p">)</span><span class="n">prop</span><span class="p">.</span><span class="na">Value</span><span class="p">));</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;PaperFormat&quot;</span><span class="p">))</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span>
                       <span class="n">paperFormat</span><span class="p">((</span><span class="n">PaperFormat</span><span class="p">)</span><span class="n">prop</span><span class="p">.</span><span class="na">Value</span><span class="p">));</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;PaperSize&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">Size</span> <span class="n">sz</span> <span class="o">=</span> <span class="p">(</span><span class="n">Size</span><span class="p">)</span><span class="n">prop</span><span class="p">.</span><span class="na">Value</span><span class="p">;</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;: (&quot;</span> <span class="o">+</span>
                            <span class="n">sz</span><span class="p">.</span><span class="na">Width</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span> <span class="n">sz</span><span class="p">.</span><span class="na">Height</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="n">prop</span><span class="p">.</span><span class="na">Value</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of reportPrinterProps()</span>
</code></pre></div>
<p>The constants in the PaperOrientation and PaperFormat classes are mapped to more
easily understood strings.</p>
<p>Typical output from Print.reportPrinterProps() is:</p>
<div class="highlight"><pre><span></span><code>Printer properties:
  Name: FinePrint
  PaperOrientation: PORTRAIT
  PaperFormat: A4
  PaperSize: (11906, 16838)
  IsBusy: false
  CanSetPaperOrientation: true
  CanSetPaperFormat: true
  CanSetPaperSize: true
</code></pre></div>
<p>At last it's time to print the document. As Figure 1 indicates, the call to
XPrintable.print() is configured using PrintOptions properties, which are listed in
Table 3.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>CopyCount</td>
<td>Number of copies to print.</td>
</tr>
<tr>
<td>FileName</td>
<td>Send the output to a file rather than to the</td>
</tr>
<tr>
<td></td>
<td>printer.</td>
</tr>
<tr>
<td>Collate</td>
<td>Collate the printed pages (set to true or</td>
</tr>
<tr>
<td></td>
<td>false).</td>
</tr>
<tr>
<td>Sort</td>
<td>Sort the pages (deprecated; use Collate)</td>
</tr>
<tr>
<td>Pages</td>
<td>A string that specifies pages and page</td>
</tr>
<tr>
<td></td>
<td>ranges to print.  For example, "1-4;10" to</td>
</tr>
<tr>
<td></td>
<td>print the pages 1 to 4 and 10.</td>
</tr>
<tr>
<td>Wait</td>
<td>Wait for the print request to be</td>
</tr>
<tr>
<td></td>
<td>completed.</td>
</tr>
<tr>
<td>DuplexMode</td>
<td>Set duplex constant (using</td>
</tr>
<tr>
<td></td>
<td>com.sun.star.view.DuplexMode)</td>
</tr>
<tr>
<td>PrinterName</td>
<td>The name of the printer.</td>
</tr>
</tbody>
</table>
<p>Table 3. Properties in com.sun.star.view.PrintOptions.</p>
<p>The configuration and printing is carried out by Print.print():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Print class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="n">XPrintable</span> <span class="n">xp</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">print</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="s">&quot;1-&quot;</span><span class="p">);</span>  <span class="p">}</span>   <span class="c1">// print all the pages</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="n">XPrintable</span> <span class="n">xp</span><span class="p">,</span> <span class="n">String</span> <span class="n">pagesStr</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xp</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Cannot print; XPrintable is null&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Print range: &quot;</span> <span class="o">+</span> <span class="n">pagesStr</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Sending document...&quot;</span><span class="p">);</span>

  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">props</span> <span class="o">=</span>
           <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;Pages&quot;</span><span class="p">,</span> <span class="n">pagesStr</span><span class="p">,</span> <span class="s">&quot;Wait&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                                          <span class="c1">// synchronous</span>
                 <span class="c1">// see com.sun.star.view.PrintOptions</span>
  <span class="n">xp</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>    <span class="c1">// print the document</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Delivered&quot;</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of print()</span>
</code></pre></div>
<p>Two properties are set: "Pages" and "Wait". "Pages" could be left out if all of the
document is to printed, but "Wait" is necessary; it forces the print() call to wait until
the job has been delivered to the driver, and so has left the Office process. If "Wait"
wasn't included then DocPrinter could continue and perhaps close Office before it had
fully transmitted the document to the printer. This would cause a crash.</p>
<p>Note that there's no need to set the "PrinterName" property since its already been
supplied as one of the PrintDescriptor properties.</p>
<h2 id="4-viewing-a-documents-print-properties">4.  Viewing a Document's Print Properties<a class="headerlink" href="#4-viewing-a-documents-print-properties" title="Permanent link">&para;</a></h2>
<p>The previous section looked at printer-related properties stored in PrinterDescriptor
(Table 1) and PrintOptions (Table 2). But the real property mother lode are those
related to documents, which are stored in the many subclasses below the Settings
service (see Figure 3). The ShowPrintProps.java example prints out those properties
for a given input document. The relevant lines are:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in ShowPrintProps.java...</span>
<span class="kt">int</span> <span class="n">docType</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">reportDocType</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">XProperty</span> <span class="n">Set</span> <span class="n">docProps</span> <span class="o">=</span> <span class="n">Print</span><span class="p">.</span><span class="na">getDocSettings</span><span class="p">(</span><span class="n">docType</span><span class="p">);</span>

<span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;Document Settings&quot;</span><span class="p">,</span> <span class="n">docProps</span><span class="p">);</span>
</code></pre></div>
<p>The document type returned by Info.reportDocType() is employed by
Print.getDocSettings() to decide which of the subclasses of the Settings service (once
again, see Figure 3) should be instantiated:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Print class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XPropertySet</span> <span class="nf">getDocSettings</span><span class="p">(</span><span class="kt">int</span> <span class="n">docType</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">WRITER</span><span class="p">)</span>
    <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                  <span class="s">&quot;com.sun.star.text.DocumentSettings&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">IMPRESS</span><span class="p">)</span>
    <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                  <span class="s">&quot;com.sun.star.presentation.DocumentSettings&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">DRAW</span><span class="p">)</span>
    <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                  <span class="s">&quot;com.sun.star.drawing.DocumentSettings&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">CALC</span><span class="p">)</span>
    <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                  <span class="s">&quot;com.sun.star.sheet.DocumentSettings&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">BASE</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No document settings for a base doc&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">MATH</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No document settings for a math doc&quot;</span><span class="p">);</span>
  <span class="k">else</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unknown document type&quot;</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">props</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getDocSettings()</span>
</code></pre></div>
<p>All these setting services support XPropertySet, which is returned as
Print.getDocSettings()'s result.</p>
<p>The printing-related properties defined in the Settings superclass are listed in Table 4,
but it contains  many more properties for different aspects of a document. For a full
list, use <code>lodoc Settings document</code> to look at the online documentation. The Settings
webpage is also a good starting point for examining its DocumentSettings subclasses.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PrinterName</td>
<td>Printer used by the document.</td>
</tr>
<tr>
<td>PrinterSetup</td>
<td>A byte array containing driver-specific</td>
</tr>
<tr>
<td></td>
<td>data.</td>
</tr>
<tr>
<td>IsPrintBooklet</td>
<td>Put two document pages on one physical</td>
</tr>
<tr>
<td></td>
<td>page, such that you can fold the output</td>
</tr>
<tr>
<td></td>
<td>into a booklet.</td>
</tr>
<tr>
<td>IsPrintBookletFront</td>
<td>Only print the fronts of a booklet</td>
</tr>
<tr>
<td>IsPrintBookletBack</td>
<td>Only print the backs of a booklet</td>
</tr>
<tr>
<td>PrintQuality</td>
<td>Normal (0); Grayscale (1), Black and</td>
</tr>
<tr>
<td></td>
<td>white (2).</td>
</tr>
<tr>
<td>PrinterIndependentLayout</td>
<td>Forbid use of printer metrics for layout.</td>
</tr>
<tr>
<td>EmbedFonts</td>
<td>Whether to embed fonts used by the</td>
</tr>
<tr>
<td></td>
<td>document.</td>
</tr>
<tr>
<td>EmbedSystemFonts</td>
<td>Whether to embed system fonts used by</td>
</tr>
<tr>
<td></td>
<td>the document.</td>
</tr>
</tbody>
</table>
<p>Table 4. Printing-related Properties in com.sun.star.document.Settings.</p>
<p>Writer documents utilize the DocumentSettings service in the text module which
doesn't contain any printing properties, but is far from empty. Again, use
<code>lodoc DocumentSettings text</code> to visit its documentation in the text module. Instead, the
print properties are inherited from the PrintSettings service in the text module, which
are listed in Table 5. Use <code>lodoc PrintSettings text</code> to visit its documentation.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PrintGraphics</td>
<td>If true, print graphic objects.</td>
</tr>
<tr>
<td>PrintTables</td>
<td>If true, print text tables.</td>
</tr>
<tr>
<td>PrintDrawings</td>
<td>If true, print shapes.</td>
</tr>
<tr>
<td>PrintLeftPages</td>
<td>If true, print left pages.</td>
</tr>
<tr>
<td>PrintRightPages</td>
<td>If true, print right pages.</td>
</tr>
<tr>
<td>PrintControls</td>
<td>If true, then control shapes in the</td>
</tr>
<tr>
<td></td>
<td>document (usually inside forms) are</td>
</tr>
<tr>
<td></td>
<td>printed.</td>
</tr>
<tr>
<td>PrintReversed</td>
<td>If true, print the pages in reverse order,</td>
</tr>
<tr>
<td></td>
<td>starting with the last page.</td>
</tr>
<tr>
<td>PrintPaperFromSetup</td>
<td>If true, use the paper tray specified for</td>
</tr>
<tr>
<td></td>
<td>the system printer. If false, use the paper</td>
</tr>
<tr>
<td></td>
<td>tray specified by the page style.</td>
</tr>
<tr>
<td>PrintFaxName</td>
<td>Name of the fax machine.</td>
</tr>
<tr>
<td>PrintAnnotationMode</td>
<td>Specify how notes are printed. Uses</td>
</tr>
<tr>
<td></td>
<td>com.sun.star.text.NotePrintMode: NOT,</td>
</tr>
<tr>
<td></td>
<td>ONLY, DOC_END, or PAGE_END).</td>
</tr>
<tr>
<td>PrintProspect</td>
<td>If true, prospect printing is used. Related</td>
</tr>
<tr>
<td></td>
<td>to brochures (I think).</td>
</tr>
<tr>
<td>PrintPageBackground</td>
<td>Determines if the background color /</td>
</tr>
<tr>
<td></td>
<td>background graphic of pages is printed.</td>
</tr>
<tr>
<td>PrintBlackFonts</td>
<td>Determines if characters are printed in</td>
</tr>
<tr>
<td></td>
<td>black.</td>
</tr>
<tr>
<td>PrintEmptyPages</td>
<td>Determines if automatically inserted</td>
</tr>
<tr>
<td></td>
<td>empty pages are printed.</td>
</tr>
</tbody>
</table>
<p>Table 5. Properties in com.sun.star.text.PrintSettings.</p>
<p>Back in ShowPrintProps.java, the properties are printed with Props.showProps(). The
output is quite lengthy since every setting is printed, not just the printing-related ones
in my tables. Typical output when a Writer file is examined includes:</p>
<div class="highlight"><pre><span></span><code>  :
PrintAnnotationMode == 0
PrintBlackFonts == false
PrintControls == true
PrintDrawings == true
PrintEmptyPages == false
PrintFaxName ==
PrintGraphics == true
PrintHiddenText == false
PrintLeftPages == true
PrintPageBackground == true
PrintPaperFromSetup == false
PrintProspect == false
PrintProspectRTL == false
PrintReversed == false
PrintRightPages == true
PrintSingleJobs == false
PrintTables == true
PrintTextPlaceholder == false
PrinterIndependentLayout == 3
PrinterName ==
PrinterSetup == [B@1222c14
PropLineSpacingShrinksFirstLine == true
ProtectForm == false
RedlineProtectionKey == [B@6d8acf
Rsid == 537223
  :
</code></pre></div>
<p>A Calc file uses the DocumentSettings service in the sheet module (use
<code>lodoc DocumentSettings sheet</code> to examine its documentation). However, printing-related
properties are stored elsewhere, in the GlobalSheetSettings and PageStyle services,
which need additional code to access them as I'll explain later.</p>
<p>An Impress file uses DocumentSettings in the presentation module (see
<code>lodoc DocumentSettings service presentation</code>); its printing-related properties are given in
Table 6.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>IsPrintDrawing</td>
<td>Enables or disables the printing of the</td>
</tr>
<tr>
<td></td>
<td>drawing pages.</td>
</tr>
<tr>
<td>IsPrintNotes</td>
<td>Enables or disables the printing of the</td>
</tr>
<tr>
<td></td>
<td>notes pages.</td>
</tr>
<tr>
<td>IsPrintHandout</td>
<td>Enables or disables the printing of the</td>
</tr>
<tr>
<td></td>
<td>handout pages.</td>
</tr>
<tr>
<td>IsPrintOutline</td>
<td>Enables or disables the printing of the</td>
</tr>
<tr>
<td></td>
<td>outline pages.</td>
</tr>
<tr>
<td>IsPrintHiddenPages</td>
<td>Enables or disables the printing of draw</td>
</tr>
<tr>
<td></td>
<td>pages that are marked as hidden.</td>
</tr>
<tr>
<td>IsPrintFitPage</td>
<td>Enables or disables the fitting of the page</td>
</tr>
<tr>
<td></td>
<td>to the printable area during printing.</td>
</tr>
<tr>
<td>IsPrintTilePage</td>
<td>If this is true and the paper size for</td>
</tr>
<tr>
<td></td>
<td>printing is larger than the paper size of</td>
</tr>
<tr>
<td></td>
<td>the printer than the content is tiled over</td>
</tr>
<tr>
<td></td>
<td>multiple pages.</td>
</tr>
</tbody>
</table>
<p>Table 6. Printing-related Properties in com.sun.star.presentation.DocumentSettings.</p>
<p>Draw documents are similar to presentations, and this is reflected in the
DocumentSettings service in the drawing module (see
<code>lodoc DocumentSettings service drawing</code>) which offers a subset of the slide
properties. The printing-related ones are listed in Table 7.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>IsPrintFitPage</td>
<td>Enables or disables the fitting of the page</td>
</tr>
<tr>
<td></td>
<td>to the printable area during printing.</td>
</tr>
<tr>
<td>IsPrintTilePage</td>
<td>If this is true and the paper size for</td>
</tr>
<tr>
<td></td>
<td>printing is larger than the paper size of</td>
</tr>
<tr>
<td></td>
<td>the printer than the content is tiled over</td>
</tr>
<tr>
<td></td>
<td>multiple pages.</td>
</tr>
</tbody>
</table>
<p>Table 7. Printing-related Properties in com.sun.star.drawing.DocumentSettings.</p>
<p>The drawing and presentation DocumentSettings services inherit the Settings service,
and a HeaderFooterSettings service in the documents folder (see
<code>lodoc HeaderFooterSettings</code>), which add the properties in Table 8.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>IsPrintPageName</td>
<td>Enables or disables the printing of the</td>
</tr>
<tr>
<td></td>
<td>page name in the header or footer.</td>
</tr>
<tr>
<td>IsPrintDate</td>
<td>Enables or disables the printing of the</td>
</tr>
<tr>
<td></td>
<td>date in the header or footer.</td>
</tr>
<tr>
<td>IsPrintTime</td>
<td>Enables or disables the printing of the</td>
</tr>
<tr>
<td></td>
<td>current time in the header or footer.</td>
</tr>
</tbody>
</table>
<p>Table 8. Properties in com.sun.star.document.HeaderFooterSettings.</p>
<h3 id="41-additional-writer-print-properties">4.1.  Additional Writer Print Properties<a class="headerlink" href="#41-additional-writer-print-properties" title="Permanent link">&para;</a></h3>
<p>As Figure 2 indicates, Writer Documents have access to an XPagePrintable interface
offered by the GenericTextDocument service (see <code>lodoc XPagePrintable</code>). It has a
print method, XPagePrintable.printPages() which utilizes properties stored in the
PagePrintSettings service (see Table 9). These relate to the document's margins and
printing multiple pages on a single sheet.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PageRows</td>
<td>Number of page rows on each</td>
</tr>
<tr>
<td></td>
<td>printed page.</td>
</tr>
<tr>
<td>PageColumns</td>
<td>Number of page columns on each</td>
</tr>
<tr>
<td></td>
<td>printed page.</td>
</tr>
<tr>
<td>LeftMargin</td>
<td>Left margin of the printed page.</td>
</tr>
<tr>
<td>RightMargin</td>
<td>Right margin.</td>
</tr>
<tr>
<td>TopMargin</td>
<td>Top margin.</td>
</tr>
<tr>
<td>BottomMargin</td>
<td>Bottom margin.</td>
</tr>
<tr>
<td>HoriMargin</td>
<td>Margin between page rows.</td>
</tr>
<tr>
<td>VertMargin</td>
<td>Margin between page columns.</td>
</tr>
<tr>
<td>IsLandscape</td>
<td>Print in landscape format?</td>
</tr>
</tbody>
</table>
<p>Table 9. Properties in com.sun.star.text.PagePrintSettings.</p>
<p>These properties are printed by casting the document to XPagePrintable:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of ShowPrintProps.java...</span>
<span class="k">if</span> <span class="p">(</span><span class="n">docType</span> <span class="o">==</span> <span class="n">Lo</span><span class="p">.</span><span class="na">WRITER</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">XPagePrintable</span> <span class="n">xpp</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPagePrintable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">printProps</span> <span class="o">=</span> <span class="n">xpp</span><span class="p">.</span><span class="na">getPagePrintSettings</span><span class="p">();</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;Page print settings&quot;</span><span class="p">,</span> <span class="n">printProps</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Typical output is:</p>
<div class="highlight"><pre><span></span><code>Properties for &quot;Page print settings&quot;:
  PageRows: 1
  PageColumns: 1
  LeftMargin: 0
  RightMargin: 0
  TopMargin: 0
  BottomMargin: 0
  HoriMargin: 0
  VertMargin: 0
  IsLandscape: false
</code></pre></div>
<h3 id="42-additional-calc-print-properties">4.2.  Additional Calc Print Properties<a class="headerlink" href="#42-additional-calc-print-properties" title="Permanent link">&para;</a></h3>
<p>Figure 3 indicates that a Calc document has three sources of printing-related
properties: DocumentSettings in the sheet module, GlobalSheetSettings also in the
sheet module, and PageStyle in the style module.</p>
<p>In a break with usual Office conventions, the GlobalSheetService service (see
<code>lodoc GlobalSheetSettings</code>) doesn’t store the properties; instead they're maintained by its
XGlobalSheetSettings interface (see <code>lodoc XGlobalSheetSettings</code>). The printing-
related properties are listed in Table 10.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PrintAllSheets</td>
<td>Specifies whether all sheets or only</td>
</tr>
<tr>
<td></td>
<td>selected sheets are printed.</td>
</tr>
<tr>
<td>PrintEmptyPages</td>
<td>Specifies whether empty pages are</td>
</tr>
<tr>
<td></td>
<td>printed.</td>
</tr>
<tr>
<td>UsePrinterMetrics</td>
<td>Specifies whether printer metrics are used</td>
</tr>
<tr>
<td></td>
<td>for display.</td>
</tr>
</tbody>
</table>
<p>Table 10. Printing-related Properties in com.sun.star.sheet.XGlobalSheetSettings.</p>
<p>This organization of the documentation may be an error, since the
XGlobalSheetSettings properties are accessed in the usual way, by instantiating the
GlobalSheetSettings service, and casting it to XPropertySet:</p>
<div class="highlight"><pre><span></span><code><span class="n">XPropertySet</span> <span class="n">globalSheetProps</span> <span class="o">=</span>
      <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
             <span class="s">&quot;com.sun.star.sheet.GlobalSheetSettings&quot;</span><span class="p">);</span>

<span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;Global Sheet Settings&quot;</span><span class="p">,</span> <span class="n">globalSheetProps</span><span class="p">);</span>
</code></pre></div>
<p>GlobalSheetSettings properties are applied to all sheets, so you may want to reset a
changed property to its original value after a print. There's an example of using global
sheet settings in PrintSheet.java later in this chapter.</p>
<p>Another source of spreadsheet properties is the PageStyle service. I explained page
styles in Chapter 22, so I refer you back there for the details. A page style is
associated with a sheet, and so it's necessary to first choose a sheet to examine, and
then access its "PageStyle" property:</p>
<div class="highlight"><pre><span></span><code><span class="n">XSpreadsheetDocument</span> <span class="n">ssDoc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSSDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="n">XSpreadsheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheet</span><span class="p">(</span><span class="n">ssDoc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>   <span class="c1">// first sheet</span>

<span class="n">String</span> <span class="n">styleName</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span> <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;PageStyle&quot;</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\nPageStyle of first sheet: &quot;</span> <span class="o">+</span> <span class="n">styleName</span><span class="p">);</span>
</code></pre></div>
<p>The page style name is used to lookup the properties for that particular style:</p>
<div class="highlight"><pre><span></span><code><span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Info</span><span class="p">.</span><span class="na">getStyleProps</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;PageStyles&quot;</span><span class="p">,</span>
                                                     <span class="n">styleName</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="n">styleName</span> <span class="o">+</span> <span class="s">&quot; PageStyles&quot;</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
</code></pre></div>
<p>Props.showProps() prints an extensive list of properties, drawn form several services
in the PageStyle hierarchy. A simplified version of that hierarchy is shown in Figure
4.</p>
<p><img alt="" src="images/41-Printing-4.png" /></p>
<p>Figure 4. Part of the PageStyle Service Hierarchy.</p>
<p>I'm only interested in printing-related properties in this chapter. Some come from the
PageProperties service in the style module (see <code>lodoc PageProperties style</code>), as listed
in Table 11.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Lots of border props…</td>
<td></td>
</tr>
<tr>
<td>Lots of margin props…</td>
<td></td>
</tr>
<tr>
<td>IsLandscape</td>
<td>Determines if the page format is</td>
</tr>
<tr>
<td></td>
<td>landscape.</td>
</tr>
<tr>
<td>PrinterPaperTray</td>
<td>Contains the name of a paper</td>
</tr>
<tr>
<td></td>
<td>tray of the selected printer.</td>
</tr>
<tr>
<td>Lots of header props…</td>
<td></td>
</tr>
<tr>
<td>Lots of footer props…</td>
<td></td>
</tr>
<tr>
<td>Lots of grid props…</td>
<td></td>
</tr>
<tr>
<td>GridPrint</td>
<td>Determines whether text grid</td>
</tr>
<tr>
<td></td>
<td>lines are printed.</td>
</tr>
</tbody>
</table>
<p>Table 11. Printing-related Properties in com.sun.star.style.PageProperties.</p>
<p>Many more print properties come from TablePageStyle in the sheet module (see
<code>lodoc TablePageStyle</code>, which are given in Table 12.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PrintAnnotations</td>
<td>Enables printing of cell annotations.</td>
</tr>
<tr>
<td>PrintGrid</td>
<td>Enables printing of the cell grid.</td>
</tr>
<tr>
<td>PrintHeaders</td>
<td>Enables printing of column and row</td>
</tr>
<tr>
<td></td>
<td>headers.</td>
</tr>
<tr>
<td>PrintCharts</td>
<td>Enables printing of charts.</td>
</tr>
<tr>
<td>PrintObjects</td>
<td>Enables printing of embedded objects.</td>
</tr>
<tr>
<td>PrintDrawing</td>
<td>Enables printing of drawing objects.</td>
</tr>
<tr>
<td>PrintFormulas</td>
<td>Enables printing of formulas instead of their</td>
</tr>
<tr>
<td></td>
<td>results.</td>
</tr>
<tr>
<td>PrintZeroValues</td>
<td>Enables printing of zero-values.</td>
</tr>
<tr>
<td>PrintDownFirst</td>
<td>Specifies the print order for the pages within</td>
</tr>
<tr>
<td></td>
<td>each sheet.</td>
</tr>
<tr>
<td>PageScale</td>
<td>Contains the scaling factor (in percent) for</td>
</tr>
<tr>
<td></td>
<td>printing the sheet.</td>
</tr>
<tr>
<td>ScaleToPages</td>
<td>Contains the number of pages the sheet will</td>
</tr>
<tr>
<td></td>
<td>use for printing.</td>
</tr>
<tr>
<td>ScaleToPagesX</td>
<td>Contains the number of horizontal pages the</td>
</tr>
<tr>
<td></td>
<td>sheet will be printed on.</td>
</tr>
<tr>
<td>ScaleToPagesY</td>
<td>Contains the number of vertical pages the</td>
</tr>
<tr>
<td></td>
<td>sheet will be printed on.</td>
</tr>
<tr>
<td>LeftPageHeaderContent</td>
<td>Contains the content of the header for the</td>
</tr>
<tr>
<td></td>
<td>left pages</td>
</tr>
<tr>
<td></td>
<td>(com.sun.star.sheet.XHeaderFooterContent).</td>
</tr>
<tr>
<td>RightPageHeaderContent</td>
<td>Contains the content of the header for the</td>
</tr>
<tr>
<td></td>
<td>right pages</td>
</tr>
<tr>
<td></td>
<td>(com.sun.star.sheet.XHeaderFooterContent).</td>
</tr>
<tr>
<td>LeftPageFooterContent</td>
<td>Contains the content of the footer for the left</td>
</tr>
<tr>
<td></td>
<td>pages</td>
</tr>
<tr>
<td></td>
<td>(com.sun.star.sheet.XHeaderFooterContent).</td>
</tr>
<tr>
<td>RightPageFooterContent</td>
<td>Contains the content of the footer for the</td>
</tr>
<tr>
<td></td>
<td>right pages</td>
</tr>
<tr>
<td></td>
<td>(com.sun.star.sheet.XHeaderFooterContent).</td>
</tr>
</tbody>
</table>
<p>Table 12. Printing-related Properties in com.sun.star.sheet.TablePageStyle.</p>
<h2 id="5-specialized-printing">5.  Specialized Printing<a class="headerlink" href="#5-specialized-printing" title="Permanent link">&para;</a></h2>
<p>In this section I'll use some of the document properties just described to control how
Writer, Impress, and Calc documents are printed. The example code is in
TextPrinter.java, ImpressPrinter.java, SheetPrinter.java, and PrintSheet.java.</p>
<p>The sad news is that although TextPrinter.java and ImpressPrinter.java successfully
print their documents, the API ignores most of the changes to the properties. Perhaps
even sadder (from a programming perspective) is the fact that these same documents
are correctly printed if the properties are set via Office's GUI.</p>
<p>Aside from this, the print GUI in Office offers more functionality than the API. For
example, it's possible to output multiple slides and sheets on a single page through the
print dialog but not with API calls.</p>
<h3 id="51-printing-a-text-document">5.1.  Printing a Text Document<a class="headerlink" href="#51-printing-a-text-document" title="Permanent link">&para;</a></h3>
<p>TextPrinter.java sends a text document to a specified printer, with two pages printed
on each sheet.</p>
<p>After the document has been loaded, the printing is carried out by:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of TextPrinter.java...</span>
<span class="n">XPrintable</span> <span class="n">xp</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPrintable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
<span class="n">Print</span><span class="p">.</span><span class="na">usePrinter</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">pName</span><span class="p">);</span>

<span class="n">XPagePrintable</span> <span class="n">xpp</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPagePrintable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
<span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">props</span> <span class="o">=</span> <span class="n">xpp</span><span class="p">.</span><span class="na">getPagePrintSettings</span><span class="p">();</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProp</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;IsLandscape&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProp</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;PageColumns&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">short</span><span class="p">)</span><span class="mi">2</span><span class="p">);</span>

<span class="n">xpp</span><span class="p">.</span><span class="na">setPagePrintSettings</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
<span class="n">xpp</span><span class="p">.</span><span class="na">printPages</span><span class="p">(</span><span class="k">new</span> <span class="n">PropertyValue</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span>    <span class="c1">// empty array of props</span>
</code></pre></div>
<p>To help understand what the code is doing, refer back to Figure 2. The document is
cast to XPrintable so the printer settings can be initialized by Print.usePrinter(). Then
the document is cast to XPagePrintable so its PagePrintSettings properties can be
configured. That's done via XPagePrintable.setPagePrintSettings() and finally
XPagePrintable.printPages() is called with an empty array.</p>
<p>The document is printed but unfortunately the two pages/sheet and landscape settings
are ignored.</p>
<p>This bug has been known for many years, and some people have suggested an
alternative implementation where the properties are passed to
XPagePrintable.printPages() rather than to XPagePrintable.setPagePrintSettings().</p>
<p>The last two lines from above would be replaced by:</p>
<div class="highlight"><pre><span></span><code><span class="n">xpp</span><span class="p">.</span><span class="na">printPages</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
</code></pre></div>
<p>Unfortunately this produces the same output in my tests.</p>
<p>If the Writer document is printed through the Office GUI, then the print dialog looks
something like Figure 5.</p>
<p><img alt="" src="images/41-Printing-5.png" /></p>
<p>Figure 5. The Writer application's Print Dialog.</p>
<p>The pages/sheet settings are on the "Page Layout" tab, as in Figure 6.</p>
<p><img alt="" src="images/41-Printing-6.png" /></p>
<p>Figure 6. The "Page Layout" Tabbed Window in the Print Dialog.</p>
<p>When "Ok" is pressed, the document is printed correctly.</p>
<h3 id="52-printing-an-impress-document">5.2.  Printing an Impress Document<a class="headerlink" href="#52-printing-an-impress-document" title="Permanent link">&para;</a></h3>
<p>ImpressPrinter.java prints an Impress document to the specified printer in handout
format, six slides per sheet, in black and white. A4 paper in landscape mode is
utilized.</p>
<p>After the document has been loaded, the printing is carried out by the following code:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of ImpressPrinter.java...</span>
<span class="c1">// set document props</span>
<span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                   <span class="s">&quot;com.sun.star.presentation.DocumentSettings&quot;</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperties</span><span class="p">(</span><span class="n">props</span><span class="p">,</span>
  <span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="p">{</span><span class="s">&quot;IsPrintHandout&quot;</span><span class="p">,</span><span class="s">&quot;SlidesPerHandout&quot;</span><span class="p">,</span><span class="s">&quot;IsPrintFitPage&quot;</span><span class="p">,</span>
                <span class="s">&quot;IsPrintDate&quot;</span><span class="p">,</span> <span class="s">&quot;PrintQuality&quot;</span><span class="p">,</span> <span class="s">&quot;PrinterName&quot;</span> <span class="p">},</span>
  <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{</span> <span class="kc">true</span><span class="p">,</span> <span class="p">(</span><span class="kt">short</span><span class="p">)</span><span class="mi">6</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pName</span><span class="p">}</span>   <span class="c1">// 2 == B&amp;W</span>
<span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;Document Settings&quot;</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>

<span class="c1">// set printer props</span>
<span class="n">XPrintable</span> <span class="n">xp</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPrintable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
<span class="n">Print</span><span class="p">.</span><span class="na">usePrinter</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">pName</span><span class="p">);</span>
<span class="n">xp</span><span class="p">.</span><span class="na">setPrinter</span><span class="p">(</span> <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span>
              <span class="s">&quot;PaperOrientation&quot;</span><span class="p">,</span> <span class="n">PaperOrientation</span><span class="p">.</span><span class="na">LANDSCAPE</span><span class="p">,</span>
              <span class="s">&quot;PaperFormat&quot;</span><span class="p">,</span> <span class="n">PaperFormat</span><span class="p">.</span><span class="na">A4</span><span class="p">)</span> <span class="p">);</span>
<span class="n">Print</span><span class="p">.</span><span class="na">reportPrinterProps</span><span class="p">(</span><span class="n">xp</span><span class="p">);</span>

<span class="n">Print</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">xp</span><span class="p">);</span>
</code></pre></div>
<p>To help understand what the code is doing, refer back to Figure 2. A presentation
DocumentSettings service is created, and its printing properties set. The
"PrintQuality" and "PrinterName" properties are from the Settings service (see Table
4), "IsPrintHandout" and "IsPrintFitPage" are from DocumentSettings (see table 6),
and "IsPrintDate" from HeaderFooterSettings (see Table 8). This leaves the
"SlidesPerHandout" property, which isn't documented anywhere. I discovered it by
looking at the print-out of that service's properties with:</p>
<div class="highlight"><pre><span></span><code><span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;Document Settings&quot;</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>
</code></pre></div>
<p>The printer properties are set as in earlier examples, but with the addition of
"PaperOrientation" and "PaperFormat" which are PrintDescriptor properties (see table
1).</p>
<p>The document is printed but as one color slide per sheet; the handout and black and
white settings are ignored.</p>
<p>If the same Impress document is printed through the Office GUI, then the print dialog
looks like Figure 7.</p>
<p><img alt="" src="images/41-Printing-7.png" /></p>
<p>Figure 7. The Impress application's Print Dialog.</p>
<p>This is much closer to what I want to output, although I couldn't print the handouts in
landscape mode.</p>
<h3 id="53-printing-a-calc-document">5.3.  Printing a Calc Document<a class="headerlink" href="#53-printing-a-calc-document" title="Permanent link">&para;</a></h3>
<p>SheetPrinter.java prints the first sheet of a Calc document, scaled so that two pages
are used in the vertical direction. Also, the paper is set to landscape mode and A4
size, and the header's central field is modified. In addition, commented-out code
restricts the printed area of the sheet to be a single column.</p>
<p>The good news is that all of these setting are correctly processed at print-time.</p>
<p>After the document has been loaded, the printing is carried out by:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of SheetPrinter.java...</span>

<span class="n">XSpreadsheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheet</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="c1">// first sheet</span>
<span class="n">String</span> <span class="n">styleName</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span> <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;PageStyle&quot;</span><span class="p">);</span>

<span class="c1">// get the properties set for the sheet&#39;s page style</span>
<span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span>
              <span class="n">Info</span><span class="p">.</span><span class="na">getStyleProps</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;PageStyles&quot;</span><span class="p">,</span> <span class="n">styleName</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;ScaleToPagesY&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">short</span><span class="p">)</span><span class="mi">2</span><span class="p">);</span>
                 <span class="c1">// use a max of 2 pages on the y-axis</span>
<span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="n">styleName</span><span class="p">,</span> <span class="n">props</span><span class="p">);</span>

<span class="n">showTotalsHeader</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm">  // print only the &quot;E&quot; column</span>
<span class="cm">  XPrintAreas printAreas = Lo.qi(XPrintAreas.class, sheet);</span>
<span class="cm">  printAreas.setPrintAreas(new CellRangeAddress[] {});</span>
<span class="cm">                 // reset print areas</span>

<span class="cm">  CellRangeAddress addr = Calc.getAddress(sheet, &quot;E1:E111&quot;);</span>
<span class="cm">  printAreas.setPrintAreas(new CellRangeAddress[]{ addr });</span>
<span class="cm">                 // set area</span>
<span class="cm">*/</span>

<span class="c1">// set printer settings</span>
<span class="n">XPrintable</span> <span class="n">xp</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPrintable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
<span class="n">Print</span><span class="p">.</span><span class="na">usePrinter</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">pName</span><span class="p">);</span>
<span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">printProps</span> <span class="o">=</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;PaperOrientation&quot;</span><span class="p">,</span> <span class="n">PaperOrientation</span><span class="p">.</span><span class="na">LANDSCAPE</span><span class="p">,</span>
                    <span class="s">&quot;PageFormat&quot;</span><span class="p">,</span> <span class="n">PaperFormat</span><span class="p">.</span><span class="na">A4</span><span class="p">);</span>
<span class="n">xp</span><span class="p">.</span><span class="na">setPrinter</span><span class="p">(</span><span class="n">printProps</span><span class="p">);</span>
<span class="n">Print</span><span class="p">.</span><span class="na">reportPrinterProps</span><span class="p">(</span><span class="n">xp</span><span class="p">);</span>

<span class="n">Print</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">xp</span><span class="p">);</span>
</code></pre></div>
<p>The scaling is done by accessing the sheet's page style properties, and setting the
"ScaleToPagesY" value. This is one of the TablePageStyle properties listed in Table
12.</p>
<h4 id="headers-and-footers">Headers and Footers<a class="headerlink" href="#headers-and-footers" title="Permanent link">&para;</a></h4>
<p>The headers and footers are manipulated by showTotalsHeader():</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in SheetPrinter.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">showTotalsHeader</span><span class="p">(</span><span class="n">XPropertySet</span> <span class="n">props</span><span class="p">)</span>
<span class="c1">// change the header of the sheet</span>
<span class="p">{</span>
  <span class="c1">//  get the right-hand header and footer</span>
  <span class="n">XHeaderFooterContent</span> <span class="n">header</span> <span class="o">=</span>
            <span class="n">Calc</span><span class="p">.</span><span class="na">getHeadFoot</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;RightPageHeaderContent&quot;</span><span class="p">);</span>
  <span class="n">XHeaderFooterContent</span> <span class="n">footer</span> <span class="o">=</span>
            <span class="n">Calc</span><span class="p">.</span><span class="na">getHeadFoot</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;RightPageFooterContent&quot;</span><span class="p">);</span>

  <span class="c1">// print details about them</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">printHeadFoot</span><span class="p">(</span><span class="s">&quot;Right Header&quot;</span><span class="p">,</span> <span class="n">header</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">printHeadFoot</span><span class="p">(</span><span class="s">&quot;Right Footer&quot;</span><span class="p">,</span> <span class="n">footer</span><span class="p">);</span>

  <span class="c1">// modify the header center text to be &quot;Totals&quot;</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">setHeadFoot</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">Calc</span><span class="p">.</span><span class="na">HF_CENTER</span><span class="p">,</span> <span class="s">&quot;Totals&quot;</span><span class="p">);</span>

  <span class="c1">// turn on headers and make left and right page headers the same</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;HeaderIsOn&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;HeaderIsShared&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                              <span class="c1">// from style.PageProperties</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;RightPageHeaderContent&quot;</span><span class="p">,</span> <span class="n">header</span><span class="p">);</span>
  <span class="p">}</span>  <span class="c1">// end of showTotalsHeader()</span>
</code></pre></div>
<p>A sheet may have two headers (one for the left hand page, one for the right) and two
footers, which are accessed as XHeaderFooterContent objects (see
<code>lodoc XHeaderFooterContent</code>). XHeaderFooterContent  is a collection of three XText
instances representing the left, center, and right of the content area.</p>
<p>The headers and footers are accessed via the sheet's page style properties, stored as
the properties "LeftPageHeaderContent", "RightPageHeaderContent",
"LeftPageFooterContent", and "RightPageFooterContent" in the TablePageStyle
service (see Table 12).</p>
<p>Calc.getHeadFoot() retrieves the page style properties, and returns the requested
XHeaderFooterContent:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XHeaderFooterContent</span> <span class="nf">getHeadFoot</span><span class="p">(</span><span class="n">XPropertySet</span> <span class="n">props</span><span class="p">,</span>
                                               <span class="n">String</span> <span class="n">content</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span> <span class="n">XHeaderFooterContent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                            <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="n">content</span><span class="p">));</span>  <span class="p">}</span>
</code></pre></div>
<p>Calc.printHeadFoot() prints the three text fields inside the XHeaderFooterContent
object:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printHeadFoot</span><span class="p">(</span><span class="n">String</span> <span class="n">title</span><span class="p">,</span>
                                 <span class="n">XHeaderFooterContent</span> <span class="n">hfc</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XText</span> <span class="n">left</span> <span class="o">=</span> <span class="n">hfc</span><span class="p">.</span><span class="na">getLeftText</span><span class="p">();</span>
  <span class="n">XText</span> <span class="n">center</span> <span class="o">=</span> <span class="n">hfc</span><span class="p">.</span><span class="na">getCenterText</span><span class="p">();</span>
  <span class="n">XText</span> <span class="n">right</span> <span class="o">=</span> <span class="n">hfc</span><span class="p">.</span><span class="na">getRightText</span><span class="p">();</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s">&quot;: \&quot;&quot;</span> <span class="o">+</span> <span class="n">left</span><span class="p">.</span><span class="na">getString</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot; : \&quot;&quot;</span> <span class="o">+</span>
                                <span class="n">center</span><span class="p">.</span><span class="na">getString</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot; : \&quot;&quot;</span> <span class="o">+</span>
                                <span class="n">right</span><span class="p">.</span><span class="na">getString</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of showHeadFoot()</span>
</code></pre></div>
<p>Calc.setHeadFoot() can change the text in the left, center, or right of a
XHeaderFooterContent instance:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in the Calc class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setHeadFoot</span><span class="p">(</span><span class="n">XHeaderFooterContent</span> <span class="n">hfc</span><span class="p">,</span>
                                     <span class="kt">int</span> <span class="n">region</span><span class="p">,</span> <span class="n">String</span> <span class="n">text</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XText</span> <span class="n">xText</span> <span class="o">=</span> <span class="n">getRegion</span><span class="p">(</span><span class="n">hfc</span><span class="p">,</span> <span class="n">region</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xText</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not set text&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">XTextCursor</span> <span class="n">headerCursor</span> <span class="o">=</span> <span class="n">xText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>
  <span class="n">headerCursor</span><span class="p">.</span><span class="na">gotoStart</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="n">headerCursor</span><span class="p">.</span><span class="na">gotoEnd</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
  <span class="n">headerCursor</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of setHeadFoot()</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="n">XText</span> <span class="nf">getRegion</span><span class="p">(</span><span class="n">XHeaderFooterContent</span> <span class="n">hfc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">region</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">hfc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Header/footer content is null&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">region</span> <span class="o">==</span> <span class="n">HF_LEFT</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hfc</span><span class="p">.</span><span class="na">getLeftText</span><span class="p">();</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">region</span> <span class="o">==</span> <span class="n">HF_CENTER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hfc</span><span class="p">.</span><span class="na">getCenterText</span><span class="p">();</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">region</span> <span class="o">==</span> <span class="n">HF_RIGHT</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hfc</span><span class="p">.</span><span class="na">getRightText</span><span class="p">();</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unknown header/footer region&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of getRegion()</span>
</code></pre></div>
<p>Back in SheetPrinter.java, showTotalsHeader() changes the central text field of the
right header to "Totals". It then switches on the display of headers, makes the left and
right headers the same, and inserts the modified XHeaderFooterContent instance back
into the page styles:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of showTotalsHeader() in SheetPrinter.java...</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;HeaderIsOn&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;HeaderIsShared&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                          <span class="c1">// from style.PageProperties</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="s">&quot;RightPageHeaderContent&quot;</span><span class="p">,</span> <span class="n">header</span><span class="p">);</span>
</code></pre></div>
<h4 id="print-areas">Print Areas<a class="headerlink" href="#print-areas" title="Permanent link">&para;</a></h4>
<p>A sheet is usually manipulated via the XSpreadsheet interface in the Spreadsheet
service. However, Spreadsheet supports a number of other interfaces, including
XPrintAreas for specifying printable areas within a sheet. This interface is illustrated
in Figure 8.</p>
<p><img alt="" src="images/41-Printing-8.png" /></p>
<p>Figure 8. The Spreadsheet XPrintAreas Interface.</p>
<p>Aside from defining printable areas, XPrintAreas also has methods for setting which
rows and/or columns are repeated if a sheet spans several pages.</p>
<p>The commented out code in SheetPrinter.java does two things: it cancels any existing
print areas, and specifies that only the "E" column will be printed:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// part of SheetPrinter.java...</span>
<span class="n">XPrintAreas</span> <span class="n">printAreas</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPrintAreas</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>
<span class="n">printAreas</span><span class="p">.</span><span class="na">setPrintAreas</span><span class="p">(</span><span class="k">new</span> <span class="n">CellRangeAddress</span><span class="o">[]</span> <span class="p">{});</span>
                     <span class="c1">// cancel print areas</span>

<span class="n">CellRangeAddress</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getAddress</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s">&quot;E1:E111&quot;</span><span class="p">);</span>
<span class="n">printAreas</span><span class="p">.</span><span class="na">setPrintAreas</span><span class="p">(</span><span class="k">new</span> <span class="n">CellRangeAddress</span><span class="o">[]</span><span class="p">{</span> <span class="n">addr</span> <span class="p">});</span>
                    <span class="c1">// set area to be the &quot;E&quot; column</span>
</code></pre></div>
<h3 id="54-printing-a-single-sheet">5.4.  Printing a Single Sheet<a class="headerlink" href="#54-printing-a-single-sheet" title="Permanent link">&para;</a></h3>
<p>My thanks to user "villeroy" on the OpenOffice forums for suggesting this example:
how is a single sheet of a multi-sheet spreadsheet printed?</p>
<p>One part of the solution is to set the "PrintAllSheets" property to false in the
GlobalSheetSettings service (see Table 10). The other is to make the current sheet
explicitly active in the XSpreadsheetView interface, which is equivalent to bringing
the sheet to the foreground in the Calc application.</p>
<p>The PrintSheet.java example shows how to do this for a spreadsheet of three sheets,
where only "Sheet2" is printed:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// in PrintSheet.java</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// hardwired spreadsheet and printer choice</span>
  <span class="n">String</span> <span class="n">fnm</span> <span class="o">=</span> <span class="s">&quot;tables.ods&quot;</span><span class="p">;</span>
  <span class="n">String</span> <span class="n">pName</span> <span class="o">=</span> <span class="s">&quot;FinePrint&quot;</span><span class="p">;</span>

  <span class="c1">// load the spreadsheet</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XComponent</span> <span class="n">cDoc</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">openReadOnlyDoc</span><span class="p">(</span><span class="n">fnm</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>
  <span class="n">XSpreadsheetDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSSDoc</span><span class="p">(</span><span class="n">cDoc</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not open &quot;</span> <span class="o">+</span> <span class="n">fnm</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// what are the sheets called?</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">sheetNms</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheetNames</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Names of sheets (&quot;</span> <span class="o">+</span> <span class="n">sheetNms</span><span class="p">.</span><span class="na">length</span> <span class="o">+</span> <span class="s">&quot;):&quot;</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">String</span> <span class="n">sheetNm</span> <span class="p">:</span> <span class="n">sheetNms</span><span class="p">)</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="n">sheetNm</span><span class="p">);</span>

  <span class="c1">// make &quot;Sheet2&quot; active</span>
  <span class="n">XSpreadsheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">.</span><span class="na">getSheet</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;Sheet2&quot;</span><span class="p">);</span>
  <span class="n">Calc</span><span class="p">.</span><span class="na">setActiveSheet</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">sheet</span><span class="p">);</span>

  <span class="c1">// set Global Sheet settings</span>
  <span class="c1">// changes are remembered</span>
  <span class="n">XPropertySet</span> <span class="n">gsProps</span> <span class="o">=</span>
              <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMCF</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                   <span class="s">&quot;com.sun.star.sheet.GlobalSheetSettings&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">gsProps</span><span class="p">,</span> <span class="s">&quot;PrintAllSheets&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;Global Sheet Settings&quot;</span><span class="p">,</span> <span class="n">gsProps</span><span class="p">);</span>

  <span class="c1">// set printer settings</span>
  <span class="n">XPrintable</span> <span class="n">xp</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPrintable</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
  <span class="n">Print</span><span class="p">.</span><span class="na">usePrinter</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">pName</span><span class="p">);</span>
  <span class="n">PropertyValue</span><span class="o">[]</span> <span class="n">printProps</span> <span class="o">=</span>
      <span class="n">Props</span><span class="p">.</span><span class="na">makeProps</span><span class="p">(</span><span class="s">&quot;PaperOrientation&quot;</span><span class="p">,</span> <span class="n">PaperOrientation</span><span class="p">.</span><span class="na">LANDSCAPE</span><span class="p">,</span>
                      <span class="s">&quot;PageFormat&quot;</span><span class="p">,</span> <span class="n">PaperFormat</span><span class="p">.</span><span class="na">A4</span><span class="p">);</span>
  <span class="n">xp</span><span class="p">.</span><span class="na">setPrinter</span><span class="p">(</span><span class="n">printProps</span><span class="p">);</span>

  <span class="n">Print</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">xp</span><span class="p">);</span>

  <span class="c1">// reset global settings</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">gsProps</span><span class="p">,</span> <span class="s">&quot;PrintAllSheets&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span>  <span class="c1">// end of main()</span>
</code></pre></div>
<p>One issue with changing GlobalSheet settings is that they are remembered after Office
has closed, and will be used by default during future prints. In that case, it's a good
idea to reset the "PrintAllSheets" to true after the Print.print() call.</p>
<h2 id="6-a-bad-idea-hacking-the-gui">6.  A Bad Idea: Hacking the GUI<a class="headerlink" href="#6-a-bad-idea-hacking-the-gui" title="Permanent link">&para;</a></h2>
<p>A recurring observation of the last few sections is that printer dialogs inside Office are
less buggy and more feature-rich than the API. In previous chapters, I've sometimes
resorted to using Office's GUI by sending dispatch messages, and key presses to the
window. I decided not to follow that approach here since it's too unreliable.</p>
<p>Getting to the print dialog is straightforward. The document window is made visible,
and an ".uno:Print" dispatch opens the print dialog:</p>
<div class="highlight"><pre><span></span><code>GUI.setVisible(doc, true);
Lo.delay(1000);   // give the Office window time to appear
Lo.dispatchCmd(&quot;Print&quot;);
Lo.delay(500);    // give the Print dialog time to appear
</code></pre></div>
<p>The first problem is that the print dialog uses tabbed windows, and the window that's
foremost can vary. Usually it's the "General" window (e.g. see Figure 5), but if the
user has previously clicked the "Ok" button in another tabbed window (such as the
"Page Layout" window in Figure 6) then that window will be foremost when the print
dialog is next invoked. This means that my code cannot be sure which tabbed window
is active after the "Print" dispatch.</p>
<p>There's also the issue of moving around the tabbed windows and their fields. This can
be implemented using Java's Robot class to send TAB and CTRL-TAB characters, as
in:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">ctrlTab</span><span class="p">()</span>
<span class="c1">// send a CTRL-TAB character combination</span>
<span class="p">{</span> <span class="k">try</span> <span class="p">{</span>
    <span class="n">Robot</span> <span class="n">robot</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Robot</span><span class="p">();</span>
    <span class="n">robot</span><span class="p">.</span><span class="na">keyPress</span><span class="p">(</span><span class="n">KeyEvent</span><span class="p">.</span><span class="na">VK_CONTROL</span><span class="p">);</span>
    <span class="n">robot</span><span class="p">.</span><span class="na">keyPress</span><span class="p">(</span><span class="n">KeyEvent</span><span class="p">.</span><span class="na">VK_TAB</span><span class="p">);</span>
    <span class="n">robot</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">robot</span><span class="p">.</span><span class="na">keyRelease</span><span class="p">(</span><span class="n">KeyEvent</span><span class="p">.</span><span class="na">VK_TAB</span><span class="p">);</span>
    <span class="n">robot</span><span class="p">.</span><span class="na">keyRelease</span><span class="p">(</span><span class="n">KeyEvent</span><span class="p">.</span><span class="na">VK_CONTROL</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">AWTException</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span> <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
<span class="p">}</span>   <span class="c1">// end of ctrlTab()</span>
</code></pre></div>
<p>The difficulty is knowing how many TABs and CTRL-TABs are needed, which
depends on the tab ordering of each window.</p>
<p>Even if my code somehow managed to get to the correct field in the correct tabbed
window, there's still the problem of entering data and 'pressing' the "Ok" button
afterwards.</p>
<p>On balance, I decided not to bother implementing this 'solution'.</p>
<h2 id="7-command-prompt-printing">7.  Command Prompt Printing<a class="headerlink" href="#7-command-prompt-printing" title="Permanent link">&para;</a></h2>
<p>Another approach to printing documents, which avoids the use of Java, is to utilize
command line utilities.</p>
<p>There's no shortage of command line printing tools in Linux and the Mac OS, based
around the CUPS printing system ( <a href="https://cups.org/">https://cups.org/</a>), and plenty of sites
explaining how to use lp, lpq, lpstat and others (e.g.
<a href="https://computerhope.com/unix/ulp.htm">https://computerhope.com/unix/ulp.htm</a>,
<a href="https://eecs.utk.edu/resources/it/kb/printing/linux-command-line/">https://eecs.utk.edu/resources/it/kb/printing/linux-command-line/</a>).</p>
<p>Perhaps less well known are the printing utilities in Windows, listed in Table 13.</p>
<table>
<thead>
<tr>
<th>VBScript</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Prnmngr.vbs</td>
<td>Printer management. Adds, deletes, and</td>
</tr>
<tr>
<td></td>
<td>lists printers or printer connections, in</td>
</tr>
<tr>
<td></td>
<td>addition to setting and displaying the</td>
</tr>
<tr>
<td></td>
<td>default printer.</td>
</tr>
<tr>
<td></td>
<td>Used by printersList.bat</td>
</tr>
<tr>
<td>Prncnfg.vbs</td>
<td>Configures or displays configuration</td>
</tr>
<tr>
<td></td>
<td>information about a printer.</td>
</tr>
<tr>
<td></td>
<td>Used by printerStatus.bat</td>
</tr>
<tr>
<td>Prnjobs.vbs</td>
<td>Pauses, resumes, cancels, and lists print</td>
</tr>
<tr>
<td></td>
<td>jobs.</td>
</tr>
<tr>
<td></td>
<td>Used by printerJobs.bat</td>
</tr>
<tr>
<td>Prnqctl.vbs</td>
<td>Printer queue management. Prints a test</td>
</tr>
<tr>
<td></td>
<td>page, pauses or resumes a printer, and</td>
</tr>
<tr>
<td></td>
<td>clears a printer queue.</td>
</tr>
<tr>
<td></td>
<td>Used by printerClean.bat</td>
</tr>
<tr>
<td>Prndrvr.vbs</td>
<td>Adds, deletes, and lists printer drivers.</td>
</tr>
<tr>
<td>Prnport.vbs</td>
<td>Printer port management.</td>
</tr>
<tr>
<td>Pubprn.vbs</td>
<td>Publish a printer to Active Directory.</td>
</tr>
</tbody>
</table>
<p>Table 13. Windows 7's VBScript Printing Utilities.</p>
<p>The utilities are Visual Basic scripts, located in the
C:\Windows\System32\Printing_Admin_Scripts\en-US folder which isn't a standard
part of Window's PATH environment variable.</p>
<p>One way of finding documentation on these tools is by starting "Windows Help" and
then following the links to the commands reference section. This will eventually take
you to Microsoft's TechNet website. A slightly easier alternative is the TechRepublic
article "How to take advantage of the hidden VBScript print utilities in Windows 10"
by Greg Shultz at
<a href="https://techrepublic.com/article/how-to-take-advantage-of-the-hidden-vbscript-print-utilities-in-windows-10/">https://techrepublic.com/article/how-to-take-advantage-of-the-hidden-vbscript-print-utilities-in-windows-10/</a>.</p>
<p>In my "Printing Tests" examples folder, there are four Batch files (printersList.bat,
printerStatus.bat, printerJobs.bat, and printerClean.bat) which use these VBScripts in
simple ways.</p>
<p>printersList.bat lists the names of all the print services visible to Windows, and also
the name of the default printer. For example:</p>
<div class="highlight"><pre><span></span><code>&gt;  printersList
Printer name Send To OneNote 2010
Printer name Ricoh Aficio MP 2000 PCL(Black Office Room)
Printer name PrinterShare
Printer name Print to Evernote
Printer name Microsoft XPS Document Writer
Printer name HPLJM806 (HP LaserJet M806)
Printer name HP LaserJet9040DN PCL 6(Office)
Printer name HP LaserJet M806 PCL 6
Printer name HP LaserJet 1200 Series PCL 6
Printer name Foxit PhantomPDF Printer
Printer name FinePrint
Printer name Fax

The default printer is FinePrint
</code></pre></div>
<p>These names can be used as printer name arguments in my earlier Java programs.</p>
<p>printerStatus.bat reports the status of a printer:</p>
<div class="highlight"><pre><span></span><code>&gt;  printerStatus &quot;HP LaserJet 1200 Series PCL 6&quot;
Printer status Idle
Extended printer status Unknown
</code></pre></div>
<p>printerJobs.bat lists all the print jobs currently on a printer's queue:</p>
<div class="highlight"><pre><span></span><code>&gt;  printerJobs &quot;HP LaserJet 1200 Series PCL 6&quot;
Number of print jobs enumerated 0
</code></pre></div>
<p>printerClean.bat deletes all the jobs on a printer queue:</p>
<div class="highlight"><pre><span></span><code>&gt;  printerClean &quot;HP LaserJet 1200 Series PCL 6&quot;
Microsoft (R) Windows Script Host Version 5.8
Copyright (C) Microsoft Corporation. All rights reserved.
</code></pre></div>
<p>Success Purge Printer HP LaserJet 1200 Series PCL 6</p>
<p>Notably missing from the VBScripts is a way to print a document, perhaps because
Windows already has an awesome "print" command:</p>
<div class="highlight"><pre><span></span><code>&gt;  print /?
Prints a text file.

PRINT [/D:device] [[drive:][path]filename[...]]
   /D:device   Specifies a print device.
</code></pre></div>
<p>An alternative is "printui" which starts Window's printui.dll
(<a href="https://technet.microsoft.com/en-us/library/ee624057(v=ws.11).aspx">https://technet.microsoft.com/en-us/library/ee624057(v=ws.11).aspx</a>).</p>
<p>However, I'd not recommend "print" or "printui" since Office is a much better
command line printing tool.</p>
<p>If you open a command prompt in the Office directory (e.g. in C:\Program
Files\LibreOffice 5), you can get a list of its command line options by typing:</p>
<div class="highlight"><pre><span></span><code>&gt; soffice.exe –h
</code></pre></div>
<p>Figure 9 shows the top half of a long window.</p>
<p><img alt="" src="images/41-Printing-9.png" /></p>
<p>Figure 9. Some of Office Command Line Arguments.</p>
<p>Another information source is the "Starting the LibreOffice Software With
Parameters" webpage at
<a href="https://help.libreoffice.org/Common/Starting_the_Software_With_Parameters">https://help.libreoffice.org/Common/Starting_the_Software_With_Parameters</a>.</p>
<p>The relevant parameters for printing are "-p" and "--pt", which can be seen near the
bottom of Figure 9. "-p" prints a file to the default printer, while "--pt" (note the two '-
's)  sends the document to the named printer. A suitable name can be obtained from
the printersList.bat script.</p>
<p>I've utilized these parameters in a loprint.bat script in the "Printing Tests" folder. If
loprint is called with no arguments, then Figure 9's help window is displayed. If a
filename argument is supplied then the document is sent to the default printer using
the '-p' parameter. Two arguments are assumed to be a printer name and filename, and
are processed by "--pt". For example:</p>
<div class="highlight"><pre><span></span><code>&gt; loprint &quot;HP LaserJet 1200 Series PCL 6&quot; cover.odg
</code></pre></div>
<p>prints the cover.odg Draw file to the HP laserjet.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="40-Building_a_Form.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 40. Building a Form Programmatically" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 40. Building a Form Programmatically
            </div>
          </div>
        </a>
      
      
        
        <a href="42-Sending_E-mail.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 42. Sending E-mail" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 42. Sending E-mail
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>